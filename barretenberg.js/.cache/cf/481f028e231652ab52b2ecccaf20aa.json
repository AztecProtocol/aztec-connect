{"id":"y3oE","dependencies":[{"name":"/mnt/user-data/zac/aztec-public/barretenberg.js/package.json","includedInParent":true,"mtime":1647611995497},{"name":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/package.json","includedInParent":true,"mtime":1613910913767},{"name":"bn.js","loc":{"line":3,"column":17},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/bn.js/lib/bn.js"},{"name":"hmac-drbg","loc":{"line":4,"column":23},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/hmac-drbg/lib/hmac-drbg.js"},{"name":"../utils","loc":{"line":5,"column":20},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/utils.js"},{"name":"../curves","loc":{"line":6,"column":21},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/curves.js"},{"name":"brorand","loc":{"line":7,"column":19},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/brorand/index.js"},{"name":"./key","loc":{"line":10,"column":22},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/ec/key.js"},{"name":"./signature","loc":{"line":11,"column":24},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/ec/index.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/elliptic/lib/elliptic/ec/signature.js"}],"generated":{"js":"\"use strict\";var e=require(\"bn.js\"),r=require(\"hmac-drbg\"),t=require(\"../utils\"),n=require(\"../curves\"),i=require(\"brorand\"),s=t.assert,o=require(\"./key\"),u=require(\"./signature\");function h(e){if(!(this instanceof h))return new h(e);\"string\"==typeof e&&(s(Object.prototype.hasOwnProperty.call(n,e),\"Unknown curve \"+e),e=n[e]),e instanceof n.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}module.exports=h,h.prototype.keyPair=function(e){return new o(this,e)},h.prototype.keyFromPrivate=function(e,r){return o.fromPrivate(this,e,r)},h.prototype.keyFromPublic=function(e,r){return o.fromPublic(this,e,r)},h.prototype.genKeyPair=function(t){t||(t={});for(var n=new r({hash:this.hash,pers:t.pers,persEnc:t.persEnc||\"utf8\",entropy:t.entropy||i(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||\"utf8\",nonce:this.n.toArray()}),s=this.n.byteLength(),o=this.n.sub(new e(2));;){var u=new e(n.generate(s));if(!(u.cmp(o)>0))return u.iaddn(1),this.keyFromPrivate(u)}},h.prototype._truncateToN=function(e,r){var t=8*e.byteLength()-this.n.bitLength();return t>0&&(e=e.ushrn(t)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e},h.prototype.sign=function(t,n,i,s){\"object\"==typeof i&&(s=i,i=null),s||(s={}),n=this.keyFromPrivate(n,i),t=this._truncateToN(new e(t,16));for(var o=this.n.byteLength(),h=n.getPrivate().toArray(\"be\",o),c=t.toArray(\"be\",o),a=new r({hash:this.hash,entropy:h,nonce:c,pers:s.pers,persEnc:s.persEnc||\"utf8\"}),p=this.n.sub(new e(1)),m=0;;m++){var v=s.k?s.k(m):new e(a.generate(this.n.byteLength()));if(!((v=this._truncateToN(v,!0)).cmpn(1)<=0||v.cmp(p)>=0)){var y=this.g.mul(v);if(!y.isInfinity()){var f=y.getX(),g=f.umod(this.n);if(0!==g.cmpn(0)){var d=v.invm(this.n).mul(g.mul(n.getPrivate()).iadd(t));if(0!==(d=d.umod(this.n)).cmpn(0)){var l=(y.getY().isOdd()?1:0)|(0!==f.cmp(g)?2:0);return s.canonical&&d.cmp(this.nh)>0&&(d=this.n.sub(d),l^=1),new u({r:g,s:d,recoveryParam:l})}}}}}},h.prototype.verify=function(r,t,n,i){r=this._truncateToN(new e(r,16)),n=this.keyFromPublic(n,i);var s=(t=new u(t,\"hex\")).r,o=t.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var h,c=o.invm(this.n),a=c.mul(r).umod(this.n),p=c.mul(s).umod(this.n);return this.curve._maxwellTrick?!(h=this.g.jmulAdd(a,n.getPublic(),p)).isInfinity()&&h.eqXToP(s):!(h=this.g.mulAdd(a,n.getPublic(),p)).isInfinity()&&0===h.getX().umod(this.n).cmp(s)},h.prototype.recoverPubKey=function(r,t,n,i){s((3&n)===n,\"The recovery param is more than two bits\"),t=new u(t,i);var o=this.n,h=new e(r),c=t.r,a=t.s,p=1&n,m=n>>1;if(c.cmp(this.curve.p.umod(this.curve.n))>=0&&m)throw new Error(\"Unable to find sencond key candinate\");c=m?this.curve.pointFromX(c.add(this.curve.n),p):this.curve.pointFromX(c,p);var v=t.r.invm(o),y=o.sub(h).mul(v).umod(o),f=a.mul(v).umod(o);return this.g.mulAdd(y,c,f)},h.prototype.getKeyRecoveryParam=function(e,r,t,n){if(null!==(r=new u(r,n)).recoveryParam)return r.recoveryParam;for(var i=0;i<4;i++){var s;try{s=this.recoverPubKey(e,r,i)}catch(e){continue}if(s.eq(t))return i}throw new Error(\"Unable to find valid recovery factor\")};"},"sourceMaps":null,"error":null,"hash":"a1f7ae776f3f0440c703c175f28a10aa","cacheData":{"env":{}}}