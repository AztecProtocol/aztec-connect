{"id":"plny","dependencies":[{"name":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/package.json","includedInParent":true,"mtime":1657108767863},{"name":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/package.json","includedInParent":true,"mtime":1614073142184},{"name":"hash.js","loc":{"line":3,"column":19},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/lib/elliptic/eddsa/index.js","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/hash.js/lib/hash.js"},{"name":"../curves","loc":{"line":4,"column":21},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/lib/elliptic/eddsa/index.js","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/lib/elliptic/curves.js"},{"name":"../utils","loc":{"line":5,"column":20},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/lib/elliptic/eddsa/index.js","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/lib/elliptic/utils.js"},{"name":"./key","loc":{"line":8,"column":22},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/lib/elliptic/eddsa/index.js","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/lib/elliptic/eddsa/key.js"},{"name":"./signature","loc":{"line":9,"column":24},"parent":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/lib/elliptic/eddsa/index.js","resolved":"/mnt/user-data/ariel/aztec2-internal/barretenberg.js/node_modules/elliptic/lib/elliptic/eddsa/signature.js"}],"generated":{"js":"\"use strict\";var t=require(\"hash.js\"),e=require(\"../curves\"),n=require(\"../utils\"),r=n.assert,i=n.parseBytes,o=require(\"./key\"),s=require(\"./signature\");function u(n){if(r(\"ed25519\"===n,\"only tested with ed25519 so far\"),!(this instanceof u))return new u(n);n=e[n].curve,this.curve=n,this.g=n.g,this.g.precompute(n.n.bitLength()+1),this.pointClass=n.point().constructor,this.encodingLength=Math.ceil(n.n.bitLength()/8),this.hash=t.sha512}module.exports=u,u.prototype.sign=function(t,e){t=i(t);var n=this.keyFromSecret(e),r=this.hashInt(n.messagePrefix(),t),o=this.g.mul(r),s=this.encodePoint(o),u=this.hashInt(s,n.pubBytes(),t).mul(n.priv()),h=r.add(u).umod(this.curve.n);return this.makeSignature({R:o,S:h,Rencoded:s})},u.prototype.verify=function(t,e,n){t=i(t),e=this.makeSignature(e);var r=this.keyFromPublic(n),o=this.hashInt(e.Rencoded(),r.pubBytes(),t),s=this.g.mul(e.S());return e.R().add(r.pub().mul(o)).eq(s)},u.prototype.hashInt=function(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return n.intFromLE(t.digest()).umod(this.curve.n)},u.prototype.keyFromPublic=function(t){return o.fromPublic(this,t)},u.prototype.keyFromSecret=function(t){return o.fromSecret(this,t)},u.prototype.makeSignature=function(t){return t instanceof s?t:new s(this,t)},u.prototype.encodePoint=function(t){var e=t.getY().toArray(\"le\",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},u.prototype.decodePoint=function(t){var e=(t=n.parseBytes(t)).length-1,r=t.slice(0,e).concat(-129&t[e]),i=0!=(128&t[e]),o=n.intFromLE(r);return this.curve.pointFromY(o,i)},u.prototype.encodeInt=function(t){return t.toArray(\"le\",this.encodingLength)},u.prototype.decodeInt=function(t){return n.intFromLE(t)},u.prototype.isPoint=function(t){return t instanceof this.pointClass};"},"sourceMaps":null,"error":null,"hash":"4e29a6f4f83ae3d2e230c1a5bb15ea15","cacheData":{"env":{}}}