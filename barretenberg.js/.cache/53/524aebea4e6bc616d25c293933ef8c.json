{"id":"e7yD","dependencies":[{"name":"/mnt/user-data/zac/aztec-public/barretenberg.js/package.json","includedInParent":true,"mtime":1647611995497},{"name":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/package.json","includedInParent":true,"mtime":1638215579157},{"name":"debug","loc":{"line":10,"column":24},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/master/spawn.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/debug/src/browser.js"},{"name":"observable-fns","loc":{"line":11,"column":27},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/master/spawn.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/observable-fns/dist.esm/index.js"},{"name":"../common","loc":{"line":12,"column":28},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/master/spawn.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/common.js"},{"name":"../promise","loc":{"line":13,"column":42},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/master/spawn.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/promise.js"},{"name":"../symbols","loc":{"line":14,"column":54},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/master/spawn.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/symbols.js"},{"name":"../types/master","loc":{"line":15,"column":32},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/master/spawn.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/types/master.js"},{"name":"./invocation-proxy","loc":{"line":16,"column":55},"parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/master/spawn.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/master/invocation-proxy.js"},{"name":"process","parent":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/threads/dist-esm/master/spawn.js","resolved":"/mnt/user-data/zac/aztec-public/barretenberg.js/node_modules/process/browser.js"}],"generated":{"js":"var process = require(\"process\");\nvar e=require(\"process\");Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.spawn=x;var t=u(require(\"debug\")),r=require(\"observable-fns\"),n=require(\"../common\"),o=require(\"../promise\"),i=require(\"../symbols\"),s=require(\"../types/master\"),a=require(\"./invocation-proxy\");function u(e){return e&&e.__esModule?e:{default:e}}var c=function(e,t,r,n){return new(r||(r=Promise))(function(o,i){function s(e){try{u(n.next(e))}catch(t){i(t)}}function a(e){try{u(n.throw(e))}catch(t){i(t)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(s,a)}u((n=n.apply(e,t||[])).next())})};const d=(0,t.default)(\"threads:master:messages\"),m=(0,t.default)(\"threads:master:spawn\"),v=(0,t.default)(\"threads:master:thread-utils\"),l=e=>e&&\"init\"===e.type,f=e=>e&&\"uncaughtError\"===e.type,p=1e4;function y(e,t,r){return c(this,void 0,void 0,function*(){let n;const o=new Promise((e,o)=>{n=setTimeout(()=>o(Error(r)),t)}),i=yield Promise.race([e,o]);return clearTimeout(n),i})}function h(e){return new Promise((t,r)=>{const o=i=>{d(\"Message from worker before finishing initialization:\",i.data),l(i.data)?(e.removeEventListener(\"message\",o),t(i.data)):f(i.data)&&(e.removeEventListener(\"message\",o),r((0,n.deserialize)(i.data.error)))};e.addEventListener(\"message\",o)})}function E(e,t){return new r.Observable(r=>{const n=e=>{const t={type:s.WorkerEventType.message,data:e.data};r.next(t)},o=e=>{v(\"Unhandled promise rejection event in thread:\",e);const t={type:s.WorkerEventType.internalError,error:Error(e.reason)};r.next(t)};e.addEventListener(\"message\",n),e.addEventListener(\"unhandledrejection\",o),t.then(()=>{const t={type:s.WorkerEventType.termination};e.removeEventListener(\"message\",n),e.removeEventListener(\"unhandledrejection\",o),r.next(t),r.complete()})})}function g(e){const[t,r]=(0,o.createPromiseWithResolver)();return{terminate:()=>c(this,void 0,void 0,function*(){v(\"Terminating worker\"),yield e.terminate(),r()}),termination:t}}function w(e,t,r,n){const o=r.filter(e=>e.type===s.WorkerEventType.internalError).map(e=>e.error);return Object.assign(e,{[i.$errors]:o,[i.$events]:r,[i.$terminate]:n,[i.$worker]:t})}function x(e,t){return c(this,void 0,void 0,function*(){m(\"Initializing new thread\");const r=t&&t.timeout?t.timeout:p,n=(yield y(h(e),r,`Timeout: Did not receive an init message from worker after ${r}ms. Make sure the worker calls expose().`)).exposed,{termination:o,terminate:i}=g(e),s=E(e,o);if(\"function\"===n.type){return w((0,a.createProxyFunction)(e),e,s,i)}if(\"module\"===n.type){return w((0,a.createProxyModule)(e,n.methods),e,s,i)}{const e=n.type;throw Error(`Worker init message states unexpected type of expose(): ${e}`)}})}"},"sourceMaps":null,"error":null,"hash":"af38997d89a842108b8e36446266a82d","cacheData":{"env":{}}}