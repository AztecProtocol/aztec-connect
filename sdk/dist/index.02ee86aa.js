function e(e,t,n,r){Object.defineProperty(e,t,{get:n,set:r,enumerable:!0,configurable:!0})}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{};function n(e){return e&&e.__esModule?e.default:e}var r={},i={},o=t.parcelRequire5a21;null==o&&((o=function(e){if(e in r)return r[e].exports;if(e in i){var t=i[e];delete i[e];var n={id:e,exports:{}};return r[e]=n,t.call(n.exports,n,n.exports),n.exports}var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}).register=function(e,t){i[e]=t},t.parcelRequire5a21=o),o.register("3KgUz",(function(e,t){var n,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,n)}(e,i,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var i,o,a,s;if(u(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=c(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,s=l,console&&console.warn&&console.warn(s)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):m(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[e];if(void 0===u)return!1;if("function"==typeof u)i(u,this,t);else{var c=u.length,l=m(u,c);for(n=0;n<c;++n)i(l[n],this,t)}return!0},a.prototype.addListener=function(e,t){return l(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return l(this,e,t,!0)},a.prototype.once=function(e,t){return u(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,i,o,a;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}})),o.register("7LjTn",(function(e,t){var n=o("iThRa");e.exports.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let r=0,i=0;t[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(r++,"%c"===e&&(i=r))})),t.splice(i,0,n)},e.exports.save=function(t){try{t?e.exports.storage.setItem("debug",t):e.exports.storage.removeItem("debug")}catch(e){}},e.exports.load=function(){let t;try{t=e.exports.storage.getItem("debug")}catch(e){}!t&&void 0!==n&&"env"in n&&(t=void 0);return t},e.exports.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.exports.storage=function(){try{return localStorage}catch(e){}}(),e.exports.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.exports.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.exports.log=console.debug||console.log||(()=>{}),e.exports=o("3KKPB")(e.exports);const{formatters:r}=e.exports;r.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}})),o.register("iThRa",(function(e,t){e.exports={}})),o.register("3KKPB",(function(e,t){e.exports=function(e){function t(e){let r,i,o,a=null;function s(...e){if(!s.enabled)return;const n=s,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];r=o.call(n,t),e.splice(a,1),a--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=n,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=o("6iIV1"),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}})),o.register("6iIV1",(function(e,t){var n=1e3,r=6e4,i=36e5,o=864e5,a=6048e5,s=315576e5;function u(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,t){t=t||{};var c,l,f=typeof e;if("string"===f&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var u=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*a;case"days":case"day":case"d":return u*o;case"hours":case"hour":case"hrs":case"hr":case"h":return u*i;case"minutes":case"minute":case"mins":case"min":case"m":return u*r;case"seconds":case"second":case"secs":case"sec":case"s":return u*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(e);if("number"===f&&isFinite(e))return t.long?(c=e,(l=Math.abs(c))>=o?u(c,l,o,"day"):l>=i?u(c,l,i,"hour"):l>=r?u(c,l,r,"minute"):l>=n?u(c,l,n,"second"):c+" ms"):function(e){var t=Math.abs(e);return t>=o?Math.round(e/o)+"d":t>=i?Math.round(e/i)+"h":t>=r?Math.round(e/r)+"m":t>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}})),o.register("575lo",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AccountId=void 0;var r=o("1T4rt");class i{constructor(e,t){this.publicKey=e,this.accountNonce=t}static fromBuffer(e){if(68!==e.length)throw new Error("Invalid id buffer.");const t=new r.GrumpkinAddress(e.slice(0,64)),n=e.readUInt32BE(64);return new i(t,n)}static fromString(e){const[t,n,o]=e.match(/^0x([0-9a-f]{128}) \(([0-9]+)\)$/i)||[];if(!t)throw new Error("Invalid id string.");const a=r.GrumpkinAddress.fromString(n);return new i(a,+o)}static random(){const e=Math.floor(Math.random()*2**32);return new i(r.GrumpkinAddress.random(),e)}equals(e){return this.toBuffer().equals(e.toBuffer())}toBuffer(){const e=n.alloc(4);return e.writeUInt32BE(this.accountNonce),n.concat([this.publicKey.toBuffer(),e])}toString(){return`${this.publicKey.toString()} (${this.accountNonce})`}toShortString(){return`${this.publicKey.toString().slice(0,10)}/${this.accountNonce}`}}e.exports.AccountId=i})),o.register("150uq",(function(t,n){var r,i,a,s;e(t.exports,"Buffer",(()=>r),(e=>r=e)),e(t.exports,"SlowBuffer",(()=>i),(e=>i=e)),e(t.exports,"INSPECT_MAX_BYTES",(()=>a),(e=>a=e)),e(t.exports,"kMaxLength",(()=>s),(e=>s=e));var u=o("966pb"),c=o("aXpis");const l="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;r=d,i=function(e){+e!=e&&(e=0);return d.alloc(+e)},a=50;const f=2147483647;function h(e){if(e>f)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,d.prototype),t}function d(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return y(e)}return p(e,t,n)}function p(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!d.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|w(e,t);let r=h(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(ee(e,Uint8Array)){const t=new Uint8Array(e);return b(t.buffer,t.byteOffset,t.byteLength)}return g(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(ee(e,ArrayBuffer)||e&&ee(e.buffer,ArrayBuffer))return b(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(ee(e,SharedArrayBuffer)||e&&ee(e.buffer,SharedArrayBuffer)))return b(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return d.from(r,t,n);const i=function(e){if(d.isBuffer(e)){const t=0|v(e.length),n=h(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||te(e.length)?h(0):g(e);if("Buffer"===e.type&&Array.isArray(e.data))return g(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return d.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function m(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function y(e){return m(e),h(e<0?0:0|v(e))}function g(e){const t=e.length<0?0:0|v(e.length),n=h(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function b(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,d.prototype),r}function v(e){if(e>=f)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+f.toString(16)+" bytes");return 0|e}function w(e,t){if(d.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||ee(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return $(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return Y(e).length;default:if(i)return r?-1:$(e).length;t=(""+t).toLowerCase(),i=!0}}function _(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return B(this,t,n);case"utf8":case"utf-8":return N(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return k(this,t,n);case"base64":return P(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function E(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function S(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),te(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=d.from(t,r)),d.isBuffer(t))return 0===t.length?-1:x(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):x(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function x(e,t,n,r,i){let o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let r=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===u)return r*a}else-1!==r&&(o-=o-r),r=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){let n=!0;for(let r=0;r<u;r++)if(c(e,o+r)!==c(t,r)){n=!1;break}if(n)return o}return-1}function T(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let a;for(r>o/2&&(r=o/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(te(r))return a;e[n+a]=r}return a}function M(e,t,n,r){return X($(t,e.length-n),e,n,r)}function A(e,t,n,r){return X(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function R(e,t,n,r){return X(Y(t),e,n,r)}function I(e,t,n,r){return X(function(e,t){let n,r,i;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function P(e,t,n){return 0===t&&n===e.length?u.fromByteArray(e):u.fromByteArray(e.slice(t,n))}function N(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=n){let n,r,s,u;switch(a){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(u=(31&t)<<6|63&n,u>127&&(o=u));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(u=(15&t)<<12|(63&n)<<6|63&r,u>2047&&(u<55296||u>57343)&&(o=u));break;case 4:n=e[i+1],r=e[i+2],s=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(u=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s,u>65535&&u<1114112&&(o=u))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=a}return function(e){const t=e.length;if(t<=O)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=O));return n}(r)}s=f,d.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),d.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(d.prototype,"parent",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.buffer}}),Object.defineProperty(d.prototype,"offset",{enumerable:!0,get:function(){if(d.isBuffer(this))return this.byteOffset}}),d.poolSize=8192,d.from=function(e,t,n){return p(e,t,n)},Object.setPrototypeOf(d.prototype,Uint8Array.prototype),Object.setPrototypeOf(d,Uint8Array),d.alloc=function(e,t,n){return function(e,t,n){return m(e),e<=0?h(e):void 0!==t?"string"==typeof n?h(e).fill(t,n):h(e).fill(t):h(e)}(e,t,n)},d.allocUnsafe=function(e){return y(e)},d.allocUnsafeSlow=function(e){return y(e)},d.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==d.prototype},d.compare=function(e,t){if(ee(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),ee(t,Uint8Array)&&(t=d.from(t,t.offset,t.byteLength)),!d.isBuffer(e)||!d.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},d.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},d.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return d.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=d.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(ee(t,Uint8Array))i+t.length>r.length?(d.isBuffer(t)||(t=d.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!d.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},d.byteLength=w,d.prototype._isBuffer=!0,d.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)E(this,t,t+1);return this},d.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)E(this,t,t+3),E(this,t+1,t+2);return this},d.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)E(this,t,t+7),E(this,t+1,t+6),E(this,t+2,t+5),E(this,t+3,t+4);return this},d.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?N(this,0,e):_.apply(this,arguments)},d.prototype.toLocaleString=d.prototype.toString,d.prototype.equals=function(e){if(!d.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===d.compare(this,e)},d.prototype.inspect=function(){let e="";const t=a;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},l&&(d.prototype[l]=d.prototype.inspect),d.prototype.compare=function(e,t,n,r,i){if(ee(e,Uint8Array)&&(e=d.from(e,e.offset,e.byteLength)),!d.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const s=Math.min(o,a),u=this.slice(r,i),c=e.slice(t,n);for(let e=0;e<s;++e)if(u[e]!==c[e]){o=u[e],a=c[e];break}return o<a?-1:a<o?1:0},d.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},d.prototype.indexOf=function(e,t,n){return S(this,e,t,n,!0)},d.prototype.lastIndexOf=function(e,t,n){return S(this,e,t,n,!1)},d.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return T(this,e,t,n);case"utf8":case"utf-8":return M(this,e,t,n);case"ascii":case"latin1":case"binary":return A(this,e,t,n);case"base64":return R(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},d.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const O=4096;function C(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function k(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function B(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=ne[e[r]];return i}function D(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function j(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,r,i,o){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function q(e,t,n,r,i){G(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function U(e,t,n,r,i){G(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function F(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function K(e,t,n,r,i){return t=+t,n>>>=0,i||F(e,0,n,4),c.write(e,t,n,r,23,4),n+4}function V(e,t,n,r,i){return t=+t,n>>>=0,i||F(e,0,n,8),c.write(e,t,n,r,52,8),n+8}d.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,d.prototype),r},d.prototype.readUintLE=d.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||j(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},d.prototype.readUintBE=d.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||j(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},d.prototype.readUint8=d.prototype.readUInt8=function(e,t){return e>>>=0,t||j(e,1,this.length),this[e]},d.prototype.readUint16LE=d.prototype.readUInt16LE=function(e,t){return e>>>=0,t||j(e,2,this.length),this[e]|this[e+1]<<8},d.prototype.readUint16BE=d.prototype.readUInt16BE=function(e,t){return e>>>=0,t||j(e,2,this.length),this[e]<<8|this[e+1]},d.prototype.readUint32LE=d.prototype.readUInt32LE=function(e,t){return e>>>=0,t||j(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},d.prototype.readUint32BE=d.prototype.readUInt32BE=function(e,t){return e>>>=0,t||j(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},d.prototype.readBigUInt64LE=re((function(e){Q(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),d.prototype.readBigUInt64BE=re((function(e){Q(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),d.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||j(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},d.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||j(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},d.prototype.readInt8=function(e,t){return e>>>=0,t||j(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},d.prototype.readInt16LE=function(e,t){e>>>=0,t||j(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},d.prototype.readInt16BE=function(e,t){e>>>=0,t||j(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},d.prototype.readInt32LE=function(e,t){return e>>>=0,t||j(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},d.prototype.readInt32BE=function(e,t){return e>>>=0,t||j(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},d.prototype.readBigInt64LE=re((function(e){Q(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),d.prototype.readBigInt64BE=re((function(e){Q(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||J(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),d.prototype.readFloatLE=function(e,t){return e>>>=0,t||j(e,4,this.length),c.read(this,e,!0,23,4)},d.prototype.readFloatBE=function(e,t){return e>>>=0,t||j(e,4,this.length),c.read(this,e,!1,23,4)},d.prototype.readDoubleLE=function(e,t){return e>>>=0,t||j(e,8,this.length),c.read(this,e,!0,52,8)},d.prototype.readDoubleBE=function(e,t){return e>>>=0,t||j(e,8,this.length),c.read(this,e,!1,52,8)},d.prototype.writeUintLE=d.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){L(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},d.prototype.writeUintBE=d.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){L(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},d.prototype.writeUint8=d.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,255,0),this[t]=255&e,t+1},d.prototype.writeUint16LE=d.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeUint16BE=d.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeUint32LE=d.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},d.prototype.writeUint32BE=d.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeBigUInt64LE=re((function(e,t=0){return q(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),d.prototype.writeBigUInt64BE=re((function(e,t=0){return U(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),d.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}let i=0,o=1,a=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},d.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}let i=n-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},d.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},d.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},d.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},d.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},d.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},d.prototype.writeBigInt64LE=re((function(e,t=0){return q(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),d.prototype.writeBigInt64BE=re((function(e,t=0){return U(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),d.prototype.writeFloatLE=function(e,t,n){return K(this,e,t,!0,n)},d.prototype.writeFloatBE=function(e,t,n){return K(this,e,t,!1,n)},d.prototype.writeDoubleLE=function(e,t,n){return V(this,e,t,!0,n)},d.prototype.writeDoubleBE=function(e,t,n){return V(this,e,t,!1,n)},d.prototype.copy=function(e,t,n,r){if(!d.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},d.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!d.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=d.isBuffer(e)?e:d.from(e,r),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%a]}return this};const z={};function W(e,t,n){z[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function H(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function G(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new z.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){Q(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||J(t,e.length-(n+1))}(r,i,o)}function Q(e,t){if("number"!=typeof e)throw new z.ERR_INVALID_ARG_TYPE(t,"number",e)}function J(e,t,n){if(Math.floor(e)!==e)throw Q(e,n),new z.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new z.ERR_BUFFER_OUT_OF_BOUNDS;throw new z.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}W("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),W("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),W("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=H(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=H(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const Z=/[^+/0-9A-Za-z-_]/g;function $(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function Y(e){return u.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(Z,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function X(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function ee(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function te(e){return e!=e}const ne=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function re(e){return"undefined"==typeof BigInt?ie:e}function ie(){throw new Error("BigInt not supported")}})),o.register("966pb",(function(t,n){var r,i;e(t.exports,"toByteArray",(()=>r),(e=>r=e)),e(t.exports,"fromByteArray",(()=>i),(e=>i=e)),r=function(e){var t,n,r=f(e),i=r[0],o=r[1],u=new s(function(e,t,n){return 3*(t+n)/4-n}(0,i,o)),c=0,l=o>0?i-4:i;for(n=0;n<l;n+=4)t=a[e.charCodeAt(n)]<<18|a[e.charCodeAt(n+1)]<<12|a[e.charCodeAt(n+2)]<<6|a[e.charCodeAt(n+3)],u[c++]=t>>16&255,u[c++]=t>>8&255,u[c++]=255&t;2===o&&(t=a[e.charCodeAt(n)]<<2|a[e.charCodeAt(n+1)]>>4,u[c++]=255&t);1===o&&(t=a[e.charCodeAt(n)]<<10|a[e.charCodeAt(n+1)]<<4|a[e.charCodeAt(n+2)]>>2,u[c++]=t>>8&255,u[c++]=255&t);return u},i=function(e){for(var t,n=e.length,r=n%3,i=[],a=16383,s=0,u=n-r;s<u;s+=a)i.push(h(e,s,s+a>u?u:s+a));1===r?(t=e[n-1],i.push(o[t>>2]+o[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(o[t>>10]+o[t>>4&63]+o[t<<2&63]+"="));return i.join("")};for(var o=[],a=[],s="undefined"!=typeof Uint8Array?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,l=u.length;c<l;++c)o[c]=u[c],a[u.charCodeAt(c)]=c;function f(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function h(e,t,n){for(var r,i,a=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(o[(i=r)>>18&63]+o[i>>12&63]+o[i>>6&63]+o[63&i]);return a.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63})),o.register("aXpis",(function(t,n){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var r,i;e(t.exports,"read",(()=>r),(e=>r=e)),e(t.exports,"write",(()=>i),(e=>i=e)),r=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=e[t+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=c}return(d?-1:1)*a*Math.pow(2,o-r)},i=function(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+d]=255&a,d+=p,a/=256,c-=8);e[n+d-p]|=128*m}})),o.register("1T4rt",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("5Z0vv"),e.exports),s(o("1C0Wt"),e.exports)}));var a=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function s(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||a(t,e,n)}var u=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function c(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&a(t,e,n);return u(t,e),t}function l(e){return e&&e.__esModule?e:{default:e}}o.register("5Z0vv",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.EthAddress=void 0;var r=o("giqbl"),i=o("1vwiL");const a=new r.Keccak(256);function s(e){return a.reset(),a.update(e),a.digest("hex")}class u{constructor(e){if(this.buffer=e,32===e.length){if(!e.slice(0,12).equals(n.alloc(12)))throw new Error("Invalid address buffer.");this.buffer=e.slice(12)}else if(20!==e.length)throw new Error("Invalid address buffer.")}static fromString(e){if(!u.isAddress(e))throw new Error(`Invalid address string: ${e}`);return new u(n.from(e.replace(/^0x/i,""),"hex"))}static random(){return new u((0,i.randomBytes)(20))}static isAddress(e){return!!/^(0x)?[0-9a-f]{40}$/i.test(e)&&(!(!/^(0x|0X)?[0-9a-f]{40}$/.test(e)&&!/^(0x|0X)?[0-9A-F]{40}$/.test(e))||u.checkAddressChecksum(e))}isZero(){return this.equals(u.ZERO)}static checkAddressChecksum(e){const t=s((e=e.replace(/^0x/i,"")).toLowerCase());for(let n=0;n<40;n++)if(parseInt(t[n],16)>7&&e[n].toUpperCase()!==e[n]||parseInt(t[n],16)<=7&&e[n].toLowerCase()!==e[n])return!1;return!0}static toChecksumAddress(e){if(!u.isAddress(e))throw new Error("Invalid address string.");const t=s(e=e.toLowerCase().replace(/^0x/i,""));let n="0x";for(let r=0;r<e.length;r++)parseInt(t[r],16)>7?n+=e[r].toUpperCase():n+=e[r];return n}equals(e){return this.buffer.equals(e.toBuffer())}toString(){return u.toChecksumAddress(this.buffer.toString("hex"))}toBuffer(){return this.buffer}toBuffer32(){const e=n.alloc(32);return this.buffer.copy(e,12),e}}e.exports.EthAddress=u,u.ZERO=new u(n.alloc(20))})),o.register("giqbl",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=e.exports.SHAKE=e.exports.SHA3Hash=e.exports.SHA3=e.exports.Keccak=void 0;var n,r=o("150uq"),i=(n=o("akpTS"))&&n.__esModule?n:{default:n};var a=function(e){var t=e.allowedSizes,n=e.defaultSize,o=e.padding;return function e(){var a=this,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;if(!this||this.constructor!==e)return new e(s);if(t&&!t.includes(s))throw new Error("Unsupported hash length");var u=new i.default({capacity:s});return this.update=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"utf8";if(r.Buffer.isBuffer(e))return u.absorb(e),a;if("string"==typeof e)return a.update(r.Buffer.from(e,t));throw new TypeError("Not a string or buffer")},this.digest=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"binary",t="string"==typeof e?{format:e}:e,n=u.squeeze({buffer:t.buffer,padding:t.padding||o});return t.format&&"binary"!==t.format?n.toString(t.format):n},this.reset=function(){return u.reset(),a},this}},s=a({allowedSizes:[224,256,384,512],defaultSize:512,padding:1});e.exports.Keccak=s;var u=a({allowedSizes:[224,256,384,512],defaultSize:512,padding:6});e.exports.SHA3=u;var c=a({allowedSizes:[128,256],defaultSize:256,padding:31});e.exports.SHAKE=c;var l=s;e.exports.SHA3Hash=l,u.SHA3Hash=l;var f=u;e.exports.default=f})),o.register("akpTS",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n,r=o("150uq"),i=(n=o("jKWdZ"))&&n.__esModule?n:{default:n};var a=function(e,t){for(var n=0;n<e.length;n+=8){var r=n/4;t[r]^=e[n+7]<<24|e[n+6]<<16|e[n+5]<<8|e[n+4],t[r+1]^=e[n+3]<<24|e[n+2]<<16|e[n+1]<<8|e[n]}return t},s=function(e,t){for(var n=0;n<t.length;n+=8){var r=n/4;t[n]=e[r+1],t[n+1]=e[r+1]>>>8,t[n+2]=e[r+1]>>>16,t[n+3]=e[r+1]>>>24,t[n+4]=e[r],t[n+5]=e[r]>>>8,t[n+6]=e[r]>>>16,t[n+7]=e[r]>>>24}return t},u=function(e){var t=this,n=e.capacity,o=e.padding,u=(0,i.default)(),c=n/8,l=200-n/4,f=0,h=new Uint32Array(50),d=r.Buffer.allocUnsafe(l);return this.absorb=function(e){for(var n=0;n<e.length;n++)d[f]=e[n],(f+=1)>=l&&(a(d,h),u(h),f=0);return t},this.squeeze=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={buffer:e.buffer||r.Buffer.allocUnsafe(c),padding:e.padding||o,queue:r.Buffer.allocUnsafe(d.length),state:new Uint32Array(h.length)};d.copy(t.queue);for(var n=0;n<h.length;n++)t.state[n]=h[n];t.queue.fill(0,f),t.queue[f]|=t.padding,t.queue[l-1]|=128,a(t.queue,t.state);for(var i=0;i<t.buffer.length;i+=l)u(t.state),s(t.state,t.buffer.slice(i,i+l));return t.buffer},this.reset=function(){return d.fill(0),h.fill(0),f=0,t},this};e.exports.default=u})),o.register("jKWdZ",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=s(o("iJez8")),r=s(o("k0WvU")),i=s(o("herZ5")),a=s(o("cuRGJ"));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){var e=new Uint32Array(10),t=new Uint32Array(10),o=new Uint32Array(2);return function(s){for(var u=0;u<24;u++)(0,a.default)({A:s,C:e,D:t,W:o}),(0,i.default)({A:s,C:e,W:o}),(0,n.default)({A:s,C:e}),(0,r.default)({A:s,roundIndex:u});e.fill(0),t.fill(0),o.fill(0)}};e.exports.default=u})),o.register("iJez8",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n,r=(n=o("8ocuB"))&&n.__esModule?n:{default:n};var i=function(e){for(var t=e.A,n=e.C,i=0;i<25;i+=5){for(var o=0;o<5;o++)(0,r.default)(t,i+o)(n,o);for(var a=0;a<5;a++){var s=2*(i+a),u=(a+1)%5*2,c=(a+2)%5*2;t[s]^=~n[u]&n[c],t[s+1]^=~n[u+1]&n[c+1]}}};e.exports.default=i})),o.register("8ocuB",(function(e,t){e.exports=function(e,t){return function(n,r){var i=2*r,o=2*t;n[i]=e[o],n[i+1]=e[o+1]}}})),o.register("k0WvU",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n,r=(n=o("aXhI1"))&&n.__esModule?n:{default:n};var i=function(e){var t=e.A,n=2*e.roundIndex;t[0]^=r.default[n],t[1]^=r.default[n+1]};e.exports.default=i})),o.register("aXhI1",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=new Uint32Array([0,1,0,32898,2147483648,32906,2147483648,2147516416,0,32907,0,2147483649,2147483648,2147516545,2147483648,32777,0,138,0,136,0,2147516425,0,2147483658,0,2147516555,2147483648,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,0,32778,2147483648,2147483658,2147483648,2147516545,2147483648,32896,0,2147483649,2147483648,2147516424]);e.exports.default=n})),o.register("herZ5",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=a(o("l2iJQ")),r=a(o("22kKR")),i=a(o("8ocuB"));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(e){var t=e.A,o=e.C,a=e.W;(0,i.default)(t,1)(a,0);for(var s=0,u=0,c=0,l=32,f=0;f<24;f++){var h=n.default[f],d=r.default[f];(0,i.default)(t,h)(o,0),s=a[0],u=a[1],l=32-d,a[c=d<32?0:1]=s<<d|u>>>l,a[(c+1)%2]=u<<d|s>>>l,(0,i.default)(a,0)(t,h),(0,i.default)(o,0)(a,0)}};e.exports.default=s})),o.register("l2iJQ",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=[10,7,11,17,18,3,5,16,8,21,24,4,15,23,19,13,12,2,20,14,22,9,6,1];e.exports.default=n})),o.register("22kKR",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n=[1,3,6,10,15,21,28,36,45,55,2,14,27,41,56,8,25,43,62,18,39,61,20,44];e.exports.default=n})),o.register("cuRGJ",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=void 0;var n,r=(n=o("8ocuB"))&&n.__esModule?n:{default:n};var i=function(e){for(var t=e.A,n=e.C,i=e.D,o=e.W,a=0,s=0,u=0;u<5;u++){var c=2*u,l=2*(u+5),f=2*(u+10),h=2*(u+15),d=2*(u+20);n[c]=t[c]^t[l]^t[f]^t[h]^t[d],n[c+1]=t[c+1]^t[l+1]^t[f+1]^t[h+1]^t[d+1]}for(var p=0;p<5;p++){(0,r.default)(n,(p+1)%5)(o,0),a=o[0],s=o[1],o[0]=a<<1|s>>>31,o[1]=s<<1|a>>>31,i[2*p]=n[(p+4)%5*2]^o[0],i[2*p+1]=n[(p+4)%5*2+1]^o[1];for(var m=0;m<25;m+=5)t[2*(m+p)]^=i[2*p],t[2*(m+p)+1]^=i[2*p+1]}};e.exports.default=i})),o.register("1vwiL",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("jsBya"),e.exports),s(o("cn1jQ"),e.exports),s(o("5N0ZB"),e.exports),s(o("da7qy"),e.exports),s(o("9zwav"),e.exports),s(o("4brpV"),e.exports)})),o.register("jsBya",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Aes128=void 0;e.exports.Aes128=class{constructor(e){this.wasm=e}encryptBufferCBC(e,t,r){const i=e.length,o=i%16!=0?16-i%16:0,a=n.alloc(o);0!=o&&a.fill(o);const s=n.concat([e,a]),u=this.wasm.call("bbmalloc",s.length+r.length+t.length+s.length);this.wasm.transferToHeap(s,u),this.wasm.transferToHeap(t,u+s.length),this.wasm.transferToHeap(r,u+s.length+t.length),this.wasm.call("aes__encrypt_buffer_cbc",u,u+s.length,u+s.length+t.length,s.length,u+s.length+t.length+r.length);const c=n.from(this.wasm.sliceMemory(u+s.length+r.length+t.length,u+s.length+r.length+t.length+s.length));return this.wasm.call("bbfree",u),c}decryptBufferCBC(e,t,r){const i=this.wasm.call("bbmalloc",e.length+r.length+t.length+e.length);this.wasm.transferToHeap(e,i),this.wasm.transferToHeap(t,i+e.length),this.wasm.transferToHeap(r,i+e.length+t.length),this.wasm.call("aes__decrypt_buffer_cbc",i,i+e.length,i+e.length+t.length,e.length,i+e.length+t.length+r.length);const o=n.from(this.wasm.sliceMemory(i+e.length+r.length+t.length,i+e.length+r.length+t.length+e.length));return this.wasm.call("bbfree",i),o}}})),o.register("cn1jQ",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Blake2s=void 0;e.exports.Blake2s=class{constructor(e){this.wasm=e}hashToField(e){const t=this.wasm.call("bbmalloc",e.length);return this.wasm.transferToHeap(e,t),this.wasm.call("blake2s_to_field",t,e.length,0),this.wasm.call("bbfree",t),n.from(this.wasm.sliceMemory(0,32))}}})),o.register("5N0ZB",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("dMHl7"),e.exports),s(o("lWIdW"),e.exports),s(o("8i1GL"),e.exports)})),o.register("dMHl7",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("lWIdW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PooledPedersen=void 0;var n=o("8i1GL");class r extends n.SinglePedersen{constructor(e,t){super(e),this.pool=[],this.pool=t.workers.map((t=>new n.SinglePedersen(e,t)))}async init(){await Promise.all(this.pool.map((e=>e.init())))}async hashToTree(e){if(!(t=e.length)||t&t-1)throw new Error("PooledPedersen::hashValuesToTree can only handle powers of 2.");var t;const n=Math.min(e.length/2,this.pool.length),r=this.pool.slice(0,Math.max(n,1)),i=e.length/r.length,o=(await Promise.all(r.map(((t,n)=>t.hashToTree(e.slice(n*i,(n+1)*i)))))).map((e=>{const t=[];for(let n=i,r=0;n>=1;r+=n,n/=2)t.push(e.slice(r,r+n));return t})),a=o[0];for(let e=1;e<o.length;++e)for(let t=0;t<o[e].length;++t)a[t]=[...a[t],...o[e][t]];for(;a[a.length-1].length>1;){const e=a[a.length-1],t=[];for(let n=0;n<e.length;n+=2)t[n/2]=this.pool[0].compress(e[n],e[n+1]);a.push(t)}return a.flat()}}e.exports.PooledPedersen=r})),o.register("8i1GL",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SinglePedersen=void 0;var r=o("7TSDW");e.exports.SinglePedersen=class{constructor(e,t=e){this.wasm=e,this.worker=t}async init(){this.wasm.call("pedersen__init"),await this.worker.call("pedersen__init")}compress(e,t){return this.wasm.transferToHeap(e,0),this.wasm.transferToHeap(t,32),this.wasm.call("pedersen__compress_fields",0,32,64),n.from(this.wasm.sliceMemory(64,96))}compressInputs(e){const t=(0,r.serializeBufferArrayToVector)(e);return this.wasm.transferToHeap(t,0),this.wasm.call("pedersen__compress",0,0),n.from(this.wasm.sliceMemory(0,32))}compressWithHashIndex(e,t){const i=(0,r.serializeBufferArrayToVector)(e);return this.wasm.transferToHeap(i,0),this.wasm.call("pedersen__compress_with_hash_index",0,0,t),n.from(this.wasm.sliceMemory(0,32))}hashToField(e){const t=this.wasm.call("bbmalloc",e.length);return this.wasm.transferToHeap(e,t),this.wasm.call("pedersen__buffer_to_field",t,e.length,0),this.wasm.call("bbfree",t),n.from(this.wasm.sliceMemory(0,32))}async hashToTree(e){const t=(0,r.serializeBufferArrayToVector)(e),i=await this.worker.call("bbmalloc",t.length);await this.worker.transferToHeap(t,i);const o=await this.worker.call("pedersen__hash_to_tree",i),a=n.from(await this.worker.sliceMemory(o,o+4)).readUInt32BE(0),s=n.from(await this.worker.sliceMemory(o,o+4+32*a));return await this.worker.call("bbfree",i),await this.worker.call("bbfree",o),(0,r.deserializeArrayFromVector)(r.deserializeField,s).elem}}})),o.register("7TSDW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("jzp0w"),e.exports),s(o("1T3Is"),e.exports),s(o("793PU"),e.exports)})),o.register("jzp0w",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.deserializeArrayFromVector=e.exports.serializeBufferArrayToVector=e.exports.deserializeField=e.exports.deserializeInt32=e.exports.deserializeUInt32=e.exports.deserializeBool=e.exports.deserializeBufferFromVector=e.exports.serializeDate=e.exports.deserializeBigInt=e.exports.serializeBigInt=e.exports.serializeBufferToVector=e.exports.numToUInt8=e.exports.numToInt32BE=e.exports.numToUInt32BE=e.exports.boolToByte=void 0;var r=o("lJwtZ");function i(e,t=32){return(0,r.toBufferBE)(e,t)}e.exports.boolToByte=function(e){const t=n.alloc(1);return t.writeUInt8(e?1:0),t},e.exports.numToUInt32BE=function(e,t=4){const r=n.alloc(t);return r.writeUInt32BE(e,t-4),r},e.exports.numToInt32BE=function(e,t=4){const r=n.alloc(t);return r.writeInt32BE(e,t-4),r},e.exports.numToUInt8=function(e){const t=n.alloc(1);return t.writeUInt8(e,0),t},e.exports.serializeBufferToVector=function(e){const t=n.alloc(4);return t.writeUInt32BE(e.length,0),n.concat([t,e])},e.exports.serializeBigInt=i,e.exports.deserializeBigInt=function(e,t=0,n=32){return{elem:(0,r.toBigIntBE)(e.slice(t,t+n)),adv:n}},e.exports.serializeDate=function(e){return i(BigInt(e.getTime()),8)},e.exports.deserializeBufferFromVector=function(e,t=0){const n=4+e.readUInt32BE(t);return{elem:e.slice(t+4,t+n),adv:n}},e.exports.deserializeBool=function(e,t=0){return{elem:e.readUInt8(t),adv:1}},e.exports.deserializeUInt32=function(e,t=0){return{elem:e.readUInt32BE(t),adv:4}},e.exports.deserializeInt32=function(e,t=0){return{elem:e.readInt32BE(t),adv:4}},e.exports.deserializeField=function(e,t=0){return{elem:e.slice(t,t+32),adv:32}},e.exports.serializeBufferArrayToVector=function(e){const t=n.alloc(4);return t.writeUInt32BE(e.length,0),n.concat([t,...e])},e.exports.deserializeArrayFromVector=function(e,t,n=0){let r=n;const i=t.readUInt32BE(r);r+=4;const o=new Array(i);for(let n=0;n<i;++n){const{elem:i,adv:a}=e(t,r);r+=a,o[n]=i}return{elem:o,adv:r-n}}})),o.register("lJwtZ",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.toBufferBE=e.exports.toBufferLE=e.exports.toBigIntBE=e.exports.toBigIntLE=void 0,e.exports.toBigIntLE=function(e){const t=n.from(e);t.reverse();const r=t.toString("hex");return 0===r.length?BigInt(0):BigInt(`0x${r}`)},e.exports.toBigIntBE=function(e){const t=e.toString("hex");return 0===t.length?BigInt(0):BigInt(`0x${t}`)},e.exports.toBufferLE=function(e,t){const r=e.toString(16),i=n.from(r.padStart(2*t,"0").slice(0,2*t),"hex");return i.reverse(),i},e.exports.toBufferBE=function(e,t){const r=e.toString(16);return n.from(r.padStart(2*t,"0").slice(0,2*t),"hex")}})),o.register("1T3Is",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Deserializer=void 0;var n=o("jzp0w");e.exports.Deserializer=class{constructor(e,t=0){this.buf=e,this.offset=t}bool(){return!!this.exec(n.deserializeBool)}uInt32(){return this.exec(n.deserializeUInt32)}int32(){return this.exec(n.deserializeInt32)}bigInt(e=32){return this.exec(((t,r)=>(0,n.deserializeBigInt)(t,r,e)))}vector(){return this.exec(n.deserializeBufferFromVector)}buffer(e){const t=this.buf.slice(this.offset,this.offset+e);return this.offset+=e,t}string(){return this.vector().toString()}date(){return new Date(Number(this.bigInt(8)))}deserializeArray(e){return this.exec(((t,r)=>(0,n.deserializeArrayFromVector)(e,t,r)))}exec(e){const{elem:t,adv:n}=e(this.buf,this.offset);return this.offset+=n,t}getOffset(){return this.offset}}})),o.register("793PU",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Serializer=void 0;var r=o("7TSDW"),i=o("jzp0w");e.exports.Serializer=class{constructor(){this.buf=[]}bool(e){this.buf.push((0,i.boolToByte)(e))}uInt32(e){this.buf.push((0,i.numToUInt32BE)(e))}int32(e){this.buf.push((0,i.numToInt32BE)(e))}bigInt(e){this.buf.push((0,i.serializeBigInt)(e))}vector(e){this.buf.push((0,i.serializeBufferToVector)(e))}buffer(e){this.buf.push(e)}string(e){this.vector(n.from(e))}date(e){this.buf.push((0,i.serializeDate)(e))}getBuffer(){return n.concat(this.buf)}serializeArray(e){this.buf.push((0,r.serializeBufferArrayToVector)(e.map((e=>e.toBuffer()))))}}})),o.register("da7qy",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.randomBytes=void 0;const r=l(o("2vGx5"));e.exports.randomBytes=e=>{if(r.default)return o("hxZzW").randomBytes(e);const t="undefined"!=typeof window&&window.crypto?window.crypto:"undefined"!=typeof self&&self.crypto?self.crypto:void 0;if(t){const r=n.alloc(e);return t.getRandomValues(r),r}throw new Error("randomBytes UnsupportedEnvironment")}})),o.register("2vGx5",(function(e,t){e.exports=!1})),o.register("hxZzW",(function(t,n){var r,i,a;e(t.exports,"randomBytes",(()=>r),(e=>r=e)),e(t.exports,"createHash",(()=>i),(e=>i=e)),e(t.exports,"createCipheriv",(()=>a),(e=>a=e)),r=o("9qUDb"),i=o("akhbg"),o("9CK9X");var s=o("8F6Vk"),u=Object.keys(s),c=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(u);var l=o("clDJD");l.pbkdf2,l.pbkdf2Sync;var f=o("e7fkm");f.Cipher,f.createCipher,f.Cipheriv,a=f.createCipheriv,f.Decipher,f.createDecipher,f.Decipheriv,f.createDecipheriv,f.getCiphers,f.listCiphers;var h=o("etCJs");h.DiffieHellmanGroup,h.createDiffieHellmanGroup,h.getDiffieHellman,h.createDiffieHellman,h.DiffieHellman;var d=o("ds9r6");d.createSign,d.Sign,d.createVerify,d.Verify,o("bQVPk");var p=o("dHzAL");p.publicEncrypt,p.privateEncrypt,p.publicDecrypt,p.privateDecrypt;var m=o("5TMqn");m.randomFill,m.randomFillSync})),o.register("9qUDb",(function(e,n){var r=o("iThRa"),i=65536;var a=o("2BZf1").Buffer,s=t.crypto||t.msCrypto;s&&s.getRandomValues?e.exports=function(e,t){if(e>4294967295)throw new RangeError("requested too many random bytes");var n=a.allocUnsafe(e);if(e>0)if(e>i)for(var o=0;o<e;o+=i)s.getRandomValues(n.slice(o,o+i));else s.getRandomValues(n);return"function"==typeof t?r.nextTick((function(){t(null,n)})):n}:e.exports=function(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}})),o.register("2BZf1",(function(e,t){var n=o("150uq"),r=n.Buffer;function i(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(i(n,e.exports),e.exports.Buffer=a),a.prototype=Object.create(r.prototype),i(r,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}})),o.register("akhbg",(function(e,t){var n=o("9iXO2"),r=o("eujcR"),i=o("4OYrg"),a=o("cRNpC"),s=o("1vQsi");function u(e){s.call(this,"digest"),this._hash=e}n(u,s),u.prototype._update=function(e){this._hash.update(e)},u.prototype._final=function(){return this._hash.digest()},e.exports=function(e){return"md5"===(e=e.toLowerCase())?new r:"rmd160"===e||"ripemd160"===e?new i:new u(a(e))}})),o.register("9iXO2",(function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}})),o.register("eujcR",(function(e,t){var n=o("9iXO2"),r=o("g4IeX"),i=o("2BZf1").Buffer,a=new Array(16);function s(){r.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}function u(e,t){return e<<t|e>>>32-t}function c(e,t,n,r,i,o,a){return u(e+(t&n|~t&r)+i+o|0,a)+t|0}function l(e,t,n,r,i,o,a){return u(e+(t&r|n&~r)+i+o|0,a)+t|0}function f(e,t,n,r,i,o,a){return u(e+(t^n^r)+i+o|0,a)+t|0}function h(e,t,n,r,i,o,a){return u(e+(n^(t|~r))+i+o|0,a)+t|0}n(s,r),s.prototype._update=function(){for(var e=a,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);var n=this._a,r=this._b,i=this._c,o=this._d;n=c(n,r,i,o,e[0],3614090360,7),o=c(o,n,r,i,e[1],3905402710,12),i=c(i,o,n,r,e[2],606105819,17),r=c(r,i,o,n,e[3],3250441966,22),n=c(n,r,i,o,e[4],4118548399,7),o=c(o,n,r,i,e[5],1200080426,12),i=c(i,o,n,r,e[6],2821735955,17),r=c(r,i,o,n,e[7],4249261313,22),n=c(n,r,i,o,e[8],1770035416,7),o=c(o,n,r,i,e[9],2336552879,12),i=c(i,o,n,r,e[10],4294925233,17),r=c(r,i,o,n,e[11],2304563134,22),n=c(n,r,i,o,e[12],1804603682,7),o=c(o,n,r,i,e[13],4254626195,12),i=c(i,o,n,r,e[14],2792965006,17),n=l(n,r=c(r,i,o,n,e[15],1236535329,22),i,o,e[1],4129170786,5),o=l(o,n,r,i,e[6],3225465664,9),i=l(i,o,n,r,e[11],643717713,14),r=l(r,i,o,n,e[0],3921069994,20),n=l(n,r,i,o,e[5],3593408605,5),o=l(o,n,r,i,e[10],38016083,9),i=l(i,o,n,r,e[15],3634488961,14),r=l(r,i,o,n,e[4],3889429448,20),n=l(n,r,i,o,e[9],568446438,5),o=l(o,n,r,i,e[14],3275163606,9),i=l(i,o,n,r,e[3],4107603335,14),r=l(r,i,o,n,e[8],1163531501,20),n=l(n,r,i,o,e[13],2850285829,5),o=l(o,n,r,i,e[2],4243563512,9),i=l(i,o,n,r,e[7],1735328473,14),n=f(n,r=l(r,i,o,n,e[12],2368359562,20),i,o,e[5],4294588738,4),o=f(o,n,r,i,e[8],2272392833,11),i=f(i,o,n,r,e[11],1839030562,16),r=f(r,i,o,n,e[14],4259657740,23),n=f(n,r,i,o,e[1],2763975236,4),o=f(o,n,r,i,e[4],1272893353,11),i=f(i,o,n,r,e[7],4139469664,16),r=f(r,i,o,n,e[10],3200236656,23),n=f(n,r,i,o,e[13],681279174,4),o=f(o,n,r,i,e[0],3936430074,11),i=f(i,o,n,r,e[3],3572445317,16),r=f(r,i,o,n,e[6],76029189,23),n=f(n,r,i,o,e[9],3654602809,4),o=f(o,n,r,i,e[12],3873151461,11),i=f(i,o,n,r,e[15],530742520,16),n=h(n,r=f(r,i,o,n,e[2],3299628645,23),i,o,e[0],4096336452,6),o=h(o,n,r,i,e[7],1126891415,10),i=h(i,o,n,r,e[14],2878612391,15),r=h(r,i,o,n,e[5],4237533241,21),n=h(n,r,i,o,e[12],1700485571,6),o=h(o,n,r,i,e[3],2399980690,10),i=h(i,o,n,r,e[10],4293915773,15),r=h(r,i,o,n,e[1],2240044497,21),n=h(n,r,i,o,e[8],1873313359,6),o=h(o,n,r,i,e[15],4264355552,10),i=h(i,o,n,r,e[6],2734768916,15),r=h(r,i,o,n,e[13],1309151649,21),n=h(n,r,i,o,e[4],4149444226,6),o=h(o,n,r,i,e[11],3174756917,10),i=h(i,o,n,r,e[2],718787259,15),r=h(r,i,o,n,e[9],3951481745,21),this._a=this._a+n|0,this._b=this._b+r|0,this._c=this._c+i|0,this._d=this._d+o|0},s.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=i.allocUnsafe(16);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e},e.exports=s})),o.register("g4IeX",(function(e,t){var n=o("2BZf1").Buffer,r=o("1Njyt").Transform;function i(e){r.call(this),this._block=n.allocUnsafe(e),this._blockSize=e,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}o("9iXO2")(i,r),i.prototype._transform=function(e,t,n){var r=null;try{this.update(e,t)}catch(e){r=e}n(r)},i.prototype._flush=function(e){var t=null;try{this.push(this.digest())}catch(e){t=e}e(t)},i.prototype.update=function(e,t){if(function(e,t){if(!n.isBuffer(e)&&"string"!=typeof e)throw new TypeError(t+" must be a string or a buffer")}(e,"Data"),this._finalized)throw new Error("Digest already called");n.isBuffer(e)||(e=n.from(e,t));for(var r=this._block,i=0;this._blockOffset+e.length-i>=this._blockSize;){for(var o=this._blockOffset;o<this._blockSize;)r[o++]=e[i++];this._update(),this._blockOffset=0}for(;i<e.length;)r[this._blockOffset++]=e[i++];for(var a=0,s=8*e.length;s>0;++a)this._length[a]+=s,(s=this._length[a]/4294967296|0)>0&&(this._length[a]-=4294967296*s);return this},i.prototype._update=function(){throw new Error("_update is not implemented")},i.prototype.digest=function(e){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var t=this._digest();void 0!==e&&(t=t.toString(e)),this._block.fill(0),this._blockOffset=0;for(var n=0;n<4;++n)this._length[n]=0;return t},i.prototype._digest=function(){throw new Error("_digest is not implemented")},e.exports=i})),o.register("1Njyt",(function(e,t){(t=e.exports=o("ki8P4")).Stream=t,t.Readable=t,t.Writable=o("8ra3K"),t.Duplex=o("dYozl"),t.Transform=o("gE6pU"),t.PassThrough=o("iRcFk"),t.finished=o("fuWL1"),t.pipeline=o("h30Yy")})),o.register("ki8P4",(function(e,n){var r,i=o("iThRa");e.exports=M,M.ReadableState=T;o("cC4OV").EventEmitter;var a=function(e,t){return e.listeners(t).length},s=o("81K49"),u=o("150uq").Buffer,c=t.Uint8Array||function(){};var l,f=o("kOtop");l=f&&f.debuglog?f.debuglog("stream"):function(){};var h,d,p,m=o("Ow5zM"),y=o("7L2CS"),g=o("74lkm").getHighWaterMark,b=o("lpWDO").codes,v=b.ERR_INVALID_ARG_TYPE,w=b.ERR_STREAM_PUSH_AFTER_EOF,_=b.ERR_METHOD_NOT_IMPLEMENTED,E=b.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;o("9iXO2")(M,s);var S=y.errorOrDestroy,x=["error","close","destroy","pause","resume"];function T(e,t,n){r=r||o("dYozl"),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",n),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=o("1qOpt").StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function M(e){if(r=r||o("dYozl"),!(this instanceof M))return new M(e);var t=this instanceof r;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function A(e,t,n,r,i){l("readableAddChunk",t);var o,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?N(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,O(e)))}(e,a);else if(i||(o=function(e,t){var n;r=t,u.isBuffer(r)||r instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new v("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(a,t)),o)S(e,o);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),r)a.endEmitted?S(e,new E):R(e,a,t,!0);else if(a.ended)S(e,new w);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?R(e,a,t,!1):C(e,a)):R(e,a,t,!1)}else r||(a.reading=!1,C(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function R(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&N(e)),C(e,t)}Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),M.prototype.destroy=y.destroy,M.prototype._undestroy=y.undestroy,M.prototype._destroy=function(e,t){t(e)},M.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=u.from(e,t),t=""),n=!0),A(this,e,t,!1,n)},M.prototype.unshift=function(e){return A(this,e,null,!0,!1)},M.prototype.isPaused=function(){return!1===this._readableState.flowing},M.prototype.setEncoding=function(e){h||(h=o("1qOpt").StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,r="";null!==n;)r+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var I=1073741824;function P(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=I?e=I:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function N(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(O,e))}function O(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function C(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(k,e,t))}function k(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(l("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function B(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function j(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function q(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function U(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(F,t,e))}function F(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function K(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}M.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?U(this):N(this),null;if(0===(e=P(e,t))&&t.ended)return 0===t.length&&U(this),null;var r,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=P(n,t))),null===(r=e>0?q(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&U(this)),null!==r&&this.emit("data",r),r},M.prototype._read=function(e){S(this,new _("_read()"))},M.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,l("pipe count=%d opts=%j",r.pipesCount,t);var o=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?u:y;function s(t,i){l("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),n.removeListener("end",u),n.removeListener("end",y),n.removeListener("data",h),f=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}r.endEmitted?i.nextTick(o):n.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,L(e))}}(n);e.on("drain",c);var f=!1;function h(t){l("ondata");var i=e.write(t);l("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==K(r.pipes,e))&&!f&&(l("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function d(t){l("onerror",t),y(),e.removeListener("error",d),0===a(e,"error")&&S(e,t)}function p(){e.removeListener("finish",m),y()}function m(){l("onfinish"),e.removeListener("close",p),y()}function y(){l("unpipe"),n.unpipe(e)}return n.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",d),e.once("close",p),e.once("finish",m),e.emit("pipe",n),r.flowing||(l("pipe resume"),n.resume()),e},M.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=K(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},M.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,l("on readable",r.length,r.reading),r.length?N(this):r.reading||i.nextTick(D,this))),n},M.prototype.addListener=M.prototype.on,M.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(B,this),n},M.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(B,this),t},M.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(j,e,t))}(this,e)),e.paused=!1,this},M.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},M.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<x.length;o++)e.on(x[o],this.emit.bind(this,x[o]));return this._read=function(t){l("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(M.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=o("hHJzY")),d(this)}),Object.defineProperty(M.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(M.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(M.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),M._fromList=q,Object.defineProperty(M.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(M.from=function(e,t){return void 0===p&&(p=o("lF6BC")),p(M,e,t)})})),o.register("cC4OV",(function(e,t){var n,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};n=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function a(){a.init.call(this)}e.exports=a,e.exports.once=function(e,t){return new Promise((function(n,r){function i(n){e.removeListener(t,o),r(n)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}y(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&y(e,"error",t,n)}(e,i,{once:!0})}))},a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var s=10;function u(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?a.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var i,o,a,s;if(u(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),a=o[t]),void 0===a)a=o[t]=n,++e._eventsCount;else if("function"==typeof a?a=o[t]=r?[n,a]:[a,n]:r?a.unshift(n):a.push(n),(i=c(e))>0&&a.length>i&&!a.warned){a.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=a.length,s=l,console&&console.warn&&console.warn(s)}return e}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function h(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=f.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):m(i,i.length)}function p(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function y(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function i(o){r.once&&e.removeEventListener(t,i),n(o)}))}}Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),a.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},a.prototype.getMaxListeners=function(){return c(this)},a.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var u=o[e];if(void 0===u)return!1;if("function"==typeof u)i(u,this,t);else{var c=u.length,l=m(u,c);for(n=0;n<c;++n)i(l[n],this,t)}return!0},a.prototype.addListener=function(e,t){return l(this,e,t,!1)},a.prototype.on=a.prototype.addListener,a.prototype.prependListener=function(e,t){return l(this,e,t,!0)},a.prototype.once=function(e,t){return u(t),this.on(e,h(this,e,t)),this},a.prototype.prependOnceListener=function(e,t){return u(t),this.prependListener(e,h(this,e,t)),this},a.prototype.removeListener=function(e,t){var n,r,i,o,a;if(u(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){a=n[o].listener,i=o;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,o=Object.keys(n);for(r=0;r<o.length;++r)"removeListener"!==(i=o[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},a.prototype.listeners=function(e){return d(this,e,!0)},a.prototype.rawListeners=function(e){return d(this,e,!1)},a.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},a.prototype.listenerCount=p,a.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]}})),o.register("81K49",(function(e,t){e.exports=o("cC4OV").EventEmitter})),o.register("kOtop",(function(e,t){})),o.register("Ow5zM",(function(e,t){function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=o("150uq").Buffer,s=o("kOtop").inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,o,c;return t=e,o=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,n,r,i=a.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,n=i,r=s,a.prototype.copy.call(t,n,r),s+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],o&&i(t.prototype,o),c&&i(t,c),e}()})),o.register("7L2CS",(function(e,t){var n=o("iThRa");function r(e,t){a(e,t),i(e)}function i(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function a(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(a,this,e)):n.nextTick(a,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?o._writableState?o._writableState.errorEmitted?n.nextTick(i,o):(o._writableState.errorEmitted=!0,n.nextTick(r,o,e)):n.nextTick(r,o,e):t?(n.nextTick(i,o),t(e)):n.nextTick(i,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}})),o.register("74lkm",(function(e,t){var n=o("lpWDO").codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,r);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new n(i?r:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}})),o.register("lpWDO",(function(t,n){var r;e(t.exports,"codes",(()=>r),(e=>r=e));var i={};function o(e,t,n){n||(n=Error);var r=function(e){var n,r;function i(n,r,i){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,i))||this}return r=e,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,i}(n);r.prototype.name=n.name,r.prototype.code=e,i[e]=r}function a(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}o("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(e,t,n){var r,i,o,s;if("string"==typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))s="The ".concat(e," ").concat(r," ").concat(a(t,"type"));else{var u=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(r," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof n)}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),r=i})),o.register("dYozl",(function(e,t){var n=o("iThRa"),r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=l;var i=o("ki8P4"),a=o("8ra3K");o("9iXO2")(l,i);for(var s=r(a.prototype),u=0;u<s.length;u++){var c=s[u];l.prototype[c]||(l.prototype[c]=a.prototype[c])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",f)))}function f(){this._writableState.ended||n.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})})),o.register("8ra3K",(function(e,n){var r,i=o("iThRa");function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=M,M.WritableState=T;var s={deprecate:o("gfowu")},u=o("81K49"),c=o("150uq").Buffer,l=t.Uint8Array||function(){};var f,h=o("7L2CS"),d=o("74lkm").getHighWaterMark,p=o("lpWDO").codes,m=p.ERR_INVALID_ARG_TYPE,y=p.ERR_METHOD_NOT_IMPLEMENTED,g=p.ERR_MULTIPLE_CALLBACK,b=p.ERR_STREAM_CANNOT_PIPE,v=p.ERR_STREAM_DESTROYED,w=p.ERR_STREAM_NULL_VALUES,_=p.ERR_STREAM_WRITE_AFTER_END,E=p.ERR_UNKNOWN_ENCODING,S=h.errorOrDestroy;function x(){}function T(e,t,n){r=r||o("dYozl"),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",n),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if("function"!=typeof o)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?(i.nextTick(o,r),i.nextTick(O,e,t),e._writableState.errorEmitted=!0,S(e,r)):(o(r),e._writableState.errorEmitted=!0,S(e,r),O(e,t))}(e,n,r,t,o);else{var a=P(n)||e.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||I(e,n),r?i.nextTick(R,e,n,a,o):R(e,n,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function M(e){var t=this instanceof(r=r||o("dYozl"));if(!t&&!f.call(M,this))return new M(e);this._writableState=new T(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),u.call(this)}function A(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function R(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),O(e,t)}function I(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,A(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,f=n.callback;if(A(e,t,!1,t.objectMode?1:c.length,c,l,f),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function P(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function N(e,t){e._final((function(n){t.pendingcb--,n&&S(e,n),t.prefinished=!0,e.emit("prefinish"),O(e,t)}))}function O(e,t){var n=P(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(N,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}o("9iXO2")(M,u),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(M,Symbol.hasInstance,{value:function(e){return!!f.call(this,e)||this===M&&(e&&e._writableState instanceof T)}})):f=function(e){return e instanceof this},M.prototype.pipe=function(){S(this,new b)},M.prototype.write=function(e,t,n){var r,o=this._writableState,a=!1,s=!o.objectMode&&(r=e,c.isBuffer(r)||r instanceof l);return s&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=x),o.ending?function(e,t){var n=new _;S(e,n),i.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var o;return null===n?o=new w:"string"==typeof n||t.objectMode||(o=new m("chunk",["string","Buffer"],n)),!o||(S(e,o),i.nextTick(r,o),!1)}(this,o,e,n))&&(o.pendingcb++,a=function(e,t,n,r,i,o){if(!n){var a=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n));return t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else A(e,t,!1,s,r,i,o);return u}(this,o,s,e,t,n)),a},M.prototype.cork=function(){this._writableState.corked++},M.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||I(this,e))},M.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new E(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(M.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(M.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),M.prototype._write=function(e,t,n){n(new y("_write()"))},M.prototype._writev=null,M.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,O(e,t),n&&(t.finished?i.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(M.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),M.prototype.destroy=h.destroy,M.prototype._undestroy=h.undestroy,M.prototype._destroy=function(e,t){t(e)}})),o.register("gfowu",(function(e,n){function r(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}})),o.register("1qOpt",(function(t,n){var r;e(t.exports,"StringDecoder",(()=>r),(e=>r=e));var i=o("2BZf1").Buffer,a=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===a||!a(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=f,t=4;break;case"utf8":this.fillLast=c,t=4;break;case"base64":this.text=h,this.end=d,t=3;break;default:return this.write=p,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function u(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function c(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function f(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function h(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function m(e){return e&&e.length?this.write(e):""}r=s,s.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=u(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=u(t[r]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=u(t[r]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}})),o.register("hHJzY",(function(e,t){var n,r=o("iThRa");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=o("fuWL1"),s=Symbol("lastResolve"),u=Symbol("lastReject"),c=Symbol("error"),l=Symbol("ended"),f=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function p(e,t){return{value:e,done:t}}function m(e){var t=e[s];if(null!==t){var n=e[d].read();null!==n&&(e[f]=null,e[s]=null,e[u]=null,t(p(n,!1)))}}function y(e){r.nextTick(m,e)}var g=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((i(n={get stream(){return this[d]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[c]?n(e[c]):t(p(void 0,!0))}))}));var n,i=this[f];if(i)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[l]?n(p(void 0,!0)):t[h](n,r)}),r)}}(i,this));else{var o=this[d].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[h])}return this[f]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,n){e[d].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),n),g);e.exports=function(e){var t,n=Object.create(b,(i(t={},d,{value:e,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,c,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var r=n[d].read();r?(n[f]=null,n[s]=null,n[u]=null,e(p(r,!1))):(n[s]=e,n[u]=t)},writable:!0}),t));return n[f]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[u];return null!==t&&(n[f]=null,n[s]=null,n[u]=null,t(e)),void(n[c]=e)}var r=n[s];null!==r&&(n[f]=null,n[s]=null,n[u]=null,r(p(void 0,!0))),n[l]=!0})),e.on("readable",y.bind(null,n)),n}})),o.register("fuWL1",(function(e,t){var n=o("lpWDO").codes.ERR_STREAM_PREMATURE_CLOSE;function r(){}e.exports=function e(t,i,o){if("function"==typeof i)return e(t,null,i);i||(i={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||r);var a=i.readable||!1!==i.readable&&t.readable,s=i.writable||!1!==i.writable&&t.writable,u=function(){t.writable||l()},c=t._writableState&&t._writableState.finished,l=function(){s=!1,c=!0,a||o.call(t)},f=t._readableState&&t._readableState.endEmitted,h=function(){a=!1,f=!0,s||o.call(t)},d=function(e){o.call(t,e)},p=function(){var e;return a&&!f?(t._readableState&&t._readableState.ended||(e=new n),o.call(t,e)):s&&!c?(t._writableState&&t._writableState.ended||(e=new n),o.call(t,e)):void 0},m=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",l),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",h),t.on("finish",l),!1!==i.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",l),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("end",h),t.removeListener("error",d),t.removeListener("close",p)}}})),o.register("lF6BC",(function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}})),o.register("gE6pU",(function(e,t){e.exports=l;var n=o("lpWDO").codes,r=n.ERR_METHOD_NOT_IMPLEMENTED,i=n.ERR_MULTIPLE_CALLBACK,a=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=o("dYozl");function c(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new i);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);u.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f)}function f(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new s;if(e._transformState.transforming)throw new a;return e.push(null)}o("9iXO2")(l,u),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new r("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}})),o.register("iRcFk",(function(e,t){e.exports=r;var n=o("gE6pU");function r(e){if(!(this instanceof r))return new r(e);n.call(this,e)}o("9iXO2")(r,n),r.prototype._transform=function(e,t,n){n(null,e)}})),o.register("h30Yy",(function(e,t){var n;var r=o("lpWDO").codes,i=r.ERR_MISSING_ARGS,a=r.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,r,i){i=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(i);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=o("fuWL1")),n(e,{readable:t,writable:r},(function(e){if(e)return i(e);s=!0,i()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void i(t||new a("pipe"))}}function c(e){e()}function l(e,t){return e.pipe(t)}function f(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o=f(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new i("streams");var a=t.map((function(e,n){var i=n<t.length-1;return u(e,i,n>0,(function(e){r||(r=e),e&&a.forEach(c),i||(a.forEach(c),o(r))}))}));return t.reduce(l)}})),o.register("4OYrg",(function(e,t){var n=o("150uq").Buffer,r=o("9iXO2"),i=o("g4IeX"),a=new Array(16),s=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],u=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],c=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],l=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],f=[0,1518500249,1859775393,2400959708,2840853838],h=[1352829926,1548603684,1836072691,2053994217,0];function d(){i.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}function p(e,t){return e<<t|e>>>32-t}function m(e,t,n,r,i,o,a,s){return p(e+(t^n^r)+o+a|0,s)+i|0}function y(e,t,n,r,i,o,a,s){return p(e+(t&n|~t&r)+o+a|0,s)+i|0}function g(e,t,n,r,i,o,a,s){return p(e+((t|~n)^r)+o+a|0,s)+i|0}function b(e,t,n,r,i,o,a,s){return p(e+(t&r|n&~r)+o+a|0,s)+i|0}function v(e,t,n,r,i,o,a,s){return p(e+(t^(n|~r))+o+a|0,s)+i|0}r(d,i),d.prototype._update=function(){for(var e=a,t=0;t<16;++t)e[t]=this._block.readInt32LE(4*t);for(var n=0|this._a,r=0|this._b,i=0|this._c,o=0|this._d,d=0|this._e,w=0|this._a,_=0|this._b,E=0|this._c,S=0|this._d,x=0|this._e,T=0;T<80;T+=1){var M,A;T<16?(M=m(n,r,i,o,d,e[s[T]],f[0],c[T]),A=v(w,_,E,S,x,e[u[T]],h[0],l[T])):T<32?(M=y(n,r,i,o,d,e[s[T]],f[1],c[T]),A=b(w,_,E,S,x,e[u[T]],h[1],l[T])):T<48?(M=g(n,r,i,o,d,e[s[T]],f[2],c[T]),A=g(w,_,E,S,x,e[u[T]],h[2],l[T])):T<64?(M=b(n,r,i,o,d,e[s[T]],f[3],c[T]),A=y(w,_,E,S,x,e[u[T]],h[3],l[T])):(M=v(n,r,i,o,d,e[s[T]],f[4],c[T]),A=m(w,_,E,S,x,e[u[T]],h[4],l[T])),n=d,d=o,o=p(i,10),i=r,r=M,w=x,x=S,S=p(E,10),E=_,_=A}var R=this._b+i+S|0;this._b=this._c+o+x|0,this._c=this._d+d+w|0,this._d=this._e+n+_|0,this._e=this._a+r+E|0,this._a=R},d.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var e=n.alloc?n.alloc(20):new n(20);return e.writeInt32LE(this._a,0),e.writeInt32LE(this._b,4),e.writeInt32LE(this._c,8),e.writeInt32LE(this._d,12),e.writeInt32LE(this._e,16),e},e.exports=d})),o.register("cRNpC",(function(e,t){var n=e.exports=function(e){e=e.toLowerCase();var t=n[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};n.sha=o("c7qnk"),n.sha1=o("iG3Dz"),n.sha224=o("7kO9c"),n.sha256=o("d3X3e"),n.sha384=o("cTDVi"),n.sha512=o("4TM1y")})),o.register("c7qnk",(function(e,t){var n=o("9iXO2"),r=o("caL8j"),i=o("2BZf1").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function u(){this.init(),this._w=s,r.call(this,64,56)}function c(e){return e<<30|e>>>2}function l(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}n(u,r),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,u=0|this._e,f=0;f<16;++f)n[f]=e.readInt32BE(4*f);for(;f<80;++f)n[f]=n[f-3]^n[f-8]^n[f-14]^n[f-16];for(var h=0;h<80;++h){var d=~~(h/20),p=0|((t=r)<<5|t>>>27)+l(d,i,o,s)+u+n[h]+a[d];u=s,s=o,o=c(i),i=r,r=p}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0},u.prototype._hash=function(){var e=i.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=u})),o.register("caL8j",(function(e,t){var n=o("2BZf1").Buffer;function r(e,t){this._block=n.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}r.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=n.from(e,t));for(var r=this._block,i=this._blockSize,o=e.length,a=this._len,s=0;s<o;){for(var u=a%i,c=Math.min(o-s,i-u),l=0;l<c;l++)r[u+l]=e[s+l];s+=c,(a+=c)%i==0&&this._update(r)}return this._len+=o,this},r.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return e?o.toString(e):o},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=r})),o.register("iG3Dz",(function(e,t){var n=o("9iXO2"),r=o("caL8j"),i=o("2BZf1").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function u(){this.init(),this._w=s,r.call(this,64,56)}function c(e){return e<<5|e>>>27}function l(e){return e<<30|e>>>2}function f(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}n(u,r),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,u=0|this._e,h=0;h<16;++h)n[h]=e.readInt32BE(4*h);for(;h<80;++h)n[h]=(t=n[h-3]^n[h-8]^n[h-14]^n[h-16])<<1|t>>>31;for(var d=0;d<80;++d){var p=~~(d/20),m=c(r)+f(p,i,o,s)+u+n[d]+a[p]|0;u=s,s=o,o=l(i),i=r,r=m}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0},u.prototype._hash=function(){var e=i.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=u})),o.register("7kO9c",(function(e,t){var n=o("9iXO2"),r=o("d3X3e"),i=o("caL8j"),a=o("2BZf1").Buffer,s=new Array(64);function u(){this.init(),this._w=s,i.call(this,64,56)}n(u,r),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var e=a.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=u})),o.register("d3X3e",(function(e,t){var n=o("9iXO2"),r=o("caL8j"),i=o("2BZf1").Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function u(){this.init(),this._w=s,r.call(this,64,56)}function c(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function f(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function h(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function d(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}n(u,r),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,u=0|this._e,p=0|this._f,m=0|this._g,y=0|this._h,g=0;g<16;++g)n[g]=e.readInt32BE(4*g);for(;g<64;++g)n[g]=0|(((t=n[g-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[g-7]+d(n[g-15])+n[g-16];for(var b=0;b<64;++b){var v=y+h(u)+c(u,p,m)+a[b]+n[b]|0,w=f(r)+l(r,i,o)|0;y=m,m=p,p=u,u=s+v|0,s=o,o=i,i=r,r=v+w|0}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0,this._f=p+this._f|0,this._g=m+this._g|0,this._h=y+this._h|0},u.prototype._hash=function(){var e=i.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=u})),o.register("cTDVi",(function(e,t){var n=o("9iXO2"),r=o("4TM1y"),i=o("caL8j"),a=o("2BZf1").Buffer,s=new Array(160);function u(){this.init(),this._w=s,i.call(this,128,112)}n(u,r),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var e=a.allocUnsafe(48);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=u})),o.register("4TM1y",(function(e,t){var n=o("9iXO2"),r=o("caL8j"),i=o("2BZf1").Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function u(){this.init(),this._w=s,r.call(this,128,112)}function c(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function f(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function h(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function d(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function y(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function g(e,t){return e>>>0<t>>>0?1:0}n(u,r),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,o=0|this._dh,s=0|this._eh,u=0|this._fh,b=0|this._gh,v=0|this._hh,w=0|this._al,_=0|this._bl,E=0|this._cl,S=0|this._dl,x=0|this._el,T=0|this._fl,M=0|this._gl,A=0|this._hl,R=0;R<32;R+=2)t[R]=e.readInt32BE(4*R),t[R+1]=e.readInt32BE(4*R+4);for(;R<160;R+=2){var I=t[R-30],P=t[R-30+1],N=d(I,P),O=p(P,I),C=m(I=t[R-4],P=t[R-4+1]),k=y(P,I),B=t[R-14],D=t[R-14+1],j=t[R-32],L=t[R-32+1],q=O+D|0,U=N+B+g(q,O)|0;U=(U=U+C+g(q=q+k|0,k)|0)+j+g(q=q+L|0,L)|0,t[R]=U,t[R+1]=q}for(var F=0;F<160;F+=2){U=t[F],q=t[F+1];var K=l(n,r,i),V=l(w,_,E),z=f(n,w),W=f(w,n),H=h(s,x),G=h(x,s),Q=a[F],J=a[F+1],Z=c(s,u,b),$=c(x,T,M),Y=A+G|0,X=v+H+g(Y,A)|0;X=(X=(X=X+Z+g(Y=Y+$|0,$)|0)+Q+g(Y=Y+J|0,J)|0)+U+g(Y=Y+q|0,q)|0;var ee=W+V|0,te=z+K+g(ee,W)|0;v=b,A=M,b=u,M=T,u=s,T=x,s=o+X+g(x=S+Y|0,S)|0,o=i,S=E,i=r,E=_,r=n,_=w,n=X+te+g(w=Y+ee|0,Y)|0}this._al=this._al+w|0,this._bl=this._bl+_|0,this._cl=this._cl+E|0,this._dl=this._dl+S|0,this._el=this._el+x|0,this._fl=this._fl+T|0,this._gl=this._gl+M|0,this._hl=this._hl+A|0,this._ah=this._ah+n+g(this._al,w)|0,this._bh=this._bh+r+g(this._bl,_)|0,this._ch=this._ch+i+g(this._cl,E)|0,this._dh=this._dh+o+g(this._dl,S)|0,this._eh=this._eh+s+g(this._el,x)|0,this._fh=this._fh+u+g(this._fl,T)|0,this._gh=this._gh+b+g(this._gl,M)|0,this._hh=this._hh+v+g(this._hl,A)|0},u.prototype._hash=function(){var e=i.allocUnsafe(64);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=u})),o.register("1vQsi",(function(e,t){var n=o("2BZf1").Buffer,r=o("aWwOA").Transform,i=o("1qOpt").StringDecoder;function a(e){r.call(this),this.hashMode="string"==typeof e,this.hashMode?this[e]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}o("9iXO2")(a,r),a.prototype.update=function(e,t,r){"string"==typeof e&&(e=n.from(e,t));var i=this._update(e);return this.hashMode?this:(r&&(i=this._toString(i,r)),i)},a.prototype.setAutoPadding=function(){},a.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")},a.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")},a.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")},a.prototype._transform=function(e,t,n){var r;try{this.hashMode?this._update(e):this.push(this._update(e))}catch(e){r=e}finally{n(r)}},a.prototype._flush=function(e){var t;try{this.push(this.__final())}catch(e){t=e}e(t)},a.prototype._finalOrDigest=function(e){var t=this.__final()||n.alloc(0);return e&&(t=this._toString(t,e,!0)),t},a.prototype._toString=function(e,t,n){if(this._decoder||(this._decoder=new i(t),this._encoding=t),this._encoding!==t)throw new Error("can't switch encodings");var r=this._decoder.write(e);return n&&(r+=this._decoder.end()),r},e.exports=a})),o.register("aWwOA",(function(e,t){e.exports=r;var n=o("cC4OV").EventEmitter;function r(){n.call(this)}o("9iXO2")(r,n),r.Readable=o("1dInE"),r.Writable=o("aItBL"),r.Duplex=o("gNom9"),r.Transform=o("jqh55"),r.PassThrough=o("lnz3O"),r.Stream=r,r.prototype.pipe=function(e,t){var r=this;function i(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",i),e.on("drain",o),e._isStdio||t&&!1===t.end||(r.on("end",s),r.on("close",u));var a=!1;function s(){a||(a=!0,e.end())}function u(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function c(e){if(l(),0===n.listenerCount(this,"error"))throw e}function l(){r.removeListener("data",i),e.removeListener("drain",o),r.removeListener("end",s),r.removeListener("close",u),r.removeListener("error",c),e.removeListener("error",c),r.removeListener("end",l),r.removeListener("close",l),e.removeListener("close",l)}return r.on("error",c),e.on("error",c),r.on("end",l),r.on("close",l),e.on("close",l),e.emit("pipe",r),e}})),o.register("1dInE",(function(e,t){(t=e.exports=o("lzfEV")).Stream=t,t.Readable=t,t.Writable=o("dCSaC"),t.Duplex=o("fxrLT"),t.Transform=o("6FgpR"),t.PassThrough=o("hDGJN")})),o.register("lzfEV",(function(e,n){var r=o("iThRa"),i=o("eZt4V");e.exports=w;var a,s=o("bfFoL");w.ReadableState=v;o("cC4OV").EventEmitter;var u=function(e,t){return e.listeners(t).length},c=o("ljiQl"),l=o("iK33v").Buffer,f=t.Uint8Array||function(){};var h=Object.create(o("6HeLD"));h.inherits=o("9iXO2");var d=o("kOtop"),p=void 0;p=d&&d.debuglog?d.debuglog("stream"):function(){};var m,y=o("8B7AA"),g=o("6Mt80");h.inherits(w,c);var b=["error","close","destroy","pause","resume"];function v(e,t){e=e||{};var n=t instanceof(a=a||o("fxrLT"));this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var r=e.highWaterMark,i=e.readableHighWaterMark,s=this.objectMode?16:16384;this.highWaterMark=r||0===r?r:n&&(i||0===i)?i:s,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new y,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(m||(m=o("5durh").StringDecoder),this.decoder=new m(e.encoding),this.encoding=e.encoding)}function w(e){if(a=a||o("fxrLT"),!(this instanceof w))return new w(e);this._readableState=new v(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),c.call(this)}function _(e,t,n,r,i){var o,a=e._readableState;null===t?(a.reading=!1,function(e,t){if(t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,T(e)}(e,a)):(i||(o=function(e,t){var n;r=t,l.isBuffer(r)||r instanceof f||"string"==typeof t||void 0===t||e.objectMode||(n=new TypeError("Invalid non-string/buffer chunk"));var r;return n}(a,t)),o?e.emit("error",o):a.objectMode||t&&t.length>0?("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===l.prototype||(t=function(e){return l.from(e)}(t)),r?a.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):E(e,a,t,!0):a.ended?e.emit("error",new Error("stream.push() after EOF")):(a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?E(e,a,t,!1):A(e,a)):E(e,a,t,!1))):r||(a.reading=!1));return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(a)}function E(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&T(e)),A(e,t)}Object.defineProperty(w.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),w.prototype.destroy=g.destroy,w.prototype._undestroy=g.undestroy,w.prototype._destroy=function(e,t){this.push(null),t(e)},w.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=l.from(e,t),t=""),n=!0),_(this,e,t,!1,n)},w.prototype.unshift=function(e){return _(this,e,null,!0,!1)},w.prototype.isPaused=function(){return!1===this._readableState.flowing},w.prototype.setEncoding=function(e){return m||(m=o("5durh").StringDecoder),this._readableState.decoder=new m(e),this._readableState.encoding=e,this};var S=8388608;function x(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=S?e=S:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function T(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(p("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?i.nextTick(M,e):M(e))}function M(e){p("emit readable"),e.emit("readable"),N(e)}function A(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(R,e,t))}function R(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(p("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function I(e){p("readable nexttick read 0"),e.read(0)}function P(e,t){t.reading||(p("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),N(e),t.flowing&&!t.reading&&e.read(0)}function N(e){var t=e._readableState;for(p("flow",t.flowing);t.flowing&&null!==e.read(););}function O(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):n=function(e,t,n){var r;e<t.head.data.length?(r=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):r=e===t.head.data.length?t.shift():n?function(e,t){var n=t.head,r=1,i=n.data;e-=i.length;for(;n=n.next;){var o=n.data,a=e>o.length?o.length:e;if(a===o.length?i+=o:i+=o.slice(0,e),0===(e-=a)){a===o.length?(++r,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(a));break}++r}return t.length-=r,i}(e,t):function(e,t){var n=l.allocUnsafe(e),r=t.head,i=1;r.data.copy(n),e-=r.data.length;for(;r=r.next;){var o=r.data,a=e>o.length?o.length:e;if(o.copy(n,n.length-e,0,a),0===(e-=a)){a===o.length?(++i,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(a));break}++i}return t.length-=i,n}(e,t);return r}(e,t.buffer,t.decoder),n);var n}function C(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,i.nextTick(k,t,e))}function k(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function B(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}w.prototype.read=function(e){p("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return p("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?C(this):T(this),null;if(0===(e=x(e,t))&&t.ended)return 0===t.length&&C(this),null;var r,i=t.needReadable;return p("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&p("length less than watermark",i=!0),t.ended||t.reading?p("reading or ended",i=!1):i&&(p("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=x(n,t))),null===(r=e>0?O(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&C(this)),null!==r&&this.emit("data",r),r},w.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},w.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,p("pipe count=%d opts=%j",o.pipesCount,t);var a=(!t||!1!==t.end)&&e!==r.stdout&&e!==r.stderr?l:v;function c(t,r){p("onunpipe"),t===n&&r&&!1===r.hasUnpiped&&(r.hasUnpiped=!0,p("cleanup"),e.removeListener("close",g),e.removeListener("finish",b),e.removeListener("drain",f),e.removeListener("error",y),e.removeListener("unpipe",c),n.removeListener("end",l),n.removeListener("end",v),n.removeListener("data",m),h=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||f())}function l(){p("onend"),e.end()}o.endEmitted?i.nextTick(a):n.once("end",a),e.on("unpipe",c);var f=function(e){return function(){var t=e._readableState;p("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&u(e,"data")&&(t.flowing=!0,N(e))}}(n);e.on("drain",f);var h=!1;var d=!1;function m(t){p("ondata"),d=!1,!1!==e.write(t)||d||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==B(o.pipes,e))&&!h&&(p("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,d=!0),n.pause())}function y(t){p("onerror",t),v(),e.removeListener("error",y),0===u(e,"error")&&e.emit("error",t)}function g(){e.removeListener("finish",b),v()}function b(){p("onfinish"),e.removeListener("close",g),v()}function v(){p("unpipe"),n.unpipe(e)}return n.on("data",m),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?s(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",y),e.once("close",g),e.once("finish",b),e.emit("pipe",n),o.flowing||(p("pipe resume"),n.resume()),e},w.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,n);return this}var a=B(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},w.prototype.on=function(e,t){var n=c.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var r=this._readableState;r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.emittedReadable=!1,r.reading?r.length&&T(this):i.nextTick(I,this))}return n},w.prototype.addListener=w.prototype.on,w.prototype.resume=function(){var e=this._readableState;return e.flowing||(p("resume"),e.flowing=!0,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(P,e,t))}(this,e)),this},w.prototype.pause=function(){return p("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(p("pause"),this._readableState.flowing=!1,this.emit("pause")),this},w.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(p("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(p("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<b.length;o++)e.on(b[o],this.emit.bind(this,b[o]));return this._read=function(t){p("wrapped _read",t),r&&(r=!1,e.resume())},this},Object.defineProperty(w.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),w._fromList=O})),o.register("eZt4V",(function(e,t){var n=o("iThRa");void 0===n||!n.version||0===n.version.indexOf("v0.")||0===n.version.indexOf("v1.")&&0!==n.version.indexOf("v1.8.")?e.exports={nextTick:function(e,t,r,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,a,s=arguments.length;switch(s){case 0:case 1:return n.nextTick(e);case 2:return n.nextTick((function(){e.call(null,t)}));case 3:return n.nextTick((function(){e.call(null,t,r)}));case 4:return n.nextTick((function(){e.call(null,t,r,i)}));default:for(o=new Array(s-1),a=0;a<o.length;)o[a++]=arguments[a];return n.nextTick((function(){e.apply(null,o)}))}}}:e.exports=n})),o.register("bfFoL",(function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}})),o.register("ljiQl",(function(e,t){e.exports=o("cC4OV").EventEmitter})),o.register("iK33v",(function(e,t){var n=o("150uq"),r=n.Buffer;function i(e,t){for(var n in e)t[n]=e[n]}function a(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(i(n,e.exports),e.exports.Buffer=a),i(r,a),a.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},a.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},a.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},a.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}})),o.register("6HeLD",(function(t,n){var r,i,a,s,u,c,l,f,h,d,p,m,y,g,b;e(t.exports,"isArray",(()=>r),(e=>r=e)),e(t.exports,"isBoolean",(()=>i),(e=>i=e)),e(t.exports,"isNull",(()=>a),(e=>a=e)),e(t.exports,"isNullOrUndefined",(()=>s),(e=>s=e)),e(t.exports,"isNumber",(()=>u),(e=>u=e)),e(t.exports,"isString",(()=>c),(e=>c=e)),e(t.exports,"isSymbol",(()=>l),(e=>l=e)),e(t.exports,"isUndefined",(()=>f),(e=>f=e)),e(t.exports,"isRegExp",(()=>h),(e=>h=e)),e(t.exports,"isObject",(()=>d),(e=>d=e)),e(t.exports,"isDate",(()=>p),(e=>p=e)),e(t.exports,"isError",(()=>m),(e=>m=e)),e(t.exports,"isFunction",(()=>y),(e=>y=e)),e(t.exports,"isPrimitive",(()=>g),(e=>g=e)),e(t.exports,"isBuffer",(()=>b),(e=>b=e)),r=function(e){return Array.isArray?Array.isArray(e):"[object Array]"===w(e)},i=function(e){return"boolean"==typeof e},a=function(e){return null===e},s=function(e){return null==e},u=function(e){return"number"==typeof e},c=function(e){return"string"==typeof e},l=function(e){return"symbol"==typeof e},f=function(e){return void 0===e},h=function(e){return"[object RegExp]"===w(e)},d=function(e){return"object"==typeof e&&null!==e},p=function(e){return"[object Date]"===w(e)},m=function(e){return"[object Error]"===w(e)||e instanceof Error},y=function(e){return"function"==typeof e},g=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e};var v=o("150uq");function w(e){return Object.prototype.toString.call(e)}b=v.Buffer.isBuffer})),o.register("8B7AA",(function(e,t){var n=o("iK33v").Buffer,r=o("kOtop");e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},e.prototype.concat=function(e){if(0===this.length)return n.alloc(0);if(1===this.length)return this.head.data;for(var t,r,i,o=n.allocUnsafe(e>>>0),a=this.head,s=0;a;)t=a.data,r=o,i=s,t.copy(r,i),s+=a.data.length,a=a.next;return o},e}(),r&&r.inspect&&r.inspect.custom&&(e.exports.prototype[r.inspect.custom]=function(){var e=r.inspect({length:this.length});return this.constructor.name+" "+e})})),o.register("6Mt80",(function(e,t){var n=o("eZt4V");function r(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var i=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||n.nextTick(r,this,e),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?(n.nextTick(r,i,e),i._writableState&&(i._writableState.errorEmitted=!0)):t&&t(e)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}}})),o.register("fxrLT",(function(e,t){var n=o("eZt4V"),r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=f;var i=Object.create(o("6HeLD"));i.inherits=o("9iXO2");var a=o("lzfEV"),s=o("dCSaC");i.inherits(f,a);for(var u=r(s.prototype),c=0;c<u.length;c++){var l=u[c];f.prototype[l]||(f.prototype[l]=s.prototype[l])}function f(e){if(!(this instanceof f))return new f(e);a.call(this,e),s.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",h)}function h(){this.allowHalfOpen||this._writableState.ended||n.nextTick(d,this)}function d(e){e.end()}Object.defineProperty(f.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(f.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),f.prototype._destroy=function(e,t){this.push(null),this.end(),n.nextTick(t,e)}})),o.register("dCSaC",(function(e,n){var r=o("eZt4V");function i(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}(t,e)}}e.exports=g;var a,s=r.nextTick;g.WritableState=y;var u=Object.create(o("6HeLD"));u.inherits=o("9iXO2");var c={deprecate:o("gfowu")},l=o("ljiQl"),f=o("iK33v").Buffer,h=t.Uint8Array||function(){};var d,p=o("6Mt80");function m(){}function y(e,t){a=a||o("fxrLT"),e=e||{};var n=t instanceof a;this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var u=e.highWaterMark,c=e.writableHighWaterMark,l=this.objectMode?16:16384;this.highWaterMark=u||0===u?u:n&&(c||0===c)?c:l,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var f=!1===e.decodeStrings;this.decodeStrings=!f,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,i=n.sync,o=n.writecb;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,i,o){--t.pendingcb,n?(r.nextTick(o,i),r.nextTick(S,e,t),e._writableState.errorEmitted=!0,e.emit("error",i)):(o(i),e._writableState.errorEmitted=!0,e.emit("error",i),S(e,t))}(e,n,i,t,o);else{var a=_(n);a||n.corked||n.bufferProcessing||!n.bufferedRequest||w(e,n),i?s(v,e,n,a,o):v(e,n,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function g(e){if(a=a||o("fxrLT"),!(d.call(g,this)||this instanceof a))return new g(e);this._writableState=new y(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),l.call(this)}function b(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function v(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),S(e,t)}function w(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,o=new Array(r),a=t.corkedRequestsFree;a.entry=n;for(var s=0,u=!0;n;)o[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;o.allBuffers=u,b(e,t,!0,t.length,o,"",a.finish),t.pendingcb++,t.lastBufferedRequest=null,a.next?(t.corkedRequestsFree=a.next,a.next=null):t.corkedRequestsFree=new i(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,f=n.callback;if(b(e,t,!1,t.objectMode?1:c.length,c,l,f),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function _(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function E(e,t){e._final((function(n){t.pendingcb--,n&&e.emit("error",n),t.prefinished=!0,e.emit("prefinish"),S(e,t)}))}function S(e,t){var n=_(t);return n&&(!function(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,r.nextTick(E,e,t)):(t.prefinished=!0,e.emit("prefinish")))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),n}u.inherits(g,l),y.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(y.prototype,"buffer",{get:c.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(d=Function.prototype[Symbol.hasInstance],Object.defineProperty(g,Symbol.hasInstance,{value:function(e){return!!d.call(this,e)||this===g&&(e&&e._writableState instanceof y)}})):d=function(e){return e instanceof this},g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},g.prototype.write=function(e,t,n){var i,o=this._writableState,a=!1,s=!o.objectMode&&(i=e,f.isBuffer(i)||i instanceof h);return s&&!f.isBuffer(e)&&(e=function(e){return f.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=m),o.ended?function(e,t){var n=new Error("write after end");e.emit("error",n),r.nextTick(t,n)}(this,n):(s||function(e,t,n,i){var o=!0,a=!1;return null===n?a=new TypeError("May not write null values to stream"):"string"==typeof n||void 0===n||t.objectMode||(a=new TypeError("Invalid non-string/buffer chunk")),a&&(e.emit("error",a),r.nextTick(i,a),o=!1),o}(this,o,e,n))&&(o.pendingcb++,a=function(e,t,n,r,i,o){if(!n){var a=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=f.from(t,n));return t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else b(e,t,!1,s,r,i,o);return u}(this,o,s,e,t,n)),a},g.prototype.cork=function(){this._writableState.corked++},g.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},g.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(g.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),g.prototype._write=function(e,t,n){n(new Error("_write() is not implemented"))},g.prototype._writev=null,g.prototype.end=function(e,t,n){var i=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),i.corked&&(i.corked=1,this.uncork()),i.ending||i.finished||function(e,t,n){t.ending=!0,S(e,t),n&&(t.finished?r.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,i,n)},Object.defineProperty(g.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),g.prototype.destroy=p.destroy,g.prototype._undestroy=p.undestroy,g.prototype._destroy=function(e,t){this.end(),t(e)}})),o.register("5durh",(function(t,n){var r;e(t.exports,"StringDecoder",(()=>r),(e=>r=e));var i=o("iK33v").Buffer,a=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===a||!a(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=f,t=4;break;case"utf8":this.fillLast=c,t=4;break;case"base64":this.text=h,this.end=d,t=3;break;default:return this.write=p,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function u(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function c(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function f(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function h(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function m(e){return e&&e.length?this.write(e):""}r=s,s.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=u(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=u(t[r]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=u(t[r]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}})),o.register("6FgpR",(function(e,t){e.exports=a;var n=o("fxrLT"),r=Object.create(o("6HeLD"));function i(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(!r)return this.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function a(e){if(!(this instanceof a))return new a(e);n.call(this,e),this._transformState={afterTransform:i.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",s)}function s(){var e=this;"function"==typeof this._flush?this._flush((function(t,n){u(e,t,n)})):u(this,null,null)}function u(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}r.inherits=o("9iXO2"),r.inherits(a,n),a.prototype.push=function(e,t){return this._transformState.needTransform=!1,n.prototype.push.call(this,e,t)},a.prototype._transform=function(e,t,n){throw new Error("_transform() is not implemented")},a.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},a.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},a.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,(function(e){t(e),r.emit("close")}))}})),o.register("hDGJN",(function(e,t){e.exports=i;var n=o("6FgpR"),r=Object.create(o("6HeLD"));function i(e){if(!(this instanceof i))return new i(e);n.call(this,e)}r.inherits=o("9iXO2"),r.inherits(i,n),i.prototype._transform=function(e,t,n){n(null,e)}})),o.register("aItBL",(function(e,t){e.exports=o("dCSaC")})),o.register("gNom9",(function(e,t){e.exports=o("fxrLT")})),o.register("jqh55",(function(e,t){e.exports=o("1dInE").Transform})),o.register("lnz3O",(function(e,t){e.exports=o("1dInE").PassThrough})),o.register("9CK9X",(function(e,t){var n=o("9iXO2"),r=o("6l7GL"),i=o("1vQsi"),a=o("2BZf1").Buffer,s=o("54dYR"),u=o("4OYrg"),c=o("cRNpC"),l=a.alloc(128);function f(e,t){i.call(this,"digest"),"string"==typeof t&&(t=a.from(t));var n="sha512"===e||"sha384"===e?128:64;(this._alg=e,this._key=t,t.length>n)?t=("rmd160"===e?new u:c(e)).update(t).digest():t.length<n&&(t=a.concat([t,l],n));for(var r=this._ipad=a.allocUnsafe(n),o=this._opad=a.allocUnsafe(n),s=0;s<n;s++)r[s]=54^t[s],o[s]=92^t[s];this._hash="rmd160"===e?new u:c(e),this._hash.update(r)}n(f,i),f.prototype._update=function(e){this._hash.update(e)},f.prototype._final=function(){var e=this._hash.digest();return("rmd160"===this._alg?new u:c(this._alg)).update(this._opad).update(e).digest()},e.exports=function(e,t){return"rmd160"===(e=e.toLowerCase())||"ripemd160"===e?new f("rmd160",t):"md5"===e?new r(s,t):new f(e,t)}})),o.register("6l7GL",(function(e,t){var n=o("9iXO2"),r=o("2BZf1").Buffer,i=o("1vQsi"),a=r.alloc(128),s=64;function u(e,t){i.call(this,"digest"),"string"==typeof t&&(t=r.from(t)),this._alg=e,this._key=t,t.length>s?t=e(t):t.length<s&&(t=r.concat([t,a],s));for(var n=this._ipad=r.allocUnsafe(s),o=this._opad=r.allocUnsafe(s),u=0;u<s;u++)n[u]=54^t[u],o[u]=92^t[u];this._hash=[n]}n(u,i),u.prototype._update=function(e){this._hash.push(e)},u.prototype._final=function(){var e=this._alg(r.concat(this._hash));return this._alg(r.concat([this._opad,e]))},e.exports=u})),o.register("54dYR",(function(e,t){var n=o("eujcR");e.exports=function(e){return(new n).update(e).digest()}})),o.register("8F6Vk",(function(e,t){e.exports=o("f05N3")})),o.register("f05N3",(function(e,t){e.exports=JSON.parse('{"sha224WithRSAEncryption":{"sign":"rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"RSA-SHA224":{"sign":"ecdsa/rsa","hash":"sha224","id":"302d300d06096086480165030402040500041c"},"sha256WithRSAEncryption":{"sign":"rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"RSA-SHA256":{"sign":"ecdsa/rsa","hash":"sha256","id":"3031300d060960864801650304020105000420"},"sha384WithRSAEncryption":{"sign":"rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"RSA-SHA384":{"sign":"ecdsa/rsa","hash":"sha384","id":"3041300d060960864801650304020205000430"},"sha512WithRSAEncryption":{"sign":"rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA512":{"sign":"ecdsa/rsa","hash":"sha512","id":"3051300d060960864801650304020305000440"},"RSA-SHA1":{"sign":"rsa","hash":"sha1","id":"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{"sign":"ecdsa","hash":"sha1","id":""},"sha256":{"sign":"ecdsa","hash":"sha256","id":""},"sha224":{"sign":"ecdsa","hash":"sha224","id":""},"sha384":{"sign":"ecdsa","hash":"sha384","id":""},"sha512":{"sign":"ecdsa","hash":"sha512","id":""},"DSA-SHA":{"sign":"dsa","hash":"sha1","id":""},"DSA-SHA1":{"sign":"dsa","hash":"sha1","id":""},"DSA":{"sign":"dsa","hash":"sha1","id":""},"DSA-WITH-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-SHA224":{"sign":"dsa","hash":"sha224","id":""},"DSA-WITH-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-SHA256":{"sign":"dsa","hash":"sha256","id":""},"DSA-WITH-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-SHA384":{"sign":"dsa","hash":"sha384","id":""},"DSA-WITH-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-SHA512":{"sign":"dsa","hash":"sha512","id":""},"DSA-RIPEMD160":{"sign":"dsa","hash":"rmd160","id":""},"ripemd160WithRSA":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"RSA-RIPEMD160":{"sign":"rsa","hash":"rmd160","id":"3021300906052b2403020105000414"},"md5WithRSAEncryption":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"},"RSA-MD5":{"sign":"rsa","hash":"md5","id":"3020300c06082a864886f70d020505000410"}}')})),o.register("clDJD",(function(t,n){var r,i;e(t.exports,"pbkdf2",(()=>r),(e=>r=e)),e(t.exports,"pbkdf2Sync",(()=>i),(e=>i=e)),r=o("63MOo"),i=o("2aqsO")})),o.register("63MOo",(function(e,n){var r,i,a=o("2BZf1").Buffer,s=o("1RSq6"),u=o("7mTtU"),c=o("2aqsO"),l=o("9oNqi"),f=t.crypto&&t.crypto.subtle,h={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},d=[];function p(){return i||(i=t.process&&t.process.nextTick?t.process.nextTick:t.queueMicrotask?t.queueMicrotask:t.setImmediate?t.setImmediate:t.setTimeout)}function m(e,t,n,r,i){return f.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]).then((function(e){return f.deriveBits({name:"PBKDF2",salt:t,iterations:n,hash:{name:i}},e,r<<3)})).then((function(e){return a.from(e)}))}e.exports=function(e,n,i,o,y,g){"function"==typeof y&&(g=y,y=void 0);var b=h[(y=y||"sha1").toLowerCase()];if(b&&"function"==typeof t.Promise){if(s(i,o),e=l(e,u,"Password"),n=l(n,u,"Salt"),"function"!=typeof g)throw new Error("No callback provided to pbkdf2");!function(e,t){e.then((function(e){p()((function(){t(null,e)}))}),(function(e){p()((function(){t(e)}))}))}(function(e){if(t.process&&!t.process.browser)return Promise.resolve(!1);if(!f||!f.importKey||!f.deriveBits)return Promise.resolve(!1);if(void 0!==d[e])return d[e];var n=m(r=r||a.alloc(8),r,10,128,e).then((function(){return!0})).catch((function(){return!1}));return d[e]=n,n}(b).then((function(t){return t?m(e,n,i,o,b):c(e,n,i,o,y)})),g)}else p()((function(){var t;try{t=c(e,n,i,o,y)}catch(e){return g(e)}g(null,t)}))}})),o.register("1RSq6",(function(e,t){var n=Math.pow(2,30)-1;e.exports=function(e,t){if("number"!=typeof e)throw new TypeError("Iterations not a number");if(e<0)throw new TypeError("Bad iterations");if("number"!=typeof t)throw new TypeError("Key length not a number");if(t<0||t>n||t!=t)throw new TypeError("Bad key length")}})),o.register("7mTtU",(function(e,n){var r,i=o("iThRa");if(t.process&&t.process.browser)r="utf-8";else if(t.process&&t.process.version){r=parseInt(i.version.split(".")[0].slice(1),10)>=6?"utf-8":"binary"}else r="utf-8";e.exports=r})),o.register("2aqsO",(function(e,t){var n=o("54dYR"),r=o("4OYrg"),i=o("cRNpC"),a=o("2BZf1").Buffer,s=o("1RSq6"),u=o("7mTtU"),c=o("9oNqi"),l=a.alloc(128),f={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function h(e,t,o){var s=function(e){function t(t){return i(e).update(t).digest()}function o(e){return(new r).update(e).digest()}return"rmd160"===e||"ripemd160"===e?o:"md5"===e?n:t}(e),u="sha512"===e||"sha384"===e?128:64;t.length>u?t=s(t):t.length<u&&(t=a.concat([t,l],u));for(var c=a.allocUnsafe(u+f[e]),h=a.allocUnsafe(u+f[e]),d=0;d<u;d++)c[d]=54^t[d],h[d]=92^t[d];var p=a.allocUnsafe(u+o+4);c.copy(p,0,0,u),this.ipad1=p,this.ipad2=c,this.opad=h,this.alg=e,this.blocksize=u,this.hash=s,this.size=f[e]}h.prototype.run=function(e,t){return e.copy(t,this.blocksize),this.hash(t).copy(this.opad,this.blocksize),this.hash(this.opad)},e.exports=function(e,t,n,r,i){s(n,r);var o=new h(i=i||"sha1",e=c(e,u,"Password"),(t=c(t,u,"Salt")).length),l=a.allocUnsafe(r),d=a.allocUnsafe(t.length+4);t.copy(d,0,0,t.length);for(var p=0,m=f[i],y=Math.ceil(r/m),g=1;g<=y;g++){d.writeUInt32BE(g,t.length);for(var b=o.run(d,o.ipad1),v=b,w=1;w<n;w++){v=o.run(v,o.ipad2);for(var _=0;_<m;_++)b[_]^=v[_]}b.copy(l,p),p+=m}return l}})),o.register("9oNqi",(function(e,t){var n=o("2BZf1").Buffer;e.exports=function(e,t,r){if(n.isBuffer(e))return e;if("string"==typeof e)return n.from(e,t);if(ArrayBuffer.isView(e))return n.from(e.buffer);throw new TypeError(r+" must be a string, a Buffer, a typed array or a DataView")}})),o.register("e7fkm",(function(t,n){var r,i,a,s,u,c,l,f,h,d;e(t.exports,"createCipher",(()=>r),(e=>r=e)),e(t.exports,"Cipher",(()=>i),(e=>i=e)),e(t.exports,"createCipheriv",(()=>a),(e=>a=e)),e(t.exports,"Cipheriv",(()=>s),(e=>s=e)),e(t.exports,"createDecipher",(()=>u),(e=>u=e)),e(t.exports,"Decipher",(()=>c),(e=>c=e)),e(t.exports,"createDecipheriv",(()=>l),(e=>l=e)),e(t.exports,"Decipheriv",(()=>f),(e=>f=e)),e(t.exports,"listCiphers",(()=>h),(e=>h=e)),e(t.exports,"getCiphers",(()=>d),(e=>d=e));var p=o("6Y8gU"),m=o("1oSxb"),y=o("9KJKg"),g=o("2eKjK"),b=o("jp7Eg");function v(e,t,n){if(e=e.toLowerCase(),y[e])return m.createCipheriv(e,t,n);if(g[e])return new p({key:t,iv:n,mode:e});throw new TypeError("invalid suite type")}function w(e,t,n){if(e=e.toLowerCase(),y[e])return m.createDecipheriv(e,t,n);if(g[e])return new p({key:t,iv:n,mode:e,decrypt:!0});throw new TypeError("invalid suite type")}r=i=function(e,t){var n,r;if(e=e.toLowerCase(),y[e])n=y[e].key,r=y[e].iv;else{if(!g[e])throw new TypeError("invalid suite type");n=8*g[e].key,r=g[e].iv}var i=b(t,!1,n,r);return v(e,i.key,i.iv)},a=s=v,u=c=function(e,t){var n,r;if(e=e.toLowerCase(),y[e])n=y[e].key,r=y[e].iv;else{if(!g[e])throw new TypeError("invalid suite type");n=8*g[e].key,r=g[e].iv}var i=b(t,!1,n,r);return w(e,i.key,i.iv)},l=f=w,h=d=function(){return Object.keys(g).concat(m.getCiphers())}})),o.register("6Y8gU",(function(e,t){var n=o("1vQsi"),r=o("96unH"),i=o("9iXO2"),a=o("2BZf1").Buffer,s={"des-ede3-cbc":r.CBC.instantiate(r.EDE),"des-ede3":r.EDE,"des-ede-cbc":r.CBC.instantiate(r.EDE),"des-ede":r.EDE,"des-cbc":r.CBC.instantiate(r.DES),"des-ecb":r.DES};function u(e){n.call(this);var t,r=e.mode.toLowerCase(),i=s[r];t=e.decrypt?"decrypt":"encrypt";var o=e.key;a.isBuffer(o)||(o=a.from(o)),"des-ede"!==r&&"des-ede-cbc"!==r||(o=a.concat([o,o.slice(0,8)]));var u=e.iv;a.isBuffer(u)||(u=a.from(u)),this._des=i.create({key:o,iv:u,type:t})}s.des=s["des-cbc"],s.des3=s["des-ede3-cbc"],e.exports=u,i(u,n),u.prototype._update=function(e){return a.from(this._des.update(e))},u.prototype._final=function(){return a.from(this._des.final())}})),o.register("96unH",(function(t,n){var r,i,a;e(t.exports,"DES",(()=>r),(e=>r=e)),e(t.exports,"CBC",(()=>i),(e=>i=e)),e(t.exports,"EDE",(()=>a),(e=>a=e)),o("Qov4S"),o("dohTS"),r=o("g6g4y"),i=o("7c1Km"),a=o("6hqnG")})),o.register("Qov4S",(function(t,n){var r,i,o,a,s,u,c,l,f,h,d;e(t.exports,"readUInt32BE",(()=>r),(e=>r=e)),e(t.exports,"writeUInt32BE",(()=>i),(e=>i=e)),e(t.exports,"ip",(()=>o),(e=>o=e)),e(t.exports,"rip",(()=>a),(e=>a=e)),e(t.exports,"pc1",(()=>s),(e=>s=e)),e(t.exports,"r28shl",(()=>u),(e=>u=e)),e(t.exports,"pc2",(()=>c),(e=>c=e)),e(t.exports,"expand",(()=>l),(e=>l=e)),e(t.exports,"substitute",(()=>f),(e=>f=e)),e(t.exports,"permute",(()=>h),(e=>h=e)),e(t.exports,"padSplit",(()=>d),(e=>d=e)),r=function(e,t){return(e[0+t]<<24|e[1+t]<<16|e[2+t]<<8|e[3+t])>>>0},i=function(e,t,n){e[0+n]=t>>>24,e[1+n]=t>>>16&255,e[2+n]=t>>>8&255,e[3+n]=255&t},o=function(e,t,n,r){for(var i=0,o=0,a=6;a>=0;a-=2){for(var s=0;s<=24;s+=8)i<<=1,i|=t>>>s+a&1;for(s=0;s<=24;s+=8)i<<=1,i|=e>>>s+a&1}for(a=6;a>=0;a-=2){for(s=1;s<=25;s+=8)o<<=1,o|=t>>>s+a&1;for(s=1;s<=25;s+=8)o<<=1,o|=e>>>s+a&1}n[r+0]=i>>>0,n[r+1]=o>>>0},a=function(e,t,n,r){for(var i=0,o=0,a=0;a<4;a++)for(var s=24;s>=0;s-=8)i<<=1,i|=t>>>s+a&1,i<<=1,i|=e>>>s+a&1;for(a=4;a<8;a++)for(s=24;s>=0;s-=8)o<<=1,o|=t>>>s+a&1,o<<=1,o|=e>>>s+a&1;n[r+0]=i>>>0,n[r+1]=o>>>0},s=function(e,t,n,r){for(var i=0,o=0,a=7;a>=5;a--){for(var s=0;s<=24;s+=8)i<<=1,i|=t>>s+a&1;for(s=0;s<=24;s+=8)i<<=1,i|=e>>s+a&1}for(s=0;s<=24;s+=8)i<<=1,i|=t>>s+a&1;for(a=1;a<=3;a++){for(s=0;s<=24;s+=8)o<<=1,o|=t>>s+a&1;for(s=0;s<=24;s+=8)o<<=1,o|=e>>s+a&1}for(s=0;s<=24;s+=8)o<<=1,o|=e>>s+a&1;n[r+0]=i>>>0,n[r+1]=o>>>0},u=function(e,t){return e<<t&268435455|e>>>28-t};var p=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];c=function(e,t,n,r){for(var i=0,o=0,a=p.length>>>1,s=0;s<a;s++)i<<=1,i|=e>>>p[s]&1;for(s=a;s<p.length;s++)o<<=1,o|=t>>>p[s]&1;n[r+0]=i>>>0,n[r+1]=o>>>0},l=function(e,t,n){var r=0,i=0;r=(1&e)<<5|e>>>27;for(var o=23;o>=15;o-=4)r<<=6,r|=e>>>o&63;for(o=11;o>=3;o-=4)i|=e>>>o&63,i<<=6;i|=(31&e)<<1|e>>>31,t[n+0]=r>>>0,t[n+1]=i>>>0};var m=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];f=function(e,t){for(var n=0,r=0;r<4;r++){n<<=4,n|=m[64*r+(e>>>18-6*r&63)]}for(r=0;r<4;r++){n<<=4,n|=m[256+64*r+(t>>>18-6*r&63)]}return n>>>0};var y=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];h=function(e){for(var t=0,n=0;n<y.length;n++)t<<=1,t|=e>>>y[n]&1;return t>>>0},d=function(e,t,n){for(var r=e.toString(2);r.length<t;)r="0"+r;for(var i=[],o=0;o<t;o+=n)i.push(r.slice(o,o+n));return i.join(" ")}})),o.register("dohTS",(function(e,t){var n=o("b8dAq");function r(e){this.options=e,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0}e.exports=r,r.prototype._init=function(){},r.prototype.update=function(e){return 0===e.length?[]:"decrypt"===this.type?this._updateDecrypt(e):this._updateEncrypt(e)},r.prototype._buffer=function(e,t){for(var n=Math.min(this.buffer.length-this.bufferOff,e.length-t),r=0;r<n;r++)this.buffer[this.bufferOff+r]=e[t+r];return this.bufferOff+=n,n},r.prototype._flushBuffer=function(e,t){return this._update(this.buffer,0,e,t),this.bufferOff=0,this.blockSize},r.prototype._updateEncrypt=function(e){var t=0,n=0,r=(this.bufferOff+e.length)/this.blockSize|0,i=new Array(r*this.blockSize);0!==this.bufferOff&&(t+=this._buffer(e,t),this.bufferOff===this.buffer.length&&(n+=this._flushBuffer(i,n)));for(var o=e.length-(e.length-t)%this.blockSize;t<o;t+=this.blockSize)this._update(e,t,i,n),n+=this.blockSize;for(;t<e.length;t++,this.bufferOff++)this.buffer[this.bufferOff]=e[t];return i},r.prototype._updateDecrypt=function(e){for(var t=0,n=0,r=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,i=new Array(r*this.blockSize);r>0;r--)t+=this._buffer(e,t),n+=this._flushBuffer(i,n);return t+=this._buffer(e,t),i},r.prototype.final=function(e){var t,n;return e&&(t=this.update(e)),n="encrypt"===this.type?this._finalEncrypt():this._finalDecrypt(),t?t.concat(n):n},r.prototype._pad=function(e,t){if(0===t)return!1;for(;t<e.length;)e[t++]=0;return!0},r.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e},r.prototype._unpad=function(e){return e},r.prototype._finalDecrypt=function(){n.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}})),o.register("b8dAq",(function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}e.exports=n,n.equal=function(e,t,n){if(e!=t)throw new Error(n||"Assertion failed: "+e+" != "+t)}})),o.register("g6g4y",(function(e,t){var n=o("b8dAq"),r=o("9iXO2"),i=o("Qov4S"),a=o("dohTS");function s(){this.tmp=new Array(2),this.keys=null}function u(e){a.call(this,e);var t=new s;this._desState=t,this.deriveKeys(t,e.key)}r(u,a),e.exports=u,u.create=function(e){return new u(e)};var c=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];u.prototype.deriveKeys=function(e,t){e.keys=new Array(32),n.equal(t.length,this.blockSize,"Invalid key length");var r=i.readUInt32BE(t,0),o=i.readUInt32BE(t,4);i.pc1(r,o,e.tmp,0),r=e.tmp[0],o=e.tmp[1];for(var a=0;a<e.keys.length;a+=2){var s=c[a>>>1];r=i.r28shl(r,s),o=i.r28shl(o,s),i.pc2(r,o,e.keys,a)}},u.prototype._update=function(e,t,n,r){var o=this._desState,a=i.readUInt32BE(e,t),s=i.readUInt32BE(e,t+4);i.ip(a,s,o.tmp,0),a=o.tmp[0],s=o.tmp[1],"encrypt"===this.type?this._encrypt(o,a,s,o.tmp,0):this._decrypt(o,a,s,o.tmp,0),a=o.tmp[0],s=o.tmp[1],i.writeUInt32BE(n,a,r),i.writeUInt32BE(n,s,r+4)},u.prototype._pad=function(e,t){for(var n=e.length-t,r=t;r<e.length;r++)e[r]=n;return!0},u.prototype._unpad=function(e){for(var t=e[e.length-1],r=e.length-t;r<e.length;r++)n.equal(e[r],t);return e.slice(0,e.length-t)},u.prototype._encrypt=function(e,t,n,r,o){for(var a=t,s=n,u=0;u<e.keys.length;u+=2){var c=e.keys[u],l=e.keys[u+1];i.expand(s,e.tmp,0),c^=e.tmp[0],l^=e.tmp[1];var f=i.substitute(c,l),h=s;s=(a^i.permute(f))>>>0,a=h}i.rip(s,a,r,o)},u.prototype._decrypt=function(e,t,n,r,o){for(var a=n,s=t,u=e.keys.length-2;u>=0;u-=2){var c=e.keys[u],l=e.keys[u+1];i.expand(a,e.tmp,0),c^=e.tmp[0],l^=e.tmp[1];var f=i.substitute(c,l),h=a;a=(s^i.permute(f))>>>0,s=h}i.rip(a,s,r,o)}})),o.register("7c1Km",(function(t,n){var r;e(t.exports,"instantiate",(()=>r),(e=>r=e));var i=o("b8dAq"),a=o("9iXO2"),s={};function u(e){i.equal(e.length,8,"Invalid IV length"),this.iv=new Array(8);for(var t=0;t<this.iv.length;t++)this.iv[t]=e[t]}r=function(e){function t(t){e.call(this,t),this._cbcInit()}a(t,e);for(var n=Object.keys(s),r=0;r<n.length;r++){var i=n[r];t.prototype[i]=s[i]}return t.create=function(e){return new t(e)},t},s._cbcInit=function(){var e=new u(this.options.iv);this._cbcState=e},s._update=function(e,t,n,r){var i=this._cbcState,o=this.constructor.super_.prototype,a=i.iv;if("encrypt"===this.type){for(var s=0;s<this.blockSize;s++)a[s]^=e[t+s];o._update.call(this,a,0,n,r);for(s=0;s<this.blockSize;s++)a[s]=n[r+s]}else{o._update.call(this,e,t,n,r);for(s=0;s<this.blockSize;s++)n[r+s]^=a[s];for(s=0;s<this.blockSize;s++)a[s]=e[t+s]}}})),o.register("6hqnG",(function(e,t){var n=o("b8dAq"),r=o("9iXO2"),i=o("dohTS"),a=o("g6g4y");function s(e,t){n.equal(t.length,24,"Invalid key length");var r=t.slice(0,8),i=t.slice(8,16),o=t.slice(16,24);this.ciphers="encrypt"===e?[a.create({type:"encrypt",key:r}),a.create({type:"decrypt",key:i}),a.create({type:"encrypt",key:o})]:[a.create({type:"decrypt",key:o}),a.create({type:"encrypt",key:i}),a.create({type:"decrypt",key:r})]}function u(e){i.call(this,e);var t=new s(this.type,this.options.key);this._edeState=t}r(u,i),e.exports=u,u.create=function(e){return new u(e)},u.prototype._update=function(e,t,n,r){var i=this._edeState;i.ciphers[0]._update(e,t,n,r),i.ciphers[1]._update(n,r,n,r),i.ciphers[2]._update(n,r,n,r)},u.prototype._pad=a.prototype._pad,u.prototype._unpad=a.prototype._unpad})),o.register("1oSxb",(function(t,n){var r,i,a;e(t.exports,"createCipheriv",(()=>r),(e=>r=e)),e(t.exports,"createDecipheriv",(()=>i),(e=>i=e)),e(t.exports,"getCiphers",(()=>a),(e=>a=e));var s=o("iL9VT"),u=o("6vOp4"),c=o("hli4S");s.createCipher,r=s.createCipheriv,u.createDecipher,i=u.createDecipheriv,a=function(){return Object.keys(c)}})),o.register("iL9VT",(function(t,n){var r,i;e(t.exports,"createCipheriv",(()=>r),(e=>r=e)),e(t.exports,"createCipher",(()=>i),(e=>i=e));var a=o("9KJKg"),s=o("Z2aU1"),u=o("2BZf1").Buffer,c=o("78JqF"),l=o("1vQsi"),f=o("l2DHC"),h=o("jp7Eg");function d(e,t,n){l.call(this),this._cache=new m,this._cipher=new f.AES(t),this._prev=u.from(n),this._mode=e,this._autopadding=!0}o("9iXO2")(d,l),d.prototype._update=function(e){var t,n;this._cache.add(e);for(var r=[];t=this._cache.get();)n=this._mode.encrypt(this,t),r.push(n);return u.concat(r)};var p=u.alloc(16,16);function m(){this.cache=u.allocUnsafe(0)}function y(e,t,n){var r=a[e.toLowerCase()];if(!r)throw new TypeError("invalid suite type");if("string"==typeof t&&(t=u.from(t)),t.length!==r.key/8)throw new TypeError("invalid key length "+t.length);if("string"==typeof n&&(n=u.from(n)),"GCM"!==r.mode&&n.length!==r.iv)throw new TypeError("invalid iv length "+n.length);return"stream"===r.type?new c(r.module,t,n):"auth"===r.type?new s(r.module,t,n):new d(r.module,t,n)}d.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return e=this._mode.encrypt(this,e),this._cipher.scrub(),e;if(!e.equals(p))throw this._cipher.scrub(),new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},m.prototype.add=function(e){this.cache=u.concat([this.cache,e])},m.prototype.get=function(){if(this.cache.length>15){var e=this.cache.slice(0,16);return this.cache=this.cache.slice(16),e}return null},m.prototype.flush=function(){for(var e=16-this.cache.length,t=u.allocUnsafe(e),n=-1;++n<e;)t.writeUInt8(e,n);return u.concat([this.cache,t])},r=y,i=function(e,t){var n=a[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=h(t,!1,n.key,n.iv);return y(e,r.key,r.iv)}})),o.register("9KJKg",(function(e,t){var n={ECB:o("bSGpl"),CBC:o("9TlJO"),CFB:o("4mNgf"),CFB8:o("dbDtR"),CFB1:o("86auT"),OFB:o("4AkpS"),CTR:o("hrvz2"),GCM:o("hrvz2")},r=o("hli4S");for(var i in r)r[i].module=n[r[i].mode];e.exports=r})),o.register("bSGpl",(function(t,n){var r,i;e(t.exports,"encrypt",(()=>r),(e=>r=e)),e(t.exports,"decrypt",(()=>i),(e=>i=e)),r=function(e,t){return e._cipher.encryptBlock(t)},i=function(e,t){return e._cipher.decryptBlock(t)}})),o.register("9TlJO",(function(t,n){var r,i;e(t.exports,"encrypt",(()=>r),(e=>r=e)),e(t.exports,"decrypt",(()=>i),(e=>i=e));var a=o("62id0");r=function(e,t){var n=a(t,e._prev);return e._prev=e._cipher.encryptBlock(n),e._prev},i=function(e,t){var n=e._prev;e._prev=t;var r=e._cipher.decryptBlock(t);return a(r,n)}})),o.register("62id0",(function(e,t){var n=o("150uq").Buffer;e.exports=function(e,t){for(var r=Math.min(e.length,t.length),i=new n(r),o=0;o<r;++o)i[o]=e[o]^t[o];return i}})),o.register("4mNgf",(function(t,n){var r;e(t.exports,"encrypt",(()=>r),(e=>r=e));var i=o("2BZf1").Buffer,a=o("62id0");function s(e,t,n){var r=t.length,o=a(t,e._cache);return e._cache=e._cache.slice(r),e._prev=i.concat([e._prev,n?t:o]),o}r=function(e,t,n){for(var r,o=i.allocUnsafe(0);t.length;){if(0===e._cache.length&&(e._cache=e._cipher.encryptBlock(e._prev),e._prev=i.allocUnsafe(0)),!(e._cache.length<=t.length)){o=i.concat([o,s(e,t,n)]);break}r=e._cache.length,o=i.concat([o,s(e,t.slice(0,r),n)]),t=t.slice(r)}return o}})),o.register("dbDtR",(function(t,n){var r;e(t.exports,"encrypt",(()=>r),(e=>r=e));var i=o("2BZf1").Buffer;function a(e,t,n){var r=e._cipher.encryptBlock(e._prev)[0]^t;return e._prev=i.concat([e._prev.slice(1),i.from([n?t:r])]),r}r=function(e,t,n){for(var r=t.length,o=i.allocUnsafe(r),s=-1;++s<r;)o[s]=a(e,t[s],n);return o}})),o.register("86auT",(function(t,n){var r;e(t.exports,"encrypt",(()=>r),(e=>r=e));var i=o("2BZf1").Buffer;function a(e,t,n){for(var r,i,o=-1,a=0;++o<8;)r=t&1<<7-o?128:0,a+=(128&(i=e._cipher.encryptBlock(e._prev)[0]^r))>>o%8,e._prev=s(e._prev,n?r:i);return a}function s(e,t){var n=e.length,r=-1,o=i.allocUnsafe(e.length);for(e=i.concat([e,i.from([t])]);++r<n;)o[r]=e[r]<<1|e[r+1]>>7;return o}r=function(e,t,n){for(var r=t.length,o=i.allocUnsafe(r),s=-1;++s<r;)o[s]=a(e,t[s],n);return o}})),o.register("4AkpS",(function(t,n){var r;e(t.exports,"encrypt",(()=>r),(e=>r=e));var i=o("150uq").Buffer,a=o("62id0");function s(e){return e._prev=e._cipher.encryptBlock(e._prev),e._prev}r=function(e,t){for(;e._cache.length<t.length;)e._cache=i.concat([e._cache,s(e)]);var n=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),a(t,n)}})),o.register("hrvz2",(function(t,n){var r;e(t.exports,"encrypt",(()=>r),(e=>r=e));var i=o("62id0"),a=o("2BZf1").Buffer,s=o("9xlU0");function u(e){var t=e._cipher.encryptBlockRaw(e._prev);return s(e._prev),t}r=function(e,t){var n=Math.ceil(t.length/16),r=e._cache.length;e._cache=a.concat([e._cache,a.allocUnsafe(16*n)]);for(var o=0;o<n;o++){var s=u(e),c=r+16*o;e._cache.writeUInt32BE(s[0],c+0),e._cache.writeUInt32BE(s[1],c+4),e._cache.writeUInt32BE(s[2],c+8),e._cache.writeUInt32BE(s[3],c+12)}var l=e._cache.slice(0,t.length);return e._cache=e._cache.slice(t.length),i(t,l)}})),o.register("9xlU0",(function(e,t){e.exports=function(e){for(var t,n=e.length;n--;){if(255!==(t=e.readUInt8(n))){t++,e.writeUInt8(t,n);break}e.writeUInt8(0,n)}}})),o.register("hli4S",(function(e,t){e.exports=JSON.parse('{"aes-128-ecb":{"cipher":"AES","key":128,"iv":0,"mode":"ECB","type":"block"},"aes-192-ecb":{"cipher":"AES","key":192,"iv":0,"mode":"ECB","type":"block"},"aes-256-ecb":{"cipher":"AES","key":256,"iv":0,"mode":"ECB","type":"block"},"aes-128-cbc":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes-192-cbc":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes-256-cbc":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes128":{"cipher":"AES","key":128,"iv":16,"mode":"CBC","type":"block"},"aes192":{"cipher":"AES","key":192,"iv":16,"mode":"CBC","type":"block"},"aes256":{"cipher":"AES","key":256,"iv":16,"mode":"CBC","type":"block"},"aes-128-cfb":{"cipher":"AES","key":128,"iv":16,"mode":"CFB","type":"stream"},"aes-192-cfb":{"cipher":"AES","key":192,"iv":16,"mode":"CFB","type":"stream"},"aes-256-cfb":{"cipher":"AES","key":256,"iv":16,"mode":"CFB","type":"stream"},"aes-128-cfb8":{"cipher":"AES","key":128,"iv":16,"mode":"CFB8","type":"stream"},"aes-192-cfb8":{"cipher":"AES","key":192,"iv":16,"mode":"CFB8","type":"stream"},"aes-256-cfb8":{"cipher":"AES","key":256,"iv":16,"mode":"CFB8","type":"stream"},"aes-128-cfb1":{"cipher":"AES","key":128,"iv":16,"mode":"CFB1","type":"stream"},"aes-192-cfb1":{"cipher":"AES","key":192,"iv":16,"mode":"CFB1","type":"stream"},"aes-256-cfb1":{"cipher":"AES","key":256,"iv":16,"mode":"CFB1","type":"stream"},"aes-128-ofb":{"cipher":"AES","key":128,"iv":16,"mode":"OFB","type":"stream"},"aes-192-ofb":{"cipher":"AES","key":192,"iv":16,"mode":"OFB","type":"stream"},"aes-256-ofb":{"cipher":"AES","key":256,"iv":16,"mode":"OFB","type":"stream"},"aes-128-ctr":{"cipher":"AES","key":128,"iv":16,"mode":"CTR","type":"stream"},"aes-192-ctr":{"cipher":"AES","key":192,"iv":16,"mode":"CTR","type":"stream"},"aes-256-ctr":{"cipher":"AES","key":256,"iv":16,"mode":"CTR","type":"stream"},"aes-128-gcm":{"cipher":"AES","key":128,"iv":12,"mode":"GCM","type":"auth"},"aes-192-gcm":{"cipher":"AES","key":192,"iv":12,"mode":"GCM","type":"auth"},"aes-256-gcm":{"cipher":"AES","key":256,"iv":12,"mode":"GCM","type":"auth"}}')})),o.register("Z2aU1",(function(e,t){var n=o("l2DHC"),r=o("2BZf1").Buffer,i=o("1vQsi"),a=o("9iXO2"),s=o("j0FAo"),u=o("62id0"),c=o("9xlU0");function l(e,t,o,a){i.call(this);var u=r.alloc(4,0);this._cipher=new n.AES(t);var l=this._cipher.encryptBlock(u);this._ghash=new s(l),o=function(e,t,n){if(12===t.length)return e._finID=r.concat([t,r.from([0,0,0,1])]),r.concat([t,r.from([0,0,0,2])]);var i=new s(n),o=t.length,a=o%16;i.update(t),a&&(a=16-a,i.update(r.alloc(a,0))),i.update(r.alloc(8,0));var u=8*o,l=r.alloc(8);l.writeUIntBE(u,0,8),i.update(l),e._finID=i.state;var f=r.from(e._finID);return c(f),f}(this,o,l),this._prev=r.from(o),this._cache=r.allocUnsafe(0),this._secCache=r.allocUnsafe(0),this._decrypt=a,this._alen=0,this._len=0,this._mode=e,this._authTag=null,this._called=!1}a(l,i),l.prototype._update=function(e){if(!this._called&&this._alen){var t=16-this._alen%16;t<16&&(t=r.alloc(t,0),this._ghash.update(t))}this._called=!0;var n=this._mode.encrypt(this,e);return this._decrypt?this._ghash.update(e):this._ghash.update(n),this._len+=e.length,n},l.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var e=u(this._ghash.final(8*this._alen,8*this._len),this._cipher.encryptBlock(this._finID));if(this._decrypt&&function(e,t){var n=0;e.length!==t.length&&n++;for(var r=Math.min(e.length,t.length),i=0;i<r;++i)n+=e[i]^t[i];return n}(e,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=e,this._cipher.scrub()},l.prototype.getAuthTag=function(){if(this._decrypt||!r.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag},l.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e},l.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length},e.exports=l})),o.register("l2DHC",(function(t,n){var r;e(t.exports,"AES",(()=>r),(e=>r=e));var i=o("2BZf1").Buffer;function a(e){i.isBuffer(e)||(e=i.from(e));for(var t=e.length/4|0,n=new Array(t),r=0;r<t;r++)n[r]=e.readUInt32BE(4*r);return n}function s(e){for(;0<e.length;e++)e[0]=0}function u(e,t,n,r,i){for(var o,a,s,u,c=n[0],l=n[1],f=n[2],h=n[3],d=e[0]^t[0],p=e[1]^t[1],m=e[2]^t[2],y=e[3]^t[3],g=4,b=1;b<i;b++)o=c[d>>>24]^l[p>>>16&255]^f[m>>>8&255]^h[255&y]^t[g++],a=c[p>>>24]^l[m>>>16&255]^f[y>>>8&255]^h[255&d]^t[g++],s=c[m>>>24]^l[y>>>16&255]^f[d>>>8&255]^h[255&p]^t[g++],u=c[y>>>24]^l[d>>>16&255]^f[p>>>8&255]^h[255&m]^t[g++],d=o,p=a,m=s,y=u;return o=(r[d>>>24]<<24|r[p>>>16&255]<<16|r[m>>>8&255]<<8|r[255&y])^t[g++],a=(r[p>>>24]<<24|r[m>>>16&255]<<16|r[y>>>8&255]<<8|r[255&d])^t[g++],s=(r[m>>>24]<<24|r[y>>>16&255]<<16|r[d>>>8&255]<<8|r[255&p])^t[g++],u=(r[y>>>24]<<24|r[d>>>16&255]<<16|r[p>>>8&255]<<8|r[255&m])^t[g++],[o>>>=0,a>>>=0,s>>>=0,u>>>=0]}var c=[0,1,2,4,8,16,32,64,128,27,54],l=function(){for(var e=new Array(256),t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;for(var n=[],r=[],i=[[],[],[],[]],o=[[],[],[],[]],a=0,s=0,u=0;u<256;++u){var c=s^s<<1^s<<2^s<<3^s<<4;c=c>>>8^255&c^99,n[a]=c,r[c]=a;var l=e[a],f=e[l],h=e[f],d=257*e[c]^16843008*c;i[0][a]=d<<24|d>>>8,i[1][a]=d<<16|d>>>16,i[2][a]=d<<8|d>>>24,i[3][a]=d,d=16843009*h^65537*f^257*l^16843008*a,o[0][c]=d<<24|d>>>8,o[1][c]=d<<16|d>>>16,o[2][c]=d<<8|d>>>24,o[3][c]=d,0===a?a=s=1:(a=l^e[e[e[h^l]]],s^=e[e[s]])}return{SBOX:n,INV_SBOX:r,SUB_MIX:i,INV_SUB_MIX:o}}();function f(e){this._key=a(e),this._reset()}f.blockSize=16,f.keySize=32,f.prototype.blockSize=f.blockSize,f.prototype.keySize=f.keySize,f.prototype._reset=function(){for(var e=this._key,t=e.length,n=t+6,r=4*(n+1),i=[],o=0;o<t;o++)i[o]=e[o];for(o=t;o<r;o++){var a=i[o-1];o%t==0?(a=a<<8|a>>>24,a=l.SBOX[a>>>24]<<24|l.SBOX[a>>>16&255]<<16|l.SBOX[a>>>8&255]<<8|l.SBOX[255&a],a^=c[o/t|0]<<24):t>6&&o%t==4&&(a=l.SBOX[a>>>24]<<24|l.SBOX[a>>>16&255]<<16|l.SBOX[a>>>8&255]<<8|l.SBOX[255&a]),i[o]=i[o-t]^a}for(var s=[],u=0;u<r;u++){var f=r-u,h=i[f-(u%4?0:4)];s[u]=u<4||f<=4?h:l.INV_SUB_MIX[0][l.SBOX[h>>>24]]^l.INV_SUB_MIX[1][l.SBOX[h>>>16&255]]^l.INV_SUB_MIX[2][l.SBOX[h>>>8&255]]^l.INV_SUB_MIX[3][l.SBOX[255&h]]}this._nRounds=n,this._keySchedule=i,this._invKeySchedule=s},f.prototype.encryptBlockRaw=function(e){return u(e=a(e),this._keySchedule,l.SUB_MIX,l.SBOX,this._nRounds)},f.prototype.encryptBlock=function(e){var t=this.encryptBlockRaw(e),n=i.allocUnsafe(16);return n.writeUInt32BE(t[0],0),n.writeUInt32BE(t[1],4),n.writeUInt32BE(t[2],8),n.writeUInt32BE(t[3],12),n},f.prototype.decryptBlock=function(e){var t=(e=a(e))[1];e[1]=e[3],e[3]=t;var n=u(e,this._invKeySchedule,l.INV_SUB_MIX,l.INV_SBOX,this._nRounds),r=i.allocUnsafe(16);return r.writeUInt32BE(n[0],0),r.writeUInt32BE(n[3],4),r.writeUInt32BE(n[2],8),r.writeUInt32BE(n[1],12),r},f.prototype.scrub=function(){s(this._keySchedule),s(this._invKeySchedule),s(this._key)},r=f})),o.register("j0FAo",(function(e,t){var n=o("2BZf1").Buffer,r=n.alloc(16,0);function i(e){var t=n.allocUnsafe(16);return t.writeUInt32BE(e[0]>>>0,0),t.writeUInt32BE(e[1]>>>0,4),t.writeUInt32BE(e[2]>>>0,8),t.writeUInt32BE(e[3]>>>0,12),t}function a(e){this.h=e,this.state=n.alloc(16,0),this.cache=n.allocUnsafe(0)}a.prototype.ghash=function(e){for(var t=-1;++t<e.length;)this.state[t]^=e[t];this._multiply()},a.prototype._multiply=function(){for(var e,t,n,r=[(e=this.h).readUInt32BE(0),e.readUInt32BE(4),e.readUInt32BE(8),e.readUInt32BE(12)],o=[0,0,0,0],a=-1;++a<128;){for(0!=(this.state[~~(a/8)]&1<<7-a%8)&&(o[0]^=r[0],o[1]^=r[1],o[2]^=r[2],o[3]^=r[3]),n=0!=(1&r[3]),t=3;t>0;t--)r[t]=r[t]>>>1|(1&r[t-1])<<31;r[0]=r[0]>>>1,n&&(r[0]=-520093696^r[0])}this.state=i(o)},a.prototype.update=function(e){var t;for(this.cache=n.concat([this.cache,e]);this.cache.length>=16;)t=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(t)},a.prototype.final=function(e,t){return this.cache.length&&this.ghash(n.concat([this.cache,r],16)),this.ghash(i([0,e,0,t])),this.state},e.exports=a})),o.register("78JqF",(function(e,t){var n=o("l2DHC"),r=o("2BZf1").Buffer,i=o("1vQsi");function a(e,t,o,a){i.call(this),this._cipher=new n.AES(t),this._prev=r.from(o),this._cache=r.allocUnsafe(0),this._secCache=r.allocUnsafe(0),this._decrypt=a,this._mode=e}o("9iXO2")(a,i),a.prototype._update=function(e){return this._mode.encrypt(this,e,this._decrypt)},a.prototype._final=function(){this._cipher.scrub()},e.exports=a})),o.register("jp7Eg",(function(e,t){var n=o("2BZf1").Buffer,r=o("eujcR");e.exports=function(e,t,i,o){if(n.isBuffer(e)||(e=n.from(e,"binary")),t&&(n.isBuffer(t)||(t=n.from(t,"binary")),8!==t.length))throw new RangeError("salt should be Buffer with 8 byte length");for(var a=i/8,s=n.alloc(a),u=n.alloc(o||0),c=n.alloc(0);a>0||o>0;){var l=new r;l.update(c),l.update(e),t&&l.update(t),c=l.digest();var f=0;if(a>0){var h=s.length-a;f=Math.min(a,c.length),c.copy(s,h,0,f),a-=f}if(f<c.length&&o>0){var d=u.length-o,p=Math.min(o,c.length-f);c.copy(u,d,f,f+p),o-=p}}return c.fill(0),{key:s,iv:u}}})),o.register("6vOp4",(function(t,n){var r,i;e(t.exports,"createDecipher",(()=>r),(e=>r=e)),e(t.exports,"createDecipheriv",(()=>i),(e=>i=e));var a=o("Z2aU1"),s=o("2BZf1").Buffer,u=o("9KJKg"),c=o("78JqF"),l=o("1vQsi"),f=o("l2DHC"),h=o("jp7Eg");function d(e,t,n){l.call(this),this._cache=new p,this._last=void 0,this._cipher=new f.AES(t),this._prev=s.from(n),this._mode=e,this._autopadding=!0}function p(){this.cache=s.allocUnsafe(0)}function m(e,t,n){var r=u[e.toLowerCase()];if(!r)throw new TypeError("invalid suite type");if("string"==typeof n&&(n=s.from(n)),"GCM"!==r.mode&&n.length!==r.iv)throw new TypeError("invalid iv length "+n.length);if("string"==typeof t&&(t=s.from(t)),t.length!==r.key/8)throw new TypeError("invalid key length "+t.length);return"stream"===r.type?new c(r.module,t,n,!0):"auth"===r.type?new a(r.module,t,n,!0):new d(r.module,t,n)}o("9iXO2")(d,l),d.prototype._update=function(e){var t,n;this._cache.add(e);for(var r=[];t=this._cache.get(this._autopadding);)n=this._mode.decrypt(this,t),r.push(n);return s.concat(r)},d.prototype._final=function(){var e=this._cache.flush();if(this._autopadding)return function(e){var t=e[15];if(t<1||t>16)throw new Error("unable to decrypt data");var n=-1;for(;++n<t;)if(e[n+(16-t)]!==t)throw new Error("unable to decrypt data");if(16===t)return;return e.slice(0,16-t)}(this._mode.decrypt(this,e));if(e)throw new Error("data not multiple of block length")},d.prototype.setAutoPadding=function(e){return this._autopadding=!!e,this},p.prototype.add=function(e){this.cache=s.concat([this.cache,e])},p.prototype.get=function(e){var t;if(e){if(this.cache.length>16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t}else if(this.cache.length>=16)return t=this.cache.slice(0,16),this.cache=this.cache.slice(16),t;return null},p.prototype.flush=function(){if(this.cache.length)return this.cache},r=function(e,t){var n=u[e.toLowerCase()];if(!n)throw new TypeError("invalid suite type");var r=h(t,!1,n.key,n.iv);return m(e,r.key,r.iv)},i=m})),o.register("2eKjK",(function(t,n){var r,i,o,a,s,u,c,l;e(t.exports,"des-ecb",(()=>r),(e=>r=e)),e(t.exports,"des-cbc",(()=>i),(e=>i=e)),e(t.exports,"des",(()=>o),(e=>o=e)),e(t.exports,"des-ede3-cbc",(()=>a),(e=>a=e)),e(t.exports,"des3",(()=>s),(e=>s=e)),e(t.exports,"des-ede3",(()=>u),(e=>u=e)),e(t.exports,"des-ede-cbc",(()=>c),(e=>c=e)),e(t.exports,"des-ede",(()=>l),(e=>l=e)),r={key:8,iv:0},i=o={key:8,iv:8},a=s={key:24,iv:8},u={key:24,iv:0},c={key:16,iv:8},l={key:16,iv:0}})),o.register("etCJs",(function(t,n){var r,i,a,s,u;e(t.exports,"DiffieHellmanGroup",(()=>r),(e=>r=e)),e(t.exports,"createDiffieHellmanGroup",(()=>i),(e=>i=e)),e(t.exports,"getDiffieHellman",(()=>a),(e=>a=e)),e(t.exports,"createDiffieHellman",(()=>s),(e=>s=e)),e(t.exports,"DiffieHellman",(()=>u),(e=>u=e));var c=o("150uq").Buffer,l=o("fnMUN"),f=o("aBhnz"),h=o("dP2A0");var d={binary:!0,hex:!0,base64:!0};r=i=a=function(e){var t=new c(f[e].prime,"hex"),n=new c(f[e].gen,"hex");return new h(t,n)},s=u=function e(t,n,r,i){return c.isBuffer(n)||void 0===d[n]?e(t,"binary",n,r):(n=n||"binary",i=i||"binary",r=r||new c([2]),c.isBuffer(r)||(r=new c(r,i)),"number"==typeof t?new h(l(t,r),r,!0):(c.isBuffer(t)||(t=new c(t,n)),new h(t,r,!0)))}})),o.register("fnMUN",(function(e,t){var n=o("9qUDb");e.exports=g,g.simpleSieve=m,g.fermatTest=y;var r=o("ks3fn"),i=new r(24),a=new(o("lqUNb")),s=new r(1),u=new r(2),c=new r(5),l=(new r(16),new r(8),new r(10)),f=new r(3),h=(new r(7),new r(11)),d=new r(4),p=(new r(12),null);function m(e){for(var t=function(){if(null!==p)return p;var e=[];e[0]=2;for(var t=1,n=3;n<1048576;n+=2){for(var r=Math.ceil(Math.sqrt(n)),i=0;i<t&&e[i]<=r&&n%e[i]!=0;i++);t!==i&&e[i]<=r||(e[t++]=n)}return p=e,e}(),n=0;n<t.length;n++)if(0===e.modn(t[n]))return 0===e.cmpn(t[n]);return!0}function y(e){var t=r.mont(e);return 0===u.toRed(t).redPow(e.subn(1)).fromRed().cmpn(1)}function g(e,t){if(e<16)return new r(2===t||5===t?[140,123]:[140,39]);var o,p;for(t=new r(t);;){for(o=new r(n(Math.ceil(e/8)));o.bitLength()>e;)o.ishrn(1);if(o.isEven()&&o.iadd(s),o.testn(1)||o.iadd(u),t.cmp(u)){if(!t.cmp(c))for(;o.mod(l).cmp(f);)o.iadd(d)}else for(;o.mod(i).cmp(h);)o.iadd(d);if(m(p=o.shrn(1))&&m(o)&&y(p)&&y(o)&&a.test(p)&&a.test(o))return o}}})),o.register("ks3fn",(function(e,t){!function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function i(e,t,n){if(i.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(n=t,t=10),this._init(e||0,t||10,n||"be"))}var a;"object"==typeof e?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;try{a="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:o("kOtop").Buffer}catch(e){}function s(e,t){var n=e.charCodeAt(t);return n>=65&&n<=70?n-55:n>=97&&n<=102?n-87:n-48&15}function u(e,t,n){var r=s(e,n);return n-1>=t&&(r|=s(e,n-1)<<4),r}function c(e,t,n,r){for(var i=0,o=Math.min(e.length,n),a=t;a<o;a++){var s=e.charCodeAt(a)-48;i*=r,i+=s>=49?s-49+10:s>=17?s-17+10:s}return i}i.isBN=function(e){return e instanceof i||null!==e&&"object"==typeof e&&e.constructor.wordSize===i.wordSize&&Array.isArray(e.words)},i.max=function(e,t){return e.cmp(t)>0?e:t},i.min=function(e,t){return e.cmp(t)<0?e:t},i.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},i.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},i.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,a,s=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)a=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)a=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);return this.strip()},i.prototype._parseHex=function(e,t,n){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var i,o=0,a=0;if("be"===n)for(r=e.length-1;r>=t;r-=2)i=u(e,t,r)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;else for(r=(e.length-t)%2==0?t+1:t;r<e.length;r+=2)i=u(e,t,r)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;this.strip()},i.prototype._parseBase=function(e,t,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=t)r++;r--,i=i/t|0;for(var o=e.length-n,a=o%r,s=Math.min(o,o-a)+n,u=0,l=n;l<s;l+=r)u=c(e,l,l+r,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==a){var f=1;for(u=c(e,l,e.length,t),l=0;l<a;l++)f*=t;this.imuln(f),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this.strip()},i.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},i.prototype.clone=function(){var e=new i(null);return this.copy(e),e},i.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},i.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],f=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],h=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function d(e,t,n){n.negative=t.negative^e.negative;var r=e.length+t.length|0;n.length=r,r=r-1|0;var i=0|e.words[0],o=0|t.words[0],a=i*o,s=67108863&a,u=a/67108864|0;n.words[0]=s;for(var c=1;c<r;c++){for(var l=u>>>26,f=67108863&u,h=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=h;d++){var p=c-d|0;l+=(a=(i=0|e.words[p])*(o=0|t.words[d])+f)/67108864|0,f=67108863&a}n.words[c]=0|f,u=0|l}return 0!==u?n.words[c]=0|u:n.length--,n.strip()}i.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,a=0;a<this.length;a++){var s=this.words[a],u=(16777215&(s<<i|o)).toString(16);r=0!==(o=s>>>24-i&16777215)||a!==this.length-1?l[6-u.length]+u+r:u+r,(i+=2)>=26&&(i-=26,a--)}for(0!==o&&(r=o.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=f[e],d=h[e];r="";var p=this.clone();for(p.negative=0;!p.isZero();){var m=p.modn(d).toString(e);r=(p=p.idivn(d)).isZero()?m+r:l[c-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(e,t){return n(void 0!==a),this.toArrayLike(a,e,t)},i.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},i.prototype.toArrayLike=function(e,t,r){var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var a,s,u="le"===t,c=new e(o),l=this.clone();if(u){for(s=0;!l.isZero();s++)a=l.andln(255),l.iushrn(8),c[s]=a;for(;s<o;s++)c[s]=0}else{for(s=0;s<o-i;s++)c[s]=0;for(s=0;!l.isZero();s++)a=l.andln(255),l.iushrn(8),c[o-s-1]=a}return c},Math.clz32?i.prototype._countBits=function(e){return 32-Math.clz32(e)}:i.prototype._countBits=function(e){var t=e,n=0;return t>=4096&&(n+=13,t>>>=13),t>=64&&(n+=7,t>>>=7),t>=8&&(n+=4,t>>>=4),t>=2&&(n+=2,t>>>=2),n+t},i.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,n=0;return 0==(8191&t)&&(n+=13,t>>>=13),0==(127&t)&&(n+=7,t>>>=7),0==(15&t)&&(n+=4,t>>>=4),0==(3&t)&&(n+=2,t>>>=2),0==(1&t)&&n++,n},i.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);if(e+=n,26!==n)break}return e},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},i.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return 0!==this.negative},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},i.prototype.ior=function(e){return n(0==(this.negative|e.negative)),this.iuor(e)},i.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},i.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},i.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]&e.words[n];return this.length=t.length,this.strip()},i.prototype.iand=function(e){return n(0==(this.negative|e.negative)),this.iuand(e)},i.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},i.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},i.prototype.iuxor=function(e){var t,n;this.length>e.length?(t=this,n=e):(t=e,n=this);for(var r=0;r<n.length;r++)this.words[r]=t.words[r]^n.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this.strip()},i.prototype.ixor=function(e){return n(0==(this.negative|e.negative)),this.iuxor(e)},i.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},i.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},i.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this.strip()},i.prototype.notn=function(e){return this.clone().inotn(e)},i.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this.strip()},i.prototype.iadd=function(e){var t,n,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(n=this,r=e):(n=e,r=this);for(var i=0,o=0;o<r.length;o++)t=(0|n.words[o])+(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<n.length;o++)t=(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this},i.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},i.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var n,r,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(n=this,r=e):(n=e,r=this);for(var o=0,a=0;a<r.length;a++)o=(t=(0|n.words[a])-(0|r.words[a])+o)>>26,this.words[a]=67108863&t;for(;0!==o&&a<n.length;a++)o=(t=(0|n.words[a])+o)>>26,this.words[a]=67108863&t;if(0===o&&a<n.length&&n!==this)for(;a<n.length;a++)this.words[a]=n.words[a];return this.length=Math.max(this.length,a),n!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(e){return this.clone().isub(e)};var p=function(e,t,n){var r,i,o,a=e.words,s=t.words,u=n.words,c=0,l=0|a[0],f=8191&l,h=l>>>13,d=0|a[1],p=8191&d,m=d>>>13,y=0|a[2],g=8191&y,b=y>>>13,v=0|a[3],w=8191&v,_=v>>>13,E=0|a[4],S=8191&E,x=E>>>13,T=0|a[5],M=8191&T,A=T>>>13,R=0|a[6],I=8191&R,P=R>>>13,N=0|a[7],O=8191&N,C=N>>>13,k=0|a[8],B=8191&k,D=k>>>13,j=0|a[9],L=8191&j,q=j>>>13,U=0|s[0],F=8191&U,K=U>>>13,V=0|s[1],z=8191&V,W=V>>>13,H=0|s[2],G=8191&H,Q=H>>>13,J=0|s[3],Z=8191&J,$=J>>>13,Y=0|s[4],X=8191&Y,ee=Y>>>13,te=0|s[5],ne=8191&te,re=te>>>13,ie=0|s[6],oe=8191&ie,ae=ie>>>13,se=0|s[7],ue=8191&se,ce=se>>>13,le=0|s[8],fe=8191&le,he=le>>>13,de=0|s[9],pe=8191&de,me=de>>>13;n.negative=e.negative^t.negative,n.length=19;var ye=(c+(r=Math.imul(f,F))|0)+((8191&(i=(i=Math.imul(f,K))+Math.imul(h,F)|0))<<13)|0;c=((o=Math.imul(h,K))+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(p,F),i=(i=Math.imul(p,K))+Math.imul(m,F)|0,o=Math.imul(m,K);var ge=(c+(r=r+Math.imul(f,z)|0)|0)+((8191&(i=(i=i+Math.imul(f,W)|0)+Math.imul(h,z)|0))<<13)|0;c=((o=o+Math.imul(h,W)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(g,F),i=(i=Math.imul(g,K))+Math.imul(b,F)|0,o=Math.imul(b,K),r=r+Math.imul(p,z)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,W)|0;var be=(c+(r=r+Math.imul(f,G)|0)|0)+((8191&(i=(i=i+Math.imul(f,Q)|0)+Math.imul(h,G)|0))<<13)|0;c=((o=o+Math.imul(h,Q)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(w,F),i=(i=Math.imul(w,K))+Math.imul(_,F)|0,o=Math.imul(_,K),r=r+Math.imul(g,z)|0,i=(i=i+Math.imul(g,W)|0)+Math.imul(b,z)|0,o=o+Math.imul(b,W)|0,r=r+Math.imul(p,G)|0,i=(i=i+Math.imul(p,Q)|0)+Math.imul(m,G)|0,o=o+Math.imul(m,Q)|0;var ve=(c+(r=r+Math.imul(f,Z)|0)|0)+((8191&(i=(i=i+Math.imul(f,$)|0)+Math.imul(h,Z)|0))<<13)|0;c=((o=o+Math.imul(h,$)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(S,F),i=(i=Math.imul(S,K))+Math.imul(x,F)|0,o=Math.imul(x,K),r=r+Math.imul(w,z)|0,i=(i=i+Math.imul(w,W)|0)+Math.imul(_,z)|0,o=o+Math.imul(_,W)|0,r=r+Math.imul(g,G)|0,i=(i=i+Math.imul(g,Q)|0)+Math.imul(b,G)|0,o=o+Math.imul(b,Q)|0,r=r+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,$)|0)+Math.imul(m,Z)|0,o=o+Math.imul(m,$)|0;var we=(c+(r=r+Math.imul(f,X)|0)|0)+((8191&(i=(i=i+Math.imul(f,ee)|0)+Math.imul(h,X)|0))<<13)|0;c=((o=o+Math.imul(h,ee)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(M,F),i=(i=Math.imul(M,K))+Math.imul(A,F)|0,o=Math.imul(A,K),r=r+Math.imul(S,z)|0,i=(i=i+Math.imul(S,W)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,W)|0,r=r+Math.imul(w,G)|0,i=(i=i+Math.imul(w,Q)|0)+Math.imul(_,G)|0,o=o+Math.imul(_,Q)|0,r=r+Math.imul(g,Z)|0,i=(i=i+Math.imul(g,$)|0)+Math.imul(b,Z)|0,o=o+Math.imul(b,$)|0,r=r+Math.imul(p,X)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,ee)|0;var _e=(c+(r=r+Math.imul(f,ne)|0)|0)+((8191&(i=(i=i+Math.imul(f,re)|0)+Math.imul(h,ne)|0))<<13)|0;c=((o=o+Math.imul(h,re)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(I,F),i=(i=Math.imul(I,K))+Math.imul(P,F)|0,o=Math.imul(P,K),r=r+Math.imul(M,z)|0,i=(i=i+Math.imul(M,W)|0)+Math.imul(A,z)|0,o=o+Math.imul(A,W)|0,r=r+Math.imul(S,G)|0,i=(i=i+Math.imul(S,Q)|0)+Math.imul(x,G)|0,o=o+Math.imul(x,Q)|0,r=r+Math.imul(w,Z)|0,i=(i=i+Math.imul(w,$)|0)+Math.imul(_,Z)|0,o=o+Math.imul(_,$)|0,r=r+Math.imul(g,X)|0,i=(i=i+Math.imul(g,ee)|0)+Math.imul(b,X)|0,o=o+Math.imul(b,ee)|0,r=r+Math.imul(p,ne)|0,i=(i=i+Math.imul(p,re)|0)+Math.imul(m,ne)|0,o=o+Math.imul(m,re)|0;var Ee=(c+(r=r+Math.imul(f,oe)|0)|0)+((8191&(i=(i=i+Math.imul(f,ae)|0)+Math.imul(h,oe)|0))<<13)|0;c=((o=o+Math.imul(h,ae)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(O,F),i=(i=Math.imul(O,K))+Math.imul(C,F)|0,o=Math.imul(C,K),r=r+Math.imul(I,z)|0,i=(i=i+Math.imul(I,W)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,W)|0,r=r+Math.imul(M,G)|0,i=(i=i+Math.imul(M,Q)|0)+Math.imul(A,G)|0,o=o+Math.imul(A,Q)|0,r=r+Math.imul(S,Z)|0,i=(i=i+Math.imul(S,$)|0)+Math.imul(x,Z)|0,o=o+Math.imul(x,$)|0,r=r+Math.imul(w,X)|0,i=(i=i+Math.imul(w,ee)|0)+Math.imul(_,X)|0,o=o+Math.imul(_,ee)|0,r=r+Math.imul(g,ne)|0,i=(i=i+Math.imul(g,re)|0)+Math.imul(b,ne)|0,o=o+Math.imul(b,re)|0,r=r+Math.imul(p,oe)|0,i=(i=i+Math.imul(p,ae)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,ae)|0;var Se=(c+(r=r+Math.imul(f,ue)|0)|0)+((8191&(i=(i=i+Math.imul(f,ce)|0)+Math.imul(h,ue)|0))<<13)|0;c=((o=o+Math.imul(h,ce)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(B,F),i=(i=Math.imul(B,K))+Math.imul(D,F)|0,o=Math.imul(D,K),r=r+Math.imul(O,z)|0,i=(i=i+Math.imul(O,W)|0)+Math.imul(C,z)|0,o=o+Math.imul(C,W)|0,r=r+Math.imul(I,G)|0,i=(i=i+Math.imul(I,Q)|0)+Math.imul(P,G)|0,o=o+Math.imul(P,Q)|0,r=r+Math.imul(M,Z)|0,i=(i=i+Math.imul(M,$)|0)+Math.imul(A,Z)|0,o=o+Math.imul(A,$)|0,r=r+Math.imul(S,X)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,ee)|0,r=r+Math.imul(w,ne)|0,i=(i=i+Math.imul(w,re)|0)+Math.imul(_,ne)|0,o=o+Math.imul(_,re)|0,r=r+Math.imul(g,oe)|0,i=(i=i+Math.imul(g,ae)|0)+Math.imul(b,oe)|0,o=o+Math.imul(b,ae)|0,r=r+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(m,ue)|0,o=o+Math.imul(m,ce)|0;var xe=(c+(r=r+Math.imul(f,fe)|0)|0)+((8191&(i=(i=i+Math.imul(f,he)|0)+Math.imul(h,fe)|0))<<13)|0;c=((o=o+Math.imul(h,he)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(L,F),i=(i=Math.imul(L,K))+Math.imul(q,F)|0,o=Math.imul(q,K),r=r+Math.imul(B,z)|0,i=(i=i+Math.imul(B,W)|0)+Math.imul(D,z)|0,o=o+Math.imul(D,W)|0,r=r+Math.imul(O,G)|0,i=(i=i+Math.imul(O,Q)|0)+Math.imul(C,G)|0,o=o+Math.imul(C,Q)|0,r=r+Math.imul(I,Z)|0,i=(i=i+Math.imul(I,$)|0)+Math.imul(P,Z)|0,o=o+Math.imul(P,$)|0,r=r+Math.imul(M,X)|0,i=(i=i+Math.imul(M,ee)|0)+Math.imul(A,X)|0,o=o+Math.imul(A,ee)|0,r=r+Math.imul(S,ne)|0,i=(i=i+Math.imul(S,re)|0)+Math.imul(x,ne)|0,o=o+Math.imul(x,re)|0,r=r+Math.imul(w,oe)|0,i=(i=i+Math.imul(w,ae)|0)+Math.imul(_,oe)|0,o=o+Math.imul(_,ae)|0,r=r+Math.imul(g,ue)|0,i=(i=i+Math.imul(g,ce)|0)+Math.imul(b,ue)|0,o=o+Math.imul(b,ce)|0,r=r+Math.imul(p,fe)|0,i=(i=i+Math.imul(p,he)|0)+Math.imul(m,fe)|0,o=o+Math.imul(m,he)|0;var Te=(c+(r=r+Math.imul(f,pe)|0)|0)+((8191&(i=(i=i+Math.imul(f,me)|0)+Math.imul(h,pe)|0))<<13)|0;c=((o=o+Math.imul(h,me)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(L,z),i=(i=Math.imul(L,W))+Math.imul(q,z)|0,o=Math.imul(q,W),r=r+Math.imul(B,G)|0,i=(i=i+Math.imul(B,Q)|0)+Math.imul(D,G)|0,o=o+Math.imul(D,Q)|0,r=r+Math.imul(O,Z)|0,i=(i=i+Math.imul(O,$)|0)+Math.imul(C,Z)|0,o=o+Math.imul(C,$)|0,r=r+Math.imul(I,X)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,ee)|0,r=r+Math.imul(M,ne)|0,i=(i=i+Math.imul(M,re)|0)+Math.imul(A,ne)|0,o=o+Math.imul(A,re)|0,r=r+Math.imul(S,oe)|0,i=(i=i+Math.imul(S,ae)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,ae)|0,r=r+Math.imul(w,ue)|0,i=(i=i+Math.imul(w,ce)|0)+Math.imul(_,ue)|0,o=o+Math.imul(_,ce)|0,r=r+Math.imul(g,fe)|0,i=(i=i+Math.imul(g,he)|0)+Math.imul(b,fe)|0,o=o+Math.imul(b,he)|0;var Me=(c+(r=r+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;c=((o=o+Math.imul(m,me)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(L,G),i=(i=Math.imul(L,Q))+Math.imul(q,G)|0,o=Math.imul(q,Q),r=r+Math.imul(B,Z)|0,i=(i=i+Math.imul(B,$)|0)+Math.imul(D,Z)|0,o=o+Math.imul(D,$)|0,r=r+Math.imul(O,X)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(C,X)|0,o=o+Math.imul(C,ee)|0,r=r+Math.imul(I,ne)|0,i=(i=i+Math.imul(I,re)|0)+Math.imul(P,ne)|0,o=o+Math.imul(P,re)|0,r=r+Math.imul(M,oe)|0,i=(i=i+Math.imul(M,ae)|0)+Math.imul(A,oe)|0,o=o+Math.imul(A,ae)|0,r=r+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(x,ue)|0,o=o+Math.imul(x,ce)|0,r=r+Math.imul(w,fe)|0,i=(i=i+Math.imul(w,he)|0)+Math.imul(_,fe)|0,o=o+Math.imul(_,he)|0;var Ae=(c+(r=r+Math.imul(g,pe)|0)|0)+((8191&(i=(i=i+Math.imul(g,me)|0)+Math.imul(b,pe)|0))<<13)|0;c=((o=o+Math.imul(b,me)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(L,Z),i=(i=Math.imul(L,$))+Math.imul(q,Z)|0,o=Math.imul(q,$),r=r+Math.imul(B,X)|0,i=(i=i+Math.imul(B,ee)|0)+Math.imul(D,X)|0,o=o+Math.imul(D,ee)|0,r=r+Math.imul(O,ne)|0,i=(i=i+Math.imul(O,re)|0)+Math.imul(C,ne)|0,o=o+Math.imul(C,re)|0,r=r+Math.imul(I,oe)|0,i=(i=i+Math.imul(I,ae)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,ae)|0,r=r+Math.imul(M,ue)|0,i=(i=i+Math.imul(M,ce)|0)+Math.imul(A,ue)|0,o=o+Math.imul(A,ce)|0,r=r+Math.imul(S,fe)|0,i=(i=i+Math.imul(S,he)|0)+Math.imul(x,fe)|0,o=o+Math.imul(x,he)|0;var Re=(c+(r=r+Math.imul(w,pe)|0)|0)+((8191&(i=(i=i+Math.imul(w,me)|0)+Math.imul(_,pe)|0))<<13)|0;c=((o=o+Math.imul(_,me)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(L,X),i=(i=Math.imul(L,ee))+Math.imul(q,X)|0,o=Math.imul(q,ee),r=r+Math.imul(B,ne)|0,i=(i=i+Math.imul(B,re)|0)+Math.imul(D,ne)|0,o=o+Math.imul(D,re)|0,r=r+Math.imul(O,oe)|0,i=(i=i+Math.imul(O,ae)|0)+Math.imul(C,oe)|0,o=o+Math.imul(C,ae)|0,r=r+Math.imul(I,ue)|0,i=(i=i+Math.imul(I,ce)|0)+Math.imul(P,ue)|0,o=o+Math.imul(P,ce)|0,r=r+Math.imul(M,fe)|0,i=(i=i+Math.imul(M,he)|0)+Math.imul(A,fe)|0,o=o+Math.imul(A,he)|0;var Ie=(c+(r=r+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,me)|0)+Math.imul(x,pe)|0))<<13)|0;c=((o=o+Math.imul(x,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(L,ne),i=(i=Math.imul(L,re))+Math.imul(q,ne)|0,o=Math.imul(q,re),r=r+Math.imul(B,oe)|0,i=(i=i+Math.imul(B,ae)|0)+Math.imul(D,oe)|0,o=o+Math.imul(D,ae)|0,r=r+Math.imul(O,ue)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(C,ue)|0,o=o+Math.imul(C,ce)|0,r=r+Math.imul(I,fe)|0,i=(i=i+Math.imul(I,he)|0)+Math.imul(P,fe)|0,o=o+Math.imul(P,he)|0;var Pe=(c+(r=r+Math.imul(M,pe)|0)|0)+((8191&(i=(i=i+Math.imul(M,me)|0)+Math.imul(A,pe)|0))<<13)|0;c=((o=o+Math.imul(A,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(L,oe),i=(i=Math.imul(L,ae))+Math.imul(q,oe)|0,o=Math.imul(q,ae),r=r+Math.imul(B,ue)|0,i=(i=i+Math.imul(B,ce)|0)+Math.imul(D,ue)|0,o=o+Math.imul(D,ce)|0,r=r+Math.imul(O,fe)|0,i=(i=i+Math.imul(O,he)|0)+Math.imul(C,fe)|0,o=o+Math.imul(C,he)|0;var Ne=(c+(r=r+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,me)|0)+Math.imul(P,pe)|0))<<13)|0;c=((o=o+Math.imul(P,me)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,r=Math.imul(L,ue),i=(i=Math.imul(L,ce))+Math.imul(q,ue)|0,o=Math.imul(q,ce),r=r+Math.imul(B,fe)|0,i=(i=i+Math.imul(B,he)|0)+Math.imul(D,fe)|0,o=o+Math.imul(D,he)|0;var Oe=(c+(r=r+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,me)|0)+Math.imul(C,pe)|0))<<13)|0;c=((o=o+Math.imul(C,me)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,r=Math.imul(L,fe),i=(i=Math.imul(L,he))+Math.imul(q,fe)|0,o=Math.imul(q,he);var Ce=(c+(r=r+Math.imul(B,pe)|0)|0)+((8191&(i=(i=i+Math.imul(B,me)|0)+Math.imul(D,pe)|0))<<13)|0;c=((o=o+Math.imul(D,me)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863;var ke=(c+(r=Math.imul(L,pe))|0)+((8191&(i=(i=Math.imul(L,me))+Math.imul(q,pe)|0))<<13)|0;return c=((o=Math.imul(q,me))+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,u[0]=ye,u[1]=ge,u[2]=be,u[3]=ve,u[4]=we,u[5]=_e,u[6]=Ee,u[7]=Se,u[8]=xe,u[9]=Te,u[10]=Me,u[11]=Ae,u[12]=Re,u[13]=Ie,u[14]=Pe,u[15]=Ne,u[16]=Oe,u[17]=Ce,u[18]=ke,0!==c&&(u[19]=c,n.length++),n};function m(e,t,n){return(new y).mulp(e,t,n)}function y(e,t){this.x=e,this.y=t}Math.imul||(p=d),i.prototype.mulTo=function(e,t){var n,r=this.length+e.length;return n=10===this.length&&10===e.length?p(this,e,t):r<63?d(this,e,t):r<1024?function(e,t,n){n.negative=t.negative^e.negative,n.length=e.length+t.length;for(var r=0,i=0,o=0;o<n.length-1;o++){var a=i;i=0;for(var s=67108863&r,u=Math.min(o,t.length-1),c=Math.max(0,o-e.length+1);c<=u;c++){var l=o-c,f=(0|e.words[l])*(0|t.words[c]),h=67108863&f;s=67108863&(h=h+s|0),i+=(a=(a=a+(f/67108864|0)|0)+(h>>>26)|0)>>>26,a&=67108863}n.words[o]=s,r=a,a=i}return 0!==r?n.words[o]=r:n.length--,n.strip()}(this,e,t):m(this,e,t),n},y.prototype.makeRBT=function(e){for(var t=new Array(e),n=i.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,n,e);return t},y.prototype.revBin=function(e,t,n){if(0===e||e===n-1)return e;for(var r=0,i=0;i<t;i++)r|=(1&e)<<t-i-1,e>>=1;return r},y.prototype.permute=function(e,t,n,r,i,o){for(var a=0;a<o;a++)r[a]=t[e[a]],i[a]=n[e[a]]},y.prototype.transform=function(e,t,n,r,i,o){this.permute(o,e,t,n,r,i);for(var a=1;a<i;a<<=1)for(var s=a<<1,u=Math.cos(2*Math.PI/s),c=Math.sin(2*Math.PI/s),l=0;l<i;l+=s)for(var f=u,h=c,d=0;d<a;d++){var p=n[l+d],m=r[l+d],y=n[l+d+a],g=r[l+d+a],b=f*y-h*g;g=f*g+h*y,y=b,n[l+d]=p+y,r[l+d]=m+g,n[l+d+a]=p-y,r[l+d+a]=m-g,d!==s&&(b=u*f-c*h,h=u*h+c*f,f=b)}},y.prototype.guessLen13b=function(e,t){var n=1|Math.max(t,e),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},y.prototype.conjugate=function(e,t,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=e[r];e[r]=e[n-r-1],e[n-r-1]=i,i=t[r],t[r]=-t[n-r-1],t[n-r-1]=-i}},y.prototype.normalize13b=function(e,t){for(var n=0,r=0;r<t/2;r++){var i=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+n;e[r]=67108863&i,n=i<67108864?0:i/67108864|0}return e},y.prototype.convert13b=function(e,t,r,i){for(var o=0,a=0;a<t;a++)o+=0|e[a],r[2*a]=8191&o,o>>>=13,r[2*a+1]=8191&o,o>>>=13;for(a=2*t;a<i;++a)r[a]=0;n(0===o),n(0==(-8192&o))},y.prototype.stub=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t},y.prototype.mulp=function(e,t,n){var r=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(r),o=this.stub(r),a=new Array(r),s=new Array(r),u=new Array(r),c=new Array(r),l=new Array(r),f=new Array(r),h=n.words;h.length=r,this.convert13b(e.words,e.length,a,r),this.convert13b(t.words,t.length,c,r),this.transform(a,o,s,u,r,i),this.transform(c,o,l,f,r,i);for(var d=0;d<r;d++){var p=s[d]*l[d]-u[d]*f[d];u[d]=s[d]*f[d]+u[d]*l[d],s[d]=p}return this.conjugate(s,u,r),this.transform(s,u,h,o,r,i),this.conjugate(h,o,r),this.normalize13b(h,r),n.negative=e.negative^t.negative,n.length=e.length+t.length,n.strip()},i.prototype.mul=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},i.prototype.mulf=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),m(this,e,t)},i.prototype.imul=function(e){return this.clone().mulTo(e,this)},i.prototype.imuln=function(e){n("number"==typeof e),n(e<67108864);for(var t=0,r=0;r<this.length;r++){var i=(0|this.words[r])*e,o=(67108863&i)+(67108863&t);t>>=26,t+=i/67108864|0,t+=o>>>26,this.words[r]=67108863&o}return 0!==t&&(this.words[r]=t,this.length++),this},i.prototype.muln=function(e){return this.clone().imuln(e)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),n=0;n<t.length;n++){var r=n/26|0,i=n%26;t[n]=(e.words[r]&1<<i)>>>i}return t}(e);if(0===t.length)return new i(1);for(var n=this,r=0;r<t.length&&0===t[r];r++,n=n.sqr());if(++r<t.length)for(var o=n.sqr();r<t.length;r++,o=o.sqr())0!==t[r]&&(n=n.mul(o));return n},i.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var a=0;for(t=0;t<this.length;t++){var s=this.words[t]&o,u=(0|this.words[t])-s<<r;this.words[t]=u|a,a=s>>>26-r}a&&(this.words[t]=a,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this.strip()},i.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},i.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,a=Math.min((e-o)/26,this.length),s=67108863^67108863>>>o<<o,u=r;if(i-=a,i=Math.max(0,i),u){for(var c=0;c<a;c++)u.words[c]=this.words[c];u.length=a}if(0===a);else if(this.length>a)for(this.length-=a,c=0;c<this.length;c++)this.words[c]=this.words[c+a];else this.words[0]=0,this.length=1;var l=0;for(c=this.length-1;c>=0&&(0!==l||c>=i);c--){var f=0|this.words[c];this.words[c]=l<<26-o|f>>>o,l=f&s}return u&&0!==l&&(u.words[u.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},i.prototype.shln=function(e){return this.clone().ishln(e)},i.prototype.ushln=function(e){return this.clone().iushln(e)},i.prototype.shrn=function(e){return this.clone().ishrn(e)},i.prototype.ushrn=function(e){return this.clone().iushrn(e)},i.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},i.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this.strip()},i.prototype.maskn=function(e){return this.clone().imaskn(e)},i.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},i.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},i.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},i.prototype.addn=function(e){return this.clone().iaddn(e)},i.prototype.subn=function(e){return this.clone().isubn(e)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(e,t,r){var i,o,a=e.length+r;this._expand(a);var s=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+s;var u=(0|e.words[i])*t;s=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)s=(o=(0|this.words[i+r])+s)>>26,this.words[i+r]=67108863&o;if(0===s)return this.strip();for(n(-1===s),s=0,i=0;i<this.length;i++)s=(o=-(0|this.words[i])+s)>>26,this.words[i]=67108863&o;return this.negative=1,this.strip()},i.prototype._wordDiv=function(e,t){var n=(this.length,e.length),r=this.clone(),o=e,a=0|o.words[o.length-1];0!==(n=26-this._countBits(a))&&(o=o.ushln(n),r.iushln(n),a=0|o.words[o.length-1]);var s,u=r.length-o.length;if("mod"!==t){(s=new i(null)).length=u+1,s.words=new Array(s.length);for(var c=0;c<s.length;c++)s.words[c]=0}var l=r.clone()._ishlnsubmul(o,1,u);0===l.negative&&(r=l,s&&(s.words[u]=1));for(var f=u-1;f>=0;f--){var h=67108864*(0|r.words[o.length+f])+(0|r.words[o.length+f-1]);for(h=Math.min(h/a|0,67108863),r._ishlnsubmul(o,h,f);0!==r.negative;)h--,r.negative=0,r._ishlnsubmul(o,1,f),r.isZero()||(r.negative^=1);s&&(s.words[f]=h)}return s&&s.strip(),r.strip(),"div"!==t&&0!==n&&r.iushrn(n),{div:s||null,mod:r}},i.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:0!==this.negative&&0===e.negative?(s=this.neg().divmod(e,t),"mod"!==t&&(o=s.div.neg()),"div"!==t&&(a=s.mod.neg(),r&&0!==a.negative&&a.iadd(e)),{div:o,mod:a}):0===this.negative&&0!==e.negative?(s=this.divmod(e.neg(),t),"mod"!==t&&(o=s.div.neg()),{div:o,mod:s.mod}):0!=(this.negative&e.negative)?(s=this.neg().divmod(e.neg(),t),"div"!==t&&(a=s.mod.neg(),r&&0!==a.negative&&a.isub(e)),{div:s.div,mod:a}):e.length>this.length||this.cmp(e)<0?{div:new i(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new i(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new i(this.modn(e.words[0]))}:this._wordDiv(e,t);var o,a,s},i.prototype.div=function(e){return this.divmod(e,"div",!1).div},i.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},i.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},i.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),i=e.andln(1),o=n.cmp(r);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},i.prototype.modn=function(e){n(e<=67108863);for(var t=67108864%e,r=0,i=this.length-1;i>=0;i--)r=(t*r+(0|this.words[i]))%e;return r},i.prototype.idivn=function(e){n(e<=67108863);for(var t=0,r=this.length-1;r>=0;r--){var i=(0|this.words[r])+67108864*t;this.words[r]=i/e|0,t=i%e}return this.strip()},i.prototype.divn=function(e){return this.clone().idivn(e)},i.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var o=new i(1),a=new i(0),s=new i(0),u=new i(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var l=r.clone(),f=t.clone();!t.isZero();){for(var h=0,d=1;0==(t.words[0]&d)&&h<26;++h,d<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(o.isOdd()||a.isOdd())&&(o.iadd(l),a.isub(f)),o.iushrn(1),a.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(s.isOdd()||u.isOdd())&&(s.iadd(l),u.isub(f)),s.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(s),a.isub(u)):(r.isub(t),s.isub(o),u.isub(a))}return{a:s,b:u,gcd:r.iushln(c)}},i.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var o,a=new i(1),s=new i(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,l=1;0==(t.words[0]&l)&&c<26;++c,l<<=1);if(c>0)for(t.iushrn(c);c-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);for(var f=0,h=1;0==(r.words[0]&h)&&f<26;++f,h<<=1);if(f>0)for(r.iushrn(f);f-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);t.cmp(r)>=0?(t.isub(r),a.isub(s)):(r.isub(t),s.isub(a))}return(o=0===t.cmpn(1)?a:s).cmpn(0)<0&&o.iadd(e),o},i.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),n=e.clone();t.negative=0,n.negative=0;for(var r=0;t.isEven()&&n.isEven();r++)t.iushrn(1),n.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=t.cmp(n);if(i<0){var o=t;t=n,n=o}else if(0===i||0===n.cmpn(1))break;t.isub(n)}return n.iushln(r)},i.prototype.invm=function(e){return this.egcd(e).a.umod(e)},i.prototype.isEven=function(){return 0==(1&this.words[0])},i.prototype.isOdd=function(){return 1==(1&this.words[0])},i.prototype.andln=function(e){return this.words[0]&e},i.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,a=r;0!==o&&a<this.length;a++){var s=0|this.words[a];o=(s+=o)>>>26,s&=67108863,this.words[a]=s}return 0!==o&&(this.words[a]=o,this.length++),this},i.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},i.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},i.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},i.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|e.words[n];if(r!==i){r<i?t=-1:r>i&&(t=1);break}}return t},i.prototype.gtn=function(e){return 1===this.cmpn(e)},i.prototype.gt=function(e){return 1===this.cmp(e)},i.prototype.gten=function(e){return this.cmpn(e)>=0},i.prototype.gte=function(e){return this.cmp(e)>=0},i.prototype.ltn=function(e){return-1===this.cmpn(e)},i.prototype.lt=function(e){return-1===this.cmp(e)},i.prototype.lten=function(e){return this.cmpn(e)<=0},i.prototype.lte=function(e){return this.cmp(e)<=0},i.prototype.eqn=function(e){return 0===this.cmpn(e)},i.prototype.eq=function(e){return 0===this.cmp(e)},i.red=function(e){return new S(e)},i.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},i.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(e){return this.red=e,this},i.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},i.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},i.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},i.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},i.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},i.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},i.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},i.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},i.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var g={k256:null,p224:null,p192:null,p25519:null};function b(e,t){this.name=e,this.p=new i(t,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function v(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function w(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function _(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function E(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function S(e){if("string"==typeof e){var t=i._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function x(e){S.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var e=new i(null);return e.words=new Array(Math.ceil(this.n/13)),e},b.prototype.ireduce=function(e){var t,n=e;do{this.split(n,this.tmp),t=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):void 0!==n.strip?n.strip():n._strip(),n},b.prototype.split=function(e,t){e.iushrn(this.n,0,t)},b.prototype.imulK=function(e){return e.imul(this.k)},r(v,b),v.prototype.split=function(e,t){for(var n=4194303,r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&n,i=10;i<e.length;i++){var a=0|e.words[i];e.words[i-10]=(a&n)<<4|o>>>22,o=a}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},v.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,n=0;n<e.length;n++){var r=0|e.words[n];t+=977*r,e.words[n]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(w,b),r(_,b),r(E,b),E.prototype.imulK=function(e){for(var t=0,n=0;n<e.length;n++){var r=19*(0|e.words[n])+t,i=67108863&r;r>>>=26,e.words[n]=i,t=r}return 0!==t&&(e.words[e.length++]=t),e},i._prime=function(e){if(g[e])return g[e];var t;if("k256"===e)t=new v;else if("p224"===e)t=new w;else if("p192"===e)t=new _;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new E}return g[e]=t,t},S.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},S.prototype._verify2=function(e,t){n(0==(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},S.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},S.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},S.prototype.add=function(e,t){this._verify2(e,t);var n=e.add(t);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},S.prototype.iadd=function(e,t){this._verify2(e,t);var n=e.iadd(t);return n.cmp(this.m)>=0&&n.isub(this.m),n},S.prototype.sub=function(e,t){this._verify2(e,t);var n=e.sub(t);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},S.prototype.isub=function(e,t){this._verify2(e,t);var n=e.isub(t);return n.cmpn(0)<0&&n.iadd(this.m),n},S.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},S.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},S.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},S.prototype.isqr=function(e){return this.imul(e,e.clone())},S.prototype.sqr=function(e){return this.mul(e,e)},S.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new i(1)).iushrn(2);return this.pow(e,r)}for(var o=this.m.subn(1),a=0;!o.isZero()&&0===o.andln(1);)a++,o.iushrn(1);n(!o.isZero());var s=new i(1).toRed(this),u=s.redNeg(),c=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new i(2*l*l).toRed(this);0!==this.pow(l,c).cmp(u);)l.redIAdd(u);for(var f=this.pow(l,o),h=this.pow(e,o.addn(1).iushrn(1)),d=this.pow(e,o),p=a;0!==d.cmp(s);){for(var m=d,y=0;0!==m.cmp(s);y++)m=m.redSqr();n(y<p);var g=this.pow(f,new i(1).iushln(p-y-1));h=h.redMul(g),f=g.redSqr(),d=d.redMul(f),p=y}return h},S.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},S.prototype.pow=function(e,t){if(t.isZero())return new i(1).toRed(this);if(0===t.cmpn(1))return e.clone();var n=new Array(16);n[0]=new i(1).toRed(this),n[1]=e;for(var r=2;r<n.length;r++)n[r]=this.mul(n[r-1],e);var o=n[0],a=0,s=0,u=t.bitLength()%26;for(0===u&&(u=26),r=t.length-1;r>=0;r--){for(var c=t.words[r],l=u-1;l>=0;l--){var f=c>>l&1;o!==n[0]&&(o=this.sqr(o)),0!==f||0!==a?(a<<=1,a|=f,(4===++s||0===r&&0===l)&&(o=this.mul(o,n[a]),s=0,a=0)):s=0}u=26}return o},S.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},S.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},i.mont=function(e){return new x(e)},r(x,S),x.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},x.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},x.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var n=e.imul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},x.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new i(0)._forceRed(this);var n=e.mul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=n.isub(r).iushrn(this.shift),a=o;return o.cmp(this.m)>=0?a=o.isub(this.m):o.cmpn(0)<0&&(a=o.iadd(this.m)),a._forceRed(this)},x.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)})),o.register("lqUNb",(function(e,t){var n=o("ks3fn"),r=o("15okD");function i(e){this.rand=e||new r.Rand}e.exports=i,i.create=function(e){return new i(e)},i.prototype._randbelow=function(e){var t=e.bitLength(),r=Math.ceil(t/8);do{var i=new n(this.rand.generate(r))}while(i.cmp(e)>=0);return i},i.prototype._randrange=function(e,t){var n=t.sub(e);return e.add(this._randbelow(n))},i.prototype.test=function(e,t,r){var i=e.bitLength(),o=n.mont(e),a=new n(1).toRed(o);t||(t=Math.max(1,i/48|0));for(var s=e.subn(1),u=0;!s.testn(u);u++);for(var c=e.shrn(u),l=s.toRed(o);t>0;t--){var f=this._randrange(new n(2),s);r&&r(f);var h=f.toRed(o).redPow(c);if(0!==h.cmp(a)&&0!==h.cmp(l)){for(var d=1;d<u;d++){if(0===(h=h.redSqr()).cmp(a))return!1;if(0===h.cmp(l))break}if(d===u)return!1}}return!0},i.prototype.getDivisor=function(e,t){var r=e.bitLength(),i=n.mont(e),o=new n(1).toRed(i);t||(t=Math.max(1,r/48|0));for(var a=e.subn(1),s=0;!a.testn(s);s++);for(var u=e.shrn(s),c=a.toRed(i);t>0;t--){var l=this._randrange(new n(2),a),f=e.gcd(l);if(0!==f.cmpn(1))return f;var h=l.toRed(i).redPow(u);if(0!==h.cmp(o)&&0!==h.cmp(c)){for(var d=1;d<s;d++){if(0===(h=h.redSqr()).cmp(o))return h.fromRed().subn(1).gcd(e);if(0===h.cmp(c))break}if(d===s)return(h=h.redSqr()).fromRed().subn(1).gcd(e)}}return!1}})),o.register("15okD",(function(e,t){var n;function r(e){this.rand=e}if(e.exports=function(e){return n||(n=new r(null)),n.generate(e)},e.exports.Rand=r,r.prototype.generate=function(e){return this._rand(e)},r.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),n=0;n<t.length;n++)t[n]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?r.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?r.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(r.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var i=o("kOtop");if("function"!=typeof i.randomBytes)throw new Error("Not supported");r.prototype._rand=function(e){return i.randomBytes(e)}}catch(e){}})),o.register("aBhnz",(function(e,t){e.exports=JSON.parse('{"modp1":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},"modp2":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},"modp5":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},"modp14":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},"modp15":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},"modp16":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},"modp17":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},"modp18":{"gen":"02","prime":"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}')})),o.register("dP2A0",(function(e,t){var n=o("150uq").Buffer,r=o("ks3fn"),i=new(o("lqUNb")),a=new r(24),s=new r(11),u=new r(10),c=new r(3),l=new r(7),f=o("fnMUN"),h=o("9qUDb");function d(e,t){return t=t||"utf8",n.isBuffer(e)||(e=new n(e,t)),this._pub=new r(e),this}function p(e,t){return t=t||"utf8",n.isBuffer(e)||(e=new n(e,t)),this._priv=new r(e),this}e.exports=y;var m={};function y(e,t,n){this.setGenerator(t),this.__prime=new r(e),this._prime=r.mont(this.__prime),this._primeLen=e.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,n?(this.setPublicKey=d,this.setPrivateKey=p):this._primeCode=8}function g(e,t){var r=new n(e.toArray());return t?r.toString(t):r}Object.defineProperty(y.prototype,"verifyError",{enumerable:!0,get:function(){return"number"!=typeof this._primeCode&&(this._primeCode=function(e,t){var n=t.toString("hex"),r=[n,e.toString(16)].join("_");if(r in m)return m[r];var o,h=0;if(e.isEven()||!f.simpleSieve||!f.fermatTest(e)||!i.test(e))return h+=1,h+="02"===n||"05"===n?8:4,m[r]=h,h;switch(i.test(e.shrn(1))||(h+=2),n){case"02":e.mod(a).cmp(s)&&(h+=8);break;case"05":(o=e.mod(u)).cmp(c)&&o.cmp(l)&&(h+=8);break;default:h+=4}return m[r]=h,h}(this.__prime,this.__gen)),this._primeCode}}),y.prototype.generateKeys=function(){return this._priv||(this._priv=new r(h(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()},y.prototype.computeSecret=function(e){var t=(e=(e=new r(e)).toRed(this._prime)).redPow(this._priv).fromRed(),i=new n(t.toArray()),o=this.getPrime();if(i.length<o.length){var a=new n(o.length-i.length);a.fill(0),i=n.concat([a,i])}return i},y.prototype.getPublicKey=function(e){return g(this._pub,e)},y.prototype.getPrivateKey=function(e){return g(this._priv,e)},y.prototype.getPrime=function(e){return g(this.__prime,e)},y.prototype.getGenerator=function(e){return g(this._gen,e)},y.prototype.setGenerator=function(e,t){return t=t||"utf8",n.isBuffer(e)||(e=new n(e,t)),this.__gen=e,this._gen=new r(e),this}})),o.register("ds9r6",(function(e,t){var n=o("2BZf1").Buffer,r=o("akhbg"),i=o("jSAH4"),a=o("9iXO2"),s=o("24DHw"),u=o("7XJvb"),c=o("f05N3");function l(e){i.Writable.call(this);var t=c[e];if(!t)throw new Error("Unknown message digest");this._hashType=t.hash,this._hash=r(t.hash),this._tag=t.id,this._signType=t.sign}function f(e){i.Writable.call(this);var t=c[e];if(!t)throw new Error("Unknown message digest");this._hash=r(t.hash),this._tag=t.id,this._signType=t.sign}function h(e){return new l(e)}function d(e){return new f(e)}Object.keys(c).forEach((function(e){c[e].id=n.from(c[e].id,"hex"),c[e.toLowerCase()]=c[e]})),a(l,i.Writable),l.prototype._write=function(e,t,n){this._hash.update(e),n()},l.prototype.update=function(e,t){return"string"==typeof e&&(e=n.from(e,t)),this._hash.update(e),this},l.prototype.sign=function(e,t){this.end();var n=this._hash.digest(),r=s(n,e,this._hashType,this._signType,this._tag);return t?r.toString(t):r},a(f,i.Writable),f.prototype._write=function(e,t,n){this._hash.update(e),n()},f.prototype.update=function(e,t){return"string"==typeof e&&(e=n.from(e,t)),this._hash.update(e),this},f.prototype.verify=function(e,t,r){"string"==typeof t&&(t=n.from(t,r)),this.end();var i=this._hash.digest();return u(t,i,e,this._signType,this._tag)},e.exports={Sign:h,Verify:d,createSign:h,createVerify:d}})),o.register("jSAH4",(function(e,t){(t=e.exports=o("YjAOO")).Stream=t,t.Readable=t,t.Writable=o("iITcC"),t.Duplex=o("jefgd"),t.Transform=o("f1dTX"),t.PassThrough=o("cJanu"),t.finished=o("iXnF4"),t.pipeline=o("hVHGL")})),o.register("YjAOO",(function(e,n){var r,i=o("iThRa");e.exports=M,M.ReadableState=T;o("cC4OV").EventEmitter;var a=function(e,t){return e.listeners(t).length},s=o("19rIo"),u=o("150uq").Buffer,c=t.Uint8Array||function(){};var l,f=o("kOtop");l=f&&f.debuglog?f.debuglog("stream"):function(){};var h,d,p,m=o("honn0"),y=o("3GJD7"),g=o("8mkBq").getHighWaterMark,b=o("SS0F1").codes,v=b.ERR_INVALID_ARG_TYPE,w=b.ERR_STREAM_PUSH_AFTER_EOF,_=b.ERR_METHOD_NOT_IMPLEMENTED,E=b.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;o("9iXO2")(M,s);var S=y.errorOrDestroy,x=["error","close","destroy","pause","resume"];function T(e,t,n){r=r||o("jefgd"),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",n),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=o("1qOpt").StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function M(e){if(r=r||o("jefgd"),!(this instanceof M))return new M(e);var t=this instanceof r;this._readableState=new T(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function A(e,t,n,r,i){l("readableAddChunk",t);var o,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?N(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,O(e)))}(e,a);else if(i||(o=function(e,t){var n;r=t,u.isBuffer(r)||r instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new v("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(a,t)),o)S(e,o);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),r)a.endEmitted?S(e,new E):R(e,a,t,!0);else if(a.ended)S(e,new w);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?R(e,a,t,!1):C(e,a)):R(e,a,t,!1)}else r||(a.reading=!1,C(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function R(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&N(e)),C(e,t)}Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),M.prototype.destroy=y.destroy,M.prototype._undestroy=y.undestroy,M.prototype._destroy=function(e,t){t(e)},M.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=u.from(e,t),t=""),n=!0),A(this,e,t,!1,n)},M.prototype.unshift=function(e){return A(this,e,null,!0,!1)},M.prototype.isPaused=function(){return!1===this._readableState.flowing},M.prototype.setEncoding=function(e){h||(h=o("1qOpt").StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,r="";null!==n;)r+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var I=1073741824;function P(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=I?e=I:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function N(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(O,e))}function O(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,L(e)}function C(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(k,e,t))}function k(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(l("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function B(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function D(e){l("readable nexttick read 0"),e.read(0)}function j(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),L(e),t.flowing&&!t.reading&&e.read(0)}function L(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function q(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function U(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(F,t,e))}function F(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function K(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}M.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?U(this):N(this),null;if(0===(e=P(e,t))&&t.ended)return 0===t.length&&U(this),null;var r,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=P(n,t))),null===(r=e>0?q(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&U(this)),null!==r&&this.emit("data",r),r},M.prototype._read=function(e){S(this,new _("_read()"))},M.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,l("pipe count=%d opts=%j",r.pipesCount,t);var o=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?u:y;function s(t,i){l("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),n.removeListener("end",u),n.removeListener("end",y),n.removeListener("data",h),f=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}r.endEmitted?i.nextTick(o):n.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,L(e))}}(n);e.on("drain",c);var f=!1;function h(t){l("ondata");var i=e.write(t);l("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==K(r.pipes,e))&&!f&&(l("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function d(t){l("onerror",t),y(),e.removeListener("error",d),0===a(e,"error")&&S(e,t)}function p(){e.removeListener("finish",m),y()}function m(){l("onfinish"),e.removeListener("close",p),y()}function y(){l("unpipe"),n.unpipe(e)}return n.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",d),e.once("close",p),e.once("finish",m),e.emit("pipe",n),r.flowing||(l("pipe resume"),n.resume()),e},M.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=K(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},M.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,l("on readable",r.length,r.reading),r.length?N(this):r.reading||i.nextTick(D,this))),n},M.prototype.addListener=M.prototype.on,M.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(B,this),n},M.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(B,this),t},M.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(j,e,t))}(this,e)),e.paused=!1,this},M.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},M.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<x.length;o++)e.on(x[o],this.emit.bind(this,x[o]));return this._read=function(t){l("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(M.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=o("4Uv6k")),d(this)}),Object.defineProperty(M.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(M.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(M.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),M._fromList=q,Object.defineProperty(M.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(M.from=function(e,t){return void 0===p&&(p=o("ks3bi")),p(M,e,t)})})),o.register("19rIo",(function(e,t){e.exports=o("cC4OV").EventEmitter})),o.register("honn0",(function(e,t){function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=o("150uq").Buffer,s=o("kOtop").inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,o,c;return t=e,o=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,n,r,i=a.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,n=i,r=s,a.prototype.copy.call(t,n,r),s+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],o&&i(t.prototype,o),c&&i(t,c),e}()})),o.register("3GJD7",(function(e,t){var n=o("iThRa");function r(e,t){a(e,t),i(e)}function i(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function a(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(a,this,e)):n.nextTick(a,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?o._writableState?o._writableState.errorEmitted?n.nextTick(i,o):(o._writableState.errorEmitted=!0,n.nextTick(r,o,e)):n.nextTick(r,o,e):t?(n.nextTick(i,o),t(e)):n.nextTick(i,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}})),o.register("8mkBq",(function(e,t){var n=o("SS0F1").codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,r);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new n(i?r:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}})),o.register("SS0F1",(function(t,n){var r;e(t.exports,"codes",(()=>r),(e=>r=e));var i={};function o(e,t,n){n||(n=Error);var r=function(e){var n,r;function i(n,r,i){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,i))||this}return r=e,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,i}(n);r.prototype.name=n.name,r.prototype.code=e,i[e]=r}function a(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}o("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(e,t,n){var r,i,o,s;if("string"==typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))s="The ".concat(e," ").concat(r," ").concat(a(t,"type"));else{var u=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(r," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof n)}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),r=i})),o.register("jefgd",(function(e,t){var n=o("iThRa"),r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=l;var i=o("YjAOO"),a=o("iITcC");o("9iXO2")(l,i);for(var s=r(a.prototype),u=0;u<s.length;u++){var c=s[u];l.prototype[c]||(l.prototype[c]=a.prototype[c])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",f)))}function f(){this._writableState.ended||n.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})})),o.register("iITcC",(function(e,n){var r,i=o("iThRa");function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=M,M.WritableState=T;var s={deprecate:o("gfowu")},u=o("19rIo"),c=o("150uq").Buffer,l=t.Uint8Array||function(){};var f,h=o("3GJD7"),d=o("8mkBq").getHighWaterMark,p=o("SS0F1").codes,m=p.ERR_INVALID_ARG_TYPE,y=p.ERR_METHOD_NOT_IMPLEMENTED,g=p.ERR_MULTIPLE_CALLBACK,b=p.ERR_STREAM_CANNOT_PIPE,v=p.ERR_STREAM_DESTROYED,w=p.ERR_STREAM_NULL_VALUES,_=p.ERR_STREAM_WRITE_AFTER_END,E=p.ERR_UNKNOWN_ENCODING,S=h.errorOrDestroy;function x(){}function T(e,t,n){r=r||o("jefgd"),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",n),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if("function"!=typeof o)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?(i.nextTick(o,r),i.nextTick(O,e,t),e._writableState.errorEmitted=!0,S(e,r)):(o(r),e._writableState.errorEmitted=!0,S(e,r),O(e,t))}(e,n,r,t,o);else{var a=P(n)||e.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||I(e,n),r?i.nextTick(R,e,n,a,o):R(e,n,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function M(e){var t=this instanceof(r=r||o("jefgd"));if(!t&&!f.call(M,this))return new M(e);this._writableState=new T(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),u.call(this)}function A(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function R(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),O(e,t)}function I(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,A(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,f=n.callback;if(A(e,t,!1,t.objectMode?1:c.length,c,l,f),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function P(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function N(e,t){e._final((function(n){t.pendingcb--,n&&S(e,n),t.prefinished=!0,e.emit("prefinish"),O(e,t)}))}function O(e,t){var n=P(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(N,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}o("9iXO2")(M,u),T.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(T.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(M,Symbol.hasInstance,{value:function(e){return!!f.call(this,e)||this===M&&(e&&e._writableState instanceof T)}})):f=function(e){return e instanceof this},M.prototype.pipe=function(){S(this,new b)},M.prototype.write=function(e,t,n){var r,o=this._writableState,a=!1,s=!o.objectMode&&(r=e,c.isBuffer(r)||r instanceof l);return s&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=x),o.ending?function(e,t){var n=new _;S(e,n),i.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var o;return null===n?o=new w:"string"==typeof n||t.objectMode||(o=new m("chunk",["string","Buffer"],n)),!o||(S(e,o),i.nextTick(r,o),!1)}(this,o,e,n))&&(o.pendingcb++,a=function(e,t,n,r,i,o){if(!n){var a=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n));return t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else A(e,t,!1,s,r,i,o);return u}(this,o,s,e,t,n)),a},M.prototype.cork=function(){this._writableState.corked++},M.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||I(this,e))},M.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new E(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(M.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(M.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),M.prototype._write=function(e,t,n){n(new y("_write()"))},M.prototype._writev=null,M.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,O(e,t),n&&(t.finished?i.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(M.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(M.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),M.prototype.destroy=h.destroy,M.prototype._undestroy=h.undestroy,M.prototype._destroy=function(e,t){t(e)}})),o.register("4Uv6k",(function(e,t){var n,r=o("iThRa");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=o("iXnF4"),s=Symbol("lastResolve"),u=Symbol("lastReject"),c=Symbol("error"),l=Symbol("ended"),f=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function p(e,t){return{value:e,done:t}}function m(e){var t=e[s];if(null!==t){var n=e[d].read();null!==n&&(e[f]=null,e[s]=null,e[u]=null,t(p(n,!1)))}}function y(e){r.nextTick(m,e)}var g=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((i(n={get stream(){return this[d]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[c]?n(e[c]):t(p(void 0,!0))}))}));var n,i=this[f];if(i)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[l]?n(p(void 0,!0)):t[h](n,r)}),r)}}(i,this));else{var o=this[d].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[h])}return this[f]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,n){e[d].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),n),g);e.exports=function(e){var t,n=Object.create(b,(i(t={},d,{value:e,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,c,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var r=n[d].read();r?(n[f]=null,n[s]=null,n[u]=null,e(p(r,!1))):(n[s]=e,n[u]=t)},writable:!0}),t));return n[f]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[u];return null!==t&&(n[f]=null,n[s]=null,n[u]=null,t(e)),void(n[c]=e)}var r=n[s];null!==r&&(n[f]=null,n[s]=null,n[u]=null,r(p(void 0,!0))),n[l]=!0})),e.on("readable",y.bind(null,n)),n}})),o.register("iXnF4",(function(e,t){var n=o("SS0F1").codes.ERR_STREAM_PREMATURE_CLOSE;function r(){}e.exports=function e(t,i,o){if("function"==typeof i)return e(t,null,i);i||(i={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||r);var a=i.readable||!1!==i.readable&&t.readable,s=i.writable||!1!==i.writable&&t.writable,u=function(){t.writable||l()},c=t._writableState&&t._writableState.finished,l=function(){s=!1,c=!0,a||o.call(t)},f=t._readableState&&t._readableState.endEmitted,h=function(){a=!1,f=!0,s||o.call(t)},d=function(e){o.call(t,e)},p=function(){var e;return a&&!f?(t._readableState&&t._readableState.ended||(e=new n),o.call(t,e)):s&&!c?(t._writableState&&t._writableState.ended||(e=new n),o.call(t,e)):void 0},m=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",l),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",h),t.on("finish",l),!1!==i.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",l),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("end",h),t.removeListener("error",d),t.removeListener("close",p)}}})),o.register("ks3bi",(function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}})),o.register("f1dTX",(function(e,t){e.exports=l;var n=o("SS0F1").codes,r=n.ERR_METHOD_NOT_IMPLEMENTED,i=n.ERR_MULTIPLE_CALLBACK,a=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=o("jefgd");function c(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new i);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);u.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f)}function f(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new s;if(e._transformState.transforming)throw new a;return e.push(null)}o("9iXO2")(l,u),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new r("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}})),o.register("cJanu",(function(e,t){e.exports=r;var n=o("f1dTX");function r(e){if(!(this instanceof r))return new r(e);n.call(this,e)}o("9iXO2")(r,n),r.prototype._transform=function(e,t,n){n(null,e)}})),o.register("hVHGL",(function(e,t){var n;var r=o("SS0F1").codes,i=r.ERR_MISSING_ARGS,a=r.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,r,i){i=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(i);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=o("iXnF4")),n(e,{readable:t,writable:r},(function(e){if(e)return i(e);s=!0,i()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void i(t||new a("pipe"))}}function c(e){e()}function l(e,t){return e.pipe(t)}function f(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o=f(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new i("streams");var a=t.map((function(e,n){var i=n<t.length-1;return u(e,i,n>0,(function(e){r||(r=e),e&&a.forEach(c),i||(a.forEach(c),o(r))}))}));return t.reduce(l)}})),o.register("24DHw",(function(e,t){var n=o("2BZf1").Buffer,r=o("9CK9X"),i=o("cfdDN"),a=o("as8Ac").ec,s=o("1kdEK"),u=o("gQsHl"),c=o("2qXhr");function l(e,t,i,o){if((e=n.from(e.toArray())).length<t.byteLength()){var a=n.alloc(t.byteLength()-e.length);e=n.concat([a,e])}var s=i.length,u=function(e,t){e=(e=f(e,t)).mod(t);var r=n.from(e.toArray());if(r.length<t.byteLength()){var i=n.alloc(t.byteLength()-r.length);r=n.concat([i,r])}return r}(i,t),c=n.alloc(s);c.fill(1);var l=n.alloc(s);return l=r(o,l).update(c).update(n.from([0])).update(e).update(u).digest(),c=r(o,l).update(c).digest(),{k:l=r(o,l).update(c).update(n.from([1])).update(e).update(u).digest(),v:c=r(o,l).update(c).digest()}}function f(e,t){var n=new s(e),r=(e.length<<3)-t.bitLength();return r>0&&n.ishrn(r),n}function h(e,t,i){var o,a;do{for(o=n.alloc(0);8*o.length<e.bitLength();)t.v=r(i,t.k).update(t.v).digest(),o=n.concat([o,t.v]);a=f(o,e),t.k=r(i,t.k).update(t.v).update(n.from([0])).digest(),t.v=r(i,t.k).update(t.v).digest()}while(-1!==a.cmp(e));return a}function d(e,t,n,r){return e.toRed(s.mont(n)).redPow(t).fromRed().mod(r)}e.exports=function(e,t,r,o,p){var m=u(t);if(m.curve){if("ecdsa"!==o&&"ecdsa/rsa"!==o)throw new Error("wrong private key type");return function(e,t){var r=c[t.curve.join(".")];if(!r)throw new Error("unknown curve "+t.curve.join("."));var i=new a(r).keyFromPrivate(t.privateKey).sign(e);return n.from(i.toDER())}(e,m)}if("dsa"===m.type){if("dsa"!==o)throw new Error("wrong private key type");return function(e,t,r){var i,o=t.params.priv_key,a=t.params.p,u=t.params.q,c=t.params.g,p=new s(0),m=f(e,u).mod(u),y=!1,g=l(o,u,e,r);for(;!1===y;)p=d(c,i=h(u,g,r),a,u),0===(y=i.invm(u).imul(m.add(o.mul(p))).mod(u)).cmpn(0)&&(y=!1,p=new s(0));return function(e,t){e=e.toArray(),t=t.toArray(),128&e[0]&&(e=[0].concat(e));128&t[0]&&(t=[0].concat(t));var r=[48,e.length+t.length+4,2,e.length];return r=r.concat(e,[2,t.length],t),n.from(r)}(p,y)}(e,m,r)}if("rsa"!==o&&"ecdsa/rsa"!==o)throw new Error("wrong private key type");e=n.concat([p,e]);for(var y=m.modulus.byteLength(),g=[0,1];e.length+g.length+1<y;)g.push(255);g.push(0);for(var b=-1;++b<e.length;)g.push(e[b]);return i(g,m)},e.exports.getKey=l,e.exports.makeKey=h})),o.register("cfdDN",(function(e,t){var n=o("150uq").Buffer,r=o("7MUmO"),i=o("9qUDb");function a(e){var t,n=e.modulus.byteLength();do{t=new r(i(n))}while(t.cmp(e.modulus)>=0||!t.umod(e.prime1)||!t.umod(e.prime2));return t}function s(e,t){var i=function(e){var t=a(e);return{blinder:t.toRed(r.mont(e.modulus)).redPow(new r(e.publicExponent)).fromRed(),unblinder:t.invm(e.modulus)}}(t),o=t.modulus.byteLength(),s=new r(e).mul(i.blinder).umod(t.modulus),u=s.toRed(r.mont(t.prime1)),c=s.toRed(r.mont(t.prime2)),l=t.coefficient,f=t.prime1,h=t.prime2,d=u.redPow(t.exponent1).fromRed(),p=c.redPow(t.exponent2).fromRed(),m=d.isub(p).imul(l).umod(f).imul(h);return p.iadd(m).imul(i.unblinder).umod(t.modulus).toArrayLike(n,"be",o)}s.getr=a,e.exports=s})),o.register("7MUmO",(function(e,t){!function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function i(e,t,n){if(i.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(n=t,t=10),this._init(e||0,t||10,n||"be"))}var a;"object"==typeof e?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;try{a="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:o("kOtop").Buffer}catch(e){}function s(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function u(e,t,n){var r=s(e,n);return n-1>=t&&(r|=s(e,n-1)<<4),r}function c(e,t,r,i){for(var o=0,a=0,s=Math.min(e.length,r),u=t;u<s;u++){var c=e.charCodeAt(u)-48;o*=i,a=c>=49?c-49+10:c>=17?c-17+10:c,n(c>=0&&a<i,"Invalid character"),o+=a}return o}function l(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(i.isBN=function(e){return e instanceof i||null!==e&&"object"==typeof e&&e.constructor.wordSize===i.wordSize&&Array.isArray(e.words)},i.max=function(e,t){return e.cmp(t)>0?e:t},i.min=function(e,t){return e.cmp(t)<0?e:t},i.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},i.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},i.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,a,s=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)a=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)a=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);return this._strip()},i.prototype._parseHex=function(e,t,n){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var i,o=0,a=0;if("be"===n)for(r=e.length-1;r>=t;r-=2)i=u(e,t,r)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;else for(r=(e.length-t)%2==0?t+1:t;r<e.length;r+=2)i=u(e,t,r)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;this._strip()},i.prototype._parseBase=function(e,t,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=t)r++;r--,i=i/t|0;for(var o=e.length-n,a=o%r,s=Math.min(o,o-a)+n,u=0,l=n;l<s;l+=r)u=c(e,l,l+r,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==a){var f=1;for(u=c(e,l,e.length,t),l=0;l<a;l++)f*=t;this.imuln(f),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this._strip()},i.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},i.prototype._move=function(e){l(e,this)},i.prototype.clone=function(){var e=new i(null);return this.copy(e),e},i.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},i.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=f}catch(e){i.prototype.inspect=f}else i.prototype.inspect=f;function f(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,a=0;a<this.length;a++){var s=this.words[a],u=(16777215&(s<<i|o)).toString(16);r=0!==(o=s>>>24-i&16777215)||a!==this.length-1?h[6-u.length]+u+r:u+r,(i+=2)>=26&&(i-=26,a--)}for(0!==o&&(r=o.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=d[e],l=p[e];r="";var f=this.clone();for(f.negative=0;!f.isZero();){var m=f.modrn(l).toString(e);r=(f=f.idivn(l)).isZero()?m+r:h[c-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},i.prototype.toJSON=function(){return this.toString(16,2)},a&&(i.prototype.toBuffer=function(e,t){return this.toArrayLike(a,e,t)}),i.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function m(e,t,n){n.negative=t.negative^e.negative;var r=e.length+t.length|0;n.length=r,r=r-1|0;var i=0|e.words[0],o=0|t.words[0],a=i*o,s=67108863&a,u=a/67108864|0;n.words[0]=s;for(var c=1;c<r;c++){for(var l=u>>>26,f=67108863&u,h=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=h;d++){var p=c-d|0;l+=(a=(i=0|e.words[p])*(o=0|t.words[d])+f)/67108864|0,f=67108863&a}n.words[c]=0|f,u=0|l}return 0!==u?n.words[c]=0|u:n.length--,n._strip()}i.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0");var a=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,o);return this["_toArrayLike"+("le"===t?"LE":"BE")](a,i),a},i.prototype._toArrayLikeLE=function(e,t){for(var n=0,r=0,i=0,o=0;i<this.length;i++){var a=this.words[i]<<o|r;e[n++]=255&a,n<e.length&&(e[n++]=a>>8&255),n<e.length&&(e[n++]=a>>16&255),6===o?(n<e.length&&(e[n++]=a>>24&255),r=0,o=0):(r=a>>>24,o+=2)}if(n<e.length)for(e[n++]=r;n<e.length;)e[n++]=0},i.prototype._toArrayLikeBE=function(e,t){for(var n=e.length-1,r=0,i=0,o=0;i<this.length;i++){var a=this.words[i]<<o|r;e[n--]=255&a,n>=0&&(e[n--]=a>>8&255),n>=0&&(e[n--]=a>>16&255),6===o?(n>=0&&(e[n--]=a>>24&255),r=0,o=0):(r=a>>>24,o+=2)}if(n>=0)for(e[n--]=r;n>=0;)e[n--]=0},Math.clz32?i.prototype._countBits=function(e){return 32-Math.clz32(e)}:i.prototype._countBits=function(e){var t=e,n=0;return t>=4096&&(n+=13,t>>>=13),t>=64&&(n+=7,t>>>=7),t>=8&&(n+=4,t>>>=4),t>=2&&(n+=2,t>>>=2),n+t},i.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,n=0;return 0==(8191&t)&&(n+=13,t>>>=13),0==(127&t)&&(n+=7,t>>>=7),0==(15&t)&&(n+=4,t>>>=4),0==(3&t)&&(n+=2,t>>>=2),0==(1&t)&&n++,n},i.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);if(e+=n,26!==n)break}return e},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},i.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return 0!==this.negative},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},i.prototype.ior=function(e){return n(0==(this.negative|e.negative)),this.iuor(e)},i.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},i.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},i.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]&e.words[n];return this.length=t.length,this._strip()},i.prototype.iand=function(e){return n(0==(this.negative|e.negative)),this.iuand(e)},i.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},i.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},i.prototype.iuxor=function(e){var t,n;this.length>e.length?(t=this,n=e):(t=e,n=this);for(var r=0;r<n.length;r++)this.words[r]=t.words[r]^n.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this._strip()},i.prototype.ixor=function(e){return n(0==(this.negative|e.negative)),this.iuxor(e)},i.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},i.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},i.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},i.prototype.notn=function(e){return this.clone().inotn(e)},i.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},i.prototype.iadd=function(e){var t,n,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(n=this,r=e):(n=e,r=this);for(var i=0,o=0;o<r.length;o++)t=(0|n.words[o])+(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<n.length;o++)t=(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this},i.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},i.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var n,r,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(n=this,r=e):(n=e,r=this);for(var o=0,a=0;a<r.length;a++)o=(t=(0|n.words[a])-(0|r.words[a])+o)>>26,this.words[a]=67108863&t;for(;0!==o&&a<n.length;a++)o=(t=(0|n.words[a])+o)>>26,this.words[a]=67108863&t;if(0===o&&a<n.length&&n!==this)for(;a<n.length;a++)this.words[a]=n.words[a];return this.length=Math.max(this.length,a),n!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(e){return this.clone().isub(e)};var y=function(e,t,n){var r,i,o,a=e.words,s=t.words,u=n.words,c=0,l=0|a[0],f=8191&l,h=l>>>13,d=0|a[1],p=8191&d,m=d>>>13,y=0|a[2],g=8191&y,b=y>>>13,v=0|a[3],w=8191&v,_=v>>>13,E=0|a[4],S=8191&E,x=E>>>13,T=0|a[5],M=8191&T,A=T>>>13,R=0|a[6],I=8191&R,P=R>>>13,N=0|a[7],O=8191&N,C=N>>>13,k=0|a[8],B=8191&k,D=k>>>13,j=0|a[9],L=8191&j,q=j>>>13,U=0|s[0],F=8191&U,K=U>>>13,V=0|s[1],z=8191&V,W=V>>>13,H=0|s[2],G=8191&H,Q=H>>>13,J=0|s[3],Z=8191&J,$=J>>>13,Y=0|s[4],X=8191&Y,ee=Y>>>13,te=0|s[5],ne=8191&te,re=te>>>13,ie=0|s[6],oe=8191&ie,ae=ie>>>13,se=0|s[7],ue=8191&se,ce=se>>>13,le=0|s[8],fe=8191&le,he=le>>>13,de=0|s[9],pe=8191&de,me=de>>>13;n.negative=e.negative^t.negative,n.length=19;var ye=(c+(r=Math.imul(f,F))|0)+((8191&(i=(i=Math.imul(f,K))+Math.imul(h,F)|0))<<13)|0;c=((o=Math.imul(h,K))+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(p,F),i=(i=Math.imul(p,K))+Math.imul(m,F)|0,o=Math.imul(m,K);var ge=(c+(r=r+Math.imul(f,z)|0)|0)+((8191&(i=(i=i+Math.imul(f,W)|0)+Math.imul(h,z)|0))<<13)|0;c=((o=o+Math.imul(h,W)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(g,F),i=(i=Math.imul(g,K))+Math.imul(b,F)|0,o=Math.imul(b,K),r=r+Math.imul(p,z)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,W)|0;var be=(c+(r=r+Math.imul(f,G)|0)|0)+((8191&(i=(i=i+Math.imul(f,Q)|0)+Math.imul(h,G)|0))<<13)|0;c=((o=o+Math.imul(h,Q)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(w,F),i=(i=Math.imul(w,K))+Math.imul(_,F)|0,o=Math.imul(_,K),r=r+Math.imul(g,z)|0,i=(i=i+Math.imul(g,W)|0)+Math.imul(b,z)|0,o=o+Math.imul(b,W)|0,r=r+Math.imul(p,G)|0,i=(i=i+Math.imul(p,Q)|0)+Math.imul(m,G)|0,o=o+Math.imul(m,Q)|0;var ve=(c+(r=r+Math.imul(f,Z)|0)|0)+((8191&(i=(i=i+Math.imul(f,$)|0)+Math.imul(h,Z)|0))<<13)|0;c=((o=o+Math.imul(h,$)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(S,F),i=(i=Math.imul(S,K))+Math.imul(x,F)|0,o=Math.imul(x,K),r=r+Math.imul(w,z)|0,i=(i=i+Math.imul(w,W)|0)+Math.imul(_,z)|0,o=o+Math.imul(_,W)|0,r=r+Math.imul(g,G)|0,i=(i=i+Math.imul(g,Q)|0)+Math.imul(b,G)|0,o=o+Math.imul(b,Q)|0,r=r+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,$)|0)+Math.imul(m,Z)|0,o=o+Math.imul(m,$)|0;var we=(c+(r=r+Math.imul(f,X)|0)|0)+((8191&(i=(i=i+Math.imul(f,ee)|0)+Math.imul(h,X)|0))<<13)|0;c=((o=o+Math.imul(h,ee)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(M,F),i=(i=Math.imul(M,K))+Math.imul(A,F)|0,o=Math.imul(A,K),r=r+Math.imul(S,z)|0,i=(i=i+Math.imul(S,W)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,W)|0,r=r+Math.imul(w,G)|0,i=(i=i+Math.imul(w,Q)|0)+Math.imul(_,G)|0,o=o+Math.imul(_,Q)|0,r=r+Math.imul(g,Z)|0,i=(i=i+Math.imul(g,$)|0)+Math.imul(b,Z)|0,o=o+Math.imul(b,$)|0,r=r+Math.imul(p,X)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,ee)|0;var _e=(c+(r=r+Math.imul(f,ne)|0)|0)+((8191&(i=(i=i+Math.imul(f,re)|0)+Math.imul(h,ne)|0))<<13)|0;c=((o=o+Math.imul(h,re)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(I,F),i=(i=Math.imul(I,K))+Math.imul(P,F)|0,o=Math.imul(P,K),r=r+Math.imul(M,z)|0,i=(i=i+Math.imul(M,W)|0)+Math.imul(A,z)|0,o=o+Math.imul(A,W)|0,r=r+Math.imul(S,G)|0,i=(i=i+Math.imul(S,Q)|0)+Math.imul(x,G)|0,o=o+Math.imul(x,Q)|0,r=r+Math.imul(w,Z)|0,i=(i=i+Math.imul(w,$)|0)+Math.imul(_,Z)|0,o=o+Math.imul(_,$)|0,r=r+Math.imul(g,X)|0,i=(i=i+Math.imul(g,ee)|0)+Math.imul(b,X)|0,o=o+Math.imul(b,ee)|0,r=r+Math.imul(p,ne)|0,i=(i=i+Math.imul(p,re)|0)+Math.imul(m,ne)|0,o=o+Math.imul(m,re)|0;var Ee=(c+(r=r+Math.imul(f,oe)|0)|0)+((8191&(i=(i=i+Math.imul(f,ae)|0)+Math.imul(h,oe)|0))<<13)|0;c=((o=o+Math.imul(h,ae)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(O,F),i=(i=Math.imul(O,K))+Math.imul(C,F)|0,o=Math.imul(C,K),r=r+Math.imul(I,z)|0,i=(i=i+Math.imul(I,W)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,W)|0,r=r+Math.imul(M,G)|0,i=(i=i+Math.imul(M,Q)|0)+Math.imul(A,G)|0,o=o+Math.imul(A,Q)|0,r=r+Math.imul(S,Z)|0,i=(i=i+Math.imul(S,$)|0)+Math.imul(x,Z)|0,o=o+Math.imul(x,$)|0,r=r+Math.imul(w,X)|0,i=(i=i+Math.imul(w,ee)|0)+Math.imul(_,X)|0,o=o+Math.imul(_,ee)|0,r=r+Math.imul(g,ne)|0,i=(i=i+Math.imul(g,re)|0)+Math.imul(b,ne)|0,o=o+Math.imul(b,re)|0,r=r+Math.imul(p,oe)|0,i=(i=i+Math.imul(p,ae)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,ae)|0;var Se=(c+(r=r+Math.imul(f,ue)|0)|0)+((8191&(i=(i=i+Math.imul(f,ce)|0)+Math.imul(h,ue)|0))<<13)|0;c=((o=o+Math.imul(h,ce)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(B,F),i=(i=Math.imul(B,K))+Math.imul(D,F)|0,o=Math.imul(D,K),r=r+Math.imul(O,z)|0,i=(i=i+Math.imul(O,W)|0)+Math.imul(C,z)|0,o=o+Math.imul(C,W)|0,r=r+Math.imul(I,G)|0,i=(i=i+Math.imul(I,Q)|0)+Math.imul(P,G)|0,o=o+Math.imul(P,Q)|0,r=r+Math.imul(M,Z)|0,i=(i=i+Math.imul(M,$)|0)+Math.imul(A,Z)|0,o=o+Math.imul(A,$)|0,r=r+Math.imul(S,X)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,ee)|0,r=r+Math.imul(w,ne)|0,i=(i=i+Math.imul(w,re)|0)+Math.imul(_,ne)|0,o=o+Math.imul(_,re)|0,r=r+Math.imul(g,oe)|0,i=(i=i+Math.imul(g,ae)|0)+Math.imul(b,oe)|0,o=o+Math.imul(b,ae)|0,r=r+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(m,ue)|0,o=o+Math.imul(m,ce)|0;var xe=(c+(r=r+Math.imul(f,fe)|0)|0)+((8191&(i=(i=i+Math.imul(f,he)|0)+Math.imul(h,fe)|0))<<13)|0;c=((o=o+Math.imul(h,he)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(L,F),i=(i=Math.imul(L,K))+Math.imul(q,F)|0,o=Math.imul(q,K),r=r+Math.imul(B,z)|0,i=(i=i+Math.imul(B,W)|0)+Math.imul(D,z)|0,o=o+Math.imul(D,W)|0,r=r+Math.imul(O,G)|0,i=(i=i+Math.imul(O,Q)|0)+Math.imul(C,G)|0,o=o+Math.imul(C,Q)|0,r=r+Math.imul(I,Z)|0,i=(i=i+Math.imul(I,$)|0)+Math.imul(P,Z)|0,o=o+Math.imul(P,$)|0,r=r+Math.imul(M,X)|0,i=(i=i+Math.imul(M,ee)|0)+Math.imul(A,X)|0,o=o+Math.imul(A,ee)|0,r=r+Math.imul(S,ne)|0,i=(i=i+Math.imul(S,re)|0)+Math.imul(x,ne)|0,o=o+Math.imul(x,re)|0,r=r+Math.imul(w,oe)|0,i=(i=i+Math.imul(w,ae)|0)+Math.imul(_,oe)|0,o=o+Math.imul(_,ae)|0,r=r+Math.imul(g,ue)|0,i=(i=i+Math.imul(g,ce)|0)+Math.imul(b,ue)|0,o=o+Math.imul(b,ce)|0,r=r+Math.imul(p,fe)|0,i=(i=i+Math.imul(p,he)|0)+Math.imul(m,fe)|0,o=o+Math.imul(m,he)|0;var Te=(c+(r=r+Math.imul(f,pe)|0)|0)+((8191&(i=(i=i+Math.imul(f,me)|0)+Math.imul(h,pe)|0))<<13)|0;c=((o=o+Math.imul(h,me)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(L,z),i=(i=Math.imul(L,W))+Math.imul(q,z)|0,o=Math.imul(q,W),r=r+Math.imul(B,G)|0,i=(i=i+Math.imul(B,Q)|0)+Math.imul(D,G)|0,o=o+Math.imul(D,Q)|0,r=r+Math.imul(O,Z)|0,i=(i=i+Math.imul(O,$)|0)+Math.imul(C,Z)|0,o=o+Math.imul(C,$)|0,r=r+Math.imul(I,X)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,ee)|0,r=r+Math.imul(M,ne)|0,i=(i=i+Math.imul(M,re)|0)+Math.imul(A,ne)|0,o=o+Math.imul(A,re)|0,r=r+Math.imul(S,oe)|0,i=(i=i+Math.imul(S,ae)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,ae)|0,r=r+Math.imul(w,ue)|0,i=(i=i+Math.imul(w,ce)|0)+Math.imul(_,ue)|0,o=o+Math.imul(_,ce)|0,r=r+Math.imul(g,fe)|0,i=(i=i+Math.imul(g,he)|0)+Math.imul(b,fe)|0,o=o+Math.imul(b,he)|0;var Me=(c+(r=r+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;c=((o=o+Math.imul(m,me)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(L,G),i=(i=Math.imul(L,Q))+Math.imul(q,G)|0,o=Math.imul(q,Q),r=r+Math.imul(B,Z)|0,i=(i=i+Math.imul(B,$)|0)+Math.imul(D,Z)|0,o=o+Math.imul(D,$)|0,r=r+Math.imul(O,X)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(C,X)|0,o=o+Math.imul(C,ee)|0,r=r+Math.imul(I,ne)|0,i=(i=i+Math.imul(I,re)|0)+Math.imul(P,ne)|0,o=o+Math.imul(P,re)|0,r=r+Math.imul(M,oe)|0,i=(i=i+Math.imul(M,ae)|0)+Math.imul(A,oe)|0,o=o+Math.imul(A,ae)|0,r=r+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(x,ue)|0,o=o+Math.imul(x,ce)|0,r=r+Math.imul(w,fe)|0,i=(i=i+Math.imul(w,he)|0)+Math.imul(_,fe)|0,o=o+Math.imul(_,he)|0;var Ae=(c+(r=r+Math.imul(g,pe)|0)|0)+((8191&(i=(i=i+Math.imul(g,me)|0)+Math.imul(b,pe)|0))<<13)|0;c=((o=o+Math.imul(b,me)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(L,Z),i=(i=Math.imul(L,$))+Math.imul(q,Z)|0,o=Math.imul(q,$),r=r+Math.imul(B,X)|0,i=(i=i+Math.imul(B,ee)|0)+Math.imul(D,X)|0,o=o+Math.imul(D,ee)|0,r=r+Math.imul(O,ne)|0,i=(i=i+Math.imul(O,re)|0)+Math.imul(C,ne)|0,o=o+Math.imul(C,re)|0,r=r+Math.imul(I,oe)|0,i=(i=i+Math.imul(I,ae)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,ae)|0,r=r+Math.imul(M,ue)|0,i=(i=i+Math.imul(M,ce)|0)+Math.imul(A,ue)|0,o=o+Math.imul(A,ce)|0,r=r+Math.imul(S,fe)|0,i=(i=i+Math.imul(S,he)|0)+Math.imul(x,fe)|0,o=o+Math.imul(x,he)|0;var Re=(c+(r=r+Math.imul(w,pe)|0)|0)+((8191&(i=(i=i+Math.imul(w,me)|0)+Math.imul(_,pe)|0))<<13)|0;c=((o=o+Math.imul(_,me)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(L,X),i=(i=Math.imul(L,ee))+Math.imul(q,X)|0,o=Math.imul(q,ee),r=r+Math.imul(B,ne)|0,i=(i=i+Math.imul(B,re)|0)+Math.imul(D,ne)|0,o=o+Math.imul(D,re)|0,r=r+Math.imul(O,oe)|0,i=(i=i+Math.imul(O,ae)|0)+Math.imul(C,oe)|0,o=o+Math.imul(C,ae)|0,r=r+Math.imul(I,ue)|0,i=(i=i+Math.imul(I,ce)|0)+Math.imul(P,ue)|0,o=o+Math.imul(P,ce)|0,r=r+Math.imul(M,fe)|0,i=(i=i+Math.imul(M,he)|0)+Math.imul(A,fe)|0,o=o+Math.imul(A,he)|0;var Ie=(c+(r=r+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,me)|0)+Math.imul(x,pe)|0))<<13)|0;c=((o=o+Math.imul(x,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(L,ne),i=(i=Math.imul(L,re))+Math.imul(q,ne)|0,o=Math.imul(q,re),r=r+Math.imul(B,oe)|0,i=(i=i+Math.imul(B,ae)|0)+Math.imul(D,oe)|0,o=o+Math.imul(D,ae)|0,r=r+Math.imul(O,ue)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(C,ue)|0,o=o+Math.imul(C,ce)|0,r=r+Math.imul(I,fe)|0,i=(i=i+Math.imul(I,he)|0)+Math.imul(P,fe)|0,o=o+Math.imul(P,he)|0;var Pe=(c+(r=r+Math.imul(M,pe)|0)|0)+((8191&(i=(i=i+Math.imul(M,me)|0)+Math.imul(A,pe)|0))<<13)|0;c=((o=o+Math.imul(A,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(L,oe),i=(i=Math.imul(L,ae))+Math.imul(q,oe)|0,o=Math.imul(q,ae),r=r+Math.imul(B,ue)|0,i=(i=i+Math.imul(B,ce)|0)+Math.imul(D,ue)|0,o=o+Math.imul(D,ce)|0,r=r+Math.imul(O,fe)|0,i=(i=i+Math.imul(O,he)|0)+Math.imul(C,fe)|0,o=o+Math.imul(C,he)|0;var Ne=(c+(r=r+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,me)|0)+Math.imul(P,pe)|0))<<13)|0;c=((o=o+Math.imul(P,me)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,r=Math.imul(L,ue),i=(i=Math.imul(L,ce))+Math.imul(q,ue)|0,o=Math.imul(q,ce),r=r+Math.imul(B,fe)|0,i=(i=i+Math.imul(B,he)|0)+Math.imul(D,fe)|0,o=o+Math.imul(D,he)|0;var Oe=(c+(r=r+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,me)|0)+Math.imul(C,pe)|0))<<13)|0;c=((o=o+Math.imul(C,me)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,r=Math.imul(L,fe),i=(i=Math.imul(L,he))+Math.imul(q,fe)|0,o=Math.imul(q,he);var Ce=(c+(r=r+Math.imul(B,pe)|0)|0)+((8191&(i=(i=i+Math.imul(B,me)|0)+Math.imul(D,pe)|0))<<13)|0;c=((o=o+Math.imul(D,me)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863;var ke=(c+(r=Math.imul(L,pe))|0)+((8191&(i=(i=Math.imul(L,me))+Math.imul(q,pe)|0))<<13)|0;return c=((o=Math.imul(q,me))+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,u[0]=ye,u[1]=ge,u[2]=be,u[3]=ve,u[4]=we,u[5]=_e,u[6]=Ee,u[7]=Se,u[8]=xe,u[9]=Te,u[10]=Me,u[11]=Ae,u[12]=Re,u[13]=Ie,u[14]=Pe,u[15]=Ne,u[16]=Oe,u[17]=Ce,u[18]=ke,0!==c&&(u[19]=c,n.length++),n};function g(e,t,n){n.negative=t.negative^e.negative,n.length=e.length+t.length;for(var r=0,i=0,o=0;o<n.length-1;o++){var a=i;i=0;for(var s=67108863&r,u=Math.min(o,t.length-1),c=Math.max(0,o-e.length+1);c<=u;c++){var l=o-c,f=(0|e.words[l])*(0|t.words[c]),h=67108863&f;s=67108863&(h=h+s|0),i+=(a=(a=a+(f/67108864|0)|0)+(h>>>26)|0)>>>26,a&=67108863}n.words[o]=s,r=a,a=i}return 0!==r?n.words[o]=r:n.length--,n._strip()}function b(e,t,n){return g(e,t,n)}function v(e,t){this.x=e,this.y=t}Math.imul||(y=m),i.prototype.mulTo=function(e,t){var n=this.length+e.length;return 10===this.length&&10===e.length?y(this,e,t):n<63?m(this,e,t):n<1024?g(this,e,t):b(this,e,t)},v.prototype.makeRBT=function(e){for(var t=new Array(e),n=i.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,n,e);return t},v.prototype.revBin=function(e,t,n){if(0===e||e===n-1)return e;for(var r=0,i=0;i<t;i++)r|=(1&e)<<t-i-1,e>>=1;return r},v.prototype.permute=function(e,t,n,r,i,o){for(var a=0;a<o;a++)r[a]=t[e[a]],i[a]=n[e[a]]},v.prototype.transform=function(e,t,n,r,i,o){this.permute(o,e,t,n,r,i);for(var a=1;a<i;a<<=1)for(var s=a<<1,u=Math.cos(2*Math.PI/s),c=Math.sin(2*Math.PI/s),l=0;l<i;l+=s)for(var f=u,h=c,d=0;d<a;d++){var p=n[l+d],m=r[l+d],y=n[l+d+a],g=r[l+d+a],b=f*y-h*g;g=f*g+h*y,y=b,n[l+d]=p+y,r[l+d]=m+g,n[l+d+a]=p-y,r[l+d+a]=m-g,d!==s&&(b=u*f-c*h,h=u*h+c*f,f=b)}},v.prototype.guessLen13b=function(e,t){var n=1|Math.max(t,e),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},v.prototype.conjugate=function(e,t,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=e[r];e[r]=e[n-r-1],e[n-r-1]=i,i=t[r],t[r]=-t[n-r-1],t[n-r-1]=-i}},v.prototype.normalize13b=function(e,t){for(var n=0,r=0;r<t/2;r++){var i=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+n;e[r]=67108863&i,n=i<67108864?0:i/67108864|0}return e},v.prototype.convert13b=function(e,t,r,i){for(var o=0,a=0;a<t;a++)o+=0|e[a],r[2*a]=8191&o,o>>>=13,r[2*a+1]=8191&o,o>>>=13;for(a=2*t;a<i;++a)r[a]=0;n(0===o),n(0==(-8192&o))},v.prototype.stub=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t},v.prototype.mulp=function(e,t,n){var r=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(r),o=this.stub(r),a=new Array(r),s=new Array(r),u=new Array(r),c=new Array(r),l=new Array(r),f=new Array(r),h=n.words;h.length=r,this.convert13b(e.words,e.length,a,r),this.convert13b(t.words,t.length,c,r),this.transform(a,o,s,u,r,i),this.transform(c,o,l,f,r,i);for(var d=0;d<r;d++){var p=s[d]*l[d]-u[d]*f[d];u[d]=s[d]*f[d]+u[d]*l[d],s[d]=p}return this.conjugate(s,u,r),this.transform(s,u,h,o,r,i),this.conjugate(h,o,r),this.normalize13b(h,r),n.negative=e.negative^t.negative,n.length=e.length+t.length,n._strip()},i.prototype.mul=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},i.prototype.mulf=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),b(this,e,t)},i.prototype.imul=function(e){return this.clone().mulTo(e,this)},i.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var o=(0|this.words[i])*e,a=(67108863&o)+(67108863&r);r>>=26,r+=o/67108864|0,r+=a>>>26,this.words[i]=67108863&a}return 0!==r&&(this.words[i]=r,this.length++),t?this.ineg():this},i.prototype.muln=function(e){return this.clone().imuln(e)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),n=0;n<t.length;n++){var r=n/26|0,i=n%26;t[n]=e.words[r]>>>i&1}return t}(e);if(0===t.length)return new i(1);for(var n=this,r=0;r<t.length&&0===t[r];r++,n=n.sqr());if(++r<t.length)for(var o=n.sqr();r<t.length;r++,o=o.sqr())0!==t[r]&&(n=n.mul(o));return n},i.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var a=0;for(t=0;t<this.length;t++){var s=this.words[t]&o,u=(0|this.words[t])-s<<r;this.words[t]=u|a,a=s>>>26-r}a&&(this.words[t]=a,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},i.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},i.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,a=Math.min((e-o)/26,this.length),s=67108863^67108863>>>o<<o,u=r;if(i-=a,i=Math.max(0,i),u){for(var c=0;c<a;c++)u.words[c]=this.words[c];u.length=a}if(0===a);else if(this.length>a)for(this.length-=a,c=0;c<this.length;c++)this.words[c]=this.words[c+a];else this.words[0]=0,this.length=1;var l=0;for(c=this.length-1;c>=0&&(0!==l||c>=i);c--){var f=0|this.words[c];this.words[c]=l<<26-o|f>>>o,l=f&s}return u&&0!==l&&(u.words[u.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},i.prototype.shln=function(e){return this.clone().ishln(e)},i.prototype.ushln=function(e){return this.clone().iushln(e)},i.prototype.shrn=function(e){return this.clone().ishrn(e)},i.prototype.ushrn=function(e){return this.clone().iushrn(e)},i.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},i.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},i.prototype.maskn=function(e){return this.clone().imaskn(e)},i.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},i.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},i.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},i.prototype.addn=function(e){return this.clone().iaddn(e)},i.prototype.subn=function(e){return this.clone().isubn(e)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(e,t,r){var i,o,a=e.length+r;this._expand(a);var s=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+s;var u=(0|e.words[i])*t;s=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)s=(o=(0|this.words[i+r])+s)>>26,this.words[i+r]=67108863&o;if(0===s)return this._strip();for(n(-1===s),s=0,i=0;i<this.length;i++)s=(o=-(0|this.words[i])+s)>>26,this.words[i]=67108863&o;return this.negative=1,this._strip()},i.prototype._wordDiv=function(e,t){var n=(this.length,e.length),r=this.clone(),o=e,a=0|o.words[o.length-1];0!==(n=26-this._countBits(a))&&(o=o.ushln(n),r.iushln(n),a=0|o.words[o.length-1]);var s,u=r.length-o.length;if("mod"!==t){(s=new i(null)).length=u+1,s.words=new Array(s.length);for(var c=0;c<s.length;c++)s.words[c]=0}var l=r.clone()._ishlnsubmul(o,1,u);0===l.negative&&(r=l,s&&(s.words[u]=1));for(var f=u-1;f>=0;f--){var h=67108864*(0|r.words[o.length+f])+(0|r.words[o.length+f-1]);for(h=Math.min(h/a|0,67108863),r._ishlnsubmul(o,h,f);0!==r.negative;)h--,r.negative=0,r._ishlnsubmul(o,1,f),r.isZero()||(r.negative^=1);s&&(s.words[f]=h)}return s&&s._strip(),r._strip(),"div"!==t&&0!==n&&r.iushrn(n),{div:s||null,mod:r}},i.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:0!==this.negative&&0===e.negative?(s=this.neg().divmod(e,t),"mod"!==t&&(o=s.div.neg()),"div"!==t&&(a=s.mod.neg(),r&&0!==a.negative&&a.iadd(e)),{div:o,mod:a}):0===this.negative&&0!==e.negative?(s=this.divmod(e.neg(),t),"mod"!==t&&(o=s.div.neg()),{div:o,mod:s.mod}):0!=(this.negative&e.negative)?(s=this.neg().divmod(e.neg(),t),"div"!==t&&(a=s.mod.neg(),r&&0!==a.negative&&a.isub(e)),{div:s.div,mod:a}):e.length>this.length||this.cmp(e)<0?{div:new i(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new i(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new i(this.modrn(e.words[0]))}:this._wordDiv(e,t);var o,a,s},i.prototype.div=function(e){return this.divmod(e,"div",!1).div},i.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},i.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},i.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),i=e.andln(1),o=n.cmp(r);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},i.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=67108864%e,i=0,o=this.length-1;o>=0;o--)i=(r*i+(0|this.words[o]))%e;return t?-i:i},i.prototype.modn=function(e){return this.modrn(e)},i.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var o=(0|this.words[i])+67108864*r;this.words[i]=o/e|0,r=o%e}return this._strip(),t?this.ineg():this},i.prototype.divn=function(e){return this.clone().idivn(e)},i.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var o=new i(1),a=new i(0),s=new i(0),u=new i(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var l=r.clone(),f=t.clone();!t.isZero();){for(var h=0,d=1;0==(t.words[0]&d)&&h<26;++h,d<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(o.isOdd()||a.isOdd())&&(o.iadd(l),a.isub(f)),o.iushrn(1),a.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(s.isOdd()||u.isOdd())&&(s.iadd(l),u.isub(f)),s.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(s),a.isub(u)):(r.isub(t),s.isub(o),u.isub(a))}return{a:s,b:u,gcd:r.iushln(c)}},i.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var o,a=new i(1),s=new i(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,l=1;0==(t.words[0]&l)&&c<26;++c,l<<=1);if(c>0)for(t.iushrn(c);c-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);for(var f=0,h=1;0==(r.words[0]&h)&&f<26;++f,h<<=1);if(f>0)for(r.iushrn(f);f-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);t.cmp(r)>=0?(t.isub(r),a.isub(s)):(r.isub(t),s.isub(a))}return(o=0===t.cmpn(1)?a:s).cmpn(0)<0&&o.iadd(e),o},i.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),n=e.clone();t.negative=0,n.negative=0;for(var r=0;t.isEven()&&n.isEven();r++)t.iushrn(1),n.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=t.cmp(n);if(i<0){var o=t;t=n,n=o}else if(0===i||0===n.cmpn(1))break;t.isub(n)}return n.iushln(r)},i.prototype.invm=function(e){return this.egcd(e).a.umod(e)},i.prototype.isEven=function(){return 0==(1&this.words[0])},i.prototype.isOdd=function(){return 1==(1&this.words[0])},i.prototype.andln=function(e){return this.words[0]&e},i.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,a=r;0!==o&&a<this.length;a++){var s=0|this.words[a];o=(s+=o)>>>26,s&=67108863,this.words[a]=s}return 0!==o&&(this.words[a]=o,this.length++),this},i.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},i.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},i.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},i.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|e.words[n];if(r!==i){r<i?t=-1:r>i&&(t=1);break}}return t},i.prototype.gtn=function(e){return 1===this.cmpn(e)},i.prototype.gt=function(e){return 1===this.cmp(e)},i.prototype.gten=function(e){return this.cmpn(e)>=0},i.prototype.gte=function(e){return this.cmp(e)>=0},i.prototype.ltn=function(e){return-1===this.cmpn(e)},i.prototype.lt=function(e){return-1===this.cmp(e)},i.prototype.lten=function(e){return this.cmpn(e)<=0},i.prototype.lte=function(e){return this.cmp(e)<=0},i.prototype.eqn=function(e){return 0===this.cmpn(e)},i.prototype.eq=function(e){return 0===this.cmp(e)},i.red=function(e){return new M(e)},i.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},i.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(e){return this.red=e,this},i.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},i.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},i.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},i.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},i.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},i.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},i.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},i.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},i.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var w={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new i(t,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function S(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function x(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function T(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function M(e){if("string"==typeof e){var t=i._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function A(e){M.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new i(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,n=e;do{this.split(n,this.tmp),t=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):void 0!==n.strip?n.strip():n._strip(),n},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},r(E,_),E.prototype.split=function(e,t){for(var n=4194303,r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&n,i=10;i<e.length;i++){var a=0|e.words[i];e.words[i-10]=(a&n)<<4|o>>>22,o=a}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,n=0;n<e.length;n++){var r=0|e.words[n];t+=977*r,e.words[n]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(S,_),r(x,_),r(T,_),T.prototype.imulK=function(e){for(var t=0,n=0;n<e.length;n++){var r=19*(0|e.words[n])+t,i=67108863&r;r>>>=26,e.words[n]=i,t=r}return 0!==t&&(e.words[e.length++]=t),e},i._prime=function(e){if(w[e])return w[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new S;else if("p192"===e)t=new x;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new T}return w[e]=t,t},M.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},M.prototype._verify2=function(e,t){n(0==(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},M.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(l(e,e.umod(this.m)._forceRed(this)),e)},M.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},M.prototype.add=function(e,t){this._verify2(e,t);var n=e.add(t);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},M.prototype.iadd=function(e,t){this._verify2(e,t);var n=e.iadd(t);return n.cmp(this.m)>=0&&n.isub(this.m),n},M.prototype.sub=function(e,t){this._verify2(e,t);var n=e.sub(t);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},M.prototype.isub=function(e,t){this._verify2(e,t);var n=e.isub(t);return n.cmpn(0)<0&&n.iadd(this.m),n},M.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},M.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},M.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},M.prototype.isqr=function(e){return this.imul(e,e.clone())},M.prototype.sqr=function(e){return this.mul(e,e)},M.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new i(1)).iushrn(2);return this.pow(e,r)}for(var o=this.m.subn(1),a=0;!o.isZero()&&0===o.andln(1);)a++,o.iushrn(1);n(!o.isZero());var s=new i(1).toRed(this),u=s.redNeg(),c=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new i(2*l*l).toRed(this);0!==this.pow(l,c).cmp(u);)l.redIAdd(u);for(var f=this.pow(l,o),h=this.pow(e,o.addn(1).iushrn(1)),d=this.pow(e,o),p=a;0!==d.cmp(s);){for(var m=d,y=0;0!==m.cmp(s);y++)m=m.redSqr();n(y<p);var g=this.pow(f,new i(1).iushln(p-y-1));h=h.redMul(g),f=g.redSqr(),d=d.redMul(f),p=y}return h},M.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},M.prototype.pow=function(e,t){if(t.isZero())return new i(1).toRed(this);if(0===t.cmpn(1))return e.clone();var n=new Array(16);n[0]=new i(1).toRed(this),n[1]=e;for(var r=2;r<n.length;r++)n[r]=this.mul(n[r-1],e);var o=n[0],a=0,s=0,u=t.bitLength()%26;for(0===u&&(u=26),r=t.length-1;r>=0;r--){for(var c=t.words[r],l=u-1;l>=0;l--){var f=c>>l&1;o!==n[0]&&(o=this.sqr(o)),0!==f||0!==a?(a<<=1,a|=f,(4===++s||0===r&&0===l)&&(o=this.mul(o,n[a]),s=0,a=0)):s=0}u=26}return o},M.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},M.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},i.mont=function(e){return new A(e)},r(A,M),A.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},A.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},A.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var n=e.imul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},A.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new i(0)._forceRed(this);var n=e.mul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=n.isub(r).iushrn(this.shift),a=o;return o.cmp(this.m)>=0?a=o.isub(this.m):o.cmpn(0)<0&&(a=o.iadd(this.m)),a._forceRed(this)},A.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)})),o.register("as8Ac",(function(e,t){var n=e.exports;n.version=o("gJ7Uj").version,n.utils=o("enxev"),n.rand=o("15okD"),n.curve=o("fxmhX"),n.curves=o("32azV"),n.ec=o("f7iqf"),n.eddsa=o("jy9b2")})),o.register("gJ7Uj",(function(e,t){e.exports=JSON.parse('{"name":"elliptic","version":"6.5.4","description":"EC cryptography","main":"lib/elliptic.js","files":["lib"],"scripts":{"lint":"eslint lib test","lint:fix":"npm run lint -- --fix","unit":"istanbul test _mocha --reporter=spec test/index.js","test":"npm run lint && npm run unit","version":"grunt dist && git add dist/"},"repository":{"type":"git","url":"git@github.com:indutny/elliptic"},"keywords":["EC","Elliptic","curve","Cryptography"],"author":"Fedor Indutny <fedor@indutny.com>","license":"MIT","bugs":{"url":"https://github.com/indutny/elliptic/issues"},"homepage":"https://github.com/indutny/elliptic","devDependencies":{"brfs":"^2.0.2","coveralls":"^3.1.0","eslint":"^7.6.0","grunt":"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1","istanbul":"^0.4.5","mocha":"^8.0.1"},"dependencies":{"bn.js":"^4.11.9","brorand":"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1","inherits":"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}')})),o.register("enxev",(function(e,t){var n=e.exports,r=o("ks3fn"),i=o("b8dAq"),a=o("jeqpy");n.assert=i,n.toArray=a.toArray,n.zero2=a.zero2,n.toHex=a.toHex,n.encode=a.encode,n.getNAF=function(e,t,n){var r=new Array(Math.max(e.bitLength(),n)+1);r.fill(0);for(var i=1<<t+1,o=e.clone(),a=0;a<r.length;a++){var s,u=o.andln(i-1);o.isOdd()?(s=u>(i>>1)-1?(i>>1)-u:u,o.isubn(s)):s=0,r[a]=s,o.iushrn(1)}return r},n.getJSF=function(e,t){var n=[[],[]];e=e.clone(),t=t.clone();for(var r,i=0,o=0;e.cmpn(-i)>0||t.cmpn(-o)>0;){var a,s,u=e.andln(3)+i&3,c=t.andln(3)+o&3;3===u&&(u=-1),3===c&&(c=-1),a=0==(1&u)?0:3!==(r=e.andln(7)+i&7)&&5!==r||2!==c?u:-u,n[0].push(a),s=0==(1&c)?0:3!==(r=t.andln(7)+o&7)&&5!==r||2!==u?c:-c,n[1].push(s),2*i===a+1&&(i=1-i),2*o===s+1&&(o=1-o),e.iushrn(1),t.iushrn(1)}return n},n.cachedProperty=function(e,t,n){var r="_"+t;e.prototype[t]=function(){return void 0!==this[r]?this[r]:this[r]=n.call(this)}},n.parseBytes=function(e){return"string"==typeof e?n.toArray(e,"hex"):e},n.intFromLE=function(e){return new r(e,"hex","le")}})),o.register("jeqpy",(function(e,t){var n=e.exports;function r(e){return 1===e.length?"0"+e:e}function i(e){for(var t="",n=0;n<e.length;n++)t+=r(e[n].toString(16));return t}n.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"!=typeof e){for(var r=0;r<e.length;r++)n[r]=0|e[r];return n}if("hex"===t){(e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e);for(r=0;r<e.length;r+=2)n.push(parseInt(e[r]+e[r+1],16))}else for(r=0;r<e.length;r++){var i=e.charCodeAt(r),o=i>>8,a=255&i;o?n.push(o,a):n.push(a)}return n},n.zero2=r,n.toHex=i,n.encode=function(e,t){return"hex"===t?i(e):e}})),o.register("fxmhX",(function(e,t){var n=e.exports;n.base=o("fQ4he"),n.short=o("h5NfT"),n.mont=o("1adNw"),n.edwards=o("aE4Qc")})),o.register("fQ4he",(function(e,t){var n=o("ks3fn"),r=o("enxev"),i=r.getNAF,a=r.getJSF,s=r.assert;function u(e,t){this.type=e,this.p=new n(t.p,16),this.red=t.prime?n.red(t.prime):n.mont(this.p),this.zero=new n(0).toRed(this.red),this.one=new n(1).toRed(this.red),this.two=new n(2).toRed(this.red),this.n=t.n&&new n(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function c(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=u,u.prototype.point=function(){throw new Error("Not implemented")},u.prototype.validate=function(){throw new Error("Not implemented")},u.prototype._fixedNafMul=function(e,t){s(e.precomputed);var n=e._getDoubles(),r=i(t,1,this._bitLength),o=(1<<n.step+1)-(n.step%2==0?2:1);o/=3;var a,u,c=[];for(a=0;a<r.length;a+=n.step){u=0;for(var l=a+n.step-1;l>=a;l--)u=(u<<1)+r[l];c.push(u)}for(var f=this.jpoint(null,null,null),h=this.jpoint(null,null,null),d=o;d>0;d--){for(a=0;a<c.length;a++)(u=c[a])===d?h=h.mixedAdd(n.points[a]):u===-d&&(h=h.mixedAdd(n.points[a].neg()));f=f.add(h)}return f.toP()},u.prototype._wnafMul=function(e,t){var n=4,r=e._getNAFPoints(n);n=r.wnd;for(var o=r.points,a=i(t,n,this._bitLength),u=this.jpoint(null,null,null),c=a.length-1;c>=0;c--){for(var l=0;c>=0&&0===a[c];c--)l++;if(c>=0&&l++,u=u.dblp(l),c<0)break;var f=a[c];s(0!==f),u="affine"===e.type?f>0?u.mixedAdd(o[f-1>>1]):u.mixedAdd(o[-f-1>>1].neg()):f>0?u.add(o[f-1>>1]):u.add(o[-f-1>>1].neg())}return"affine"===e.type?u.toP():u},u.prototype._wnafMulAdd=function(e,t,n,r,o){var s,u,c,l=this._wnafT1,f=this._wnafT2,h=this._wnafT3,d=0;for(s=0;s<r;s++){var p=(c=t[s])._getNAFPoints(e);l[s]=p.wnd,f[s]=p.points}for(s=r-1;s>=1;s-=2){var m=s-1,y=s;if(1===l[m]&&1===l[y]){var g=[t[m],null,null,t[y]];0===t[m].y.cmp(t[y].y)?(g[1]=t[m].add(t[y]),g[2]=t[m].toJ().mixedAdd(t[y].neg())):0===t[m].y.cmp(t[y].y.redNeg())?(g[1]=t[m].toJ().mixedAdd(t[y]),g[2]=t[m].add(t[y].neg())):(g[1]=t[m].toJ().mixedAdd(t[y]),g[2]=t[m].toJ().mixedAdd(t[y].neg()));var b=[-3,-1,-5,-7,0,7,5,1,3],v=a(n[m],n[y]);for(d=Math.max(v[0].length,d),h[m]=new Array(d),h[y]=new Array(d),u=0;u<d;u++){var w=0|v[0][u],_=0|v[1][u];h[m][u]=b[3*(w+1)+(_+1)],h[y][u]=0,f[m]=g}}else h[m]=i(n[m],l[m],this._bitLength),h[y]=i(n[y],l[y],this._bitLength),d=Math.max(h[m].length,d),d=Math.max(h[y].length,d)}var E=this.jpoint(null,null,null),S=this._wnafT4;for(s=d;s>=0;s--){for(var x=0;s>=0;){var T=!0;for(u=0;u<r;u++)S[u]=0|h[u][s],0!==S[u]&&(T=!1);if(!T)break;x++,s--}if(s>=0&&x++,E=E.dblp(x),s<0)break;for(u=0;u<r;u++){var M=S[u];0!==M&&(M>0?c=f[u][M-1>>1]:M<0&&(c=f[u][-M-1>>1].neg()),E="affine"===c.type?E.mixedAdd(c):E.add(c))}}for(s=0;s<r;s++)f[s]=null;return o?E:E.toP()},u.BasePoint=c,c.prototype.eq=function(){throw new Error("Not implemented")},c.prototype.validate=function(){return this.curve.validate(this)},u.prototype.decodePoint=function(e,t){e=r.toArray(e,t);var n=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*n)return 6===e[0]?s(e[e.length-1]%2==0):7===e[0]&&s(e[e.length-1]%2==1),this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));if((2===e[0]||3===e[0])&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),3===e[0]);throw new Error("Unknown point format")},c.prototype.encodeCompressed=function(e){return this.encode(e,!0)},c.prototype._encode=function(e){var t=this.curve.p.byteLength(),n=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",t))},c.prototype.encode=function(e,t){return r.encode(this._encode(t),e)},c.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},c.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},c.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],r=this,i=0;i<t;i+=e){for(var o=0;o<e;o++)r=r.dbl();n.push(r)}return{step:e,points:n}},c.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],n=(1<<e)-1,r=1===n?null:this.dbl(),i=1;i<n;i++)t[i]=t[i-1].add(r);return{wnd:e,points:t}},c.prototype._getBeta=function(){return null},c.prototype.dblp=function(e){for(var t=this,n=0;n<e;n++)t=t.dbl();return t}})),o.register("h5NfT",(function(e,t){var n=o("enxev"),r=o("ks3fn"),i=o("9iXO2"),a=o("fQ4he"),s=n.assert;function u(e){a.call(this,"short",e),this.a=new r(e.a,16).toRed(this.red),this.b=new r(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function c(e,t,n,i){a.BasePoint.call(this,e,"affine"),null===t&&null===n?(this.x=null,this.y=null,this.inf=!0):(this.x=new r(t,16),this.y=new r(n,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function l(e,t,n,i){a.BasePoint.call(this,e,"jacobian"),null===t&&null===n&&null===i?(this.x=this.curve.one,this.y=this.curve.one,this.z=new r(0)):(this.x=new r(t,16),this.y=new r(n,16),this.z=new r(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}i(u,a),e.exports=u,u.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var t,n;if(e.beta)t=new r(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);t=(t=i[0].cmp(i[1])<0?i[0]:i[1]).toRed(this.red)}if(e.lambda)n=new r(e.lambda,16);else{var o=this._getEndoRoots(this.n);0===this.g.mul(o[0]).x.cmp(this.g.x.redMul(t))?n=o[0]:(n=o[1],s(0===this.g.mul(n).x.cmp(this.g.x.redMul(t))))}return{beta:t,lambda:n,basis:e.basis?e.basis.map((function(e){return{a:new r(e.a,16),b:new r(e.b,16)}})):this._getEndoBasis(n)}}},u.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:r.mont(e),n=new r(2).toRed(t).redInvm(),i=n.redNeg(),o=new r(3).toRed(t).redNeg().redSqrt().redMul(n);return[i.redAdd(o).fromRed(),i.redSub(o).fromRed()]},u.prototype._getEndoBasis=function(e){for(var t,n,i,o,a,s,u,c,l,f=this.n.ushrn(Math.floor(this.n.bitLength()/2)),h=e,d=this.n.clone(),p=new r(1),m=new r(0),y=new r(0),g=new r(1),b=0;0!==h.cmpn(0);){var v=d.div(h);c=d.sub(v.mul(h)),l=y.sub(v.mul(p));var w=g.sub(v.mul(m));if(!i&&c.cmp(f)<0)t=u.neg(),n=p,i=c.neg(),o=l;else if(i&&2==++b)break;u=c,d=h,h=c,y=p,p=l,g=m,m=w}a=c.neg(),s=l;var _=i.sqr().add(o.sqr());return a.sqr().add(s.sqr()).cmp(_)>=0&&(a=t,s=n),i.negative&&(i=i.neg(),o=o.neg()),a.negative&&(a=a.neg(),s=s.neg()),[{a:i,b:o},{a:a,b:s}]},u.prototype._endoSplit=function(e){var t=this.endo.basis,n=t[0],r=t[1],i=r.b.mul(e).divRound(this.n),o=n.b.neg().mul(e).divRound(this.n),a=i.mul(n.a),s=o.mul(r.a),u=i.mul(n.b),c=o.mul(r.b);return{k1:e.sub(a).sub(s),k2:u.add(c).neg()}},u.prototype.pointFromX=function(e,t){(e=new r(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(0!==i.redSqr().redSub(n).cmp(this.zero))throw new Error("invalid point");var o=i.fromRed().isOdd();return(t&&!o||!t&&o)&&(i=i.redNeg()),this.point(e,i)},u.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,n=e.y,r=this.a.redMul(t),i=t.redSqr().redMul(t).redIAdd(r).redIAdd(this.b);return 0===n.redSqr().redISub(i).cmpn(0)},u.prototype._endoWnafMulAdd=function(e,t,n){for(var r=this._endoWnafT1,i=this._endoWnafT2,o=0;o<e.length;o++){var a=this._endoSplit(t[o]),s=e[o],u=s._getBeta();a.k1.negative&&(a.k1.ineg(),s=s.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),r[2*o]=s,r[2*o+1]=u,i[2*o]=a.k1,i[2*o+1]=a.k2}for(var c=this._wnafMulAdd(1,r,i,2*o,n),l=0;l<2*o;l++)r[l]=null,i[l]=null;return c},i(c,a.BasePoint),u.prototype.point=function(e,t,n){return new c(this,e,t,n)},u.prototype.pointFromJSON=function(e,t){return c.fromJSON(this,e,t)},c.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,r=function(e){return n.point(e.x.redMul(n.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(r)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(r)}}}return t}},c.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},c.fromJSON=function(e,t,n){"string"==typeof t&&(t=JSON.parse(t));var r=e.point(t[0],t[1],n);if(!t[2])return r;function i(t){return e.point(t[0],t[1],n)}var o=t[2];return r.precomputed={beta:null,doubles:o.doubles&&{step:o.doubles.step,points:[r].concat(o.doubles.points.map(i))},naf:o.naf&&{wnd:o.naf.wnd,points:[r].concat(o.naf.points.map(i))}},r},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return this.inf},c.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var n=t.redSqr().redISub(this.x).redISub(e.x),r=t.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,r)},c.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,n=this.x.redSqr(),r=e.redInvm(),i=n.redAdd(n).redIAdd(n).redIAdd(t).redMul(r),o=i.redSqr().redISub(this.x.redAdd(this.x)),a=i.redMul(this.x.redSub(o)).redISub(this.y);return this.curve.point(o,a)},c.prototype.getX=function(){return this.x.fromRed()},c.prototype.getY=function(){return this.y.fromRed()},c.prototype.mul=function(e){return e=new r(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,n){var r=[this,t],i=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i):this.curve._wnafMulAdd(1,r,i,2)},c.prototype.jmulAdd=function(e,t,n){var r=[this,t],i=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(r,i,!0):this.curve._wnafMulAdd(1,r,i,2,!0)},c.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},c.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,r=function(e){return e.neg()};t.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(r)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(r)}}}return t},c.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},i(l,a.BasePoint),u.prototype.jpoint=function(e,t,n){return new l(this,e,t,n)},l.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),n=this.x.redMul(t),r=this.y.redMul(t).redMul(e);return this.curve.point(n,r)},l.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},l.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),n=this.z.redSqr(),r=this.x.redMul(t),i=e.x.redMul(n),o=this.y.redMul(t.redMul(e.z)),a=e.y.redMul(n.redMul(this.z)),s=r.redSub(i),u=o.redSub(a);if(0===s.cmpn(0))return 0!==u.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=s.redSqr(),l=c.redMul(s),f=r.redMul(c),h=u.redSqr().redIAdd(l).redISub(f).redISub(f),d=u.redMul(f.redISub(h)).redISub(o.redMul(l)),p=this.z.redMul(e.z).redMul(s);return this.curve.jpoint(h,d,p)},l.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),n=this.x,r=e.x.redMul(t),i=this.y,o=e.y.redMul(t).redMul(this.z),a=n.redSub(r),s=i.redSub(o);if(0===a.cmpn(0))return 0!==s.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),c=u.redMul(a),l=n.redMul(u),f=s.redSqr().redIAdd(c).redISub(l).redISub(l),h=s.redMul(l.redISub(f)).redISub(i.redMul(c)),d=this.z.redMul(a);return this.curve.jpoint(f,h,d)},l.prototype.dblp=function(e){if(0===e)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var t;if(this.curve.zeroA||this.curve.threeA){var n=this;for(t=0;t<e;t++)n=n.dbl();return n}var r=this.curve.a,i=this.curve.tinv,o=this.x,a=this.y,s=this.z,u=s.redSqr().redSqr(),c=a.redAdd(a);for(t=0;t<e;t++){var l=o.redSqr(),f=c.redSqr(),h=f.redSqr(),d=l.redAdd(l).redIAdd(l).redIAdd(r.redMul(u)),p=o.redMul(f),m=d.redSqr().redISub(p.redAdd(p)),y=p.redISub(m),g=d.redMul(y);g=g.redIAdd(g).redISub(h);var b=c.redMul(s);t+1<e&&(u=u.redMul(h)),o=m,s=b,c=g}return this.curve.jpoint(o,c.redMul(i),s)},l.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},l.prototype._zeroDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),a=this.x.redAdd(i).redSqr().redISub(r).redISub(o);a=a.redIAdd(a);var s=r.redAdd(r).redIAdd(r),u=s.redSqr().redISub(a).redISub(a),c=o.redIAdd(o);c=(c=c.redIAdd(c)).redIAdd(c),e=u,t=s.redMul(a.redISub(u)).redISub(c),n=this.y.redAdd(this.y)}else{var l=this.x.redSqr(),f=this.y.redSqr(),h=f.redSqr(),d=this.x.redAdd(f).redSqr().redISub(l).redISub(h);d=d.redIAdd(d);var p=l.redAdd(l).redIAdd(l),m=p.redSqr(),y=h.redIAdd(h);y=(y=y.redIAdd(y)).redIAdd(y),e=m.redISub(d).redISub(d),t=p.redMul(d.redISub(e)).redISub(y),n=(n=this.y.redMul(this.z)).redIAdd(n)}return this.curve.jpoint(e,t,n)},l.prototype._threeDbl=function(){var e,t,n;if(this.zOne){var r=this.x.redSqr(),i=this.y.redSqr(),o=i.redSqr(),a=this.x.redAdd(i).redSqr().redISub(r).redISub(o);a=a.redIAdd(a);var s=r.redAdd(r).redIAdd(r).redIAdd(this.curve.a),u=s.redSqr().redISub(a).redISub(a);e=u;var c=o.redIAdd(o);c=(c=c.redIAdd(c)).redIAdd(c),t=s.redMul(a.redISub(u)).redISub(c),n=this.y.redAdd(this.y)}else{var l=this.z.redSqr(),f=this.y.redSqr(),h=this.x.redMul(f),d=this.x.redSub(l).redMul(this.x.redAdd(l));d=d.redAdd(d).redIAdd(d);var p=h.redIAdd(h),m=(p=p.redIAdd(p)).redAdd(p);e=d.redSqr().redISub(m),n=this.y.redAdd(this.z).redSqr().redISub(f).redISub(l);var y=f.redSqr();y=(y=(y=y.redIAdd(y)).redIAdd(y)).redIAdd(y),t=d.redMul(p.redISub(e)).redISub(y)}return this.curve.jpoint(e,t,n)},l.prototype._dbl=function(){var e=this.curve.a,t=this.x,n=this.y,r=this.z,i=r.redSqr().redSqr(),o=t.redSqr(),a=n.redSqr(),s=o.redAdd(o).redIAdd(o).redIAdd(e.redMul(i)),u=t.redAdd(t),c=(u=u.redIAdd(u)).redMul(a),l=s.redSqr().redISub(c.redAdd(c)),f=c.redISub(l),h=a.redSqr();h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var d=s.redMul(f).redISub(h),p=n.redAdd(n).redMul(r);return this.curve.jpoint(l,d,p)},l.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr(),r=t.redSqr(),i=e.redAdd(e).redIAdd(e),o=i.redSqr(),a=this.x.redAdd(t).redSqr().redISub(e).redISub(r),s=(a=(a=(a=a.redIAdd(a)).redAdd(a).redIAdd(a)).redISub(o)).redSqr(),u=r.redIAdd(r);u=(u=(u=u.redIAdd(u)).redIAdd(u)).redIAdd(u);var c=i.redIAdd(a).redSqr().redISub(o).redISub(s).redISub(u),l=t.redMul(c);l=(l=l.redIAdd(l)).redIAdd(l);var f=this.x.redMul(s).redISub(l);f=(f=f.redIAdd(f)).redIAdd(f);var h=this.y.redMul(c.redMul(u.redISub(c)).redISub(a.redMul(s)));h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var d=this.z.redAdd(a).redSqr().redISub(n).redISub(s);return this.curve.jpoint(f,h,d)},l.prototype.mul=function(e,t){return e=new r(e,t),this.curve._wnafMul(this,e)},l.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),n=e.z.redSqr();if(0!==this.x.redMul(n).redISub(e.x.redMul(t)).cmpn(0))return!1;var r=t.redMul(this.z),i=n.redMul(e.z);return 0===this.y.redMul(i).redISub(e.y.redMul(r)).cmpn(0)},l.prototype.eqXToP=function(e){var t=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(n))return!0;for(var r=e.clone(),i=this.curve.redN.redMul(t);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(i),0===this.x.cmp(n))return!0}},l.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}})),o.register("1adNw",(function(e,t){var n=o("ks3fn"),r=o("9iXO2"),i=o("fQ4he"),a=o("enxev");function s(e){i.call(this,"mont",e),this.a=new n(e.a,16).toRed(this.red),this.b=new n(e.b,16).toRed(this.red),this.i4=new n(4).toRed(this.red).redInvm(),this.two=new n(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function u(e,t,r){i.BasePoint.call(this,e,"projective"),null===t&&null===r?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new n(t,16),this.z=new n(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}r(s,i),e.exports=s,s.prototype.validate=function(e){var t=e.normalize().x,n=t.redSqr(),r=n.redMul(t).redAdd(n.redMul(this.a)).redAdd(t);return 0===r.redSqrt().redSqr().cmp(r)},r(u,i.BasePoint),s.prototype.decodePoint=function(e,t){return this.point(a.toArray(e,t),1)},s.prototype.point=function(e,t){return new u(this,e,t)},s.prototype.pointFromJSON=function(e){return u.fromJSON(this,e)},u.prototype.precompute=function(){},u.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},u.fromJSON=function(e,t){return new u(e,t[0],t[1]||e.one)},u.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},u.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},u.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),n=e.redSub(t),r=e.redMul(t),i=n.redMul(t.redAdd(this.curve.a24.redMul(n)));return this.curve.point(r,i)},u.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.diffAdd=function(e,t){var n=this.x.redAdd(this.z),r=this.x.redSub(this.z),i=e.x.redAdd(e.z),o=e.x.redSub(e.z).redMul(n),a=i.redMul(r),s=t.z.redMul(o.redAdd(a).redSqr()),u=t.x.redMul(o.redISub(a).redSqr());return this.curve.point(s,u)},u.prototype.mul=function(e){for(var t=e.clone(),n=this,r=this.curve.point(null,null),i=[];0!==t.cmpn(0);t.iushrn(1))i.push(t.andln(1));for(var o=i.length-1;o>=0;o--)0===i[o]?(n=n.diffAdd(r,this),r=r.dbl()):(r=n.diffAdd(r,this),n=n.dbl());return r},u.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},u.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},u.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},u.prototype.getX=function(){return this.normalize(),this.x.fromRed()}})),o.register("aE4Qc",(function(e,t){var n=o("enxev"),r=o("ks3fn"),i=o("9iXO2"),a=o("fQ4he"),s=n.assert;function u(e){this.twisted=1!=(0|e.a),this.mOneA=this.twisted&&-1==(0|e.a),this.extended=this.mOneA,a.call(this,"edwards",e),this.a=new r(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new r(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new r(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),s(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|e.c)}function c(e,t,n,i,o){a.BasePoint.call(this,e,"projective"),null===t&&null===n&&null===i?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new r(t,16),this.y=new r(n,16),this.z=i?new r(i,16):this.curve.one,this.t=o&&new r(o,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}i(u,a),e.exports=u,u.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},u.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},u.prototype.jpoint=function(e,t,n,r){return this.point(e,t,n,r)},u.prototype.pointFromX=function(e,t){(e=new r(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr(),i=this.c2.redSub(this.a.redMul(n)),o=this.one.redSub(this.c2.redMul(this.d).redMul(n)),a=i.redMul(o.redInvm()),s=a.redSqrt();if(0!==s.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");var u=s.fromRed().isOdd();return(t&&!u||!t&&u)&&(s=s.redNeg()),this.point(e,s)},u.prototype.pointFromY=function(e,t){(e=new r(e,16)).red||(e=e.toRed(this.red));var n=e.redSqr(),i=n.redSub(this.c2),o=n.redMul(this.d).redMul(this.c2).redSub(this.a),a=i.redMul(o.redInvm());if(0===a.cmp(this.zero)){if(t)throw new Error("invalid point");return this.point(this.zero,e)}var s=a.redSqrt();if(0!==s.redSqr().redSub(a).cmp(this.zero))throw new Error("invalid point");return s.fromRed().isOdd()!==t&&(s=s.redNeg()),this.point(s,e)},u.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),n=e.y.redSqr(),r=t.redMul(this.a).redAdd(n),i=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(n)));return 0===r.cmp(i)},i(c,a.BasePoint),u.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},u.prototype.point=function(e,t,n,r){return new c(this,e,t,n,r)},c.fromJSON=function(e,t){return new c(e,t[0],t[1],t[2])},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},c.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var r=this.curve._mulA(e),i=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),o=r.redAdd(t),a=o.redSub(n),s=r.redSub(t),u=i.redMul(a),c=o.redMul(s),l=i.redMul(s),f=a.redMul(o);return this.curve.point(u,c,f,l)},c.prototype._projDbl=function(){var e,t,n,r,i,o,a=this.x.redAdd(this.y).redSqr(),s=this.x.redSqr(),u=this.y.redSqr();if(this.curve.twisted){var c=(r=this.curve._mulA(s)).redAdd(u);this.zOne?(e=a.redSub(s).redSub(u).redMul(c.redSub(this.curve.two)),t=c.redMul(r.redSub(u)),n=c.redSqr().redSub(c).redSub(c)):(i=this.z.redSqr(),o=c.redSub(i).redISub(i),e=a.redSub(s).redISub(u).redMul(o),t=c.redMul(r.redSub(u)),n=c.redMul(o))}else r=s.redAdd(u),i=this.curve._mulC(this.z).redSqr(),o=r.redSub(i).redSub(i),e=this.curve._mulC(a.redISub(r)).redMul(o),t=this.curve._mulC(r).redMul(s.redISub(u)),n=r.redMul(o);return this.curve.point(e,t,n)},c.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},c.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),r=this.t.redMul(this.curve.dd).redMul(e.t),i=this.z.redMul(e.z.redAdd(e.z)),o=n.redSub(t),a=i.redSub(r),s=i.redAdd(r),u=n.redAdd(t),c=o.redMul(a),l=s.redMul(u),f=o.redMul(u),h=a.redMul(s);return this.curve.point(c,l,h,f)},c.prototype._projAdd=function(e){var t,n,r=this.z.redMul(e.z),i=r.redSqr(),o=this.x.redMul(e.x),a=this.y.redMul(e.y),s=this.curve.d.redMul(o).redMul(a),u=i.redSub(s),c=i.redAdd(s),l=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(o).redISub(a),f=r.redMul(u).redMul(l);return this.curve.twisted?(t=r.redMul(c).redMul(a.redSub(this.curve._mulA(o))),n=u.redMul(c)):(t=r.redMul(c).redMul(a.redSub(o)),n=this.curve._mulC(u).redMul(c)),this.curve.point(f,t,n)},c.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},c.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},c.prototype.mulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!1)},c.prototype.jmulAdd=function(e,t,n){return this.curve._wnafMulAdd(1,[this,t],[e,n],2,!0)},c.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},c.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()},c.prototype.getY=function(){return this.normalize(),this.y.fromRed()},c.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},c.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var n=e.clone(),r=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(r),0===this.x.cmp(t))return!0}},c.prototype.toP=c.prototype.normalize,c.prototype.mixedAdd=c.prototype.add})),o.register("32azV",(function(e,t){var n,r=e.exports,i=o("4gvzO"),a=o("fxmhX"),s=o("enxev").assert;function u(e){"short"===e.type?this.curve=new a.short(e):"edwards"===e.type?this.curve=new a.edwards(e):this.curve=new a.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(e,t){Object.defineProperty(r,e,{configurable:!0,enumerable:!0,get:function(){var n=new u(t);return Object.defineProperty(r,e,{configurable:!0,enumerable:!0,value:n}),n}})}r.PresetCurve=u,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:i.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:i.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:i.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:i.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:i.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:i.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:i.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{n=o("cMpNM")}catch(e){n=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:i.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",n]})})),o.register("4gvzO",(function(e,t){var n=e.exports;n.utils=o("YBBPZ"),n.common=o("gE0ay"),n.sha=o("guWXR"),n.ripemd=o("2PbPy"),n.hmac=o("abuAX"),n.sha1=n.sha.sha1,n.sha256=n.sha.sha256,n.sha224=n.sha.sha224,n.sha384=n.sha.sha384,n.sha512=n.sha.sha512,n.ripemd160=n.ripemd.ripemd160})),o.register("YBBPZ",(function(t,n){var r,i,a,s,u,c,l,f,h,d,p,m,y,g,b,v,w,_,E,S,x,T,M,A,R,I;e(t.exports,"inherits",(()=>r),(e=>r=e)),e(t.exports,"toArray",(()=>i),(e=>i=e)),e(t.exports,"toHex",(()=>a),(e=>a=e)),e(t.exports,"htonl",(()=>s),(e=>s=e)),e(t.exports,"toHex32",(()=>u),(e=>u=e)),e(t.exports,"zero2",(()=>c),(e=>c=e)),e(t.exports,"zero8",(()=>l),(e=>l=e)),e(t.exports,"join32",(()=>f),(e=>f=e)),e(t.exports,"split32",(()=>h),(e=>h=e)),e(t.exports,"rotr32",(()=>d),(e=>d=e)),e(t.exports,"rotl32",(()=>p),(e=>p=e)),e(t.exports,"sum32",(()=>m),(e=>m=e)),e(t.exports,"sum32_3",(()=>y),(e=>y=e)),e(t.exports,"sum32_4",(()=>g),(e=>g=e)),e(t.exports,"sum32_5",(()=>b),(e=>b=e)),e(t.exports,"sum64",(()=>v),(e=>v=e)),e(t.exports,"sum64_hi",(()=>w),(e=>w=e)),e(t.exports,"sum64_lo",(()=>_),(e=>_=e)),e(t.exports,"sum64_4_hi",(()=>E),(e=>E=e)),e(t.exports,"sum64_4_lo",(()=>S),(e=>S=e)),e(t.exports,"sum64_5_hi",(()=>x),(e=>x=e)),e(t.exports,"sum64_5_lo",(()=>T),(e=>T=e)),e(t.exports,"rotr64_hi",(()=>M),(e=>M=e)),e(t.exports,"rotr64_lo",(()=>A),(e=>A=e)),e(t.exports,"shr64_hi",(()=>R),(e=>R=e)),e(t.exports,"shr64_lo",(()=>I),(e=>I=e));var P=o("b8dAq"),N=o("9iXO2");function O(e,t){return 55296==(64512&e.charCodeAt(t))&&(!(t<0||t+1>=e.length)&&56320==(64512&e.charCodeAt(t+1)))}function C(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function k(e){return 1===e.length?"0"+e:e}function B(e){return 7===e.length?"0"+e:6===e.length?"00"+e:5===e.length?"000"+e:4===e.length?"0000"+e:3===e.length?"00000"+e:2===e.length?"000000"+e:1===e.length?"0000000"+e:e}r=N,i=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var n=[];if("string"==typeof e)if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(e="0"+e),i=0;i<e.length;i+=2)n.push(parseInt(e[i]+e[i+1],16))}else for(var r=0,i=0;i<e.length;i++){var o=e.charCodeAt(i);o<128?n[r++]=o:o<2048?(n[r++]=o>>6|192,n[r++]=63&o|128):O(e,i)?(o=65536+((1023&o)<<10)+(1023&e.charCodeAt(++i)),n[r++]=o>>18|240,n[r++]=o>>12&63|128,n[r++]=o>>6&63|128,n[r++]=63&o|128):(n[r++]=o>>12|224,n[r++]=o>>6&63|128,n[r++]=63&o|128)}else for(i=0;i<e.length;i++)n[i]=0|e[i];return n},a=function(e){for(var t="",n=0;n<e.length;n++)t+=k(e[n].toString(16));return t},s=C,u=function(e,t){for(var n="",r=0;r<e.length;r++){var i=e[r];"little"===t&&(i=C(i)),n+=B(i.toString(16))}return n},c=k,l=B,f=function(e,t,n,r){var i=n-t;P(i%4==0);for(var o=new Array(i/4),a=0,s=t;a<o.length;a++,s+=4){var u;u="big"===r?e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3]:e[s+3]<<24|e[s+2]<<16|e[s+1]<<8|e[s],o[a]=u>>>0}return o},h=function(e,t){for(var n=new Array(4*e.length),r=0,i=0;r<e.length;r++,i+=4){var o=e[r];"big"===t?(n[i]=o>>>24,n[i+1]=o>>>16&255,n[i+2]=o>>>8&255,n[i+3]=255&o):(n[i+3]=o>>>24,n[i+2]=o>>>16&255,n[i+1]=o>>>8&255,n[i]=255&o)}return n},d=function(e,t){return e>>>t|e<<32-t},p=function(e,t){return e<<t|e>>>32-t},m=function(e,t){return e+t>>>0},y=function(e,t,n){return e+t+n>>>0},g=function(e,t,n,r){return e+t+n+r>>>0},b=function(e,t,n,r,i){return e+t+n+r+i>>>0},v=function(e,t,n,r){var i=e[t],o=r+e[t+1]>>>0,a=(o<r?1:0)+n+i;e[t]=a>>>0,e[t+1]=o},w=function(e,t,n,r){return(t+r>>>0<t?1:0)+e+n>>>0},_=function(e,t,n,r){return t+r>>>0},E=function(e,t,n,r,i,o,a,s){var u=0,c=t;return u+=(c=c+r>>>0)<t?1:0,u+=(c=c+o>>>0)<o?1:0,e+n+i+a+(u+=(c=c+s>>>0)<s?1:0)>>>0},S=function(e,t,n,r,i,o,a,s){return t+r+o+s>>>0},x=function(e,t,n,r,i,o,a,s,u,c){var l=0,f=t;return l+=(f=f+r>>>0)<t?1:0,l+=(f=f+o>>>0)<o?1:0,l+=(f=f+s>>>0)<s?1:0,e+n+i+a+u+(l+=(f=f+c>>>0)<c?1:0)>>>0},T=function(e,t,n,r,i,o,a,s,u,c){return t+r+o+s+c>>>0},M=function(e,t,n){return(t<<32-n|e>>>n)>>>0},A=function(e,t,n){return(e<<32-n|t>>>n)>>>0},R=function(e,t,n){return e>>>n},I=function(e,t,n){return(e<<32-n|t>>>n)>>>0}})),o.register("gE0ay",(function(t,n){var r;e(t.exports,"BlockHash",(()=>r),(e=>r=e));var i=o("YBBPZ"),a=o("b8dAq");function s(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}r=s,s.prototype.update=function(e,t){if(e=i.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var n=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-n,e.length),0===this.pending.length&&(this.pending=null),e=i.join32(e,0,e.length-n,this.endian);for(var r=0;r<e.length;r+=this._delta32)this._update(e,r,r+this._delta32)}return this},s.prototype.digest=function(e){return this.update(this._pad()),a(null===this.pending),this._digest(e)},s.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,n=t-(e+this.padLength)%t,r=new Array(n+this.padLength);r[0]=128;for(var i=1;i<n;i++)r[i]=0;if(e<<=3,"big"===this.endian){for(var o=8;o<this.padLength;o++)r[i++]=0;r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=e>>>24&255,r[i++]=e>>>16&255,r[i++]=e>>>8&255,r[i++]=255&e}else for(r[i++]=255&e,r[i++]=e>>>8&255,r[i++]=e>>>16&255,r[i++]=e>>>24&255,r[i++]=0,r[i++]=0,r[i++]=0,r[i++]=0,o=8;o<this.padLength;o++)r[i++]=0;return r}})),o.register("guWXR",(function(t,n){var r,i,a,s,u;e(t.exports,"sha1",(()=>r),(e=>r=e)),e(t.exports,"sha224",(()=>i),(e=>i=e)),e(t.exports,"sha256",(()=>a),(e=>a=e)),e(t.exports,"sha384",(()=>s),(e=>s=e)),e(t.exports,"sha512",(()=>u),(e=>u=e)),r=o("gZLkN"),i=o("fLbcH"),a=o("wN9xK"),s=o("8tteK"),u=o("7rorf")})),o.register("gZLkN",(function(e,t){var n=o("YBBPZ"),r=o("gE0ay"),i=o("2WH92"),a=n.rotl32,s=n.sum32,u=n.sum32_5,c=i.ft_1,l=r.BlockHash,f=[1518500249,1859775393,2400959708,3395469782];function h(){if(!(this instanceof h))return new h;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}n.inherits(h,l),e.exports=h,h.blockSize=512,h.outSize=160,h.hmacStrength=80,h.padLength=64,h.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=a(n[r-3]^n[r-8]^n[r-14]^n[r-16],1);var i=this.h[0],o=this.h[1],l=this.h[2],h=this.h[3],d=this.h[4];for(r=0;r<n.length;r++){var p=~~(r/20),m=u(a(i,5),c(p,o,l,h),d,n[r],f[p]);d=h,h=l,l=a(o,30),o=i,i=m}this.h[0]=s(this.h[0],i),this.h[1]=s(this.h[1],o),this.h[2]=s(this.h[2],l),this.h[3]=s(this.h[3],h),this.h[4]=s(this.h[4],d)},h.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}})),o.register("2WH92",(function(t,n){var r,i,a,s,u,c,l;e(t.exports,"ft_1",(()=>r),(e=>r=e)),e(t.exports,"ch32",(()=>i),(e=>i=e)),e(t.exports,"maj32",(()=>a),(e=>a=e)),e(t.exports,"s0_256",(()=>s),(e=>s=e)),e(t.exports,"s1_256",(()=>u),(e=>u=e)),e(t.exports,"g0_256",(()=>c),(e=>c=e)),e(t.exports,"g1_256",(()=>l),(e=>l=e));var f=o("YBBPZ").rotr32;function h(e,t,n){return e&t^~e&n}function d(e,t,n){return e&t^e&n^t&n}function p(e,t,n){return e^t^n}r=function(e,t,n,r){return 0===e?h(t,n,r):1===e||3===e?p(t,n,r):2===e?d(t,n,r):void 0},i=h,a=d,s=function(e){return f(e,2)^f(e,13)^f(e,22)},u=function(e){return f(e,6)^f(e,11)^f(e,25)},c=function(e){return f(e,7)^f(e,18)^e>>>3},l=function(e){return f(e,17)^f(e,19)^e>>>10}})),o.register("fLbcH",(function(e,t){var n=o("YBBPZ"),r=o("wN9xK");function i(){if(!(this instanceof i))return new i;r.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}n.inherits(i,r),e.exports=i,i.blockSize=512,i.outSize=224,i.hmacStrength=192,i.padLength=64,i.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,7),"big"):n.split32(this.h.slice(0,7),"big")}})),o.register("wN9xK",(function(e,t){var n=o("YBBPZ"),r=o("gE0ay"),i=o("2WH92"),a=o("b8dAq"),s=n.sum32,u=n.sum32_4,c=n.sum32_5,l=i.ch32,f=i.maj32,h=i.s0_256,d=i.s1_256,p=i.g0_256,m=i.g1_256,y=r.BlockHash,g=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function b(){if(!(this instanceof b))return new b;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=g,this.W=new Array(64)}n.inherits(b,y),e.exports=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(e,t){for(var n=this.W,r=0;r<16;r++)n[r]=e[t+r];for(;r<n.length;r++)n[r]=u(m(n[r-2]),n[r-7],p(n[r-15]),n[r-16]);var i=this.h[0],o=this.h[1],y=this.h[2],g=this.h[3],b=this.h[4],v=this.h[5],w=this.h[6],_=this.h[7];for(a(this.k.length===n.length),r=0;r<n.length;r++){var E=c(_,d(b),l(b,v,w),this.k[r],n[r]),S=s(h(i),f(i,o,y));_=w,w=v,v=b,b=s(g,E),g=y,y=o,o=i,i=s(E,S)}this.h[0]=s(this.h[0],i),this.h[1]=s(this.h[1],o),this.h[2]=s(this.h[2],y),this.h[3]=s(this.h[3],g),this.h[4]=s(this.h[4],b),this.h[5]=s(this.h[5],v),this.h[6]=s(this.h[6],w),this.h[7]=s(this.h[7],_)},b.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}})),o.register("8tteK",(function(e,t){var n=o("YBBPZ"),r=o("7rorf");function i(){if(!(this instanceof i))return new i;r.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}n.inherits(i,r),e.exports=i,i.blockSize=1024,i.outSize=384,i.hmacStrength=192,i.padLength=128,i.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h.slice(0,12),"big"):n.split32(this.h.slice(0,12),"big")}})),o.register("7rorf",(function(e,t){var n=o("YBBPZ"),r=o("gE0ay"),i=o("b8dAq"),a=n.rotr64_hi,s=n.rotr64_lo,u=n.shr64_hi,c=n.shr64_lo,l=n.sum64,f=n.sum64_hi,h=n.sum64_lo,d=n.sum64_4_hi,p=n.sum64_4_lo,m=n.sum64_5_hi,y=n.sum64_5_lo,g=r.BlockHash,b=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function v(){if(!(this instanceof v))return new v;g.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=b,this.W=new Array(160)}function w(e,t,n,r,i){var o=e&n^~e&i;return o<0&&(o+=4294967296),o}function _(e,t,n,r,i,o){var a=t&r^~t&o;return a<0&&(a+=4294967296),a}function E(e,t,n,r,i){var o=e&n^e&i^n&i;return o<0&&(o+=4294967296),o}function S(e,t,n,r,i,o){var a=t&r^t&o^r&o;return a<0&&(a+=4294967296),a}function x(e,t){var n=a(e,t,28)^a(t,e,2)^a(t,e,7);return n<0&&(n+=4294967296),n}function T(e,t){var n=s(e,t,28)^s(t,e,2)^s(t,e,7);return n<0&&(n+=4294967296),n}function M(e,t){var n=a(e,t,14)^a(e,t,18)^a(t,e,9);return n<0&&(n+=4294967296),n}function A(e,t){var n=s(e,t,14)^s(e,t,18)^s(t,e,9);return n<0&&(n+=4294967296),n}function R(e,t){var n=a(e,t,1)^a(e,t,8)^u(e,t,7);return n<0&&(n+=4294967296),n}function I(e,t){var n=s(e,t,1)^s(e,t,8)^c(e,t,7);return n<0&&(n+=4294967296),n}function P(e,t){var n=a(e,t,19)^a(t,e,29)^u(e,t,6);return n<0&&(n+=4294967296),n}function N(e,t){var n=s(e,t,19)^s(t,e,29)^c(e,t,6);return n<0&&(n+=4294967296),n}n.inherits(v,g),e.exports=v,v.blockSize=1024,v.outSize=512,v.hmacStrength=192,v.padLength=128,v.prototype._prepareBlock=function(e,t){for(var n=this.W,r=0;r<32;r++)n[r]=e[t+r];for(;r<n.length;r+=2){var i=P(n[r-4],n[r-3]),o=N(n[r-4],n[r-3]),a=n[r-14],s=n[r-13],u=R(n[r-30],n[r-29]),c=I(n[r-30],n[r-29]),l=n[r-32],f=n[r-31];n[r]=d(i,o,a,s,u,c,l,f),n[r+1]=p(i,o,a,s,u,c,l,f)}},v.prototype._update=function(e,t){this._prepareBlock(e,t);var n=this.W,r=this.h[0],o=this.h[1],a=this.h[2],s=this.h[3],u=this.h[4],c=this.h[5],d=this.h[6],p=this.h[7],g=this.h[8],b=this.h[9],v=this.h[10],R=this.h[11],I=this.h[12],P=this.h[13],N=this.h[14],O=this.h[15];i(this.k.length===n.length);for(var C=0;C<n.length;C+=2){var k=N,B=O,D=M(g,b),j=A(g,b),L=w(g,b,v,R,I),q=_(g,b,v,R,I,P),U=this.k[C],F=this.k[C+1],K=n[C],V=n[C+1],z=m(k,B,D,j,L,q,U,F,K,V),W=y(k,B,D,j,L,q,U,F,K,V);k=x(r,o),B=T(r,o),D=E(r,o,a,s,u),j=S(r,o,a,s,u,c);var H=f(k,B,D,j),G=h(k,B,D,j);N=I,O=P,I=v,P=R,v=g,R=b,g=f(d,p,z,W),b=h(p,p,z,W),d=u,p=c,u=a,c=s,a=r,s=o,r=f(z,W,H,G),o=h(z,W,H,G)}l(this.h,0,r,o),l(this.h,2,a,s),l(this.h,4,u,c),l(this.h,6,d,p),l(this.h,8,g,b),l(this.h,10,v,R),l(this.h,12,I,P),l(this.h,14,N,O)},v.prototype._digest=function(e){return"hex"===e?n.toHex32(this.h,"big"):n.split32(this.h,"big")}})),o.register("2PbPy",(function(t,n){var r;e(t.exports,"ripemd160",(()=>r),(e=>r=e));var i=o("YBBPZ"),a=o("gE0ay"),s=i.rotl32,u=i.sum32,c=i.sum32_3,l=i.sum32_4,f=a.BlockHash;function h(){if(!(this instanceof h))return new h;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function d(e,t,n,r){return e<=15?t^n^r:e<=31?t&n|~t&r:e<=47?(t|~n)^r:e<=63?t&r|n&~r:t^(n|~r)}function p(e){return e<=15?0:e<=31?1518500249:e<=47?1859775393:e<=63?2400959708:2840853838}function m(e){return e<=15?1352829926:e<=31?1548603684:e<=47?1836072691:e<=63?2053994217:0}i.inherits(h,f),r=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(e,t){for(var n=this.h[0],r=this.h[1],i=this.h[2],o=this.h[3],a=this.h[4],f=n,h=r,w=i,_=o,E=a,S=0;S<80;S++){var x=u(s(l(n,d(S,r,i,o),e[y[S]+t],p(S)),b[S]),a);n=a,a=o,o=s(i,10),i=r,r=x,x=u(s(l(f,d(79-S,h,w,_),e[g[S]+t],m(S)),v[S]),E),f=E,E=_,_=s(w,10),w=h,h=x}x=c(this.h[1],i,_),this.h[1]=c(this.h[2],o,E),this.h[2]=c(this.h[3],a,f),this.h[3]=c(this.h[4],n,h),this.h[4]=c(this.h[0],r,w),this.h[0]=x},h.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var y=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],g=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],b=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],v=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]})),o.register("abuAX",(function(e,t){var n=o("YBBPZ"),r=o("b8dAq");function i(e,t,r){if(!(this instanceof i))return new i(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(n.toArray(t,r))}e.exports=i,i.prototype._init=function(e){e.length>this.blockSize&&(e=(new this.Hash).update(e).digest()),r(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(this.inner=(new this.Hash).update(e),t=0;t<e.length;t++)e[t]^=106;this.outer=(new this.Hash).update(e)},i.prototype.update=function(e,t){return this.inner.update(e,t),this},i.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}})),o.register("cMpNM",(function(e,t){e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}})),o.register("f7iqf",(function(e,t){var n=o("ks3fn"),r=o("9jPCc"),i=o("enxev"),a=o("32azV"),s=o("15okD"),u=i.assert,c=o("dWfTq"),l=o("5Aiub");function f(e){if(!(this instanceof f))return new f(e);"string"==typeof e&&(u(Object.prototype.hasOwnProperty.call(a,e),"Unknown curve "+e),e=a[e]),e instanceof a.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=f,f.prototype.keyPair=function(e){return new c(this,e)},f.prototype.keyFromPrivate=function(e,t){return c.fromPrivate(this,e,t)},f.prototype.keyFromPublic=function(e,t){return c.fromPublic(this,e,t)},f.prototype.genKeyPair=function(e){e||(e={});for(var t=new r({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||s(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),o=this.n.sub(new n(2));;){var a=new n(t.generate(i));if(!(a.cmp(o)>0))return a.iaddn(1),this.keyFromPrivate(a)}},f.prototype._truncateToN=function(e,t){var n=8*e.byteLength()-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!t&&e.cmp(this.n)>=0?e.sub(this.n):e},f.prototype.sign=function(e,t,i,o){"object"==typeof i&&(o=i,i=null),o||(o={}),t=this.keyFromPrivate(t,i),e=this._truncateToN(new n(e,16));for(var a=this.n.byteLength(),s=t.getPrivate().toArray("be",a),u=e.toArray("be",a),c=new r({hash:this.hash,entropy:s,nonce:u,pers:o.pers,persEnc:o.persEnc||"utf8"}),f=this.n.sub(new n(1)),h=0;;h++){var d=o.k?o.k(h):new n(c.generate(this.n.byteLength()));if(!((d=this._truncateToN(d,!0)).cmpn(1)<=0||d.cmp(f)>=0)){var p=this.g.mul(d);if(!p.isInfinity()){var m=p.getX(),y=m.umod(this.n);if(0!==y.cmpn(0)){var g=d.invm(this.n).mul(y.mul(t.getPrivate()).iadd(e));if(0!==(g=g.umod(this.n)).cmpn(0)){var b=(p.getY().isOdd()?1:0)|(0!==m.cmp(y)?2:0);return o.canonical&&g.cmp(this.nh)>0&&(g=this.n.sub(g),b^=1),new l({r:y,s:g,recoveryParam:b})}}}}}},f.prototype.verify=function(e,t,r,i){e=this._truncateToN(new n(e,16)),r=this.keyFromPublic(r,i);var o=(t=new l(t,"hex")).r,a=t.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;if(a.cmpn(1)<0||a.cmp(this.n)>=0)return!1;var s,u=a.invm(this.n),c=u.mul(e).umod(this.n),f=u.mul(o).umod(this.n);return this.curve._maxwellTrick?!(s=this.g.jmulAdd(c,r.getPublic(),f)).isInfinity()&&s.eqXToP(o):!(s=this.g.mulAdd(c,r.getPublic(),f)).isInfinity()&&0===s.getX().umod(this.n).cmp(o)},f.prototype.recoverPubKey=function(e,t,r,i){u((3&r)===r,"The recovery param is more than two bits"),t=new l(t,i);var o=this.n,a=new n(e),s=t.r,c=t.s,f=1&r,h=r>>1;if(s.cmp(this.curve.p.umod(this.curve.n))>=0&&h)throw new Error("Unable to find sencond key candinate");s=h?this.curve.pointFromX(s.add(this.curve.n),f):this.curve.pointFromX(s,f);var d=t.r.invm(o),p=o.sub(a).mul(d).umod(o),m=c.mul(d).umod(o);return this.g.mulAdd(p,s,m)},f.prototype.getKeyRecoveryParam=function(e,t,n,r){if(null!==(t=new l(t,r)).recoveryParam)return t.recoveryParam;for(var i=0;i<4;i++){var o;try{o=this.recoverPubKey(e,t,i)}catch(e){continue}if(o.eq(n))return i}throw new Error("Unable to find valid recovery factor")}})),o.register("9jPCc",(function(e,t){var n=o("4gvzO"),r=o("jeqpy"),i=o("b8dAq");function a(e){if(!(this instanceof a))return new a(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=r.toArray(e.entropy,e.entropyEnc||"hex"),n=r.toArray(e.nonce,e.nonceEnc||"hex"),o=r.toArray(e.pers,e.persEnc||"hex");i(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,n,o)}e.exports=a,a.prototype._init=function(e,t,n){var r=e.concat(t).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var i=0;i<this.V.length;i++)this.K[i]=0,this.V[i]=1;this._update(r),this._reseed=1,this.reseedInterval=281474976710656},a.prototype._hmac=function(){return new n.hmac(this.hash,this.K)},a.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},a.prototype.reseed=function(e,t,n,o){"string"!=typeof t&&(o=n,n=t,t=null),e=r.toArray(e,t),n=r.toArray(n,o),i(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1},a.prototype.generate=function(e,t,n,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof t&&(i=n,n=t,t=null),n&&(n=r.toArray(n,i||"hex"),this._update(n));for(var o=[];o.length<e;)this.V=this._hmac().update(this.V).digest(),o=o.concat(this.V);var a=o.slice(0,e);return this._update(n),this._reseed++,r.encode(a,t)}})),o.register("dWfTq",(function(e,t){var n=o("ks3fn"),r=o("enxev").assert;function i(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=i,i.fromPublic=function(e,t,n){return t instanceof i?t:new i(e,{pub:t,pubEnc:n})},i.fromPrivate=function(e,t,n){return t instanceof i?t:new i(e,{priv:t,privEnc:n})},i.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},i.prototype.getPublic=function(e,t){return"string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t?this.pub.encode(t,e):this.pub},i.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},i.prototype._importPrivate=function(e,t){this.priv=new n(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},i.prototype._importPublic=function(e,t){if(e.x||e.y)return"mont"===this.ec.curve.type?r(e.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||r(e.x&&e.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(e.x,e.y));this.pub=this.ec.curve.decodePoint(e,t)},i.prototype.derive=function(e){return e.validate()||r(e.validate(),"public point not validated"),e.mul(this.priv).getX()},i.prototype.sign=function(e,t,n){return this.ec.sign(e,this,t,n)},i.prototype.verify=function(e,t){return this.ec.verify(e,t,this)},i.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}})),o.register("5Aiub",(function(e,t){var n=o("ks3fn"),r=o("enxev"),i=r.assert;function a(e,t){if(e instanceof a)return e;this._importDER(e,t)||(i(e.r&&e.s,"Signature without r or s"),this.r=new n(e.r,16),this.s=new n(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function s(){this.place=0}function u(e,t){var n=e[t.place++];if(!(128&n))return n;var r=15&n;if(0===r||r>4)return!1;for(var i=0,o=0,a=t.place;o<r;o++,a++)i<<=8,i|=e[a],i>>>=0;return!(i<=127)&&(t.place=a,i)}function c(e){for(var t=0,n=e.length-1;!e[t]&&!(128&e[t+1])&&t<n;)t++;return 0===t?e:e.slice(t)}function l(e,t){if(t<128)e.push(t);else{var n=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|n);--n;)e.push(t>>>(n<<3)&255);e.push(t)}}e.exports=a,a.prototype._importDER=function(e,t){e=r.toArray(e,t);var i=new s;if(48!==e[i.place++])return!1;var o=u(e,i);if(!1===o)return!1;if(o+i.place!==e.length)return!1;if(2!==e[i.place++])return!1;var a=u(e,i);if(!1===a)return!1;var c=e.slice(i.place,a+i.place);if(i.place+=a,2!==e[i.place++])return!1;var l=u(e,i);if(!1===l)return!1;if(e.length!==l+i.place)return!1;var f=e.slice(i.place,l+i.place);if(0===c[0]){if(!(128&c[1]))return!1;c=c.slice(1)}if(0===f[0]){if(!(128&f[1]))return!1;f=f.slice(1)}return this.r=new n(c),this.s=new n(f),this.recoveryParam=null,!0},a.prototype.toDER=function(e){var t=this.r.toArray(),n=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&n[0]&&(n=[0].concat(n)),t=c(t),n=c(n);!(n[0]||128&n[1]);)n=n.slice(1);var i=[2];l(i,t.length),(i=i.concat(t)).push(2),l(i,n.length);var o=i.concat(n),a=[48];return l(a,o.length),a=a.concat(o),r.encode(a,e)}})),o.register("jy9b2",(function(e,t){var n=o("4gvzO"),r=o("32azV"),i=o("enxev"),a=i.assert,s=i.parseBytes,u=o("foNv7"),c=o("5PS3k");function l(e){if(a("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof l))return new l(e);e=r[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=n.sha512}e.exports=l,l.prototype.sign=function(e,t){e=s(e);var n=this.keyFromSecret(t),r=this.hashInt(n.messagePrefix(),e),i=this.g.mul(r),o=this.encodePoint(i),a=this.hashInt(o,n.pubBytes(),e).mul(n.priv()),u=r.add(a).umod(this.curve.n);return this.makeSignature({R:i,S:u,Rencoded:o})},l.prototype.verify=function(e,t,n){e=s(e),t=this.makeSignature(t);var r=this.keyFromPublic(n),i=this.hashInt(t.Rencoded(),r.pubBytes(),e),o=this.g.mul(t.S());return t.R().add(r.pub().mul(i)).eq(o)},l.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return i.intFromLE(e.digest()).umod(this.curve.n)},l.prototype.keyFromPublic=function(e){return u.fromPublic(this,e)},l.prototype.keyFromSecret=function(e){return u.fromSecret(this,e)},l.prototype.makeSignature=function(e){return e instanceof c?e:new c(this,e)},l.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},l.prototype.decodePoint=function(e){var t=(e=i.parseBytes(e)).length-1,n=e.slice(0,t).concat(-129&e[t]),r=0!=(128&e[t]),o=i.intFromLE(n);return this.curve.pointFromY(o,r)},l.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},l.prototype.decodeInt=function(e){return i.intFromLE(e)},l.prototype.isPoint=function(e){return e instanceof this.pointClass}})),o.register("foNv7",(function(e,t){var n=o("enxev"),r=n.assert,i=n.parseBytes,a=n.cachedProperty;function s(e,t){this.eddsa=e,this._secret=i(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=i(t.pub)}s.fromPublic=function(e,t){return t instanceof s?t:new s(e,{pub:t})},s.fromSecret=function(e,t){return t instanceof s?t:new s(e,{secret:t})},s.prototype.secret=function(){return this._secret},a(s,"pubBytes",(function(){return this.eddsa.encodePoint(this.pub())})),a(s,"pub",(function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())})),a(s,"privBytes",(function(){var e=this.eddsa,t=this.hash(),n=e.encodingLength-1,r=t.slice(0,e.encodingLength);return r[0]&=248,r[n]&=127,r[n]|=64,r})),a(s,"priv",(function(){return this.eddsa.decodeInt(this.privBytes())})),a(s,"hash",(function(){return this.eddsa.hash().update(this.secret()).digest()})),a(s,"messagePrefix",(function(){return this.hash().slice(this.eddsa.encodingLength)})),s.prototype.sign=function(e){return r(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},s.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},s.prototype.getSecret=function(e){return r(this._secret,"KeyPair is public only"),n.encode(this.secret(),e)},s.prototype.getPublic=function(e){return n.encode(this.pubBytes(),e)},e.exports=s})),o.register("5PS3k",(function(e,t){var n=o("ks3fn"),r=o("enxev"),i=r.assert,a=r.cachedProperty,s=r.parseBytes;function u(e,t){this.eddsa=e,"object"!=typeof t&&(t=s(t)),Array.isArray(t)&&(t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),i(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof n&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}a(u,"S",(function(){return this.eddsa.decodeInt(this.Sencoded())})),a(u,"R",(function(){return this.eddsa.decodePoint(this.Rencoded())})),a(u,"Rencoded",(function(){return this.eddsa.encodePoint(this.R())})),a(u,"Sencoded",(function(){return this.eddsa.encodeInt(this.S())})),u.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},u.prototype.toHex=function(){return r.encode(this.toBytes(),"hex").toUpperCase()},e.exports=u})),o.register("1kdEK",(function(e,t){!function(e,t){function n(e,t){if(!e)throw new Error(t||"Assertion failed")}function r(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}function i(e,t,n){if(i.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&("le"!==t&&"be"!==t||(n=t,t=10),this._init(e||0,t||10,n||"be"))}var a;"object"==typeof e?e.exports=i:t.BN=i,i.BN=i,i.wordSize=26;try{a="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:o("kOtop").Buffer}catch(e){}function s(e,t){var r=e.charCodeAt(t);return r>=48&&r<=57?r-48:r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:void n(!1,"Invalid character in "+e)}function u(e,t,n){var r=s(e,n);return n-1>=t&&(r|=s(e,n-1)<<4),r}function c(e,t,r,i){for(var o=0,a=0,s=Math.min(e.length,r),u=t;u<s;u++){var c=e.charCodeAt(u)-48;o*=i,a=c>=49?c-49+10:c>=17?c-17+10:c,n(c>=0&&a<i,"Invalid character"),o+=a}return o}function l(e,t){e.words=t.words,e.length=t.length,e.negative=t.negative,e.red=t.red}if(i.isBN=function(e){return e instanceof i||null!==e&&"object"==typeof e&&e.constructor.wordSize===i.wordSize&&Array.isArray(e.words)},i.max=function(e,t){return e.cmp(t)>0?e:t},i.min=function(e,t){return e.cmp(t)<0?e:t},i.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),n(t===(0|t)&&t>=2&&t<=36);var i=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(i++,this.negative=1),i<e.length&&(16===t?this._parseHex(e,i,r):(this._parseBase(e,t,i),"le"===r&&this._initArray(this.toArray(),t,r)))},i.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(n(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},i.prototype._initArray=function(e,t,r){if(n("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var o,a,s=0;if("be"===r)for(i=e.length-1,o=0;i>=0;i-=3)a=e[i]|e[i-1]<<8|e[i-2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);else if("le"===r)for(i=0,o=0;i<e.length;i+=3)a=e[i]|e[i+1]<<8|e[i+2]<<16,this.words[o]|=a<<s&67108863,this.words[o+1]=a>>>26-s&67108863,(s+=24)>=26&&(s-=26,o++);return this._strip()},i.prototype._parseHex=function(e,t,n){this.length=Math.ceil((e.length-t)/6),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var i,o=0,a=0;if("be"===n)for(r=e.length-1;r>=t;r-=2)i=u(e,t,r)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;else for(r=(e.length-t)%2==0?t+1:t;r<e.length;r+=2)i=u(e,t,r)<<o,this.words[a]|=67108863&i,o>=18?(o-=18,a+=1,this.words[a]|=i>>>26):o+=8;this._strip()},i.prototype._parseBase=function(e,t,n){this.words=[0],this.length=1;for(var r=0,i=1;i<=67108863;i*=t)r++;r--,i=i/t|0;for(var o=e.length-n,a=o%r,s=Math.min(o,o-a)+n,u=0,l=n;l<s;l+=r)u=c(e,l,l+r,t),this.imuln(i),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u);if(0!==a){var f=1;for(u=c(e,l,e.length,t),l=0;l<a;l++)f*=t;this.imuln(f),this.words[0]+u<67108864?this.words[0]+=u:this._iaddn(u)}this._strip()},i.prototype.copy=function(e){e.words=new Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},i.prototype._move=function(e){l(e,this)},i.prototype.clone=function(){var e=new i(null);return this.copy(e),e},i.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},i.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=f}catch(e){i.prototype.inspect=f}else i.prototype.inspect=f;function f(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],d=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],p=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(e,t){var r;if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var i=0,o=0,a=0;a<this.length;a++){var s=this.words[a],u=(16777215&(s<<i|o)).toString(16);r=0!==(o=s>>>24-i&16777215)||a!==this.length-1?h[6-u.length]+u+r:u+r,(i+=2)>=26&&(i-=26,a--)}for(0!==o&&(r=o.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var c=d[e],l=p[e];r="";var f=this.clone();for(f.negative=0;!f.isZero();){var m=f.modrn(l).toString(e);r=(f=f.idivn(l)).isZero()?m+r:h[c-m.length]+m+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}n(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},i.prototype.toJSON=function(){return this.toString(16,2)},a&&(i.prototype.toBuffer=function(e,t){return this.toArrayLike(a,e,t)}),i.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)};function m(e,t,n){n.negative=t.negative^e.negative;var r=e.length+t.length|0;n.length=r,r=r-1|0;var i=0|e.words[0],o=0|t.words[0],a=i*o,s=67108863&a,u=a/67108864|0;n.words[0]=s;for(var c=1;c<r;c++){for(var l=u>>>26,f=67108863&u,h=Math.min(c,t.length-1),d=Math.max(0,c-e.length+1);d<=h;d++){var p=c-d|0;l+=(a=(i=0|e.words[p])*(o=0|t.words[d])+f)/67108864|0,f=67108863&a}n.words[c]=0|f,u=0|l}return 0!==u?n.words[c]=0|u:n.length--,n._strip()}i.prototype.toArrayLike=function(e,t,r){this._strip();var i=this.byteLength(),o=r||Math.max(1,i);n(i<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0");var a=function(e,t){return e.allocUnsafe?e.allocUnsafe(t):new e(t)}(e,o);return this["_toArrayLike"+("le"===t?"LE":"BE")](a,i),a},i.prototype._toArrayLikeLE=function(e,t){for(var n=0,r=0,i=0,o=0;i<this.length;i++){var a=this.words[i]<<o|r;e[n++]=255&a,n<e.length&&(e[n++]=a>>8&255),n<e.length&&(e[n++]=a>>16&255),6===o?(n<e.length&&(e[n++]=a>>24&255),r=0,o=0):(r=a>>>24,o+=2)}if(n<e.length)for(e[n++]=r;n<e.length;)e[n++]=0},i.prototype._toArrayLikeBE=function(e,t){for(var n=e.length-1,r=0,i=0,o=0;i<this.length;i++){var a=this.words[i]<<o|r;e[n--]=255&a,n>=0&&(e[n--]=a>>8&255),n>=0&&(e[n--]=a>>16&255),6===o?(n>=0&&(e[n--]=a>>24&255),r=0,o=0):(r=a>>>24,o+=2)}if(n>=0)for(e[n--]=r;n>=0;)e[n--]=0},Math.clz32?i.prototype._countBits=function(e){return 32-Math.clz32(e)}:i.prototype._countBits=function(e){var t=e,n=0;return t>=4096&&(n+=13,t>>>=13),t>=64&&(n+=7,t>>>=7),t>=8&&(n+=4,t>>>=4),t>=2&&(n+=2,t>>>=2),n+t},i.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,n=0;return 0==(8191&t)&&(n+=13,t>>>=13),0==(127&t)&&(n+=7,t>>>=7),0==(15&t)&&(n+=4,t>>>=4),0==(3&t)&&(n+=2,t>>>=2),0==(1&t)&&n++,n},i.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return 26*(this.length-1)+t},i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var n=this._zeroBits(this.words[t]);if(e+=n,26!==n)break}return e},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},i.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return 0!==this.negative},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this._strip()},i.prototype.ior=function(e){return n(0==(this.negative|e.negative)),this.iuor(e)},i.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},i.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},i.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var n=0;n<t.length;n++)this.words[n]=this.words[n]&e.words[n];return this.length=t.length,this._strip()},i.prototype.iand=function(e){return n(0==(this.negative|e.negative)),this.iuand(e)},i.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},i.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},i.prototype.iuxor=function(e){var t,n;this.length>e.length?(t=this,n=e):(t=e,n=this);for(var r=0;r<n.length;r++)this.words[r]=t.words[r]^n.words[r];if(this!==t)for(;r<t.length;r++)this.words[r]=t.words[r];return this.length=t.length,this._strip()},i.prototype.ixor=function(e){return n(0==(this.negative|e.negative)),this.iuxor(e)},i.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},i.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},i.prototype.inotn=function(e){n("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var i=0;i<t;i++)this.words[i]=67108863&~this.words[i];return r>0&&(this.words[i]=~this.words[i]&67108863>>26-r),this._strip()},i.prototype.notn=function(e){return this.clone().inotn(e)},i.prototype.setn=function(e,t){n("number"==typeof e&&e>=0);var r=e/26|0,i=e%26;return this._expand(r+1),this.words[r]=t?this.words[r]|1<<i:this.words[r]&~(1<<i),this._strip()},i.prototype.iadd=function(e){var t,n,r;if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(n=this,r=e):(n=e,r=this);for(var i=0,o=0;o<r.length;o++)t=(0|n.words[o])+(0|r.words[o])+i,this.words[o]=67108863&t,i=t>>>26;for(;0!==i&&o<n.length;o++)t=(0|n.words[o])+i,this.words[o]=67108863&t,i=t>>>26;if(this.length=n.length,0!==i)this.words[this.length]=i,this.length++;else if(n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this},i.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},i.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t=this.iadd(e);return e.negative=1,t._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var n,r,i=this.cmp(e);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;i>0?(n=this,r=e):(n=e,r=this);for(var o=0,a=0;a<r.length;a++)o=(t=(0|n.words[a])-(0|r.words[a])+o)>>26,this.words[a]=67108863&t;for(;0!==o&&a<n.length;a++)o=(t=(0|n.words[a])+o)>>26,this.words[a]=67108863&t;if(0===o&&a<n.length&&n!==this)for(;a<n.length;a++)this.words[a]=n.words[a];return this.length=Math.max(this.length,a),n!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(e){return this.clone().isub(e)};var y=function(e,t,n){var r,i,o,a=e.words,s=t.words,u=n.words,c=0,l=0|a[0],f=8191&l,h=l>>>13,d=0|a[1],p=8191&d,m=d>>>13,y=0|a[2],g=8191&y,b=y>>>13,v=0|a[3],w=8191&v,_=v>>>13,E=0|a[4],S=8191&E,x=E>>>13,T=0|a[5],M=8191&T,A=T>>>13,R=0|a[6],I=8191&R,P=R>>>13,N=0|a[7],O=8191&N,C=N>>>13,k=0|a[8],B=8191&k,D=k>>>13,j=0|a[9],L=8191&j,q=j>>>13,U=0|s[0],F=8191&U,K=U>>>13,V=0|s[1],z=8191&V,W=V>>>13,H=0|s[2],G=8191&H,Q=H>>>13,J=0|s[3],Z=8191&J,$=J>>>13,Y=0|s[4],X=8191&Y,ee=Y>>>13,te=0|s[5],ne=8191&te,re=te>>>13,ie=0|s[6],oe=8191&ie,ae=ie>>>13,se=0|s[7],ue=8191&se,ce=se>>>13,le=0|s[8],fe=8191&le,he=le>>>13,de=0|s[9],pe=8191&de,me=de>>>13;n.negative=e.negative^t.negative,n.length=19;var ye=(c+(r=Math.imul(f,F))|0)+((8191&(i=(i=Math.imul(f,K))+Math.imul(h,F)|0))<<13)|0;c=((o=Math.imul(h,K))+(i>>>13)|0)+(ye>>>26)|0,ye&=67108863,r=Math.imul(p,F),i=(i=Math.imul(p,K))+Math.imul(m,F)|0,o=Math.imul(m,K);var ge=(c+(r=r+Math.imul(f,z)|0)|0)+((8191&(i=(i=i+Math.imul(f,W)|0)+Math.imul(h,z)|0))<<13)|0;c=((o=o+Math.imul(h,W)|0)+(i>>>13)|0)+(ge>>>26)|0,ge&=67108863,r=Math.imul(g,F),i=(i=Math.imul(g,K))+Math.imul(b,F)|0,o=Math.imul(b,K),r=r+Math.imul(p,z)|0,i=(i=i+Math.imul(p,W)|0)+Math.imul(m,z)|0,o=o+Math.imul(m,W)|0;var be=(c+(r=r+Math.imul(f,G)|0)|0)+((8191&(i=(i=i+Math.imul(f,Q)|0)+Math.imul(h,G)|0))<<13)|0;c=((o=o+Math.imul(h,Q)|0)+(i>>>13)|0)+(be>>>26)|0,be&=67108863,r=Math.imul(w,F),i=(i=Math.imul(w,K))+Math.imul(_,F)|0,o=Math.imul(_,K),r=r+Math.imul(g,z)|0,i=(i=i+Math.imul(g,W)|0)+Math.imul(b,z)|0,o=o+Math.imul(b,W)|0,r=r+Math.imul(p,G)|0,i=(i=i+Math.imul(p,Q)|0)+Math.imul(m,G)|0,o=o+Math.imul(m,Q)|0;var ve=(c+(r=r+Math.imul(f,Z)|0)|0)+((8191&(i=(i=i+Math.imul(f,$)|0)+Math.imul(h,Z)|0))<<13)|0;c=((o=o+Math.imul(h,$)|0)+(i>>>13)|0)+(ve>>>26)|0,ve&=67108863,r=Math.imul(S,F),i=(i=Math.imul(S,K))+Math.imul(x,F)|0,o=Math.imul(x,K),r=r+Math.imul(w,z)|0,i=(i=i+Math.imul(w,W)|0)+Math.imul(_,z)|0,o=o+Math.imul(_,W)|0,r=r+Math.imul(g,G)|0,i=(i=i+Math.imul(g,Q)|0)+Math.imul(b,G)|0,o=o+Math.imul(b,Q)|0,r=r+Math.imul(p,Z)|0,i=(i=i+Math.imul(p,$)|0)+Math.imul(m,Z)|0,o=o+Math.imul(m,$)|0;var we=(c+(r=r+Math.imul(f,X)|0)|0)+((8191&(i=(i=i+Math.imul(f,ee)|0)+Math.imul(h,X)|0))<<13)|0;c=((o=o+Math.imul(h,ee)|0)+(i>>>13)|0)+(we>>>26)|0,we&=67108863,r=Math.imul(M,F),i=(i=Math.imul(M,K))+Math.imul(A,F)|0,o=Math.imul(A,K),r=r+Math.imul(S,z)|0,i=(i=i+Math.imul(S,W)|0)+Math.imul(x,z)|0,o=o+Math.imul(x,W)|0,r=r+Math.imul(w,G)|0,i=(i=i+Math.imul(w,Q)|0)+Math.imul(_,G)|0,o=o+Math.imul(_,Q)|0,r=r+Math.imul(g,Z)|0,i=(i=i+Math.imul(g,$)|0)+Math.imul(b,Z)|0,o=o+Math.imul(b,$)|0,r=r+Math.imul(p,X)|0,i=(i=i+Math.imul(p,ee)|0)+Math.imul(m,X)|0,o=o+Math.imul(m,ee)|0;var _e=(c+(r=r+Math.imul(f,ne)|0)|0)+((8191&(i=(i=i+Math.imul(f,re)|0)+Math.imul(h,ne)|0))<<13)|0;c=((o=o+Math.imul(h,re)|0)+(i>>>13)|0)+(_e>>>26)|0,_e&=67108863,r=Math.imul(I,F),i=(i=Math.imul(I,K))+Math.imul(P,F)|0,o=Math.imul(P,K),r=r+Math.imul(M,z)|0,i=(i=i+Math.imul(M,W)|0)+Math.imul(A,z)|0,o=o+Math.imul(A,W)|0,r=r+Math.imul(S,G)|0,i=(i=i+Math.imul(S,Q)|0)+Math.imul(x,G)|0,o=o+Math.imul(x,Q)|0,r=r+Math.imul(w,Z)|0,i=(i=i+Math.imul(w,$)|0)+Math.imul(_,Z)|0,o=o+Math.imul(_,$)|0,r=r+Math.imul(g,X)|0,i=(i=i+Math.imul(g,ee)|0)+Math.imul(b,X)|0,o=o+Math.imul(b,ee)|0,r=r+Math.imul(p,ne)|0,i=(i=i+Math.imul(p,re)|0)+Math.imul(m,ne)|0,o=o+Math.imul(m,re)|0;var Ee=(c+(r=r+Math.imul(f,oe)|0)|0)+((8191&(i=(i=i+Math.imul(f,ae)|0)+Math.imul(h,oe)|0))<<13)|0;c=((o=o+Math.imul(h,ae)|0)+(i>>>13)|0)+(Ee>>>26)|0,Ee&=67108863,r=Math.imul(O,F),i=(i=Math.imul(O,K))+Math.imul(C,F)|0,o=Math.imul(C,K),r=r+Math.imul(I,z)|0,i=(i=i+Math.imul(I,W)|0)+Math.imul(P,z)|0,o=o+Math.imul(P,W)|0,r=r+Math.imul(M,G)|0,i=(i=i+Math.imul(M,Q)|0)+Math.imul(A,G)|0,o=o+Math.imul(A,Q)|0,r=r+Math.imul(S,Z)|0,i=(i=i+Math.imul(S,$)|0)+Math.imul(x,Z)|0,o=o+Math.imul(x,$)|0,r=r+Math.imul(w,X)|0,i=(i=i+Math.imul(w,ee)|0)+Math.imul(_,X)|0,o=o+Math.imul(_,ee)|0,r=r+Math.imul(g,ne)|0,i=(i=i+Math.imul(g,re)|0)+Math.imul(b,ne)|0,o=o+Math.imul(b,re)|0,r=r+Math.imul(p,oe)|0,i=(i=i+Math.imul(p,ae)|0)+Math.imul(m,oe)|0,o=o+Math.imul(m,ae)|0;var Se=(c+(r=r+Math.imul(f,ue)|0)|0)+((8191&(i=(i=i+Math.imul(f,ce)|0)+Math.imul(h,ue)|0))<<13)|0;c=((o=o+Math.imul(h,ce)|0)+(i>>>13)|0)+(Se>>>26)|0,Se&=67108863,r=Math.imul(B,F),i=(i=Math.imul(B,K))+Math.imul(D,F)|0,o=Math.imul(D,K),r=r+Math.imul(O,z)|0,i=(i=i+Math.imul(O,W)|0)+Math.imul(C,z)|0,o=o+Math.imul(C,W)|0,r=r+Math.imul(I,G)|0,i=(i=i+Math.imul(I,Q)|0)+Math.imul(P,G)|0,o=o+Math.imul(P,Q)|0,r=r+Math.imul(M,Z)|0,i=(i=i+Math.imul(M,$)|0)+Math.imul(A,Z)|0,o=o+Math.imul(A,$)|0,r=r+Math.imul(S,X)|0,i=(i=i+Math.imul(S,ee)|0)+Math.imul(x,X)|0,o=o+Math.imul(x,ee)|0,r=r+Math.imul(w,ne)|0,i=(i=i+Math.imul(w,re)|0)+Math.imul(_,ne)|0,o=o+Math.imul(_,re)|0,r=r+Math.imul(g,oe)|0,i=(i=i+Math.imul(g,ae)|0)+Math.imul(b,oe)|0,o=o+Math.imul(b,ae)|0,r=r+Math.imul(p,ue)|0,i=(i=i+Math.imul(p,ce)|0)+Math.imul(m,ue)|0,o=o+Math.imul(m,ce)|0;var xe=(c+(r=r+Math.imul(f,fe)|0)|0)+((8191&(i=(i=i+Math.imul(f,he)|0)+Math.imul(h,fe)|0))<<13)|0;c=((o=o+Math.imul(h,he)|0)+(i>>>13)|0)+(xe>>>26)|0,xe&=67108863,r=Math.imul(L,F),i=(i=Math.imul(L,K))+Math.imul(q,F)|0,o=Math.imul(q,K),r=r+Math.imul(B,z)|0,i=(i=i+Math.imul(B,W)|0)+Math.imul(D,z)|0,o=o+Math.imul(D,W)|0,r=r+Math.imul(O,G)|0,i=(i=i+Math.imul(O,Q)|0)+Math.imul(C,G)|0,o=o+Math.imul(C,Q)|0,r=r+Math.imul(I,Z)|0,i=(i=i+Math.imul(I,$)|0)+Math.imul(P,Z)|0,o=o+Math.imul(P,$)|0,r=r+Math.imul(M,X)|0,i=(i=i+Math.imul(M,ee)|0)+Math.imul(A,X)|0,o=o+Math.imul(A,ee)|0,r=r+Math.imul(S,ne)|0,i=(i=i+Math.imul(S,re)|0)+Math.imul(x,ne)|0,o=o+Math.imul(x,re)|0,r=r+Math.imul(w,oe)|0,i=(i=i+Math.imul(w,ae)|0)+Math.imul(_,oe)|0,o=o+Math.imul(_,ae)|0,r=r+Math.imul(g,ue)|0,i=(i=i+Math.imul(g,ce)|0)+Math.imul(b,ue)|0,o=o+Math.imul(b,ce)|0,r=r+Math.imul(p,fe)|0,i=(i=i+Math.imul(p,he)|0)+Math.imul(m,fe)|0,o=o+Math.imul(m,he)|0;var Te=(c+(r=r+Math.imul(f,pe)|0)|0)+((8191&(i=(i=i+Math.imul(f,me)|0)+Math.imul(h,pe)|0))<<13)|0;c=((o=o+Math.imul(h,me)|0)+(i>>>13)|0)+(Te>>>26)|0,Te&=67108863,r=Math.imul(L,z),i=(i=Math.imul(L,W))+Math.imul(q,z)|0,o=Math.imul(q,W),r=r+Math.imul(B,G)|0,i=(i=i+Math.imul(B,Q)|0)+Math.imul(D,G)|0,o=o+Math.imul(D,Q)|0,r=r+Math.imul(O,Z)|0,i=(i=i+Math.imul(O,$)|0)+Math.imul(C,Z)|0,o=o+Math.imul(C,$)|0,r=r+Math.imul(I,X)|0,i=(i=i+Math.imul(I,ee)|0)+Math.imul(P,X)|0,o=o+Math.imul(P,ee)|0,r=r+Math.imul(M,ne)|0,i=(i=i+Math.imul(M,re)|0)+Math.imul(A,ne)|0,o=o+Math.imul(A,re)|0,r=r+Math.imul(S,oe)|0,i=(i=i+Math.imul(S,ae)|0)+Math.imul(x,oe)|0,o=o+Math.imul(x,ae)|0,r=r+Math.imul(w,ue)|0,i=(i=i+Math.imul(w,ce)|0)+Math.imul(_,ue)|0,o=o+Math.imul(_,ce)|0,r=r+Math.imul(g,fe)|0,i=(i=i+Math.imul(g,he)|0)+Math.imul(b,fe)|0,o=o+Math.imul(b,he)|0;var Me=(c+(r=r+Math.imul(p,pe)|0)|0)+((8191&(i=(i=i+Math.imul(p,me)|0)+Math.imul(m,pe)|0))<<13)|0;c=((o=o+Math.imul(m,me)|0)+(i>>>13)|0)+(Me>>>26)|0,Me&=67108863,r=Math.imul(L,G),i=(i=Math.imul(L,Q))+Math.imul(q,G)|0,o=Math.imul(q,Q),r=r+Math.imul(B,Z)|0,i=(i=i+Math.imul(B,$)|0)+Math.imul(D,Z)|0,o=o+Math.imul(D,$)|0,r=r+Math.imul(O,X)|0,i=(i=i+Math.imul(O,ee)|0)+Math.imul(C,X)|0,o=o+Math.imul(C,ee)|0,r=r+Math.imul(I,ne)|0,i=(i=i+Math.imul(I,re)|0)+Math.imul(P,ne)|0,o=o+Math.imul(P,re)|0,r=r+Math.imul(M,oe)|0,i=(i=i+Math.imul(M,ae)|0)+Math.imul(A,oe)|0,o=o+Math.imul(A,ae)|0,r=r+Math.imul(S,ue)|0,i=(i=i+Math.imul(S,ce)|0)+Math.imul(x,ue)|0,o=o+Math.imul(x,ce)|0,r=r+Math.imul(w,fe)|0,i=(i=i+Math.imul(w,he)|0)+Math.imul(_,fe)|0,o=o+Math.imul(_,he)|0;var Ae=(c+(r=r+Math.imul(g,pe)|0)|0)+((8191&(i=(i=i+Math.imul(g,me)|0)+Math.imul(b,pe)|0))<<13)|0;c=((o=o+Math.imul(b,me)|0)+(i>>>13)|0)+(Ae>>>26)|0,Ae&=67108863,r=Math.imul(L,Z),i=(i=Math.imul(L,$))+Math.imul(q,Z)|0,o=Math.imul(q,$),r=r+Math.imul(B,X)|0,i=(i=i+Math.imul(B,ee)|0)+Math.imul(D,X)|0,o=o+Math.imul(D,ee)|0,r=r+Math.imul(O,ne)|0,i=(i=i+Math.imul(O,re)|0)+Math.imul(C,ne)|0,o=o+Math.imul(C,re)|0,r=r+Math.imul(I,oe)|0,i=(i=i+Math.imul(I,ae)|0)+Math.imul(P,oe)|0,o=o+Math.imul(P,ae)|0,r=r+Math.imul(M,ue)|0,i=(i=i+Math.imul(M,ce)|0)+Math.imul(A,ue)|0,o=o+Math.imul(A,ce)|0,r=r+Math.imul(S,fe)|0,i=(i=i+Math.imul(S,he)|0)+Math.imul(x,fe)|0,o=o+Math.imul(x,he)|0;var Re=(c+(r=r+Math.imul(w,pe)|0)|0)+((8191&(i=(i=i+Math.imul(w,me)|0)+Math.imul(_,pe)|0))<<13)|0;c=((o=o+Math.imul(_,me)|0)+(i>>>13)|0)+(Re>>>26)|0,Re&=67108863,r=Math.imul(L,X),i=(i=Math.imul(L,ee))+Math.imul(q,X)|0,o=Math.imul(q,ee),r=r+Math.imul(B,ne)|0,i=(i=i+Math.imul(B,re)|0)+Math.imul(D,ne)|0,o=o+Math.imul(D,re)|0,r=r+Math.imul(O,oe)|0,i=(i=i+Math.imul(O,ae)|0)+Math.imul(C,oe)|0,o=o+Math.imul(C,ae)|0,r=r+Math.imul(I,ue)|0,i=(i=i+Math.imul(I,ce)|0)+Math.imul(P,ue)|0,o=o+Math.imul(P,ce)|0,r=r+Math.imul(M,fe)|0,i=(i=i+Math.imul(M,he)|0)+Math.imul(A,fe)|0,o=o+Math.imul(A,he)|0;var Ie=(c+(r=r+Math.imul(S,pe)|0)|0)+((8191&(i=(i=i+Math.imul(S,me)|0)+Math.imul(x,pe)|0))<<13)|0;c=((o=o+Math.imul(x,me)|0)+(i>>>13)|0)+(Ie>>>26)|0,Ie&=67108863,r=Math.imul(L,ne),i=(i=Math.imul(L,re))+Math.imul(q,ne)|0,o=Math.imul(q,re),r=r+Math.imul(B,oe)|0,i=(i=i+Math.imul(B,ae)|0)+Math.imul(D,oe)|0,o=o+Math.imul(D,ae)|0,r=r+Math.imul(O,ue)|0,i=(i=i+Math.imul(O,ce)|0)+Math.imul(C,ue)|0,o=o+Math.imul(C,ce)|0,r=r+Math.imul(I,fe)|0,i=(i=i+Math.imul(I,he)|0)+Math.imul(P,fe)|0,o=o+Math.imul(P,he)|0;var Pe=(c+(r=r+Math.imul(M,pe)|0)|0)+((8191&(i=(i=i+Math.imul(M,me)|0)+Math.imul(A,pe)|0))<<13)|0;c=((o=o+Math.imul(A,me)|0)+(i>>>13)|0)+(Pe>>>26)|0,Pe&=67108863,r=Math.imul(L,oe),i=(i=Math.imul(L,ae))+Math.imul(q,oe)|0,o=Math.imul(q,ae),r=r+Math.imul(B,ue)|0,i=(i=i+Math.imul(B,ce)|0)+Math.imul(D,ue)|0,o=o+Math.imul(D,ce)|0,r=r+Math.imul(O,fe)|0,i=(i=i+Math.imul(O,he)|0)+Math.imul(C,fe)|0,o=o+Math.imul(C,he)|0;var Ne=(c+(r=r+Math.imul(I,pe)|0)|0)+((8191&(i=(i=i+Math.imul(I,me)|0)+Math.imul(P,pe)|0))<<13)|0;c=((o=o+Math.imul(P,me)|0)+(i>>>13)|0)+(Ne>>>26)|0,Ne&=67108863,r=Math.imul(L,ue),i=(i=Math.imul(L,ce))+Math.imul(q,ue)|0,o=Math.imul(q,ce),r=r+Math.imul(B,fe)|0,i=(i=i+Math.imul(B,he)|0)+Math.imul(D,fe)|0,o=o+Math.imul(D,he)|0;var Oe=(c+(r=r+Math.imul(O,pe)|0)|0)+((8191&(i=(i=i+Math.imul(O,me)|0)+Math.imul(C,pe)|0))<<13)|0;c=((o=o+Math.imul(C,me)|0)+(i>>>13)|0)+(Oe>>>26)|0,Oe&=67108863,r=Math.imul(L,fe),i=(i=Math.imul(L,he))+Math.imul(q,fe)|0,o=Math.imul(q,he);var Ce=(c+(r=r+Math.imul(B,pe)|0)|0)+((8191&(i=(i=i+Math.imul(B,me)|0)+Math.imul(D,pe)|0))<<13)|0;c=((o=o+Math.imul(D,me)|0)+(i>>>13)|0)+(Ce>>>26)|0,Ce&=67108863;var ke=(c+(r=Math.imul(L,pe))|0)+((8191&(i=(i=Math.imul(L,me))+Math.imul(q,pe)|0))<<13)|0;return c=((o=Math.imul(q,me))+(i>>>13)|0)+(ke>>>26)|0,ke&=67108863,u[0]=ye,u[1]=ge,u[2]=be,u[3]=ve,u[4]=we,u[5]=_e,u[6]=Ee,u[7]=Se,u[8]=xe,u[9]=Te,u[10]=Me,u[11]=Ae,u[12]=Re,u[13]=Ie,u[14]=Pe,u[15]=Ne,u[16]=Oe,u[17]=Ce,u[18]=ke,0!==c&&(u[19]=c,n.length++),n};function g(e,t,n){n.negative=t.negative^e.negative,n.length=e.length+t.length;for(var r=0,i=0,o=0;o<n.length-1;o++){var a=i;i=0;for(var s=67108863&r,u=Math.min(o,t.length-1),c=Math.max(0,o-e.length+1);c<=u;c++){var l=o-c,f=(0|e.words[l])*(0|t.words[c]),h=67108863&f;s=67108863&(h=h+s|0),i+=(a=(a=a+(f/67108864|0)|0)+(h>>>26)|0)>>>26,a&=67108863}n.words[o]=s,r=a,a=i}return 0!==r?n.words[o]=r:n.length--,n._strip()}function b(e,t,n){return g(e,t,n)}function v(e,t){this.x=e,this.y=t}Math.imul||(y=m),i.prototype.mulTo=function(e,t){var n=this.length+e.length;return 10===this.length&&10===e.length?y(this,e,t):n<63?m(this,e,t):n<1024?g(this,e,t):b(this,e,t)},v.prototype.makeRBT=function(e){for(var t=new Array(e),n=i.prototype._countBits(e)-1,r=0;r<e;r++)t[r]=this.revBin(r,n,e);return t},v.prototype.revBin=function(e,t,n){if(0===e||e===n-1)return e;for(var r=0,i=0;i<t;i++)r|=(1&e)<<t-i-1,e>>=1;return r},v.prototype.permute=function(e,t,n,r,i,o){for(var a=0;a<o;a++)r[a]=t[e[a]],i[a]=n[e[a]]},v.prototype.transform=function(e,t,n,r,i,o){this.permute(o,e,t,n,r,i);for(var a=1;a<i;a<<=1)for(var s=a<<1,u=Math.cos(2*Math.PI/s),c=Math.sin(2*Math.PI/s),l=0;l<i;l+=s)for(var f=u,h=c,d=0;d<a;d++){var p=n[l+d],m=r[l+d],y=n[l+d+a],g=r[l+d+a],b=f*y-h*g;g=f*g+h*y,y=b,n[l+d]=p+y,r[l+d]=m+g,n[l+d+a]=p-y,r[l+d+a]=m-g,d!==s&&(b=u*f-c*h,h=u*h+c*f,f=b)}},v.prototype.guessLen13b=function(e,t){var n=1|Math.max(t,e),r=1&n,i=0;for(n=n/2|0;n;n>>>=1)i++;return 1<<i+1+r},v.prototype.conjugate=function(e,t,n){if(!(n<=1))for(var r=0;r<n/2;r++){var i=e[r];e[r]=e[n-r-1],e[n-r-1]=i,i=t[r],t[r]=-t[n-r-1],t[n-r-1]=-i}},v.prototype.normalize13b=function(e,t){for(var n=0,r=0;r<t/2;r++){var i=8192*Math.round(e[2*r+1]/t)+Math.round(e[2*r]/t)+n;e[r]=67108863&i,n=i<67108864?0:i/67108864|0}return e},v.prototype.convert13b=function(e,t,r,i){for(var o=0,a=0;a<t;a++)o+=0|e[a],r[2*a]=8191&o,o>>>=13,r[2*a+1]=8191&o,o>>>=13;for(a=2*t;a<i;++a)r[a]=0;n(0===o),n(0==(-8192&o))},v.prototype.stub=function(e){for(var t=new Array(e),n=0;n<e;n++)t[n]=0;return t},v.prototype.mulp=function(e,t,n){var r=2*this.guessLen13b(e.length,t.length),i=this.makeRBT(r),o=this.stub(r),a=new Array(r),s=new Array(r),u=new Array(r),c=new Array(r),l=new Array(r),f=new Array(r),h=n.words;h.length=r,this.convert13b(e.words,e.length,a,r),this.convert13b(t.words,t.length,c,r),this.transform(a,o,s,u,r,i),this.transform(c,o,l,f,r,i);for(var d=0;d<r;d++){var p=s[d]*l[d]-u[d]*f[d];u[d]=s[d]*f[d]+u[d]*l[d],s[d]=p}return this.conjugate(s,u,r),this.transform(s,u,h,o,r,i),this.conjugate(h,o,r),this.normalize13b(h,r),n.negative=e.negative^t.negative,n.length=e.length+t.length,n._strip()},i.prototype.mul=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),this.mulTo(e,t)},i.prototype.mulf=function(e){var t=new i(null);return t.words=new Array(this.length+e.length),b(this,e,t)},i.prototype.imul=function(e){return this.clone().mulTo(e,this)},i.prototype.imuln=function(e){var t=e<0;t&&(e=-e),n("number"==typeof e),n(e<67108864);for(var r=0,i=0;i<this.length;i++){var o=(0|this.words[i])*e,a=(67108863&o)+(67108863&r);r>>=26,r+=o/67108864|0,r+=a>>>26,this.words[i]=67108863&a}return 0!==r&&(this.words[i]=r,this.length++),t?this.ineg():this},i.prototype.muln=function(e){return this.clone().imuln(e)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(e){var t=function(e){for(var t=new Array(e.bitLength()),n=0;n<t.length;n++){var r=n/26|0,i=n%26;t[n]=e.words[r]>>>i&1}return t}(e);if(0===t.length)return new i(1);for(var n=this,r=0;r<t.length&&0===t[r];r++,n=n.sqr());if(++r<t.length)for(var o=n.sqr();r<t.length;r++,o=o.sqr())0!==t[r]&&(n=n.mul(o));return n},i.prototype.iushln=function(e){n("number"==typeof e&&e>=0);var t,r=e%26,i=(e-r)/26,o=67108863>>>26-r<<26-r;if(0!==r){var a=0;for(t=0;t<this.length;t++){var s=this.words[t]&o,u=(0|this.words[t])-s<<r;this.words[t]=u|a,a=s>>>26-r}a&&(this.words[t]=a,this.length++)}if(0!==i){for(t=this.length-1;t>=0;t--)this.words[t+i]=this.words[t];for(t=0;t<i;t++)this.words[t]=0;this.length+=i}return this._strip()},i.prototype.ishln=function(e){return n(0===this.negative),this.iushln(e)},i.prototype.iushrn=function(e,t,r){var i;n("number"==typeof e&&e>=0),i=t?(t-t%26)/26:0;var o=e%26,a=Math.min((e-o)/26,this.length),s=67108863^67108863>>>o<<o,u=r;if(i-=a,i=Math.max(0,i),u){for(var c=0;c<a;c++)u.words[c]=this.words[c];u.length=a}if(0===a);else if(this.length>a)for(this.length-=a,c=0;c<this.length;c++)this.words[c]=this.words[c+a];else this.words[0]=0,this.length=1;var l=0;for(c=this.length-1;c>=0&&(0!==l||c>=i);c--){var f=0|this.words[c];this.words[c]=l<<26-o|f>>>o,l=f&s}return u&&0!==l&&(u.words[u.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(e,t,r){return n(0===this.negative),this.iushrn(e,t,r)},i.prototype.shln=function(e){return this.clone().ishln(e)},i.prototype.ushln=function(e){return this.clone().iushln(e)},i.prototype.shrn=function(e){return this.clone().ishrn(e)},i.prototype.ushrn=function(e){return this.clone().iushrn(e)},i.prototype.testn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26,i=1<<t;return!(this.length<=r)&&!!(this.words[r]&i)},i.prototype.imaskn=function(e){n("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)return this;if(0!==t&&r++,this.length=Math.min(r,this.length),0!==t){var i=67108863^67108863>>>t<<t;this.words[this.length-1]&=i}return this._strip()},i.prototype.maskn=function(e){return this.clone().imaskn(e)},i.prototype.iaddn=function(e){return n("number"==typeof e),n(e<67108864),e<0?this.isubn(-e):0!==this.negative?1===this.length&&(0|this.words[0])<=e?(this.words[0]=e-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(e),this.negative=1,this):this._iaddn(e)},i.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},i.prototype.isubn=function(e){if(n("number"==typeof e),n(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this._strip()},i.prototype.addn=function(e){return this.clone().iaddn(e)},i.prototype.subn=function(e){return this.clone().isubn(e)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(e,t,r){var i,o,a=e.length+r;this._expand(a);var s=0;for(i=0;i<e.length;i++){o=(0|this.words[i+r])+s;var u=(0|e.words[i])*t;s=((o-=67108863&u)>>26)-(u/67108864|0),this.words[i+r]=67108863&o}for(;i<this.length-r;i++)s=(o=(0|this.words[i+r])+s)>>26,this.words[i+r]=67108863&o;if(0===s)return this._strip();for(n(-1===s),s=0,i=0;i<this.length;i++)s=(o=-(0|this.words[i])+s)>>26,this.words[i]=67108863&o;return this.negative=1,this._strip()},i.prototype._wordDiv=function(e,t){var n=(this.length,e.length),r=this.clone(),o=e,a=0|o.words[o.length-1];0!==(n=26-this._countBits(a))&&(o=o.ushln(n),r.iushln(n),a=0|o.words[o.length-1]);var s,u=r.length-o.length;if("mod"!==t){(s=new i(null)).length=u+1,s.words=new Array(s.length);for(var c=0;c<s.length;c++)s.words[c]=0}var l=r.clone()._ishlnsubmul(o,1,u);0===l.negative&&(r=l,s&&(s.words[u]=1));for(var f=u-1;f>=0;f--){var h=67108864*(0|r.words[o.length+f])+(0|r.words[o.length+f-1]);for(h=Math.min(h/a|0,67108863),r._ishlnsubmul(o,h,f);0!==r.negative;)h--,r.negative=0,r._ishlnsubmul(o,1,f),r.isZero()||(r.negative^=1);s&&(s.words[f]=h)}return s&&s._strip(),r._strip(),"div"!==t&&0!==n&&r.iushrn(n),{div:s||null,mod:r}},i.prototype.divmod=function(e,t,r){return n(!e.isZero()),this.isZero()?{div:new i(0),mod:new i(0)}:0!==this.negative&&0===e.negative?(s=this.neg().divmod(e,t),"mod"!==t&&(o=s.div.neg()),"div"!==t&&(a=s.mod.neg(),r&&0!==a.negative&&a.iadd(e)),{div:o,mod:a}):0===this.negative&&0!==e.negative?(s=this.divmod(e.neg(),t),"mod"!==t&&(o=s.div.neg()),{div:o,mod:s.mod}):0!=(this.negative&e.negative)?(s=this.neg().divmod(e.neg(),t),"div"!==t&&(a=s.mod.neg(),r&&0!==a.negative&&a.isub(e)),{div:s.div,mod:a}):e.length>this.length||this.cmp(e)<0?{div:new i(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new i(this.modrn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new i(this.modrn(e.words[0]))}:this._wordDiv(e,t);var o,a,s},i.prototype.div=function(e){return this.divmod(e,"div",!1).div},i.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},i.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},i.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var n=0!==t.div.negative?t.mod.isub(e):t.mod,r=e.ushrn(1),i=e.andln(1),o=n.cmp(r);return o<0||1===i&&0===o?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},i.prototype.modrn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=67108864%e,i=0,o=this.length-1;o>=0;o--)i=(r*i+(0|this.words[o]))%e;return t?-i:i},i.prototype.modn=function(e){return this.modrn(e)},i.prototype.idivn=function(e){var t=e<0;t&&(e=-e),n(e<=67108863);for(var r=0,i=this.length-1;i>=0;i--){var o=(0|this.words[i])+67108864*r;this.words[i]=o/e|0,r=o%e}return this._strip(),t?this.ineg():this},i.prototype.divn=function(e){return this.clone().idivn(e)},i.prototype.egcd=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var o=new i(1),a=new i(0),s=new i(0),u=new i(1),c=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++c;for(var l=r.clone(),f=t.clone();!t.isZero();){for(var h=0,d=1;0==(t.words[0]&d)&&h<26;++h,d<<=1);if(h>0)for(t.iushrn(h);h-- >0;)(o.isOdd()||a.isOdd())&&(o.iadd(l),a.isub(f)),o.iushrn(1),a.iushrn(1);for(var p=0,m=1;0==(r.words[0]&m)&&p<26;++p,m<<=1);if(p>0)for(r.iushrn(p);p-- >0;)(s.isOdd()||u.isOdd())&&(s.iadd(l),u.isub(f)),s.iushrn(1),u.iushrn(1);t.cmp(r)>=0?(t.isub(r),o.isub(s),a.isub(u)):(r.isub(t),s.isub(o),u.isub(a))}return{a:s,b:u,gcd:r.iushln(c)}},i.prototype._invmp=function(e){n(0===e.negative),n(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var o,a=new i(1),s=new i(0),u=r.clone();t.cmpn(1)>0&&r.cmpn(1)>0;){for(var c=0,l=1;0==(t.words[0]&l)&&c<26;++c,l<<=1);if(c>0)for(t.iushrn(c);c-- >0;)a.isOdd()&&a.iadd(u),a.iushrn(1);for(var f=0,h=1;0==(r.words[0]&h)&&f<26;++f,h<<=1);if(f>0)for(r.iushrn(f);f-- >0;)s.isOdd()&&s.iadd(u),s.iushrn(1);t.cmp(r)>=0?(t.isub(r),a.isub(s)):(r.isub(t),s.isub(a))}return(o=0===t.cmpn(1)?a:s).cmpn(0)<0&&o.iadd(e),o},i.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),n=e.clone();t.negative=0,n.negative=0;for(var r=0;t.isEven()&&n.isEven();r++)t.iushrn(1),n.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;n.isEven();)n.iushrn(1);var i=t.cmp(n);if(i<0){var o=t;t=n,n=o}else if(0===i||0===n.cmpn(1))break;t.isub(n)}return n.iushln(r)},i.prototype.invm=function(e){return this.egcd(e).a.umod(e)},i.prototype.isEven=function(){return 0==(1&this.words[0])},i.prototype.isOdd=function(){return 1==(1&this.words[0])},i.prototype.andln=function(e){return this.words[0]&e},i.prototype.bincn=function(e){n("number"==typeof e);var t=e%26,r=(e-t)/26,i=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=i,this;for(var o=i,a=r;0!==o&&a<this.length;a++){var s=0|this.words[a];o=(s+=o)>>>26,s&=67108863,this.words[a]=s}return 0!==o&&(this.words[a]=o,this.length++),this},i.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},i.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return-1;if(0===this.negative&&r)return 1;if(this._strip(),this.length>1)t=1;else{r&&(e=-e),n(e<=67108863,"Number is too big");var i=0|this.words[0];t=i===e?0:i<e?-1:1}return 0!==this.negative?0|-t:t},i.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return-1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},i.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return-1;for(var t=0,n=this.length-1;n>=0;n--){var r=0|this.words[n],i=0|e.words[n];if(r!==i){r<i?t=-1:r>i&&(t=1);break}}return t},i.prototype.gtn=function(e){return 1===this.cmpn(e)},i.prototype.gt=function(e){return 1===this.cmp(e)},i.prototype.gten=function(e){return this.cmpn(e)>=0},i.prototype.gte=function(e){return this.cmp(e)>=0},i.prototype.ltn=function(e){return-1===this.cmpn(e)},i.prototype.lt=function(e){return-1===this.cmp(e)},i.prototype.lten=function(e){return this.cmpn(e)<=0},i.prototype.lte=function(e){return this.cmp(e)<=0},i.prototype.eqn=function(e){return 0===this.cmpn(e)},i.prototype.eq=function(e){return 0===this.cmp(e)},i.red=function(e){return new M(e)},i.prototype.toRed=function(e){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},i.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(e){return this.red=e,this},i.prototype.forceRed=function(e){return n(!this.red,"Already a number in reduction context"),this._forceRed(e)},i.prototype.redAdd=function(e){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},i.prototype.redIAdd=function(e){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},i.prototype.redSub=function(e){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},i.prototype.redISub=function(e){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},i.prototype.redShl=function(e){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},i.prototype.redMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},i.prototype.redIMul=function(e){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},i.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(e){return n(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var w={k256:null,p224:null,p192:null,p25519:null};function _(e,t){this.name=e,this.p=new i(t,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function E(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function S(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function x(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function T(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function M(e){if("string"==typeof e){var t=i._prime(e);this.m=t.p,this.prime=t}else n(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function A(e){M.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var e=new i(null);return e.words=new Array(Math.ceil(this.n/13)),e},_.prototype.ireduce=function(e){var t,n=e;do{this.split(n,this.tmp),t=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(t>this.n);var r=t<this.n?-1:n.ucmp(this.p);return 0===r?(n.words[0]=0,n.length=1):r>0?n.isub(this.p):void 0!==n.strip?n.strip():n._strip(),n},_.prototype.split=function(e,t){e.iushrn(this.n,0,t)},_.prototype.imulK=function(e){return e.imul(this.k)},r(E,_),E.prototype.split=function(e,t){for(var n=4194303,r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9)return e.words[0]=0,void(e.length=1);var o=e.words[9];for(t.words[t.length++]=o&n,i=10;i<e.length;i++){var a=0|e.words[i];e.words[i-10]=(a&n)<<4|o>>>22,o=a}o>>>=22,e.words[i-10]=o,0===o&&e.length>10?e.length-=10:e.length-=9},E.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,n=0;n<e.length;n++){var r=0|e.words[n];t+=977*r,e.words[n]=67108863&t,t=64*r+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},r(S,_),r(x,_),r(T,_),T.prototype.imulK=function(e){for(var t=0,n=0;n<e.length;n++){var r=19*(0|e.words[n])+t,i=67108863&r;r>>>=26,e.words[n]=i,t=r}return 0!==t&&(e.words[e.length++]=t),e},i._prime=function(e){if(w[e])return w[e];var t;if("k256"===e)t=new E;else if("p224"===e)t=new S;else if("p192"===e)t=new x;else{if("p25519"!==e)throw new Error("Unknown prime "+e);t=new T}return w[e]=t,t},M.prototype._verify1=function(e){n(0===e.negative,"red works only with positives"),n(e.red,"red works only with red numbers")},M.prototype._verify2=function(e,t){n(0==(e.negative|t.negative),"red works only with positives"),n(e.red&&e.red===t.red,"red works only with red numbers")},M.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):(l(e,e.umod(this.m)._forceRed(this)),e)},M.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},M.prototype.add=function(e,t){this._verify2(e,t);var n=e.add(t);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},M.prototype.iadd=function(e,t){this._verify2(e,t);var n=e.iadd(t);return n.cmp(this.m)>=0&&n.isub(this.m),n},M.prototype.sub=function(e,t){this._verify2(e,t);var n=e.sub(t);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},M.prototype.isub=function(e,t){this._verify2(e,t);var n=e.isub(t);return n.cmpn(0)<0&&n.iadd(this.m),n},M.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},M.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},M.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},M.prototype.isqr=function(e){return this.imul(e,e.clone())},M.prototype.sqr=function(e){return this.mul(e,e)},M.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(n(t%2==1),3===t){var r=this.m.add(new i(1)).iushrn(2);return this.pow(e,r)}for(var o=this.m.subn(1),a=0;!o.isZero()&&0===o.andln(1);)a++,o.iushrn(1);n(!o.isZero());var s=new i(1).toRed(this),u=s.redNeg(),c=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new i(2*l*l).toRed(this);0!==this.pow(l,c).cmp(u);)l.redIAdd(u);for(var f=this.pow(l,o),h=this.pow(e,o.addn(1).iushrn(1)),d=this.pow(e,o),p=a;0!==d.cmp(s);){for(var m=d,y=0;0!==m.cmp(s);y++)m=m.redSqr();n(y<p);var g=this.pow(f,new i(1).iushln(p-y-1));h=h.redMul(g),f=g.redSqr(),d=d.redMul(f),p=y}return h},M.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},M.prototype.pow=function(e,t){if(t.isZero())return new i(1).toRed(this);if(0===t.cmpn(1))return e.clone();var n=new Array(16);n[0]=new i(1).toRed(this),n[1]=e;for(var r=2;r<n.length;r++)n[r]=this.mul(n[r-1],e);var o=n[0],a=0,s=0,u=t.bitLength()%26;for(0===u&&(u=26),r=t.length-1;r>=0;r--){for(var c=t.words[r],l=u-1;l>=0;l--){var f=c>>l&1;o!==n[0]&&(o=this.sqr(o)),0!==f||0!==a?(a<<=1,a|=f,(4===++s||0===r&&0===l)&&(o=this.mul(o,n[a]),s=0,a=0)):s=0}u=26}return o},M.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},M.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},i.mont=function(e){return new A(e)},r(A,M),A.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},A.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},A.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var n=e.imul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),i=n.isub(r).iushrn(this.shift),o=i;return i.cmp(this.m)>=0?o=i.isub(this.m):i.cmpn(0)<0&&(o=i.iadd(this.m)),o._forceRed(this)},A.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new i(0)._forceRed(this);var n=e.mul(t),r=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=n.isub(r).iushrn(this.shift),a=o;return o.cmp(this.m)>=0?a=o.isub(this.m):o.cmpn(0)<0&&(a=o.iadd(this.m)),a._forceRed(this)},A.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e,this)})),o.register("gQsHl",(function(e,t){var n=o("4auWO"),r=o("kToZc"),i=o("k1A0j"),a=o("1oSxb"),s=o("clDJD"),u=o("2BZf1").Buffer;function c(e){var t;"object"!=typeof e||u.isBuffer(e)||(t=e.passphrase,e=e.key),"string"==typeof e&&(e=u.from(e));var o,c,l=i(e,t),f=l.tag,h=l.data;switch(f){case"CERTIFICATE":c=n.certificate.decode(h,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(c||(c=n.PublicKey.decode(h,"der")),o=c.algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return n.RSAPublicKey.decode(c.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return c.subjectPrivateKey=c.subjectPublicKey,{type:"ec",data:c};case"1.2.840.10040.4.1":return c.algorithm.params.pub_key=n.DSAparam.decode(c.subjectPublicKey.data,"der"),{type:"dsa",data:c.algorithm.params};default:throw new Error("unknown key id "+o)}case"ENCRYPTED PRIVATE KEY":h=function(e,t){var n=e.algorithm.decrypt.kde.kdeparams.salt,i=parseInt(e.algorithm.decrypt.kde.kdeparams.iters.toString(),10),o=r[e.algorithm.decrypt.cipher.algo.join(".")],c=e.algorithm.decrypt.cipher.iv,l=e.subjectPrivateKey,f=parseInt(o.split("-")[1],10)/8,h=s.pbkdf2Sync(t,n,i,f,"sha1"),d=a.createDecipheriv(o,h,c),p=[];return p.push(d.update(l)),p.push(d.final()),u.concat(p)}(h=n.EncryptedPrivateKey.decode(h,"der"),t);case"PRIVATE KEY":switch(o=(c=n.PrivateKey.decode(h,"der")).algorithm.algorithm.join(".")){case"1.2.840.113549.1.1.1":return n.RSAPrivateKey.decode(c.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:c.algorithm.curve,privateKey:n.ECPrivateKey.decode(c.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return c.algorithm.params.priv_key=n.DSAparam.decode(c.subjectPrivateKey,"der"),{type:"dsa",params:c.algorithm.params};default:throw new Error("unknown key id "+o)}case"RSA PUBLIC KEY":return n.RSAPublicKey.decode(h,"der");case"RSA PRIVATE KEY":return n.RSAPrivateKey.decode(h,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:n.DSAPrivateKey.decode(h,"der")};case"EC PRIVATE KEY":return{curve:(h=n.ECPrivateKey.decode(h,"der")).parameters.value,privateKey:h.privateKey};default:throw new Error("unknown key type "+f)}}e.exports=c,c.signature=n.signature})),o.register("4auWO",(function(t,n){var r,i,a,s,u,c,l,f,h,d;e(t.exports,"certificate",(()=>r),(e=>r=e)),e(t.exports,"RSAPrivateKey",(()=>i),(e=>i=e)),e(t.exports,"RSAPublicKey",(()=>a),(e=>a=e)),e(t.exports,"PublicKey",(()=>s),(e=>s=e)),e(t.exports,"PrivateKey",(()=>u),(e=>u=e)),e(t.exports,"EncryptedPrivateKey",(()=>c),(e=>c=e)),e(t.exports,"DSAPrivateKey",(()=>l),(e=>l=e)),e(t.exports,"DSAparam",(()=>f),(e=>f=e)),e(t.exports,"ECPrivateKey",(()=>h),(e=>h=e)),e(t.exports,"signature",(()=>d),(e=>d=e));var p=o("4SGXr");r=o("h6QG3");var m=p.define("RSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())}));i=m;var y=p.define("RSAPublicKey",(function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())}));a=y;var g=p.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(b),this.key("subjectPublicKey").bitstr())}));s=g;var b=p.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())})),v=p.define("PrivateKeyInfo",(function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(b),this.key("subjectPrivateKey").octstr())}));u=v;var w=p.define("EncryptedPrivateKeyInfo",(function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())}));c=w;var _=p.define("DSAPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())}));l=_,f=p.define("DSAparam",(function(){this.int()}));var E=p.define("ECPrivateKey",(function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(S),this.key("publicKey").optional().explicit(1).bitstr())}));h=E;var S=p.define("ECParameters",(function(){this.choice({namedCurve:this.objid()})}));d=p.define("signature",(function(){this.seq().obj(this.key("r").int(),this.key("s").int())}))})),o.register("4SGXr",(function(e,t){const n=e.exports;n.bignum=o("ks3fn"),n.define=o("iD7Wz").define,n.base=o("ls5CE"),n.constants=o("lOEVn"),n.decoders=o("auozE"),n.encoders=o("kO7S4")})),o.register("iD7Wz",(function(e,t){var n=o("kO7S4"),r=o("auozE"),i=o("9iXO2");function a(e,t){this.name=e,this.body=t,this.decoders={},this.encoders={}}e.exports.define=function(e,t){return new a(e,t)},a.prototype._createNamed=function(e){const t=this.name;function n(e){this._initNamed(e,t)}return i(n,e),n.prototype._initNamed=function(t,n){e.call(this,t,n)},new n(this)},a.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(r[e])),this.decoders[e]},a.prototype.decode=function(e,t,n){return this._getDecoder(t).decode(e,n)},a.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(n[e])),this.encoders[e]},a.prototype.encode=function(e,t,n){return this._getEncoder(t).encode(e,n)}})),o.register("kO7S4",(function(e,t){const n=e.exports;n.der=o("fscgm"),n.pem=o("2os5Q")})),o.register("fscgm",(function(e,t){var n=o("9iXO2"),r=o("gaHwf").Buffer,i=o("5FKTu"),a=o("MH0qh");function s(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new u,this.tree._init(e.body)}function u(e){i.call(this,"der",e)}function c(e){return e<10?"0"+e:e}e.exports=s,s.prototype.encode=function(e,t){return this.tree._encode(e,t).join()},n(u,i),u.prototype._encodeComposite=function(e,t,n,i){const o=function(e,t,n,r){let i;"seqof"===e?e="seq":"setof"===e&&(e="set");if(a.tagByName.hasOwnProperty(e))i=a.tagByName[e];else{if("number"!=typeof e||(0|e)!==e)return r.error("Unknown tag: "+e);i=e}if(i>=31)return r.error("Multi-octet tag encoding unsupported");t||(i|=32);return i|=a.tagClassByName[n||"universal"]<<6,i}(e,t,n,this.reporter);if(i.length<128){const e=r.alloc(2);return e[0]=o,e[1]=i.length,this._createEncoderBuffer([e,i])}let s=1;for(let e=i.length;e>=256;e>>=8)s++;const u=r.alloc(2+s);u[0]=o,u[1]=128|s;for(let e=1+s,t=i.length;t>0;e--,t>>=8)u[e]=255&t;return this._createEncoderBuffer([u,i])},u.prototype._encodeStr=function(e,t){if("bitstr"===t)return this._createEncoderBuffer([0|e.unused,e.data]);if("bmpstr"===t){const t=r.alloc(2*e.length);for(let n=0;n<e.length;n++)t.writeUInt16BE(e.charCodeAt(n),2*n);return this._createEncoderBuffer(t)}return"numstr"===t?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):"printstr"===t?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(t)||"objDesc"===t?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+t+" unsupported")},u.prototype._encodeObjid=function(e,t,n){if("string"==typeof e){if(!t)return this.reporter.error("string objid given, but no values map found");if(!t.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=t[e].split(/[\s.]+/g);for(let t=0;t<e.length;t++)e[t]|=0}else if(Array.isArray(e)){e=e.slice();for(let t=0;t<e.length;t++)e[t]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!n){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,40*e[0]+e[1])}let i=0;for(let t=0;t<e.length;t++){let n=e[t];for(i++;n>=128;n>>=7)i++}const o=r.alloc(i);let a=o.length-1;for(let t=e.length-1;t>=0;t--){let n=e[t];for(o[a--]=127&n;(n>>=7)>0;)o[a--]=128|127&n}return this._createEncoderBuffer(o)},u.prototype._encodeTime=function(e,t){let n;const r=new Date(e);return"gentime"===t?n=[c(r.getUTCFullYear()),c(r.getUTCMonth()+1),c(r.getUTCDate()),c(r.getUTCHours()),c(r.getUTCMinutes()),c(r.getUTCSeconds()),"Z"].join(""):"utctime"===t?n=[c(r.getUTCFullYear()%100),c(r.getUTCMonth()+1),c(r.getUTCDate()),c(r.getUTCHours()),c(r.getUTCMinutes()),c(r.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+t+" time is not supported yet"),this._encodeStr(n,"octstr")},u.prototype._encodeNull=function(){return this._createEncoderBuffer("")},u.prototype._encodeInt=function(e,t){if("string"==typeof e){if(!t)return this.reporter.error("String int or enum given, but no values map");if(!t.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=t[e]}if("number"!=typeof e&&!r.isBuffer(e)){const t=e.toArray();!e.sign&&128&t[0]&&t.unshift(0),e=r.from(t)}if(r.isBuffer(e)){let t=e.length;0===e.length&&t++;const n=r.alloc(t);return e.copy(n),0===e.length&&(n[0]=0),this._createEncoderBuffer(n)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);let n=1;for(let t=e;t>=256;t>>=8)n++;const i=new Array(n);for(let t=i.length-1;t>=0;t--)i[t]=255&e,e>>=8;return 128&i[0]&&i.unshift(0),this._createEncoderBuffer(r.from(i))},u.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)},u.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getEncoder("der").tree},u.prototype._skipDefault=function(e,t,n){const r=this._baseState;let i;if(null===r.default)return!1;const o=e.join();if(void 0===r.defaultBuffer&&(r.defaultBuffer=this._encodeValue(r.default,t,n).join()),o.length!==r.defaultBuffer.length)return!1;for(i=0;i<o.length;i++)if(o[i]!==r.defaultBuffer[i])return!1;return!0}})),o.register("gaHwf",(function(e,t){var n,r=o("iThRa"),i=o("150uq"),a=i.Buffer,s={};for(n in i)i.hasOwnProperty(n)&&"SlowBuffer"!==n&&"Buffer"!==n&&(s[n]=i[n]);var u=s.Buffer={};for(n in a)a.hasOwnProperty(n)&&"allocUnsafe"!==n&&"allocUnsafeSlow"!==n&&(u[n]=a[n]);if(s.Buffer.prototype=a.prototype,u.from&&u.from!==Uint8Array.from||(u.from=function(e,t,n){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return a(e,t,n)}),u.alloc||(u.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2147483648)throw new RangeError('The value "'+e+'" is invalid for option "size"');var r=a(e);return t&&0!==t.length?"string"==typeof n?r.fill(t,n):r.fill(t):r.fill(0),r}),!s.kStringMaxLength)try{s.kStringMaxLength=r.binding("buffer").kStringMaxLength}catch(e){}s.constants||(s.constants={MAX_LENGTH:s.kMaxLength},s.kStringMaxLength&&(s.constants.MAX_STRING_LENGTH=s.kStringMaxLength)),e.exports=s})),o.register("5FKTu",(function(e,t){var n=o("4oaGH").Reporter,r=o("jAQPM").EncoderBuffer,i=o("jAQPM").DecoderBuffer,a=o("b8dAq");const s=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],u=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(s);function c(e,t,n){const r={};this._baseState=r,r.name=n,r.enc=e,r.parent=t||null,r.children=null,r.tag=null,r.args=null,r.reverseArgs=null,r.choice=null,r.optional=!1,r.any=!1,r.obj=!1,r.use=null,r.useDecoder=null,r.key=null,r.default=null,r.explicit=null,r.implicit=null,r.contains=null,r.parent||(r.children=[],this._wrap())}e.exports=c;const l=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];c.prototype.clone=function(){const e=this._baseState,t={};l.forEach((function(n){t[n]=e[n]}));const n=new this.constructor(t.parent);return n._baseState=t,n},c.prototype._wrap=function(){const e=this._baseState;u.forEach((function(t){this[t]=function(){const n=new this.constructor(this);return e.children.push(n),n[t].apply(n,arguments)}}),this)},c.prototype._init=function(e){const t=this._baseState;a(null===t.parent),e.call(this),t.children=t.children.filter((function(e){return e._baseState.parent===this}),this),a.equal(t.children.length,1,"Root node can have only one child")},c.prototype._useArgs=function(e){const t=this._baseState,n=e.filter((function(e){return e instanceof this.constructor}),this);e=e.filter((function(e){return!(e instanceof this.constructor)}),this),0!==n.length&&(a(null===t.children),t.children=n,n.forEach((function(e){e._baseState.parent=this}),this)),0!==e.length&&(a(null===t.args),t.args=e,t.reverseArgs=e.map((function(e){if("object"!=typeof e||e.constructor!==Object)return e;const t={};return Object.keys(e).forEach((function(n){n==(0|n)&&(n|=0);const r=e[n];t[r]=n})),t})))},["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"].forEach((function(e){c.prototype[e]=function(){const t=this._baseState;throw new Error(e+" not implemented for encoding: "+t.enc)}})),s.forEach((function(e){c.prototype[e]=function(){const t=this._baseState,n=Array.prototype.slice.call(arguments);return a(null===t.tag),t.tag=e,this._useArgs(n),this}})),c.prototype.use=function(e){a(e);const t=this._baseState;return a(null===t.use),t.use=e,this},c.prototype.optional=function(){return this._baseState.optional=!0,this},c.prototype.def=function(e){const t=this._baseState;return a(null===t.default),t.default=e,t.optional=!0,this},c.prototype.explicit=function(e){const t=this._baseState;return a(null===t.explicit&&null===t.implicit),t.explicit=e,this},c.prototype.implicit=function(e){const t=this._baseState;return a(null===t.explicit&&null===t.implicit),t.implicit=e,this},c.prototype.obj=function(){const e=this._baseState,t=Array.prototype.slice.call(arguments);return e.obj=!0,0!==t.length&&this._useArgs(t),this},c.prototype.key=function(e){const t=this._baseState;return a(null===t.key),t.key=e,this},c.prototype.any=function(){return this._baseState.any=!0,this},c.prototype.choice=function(e){const t=this._baseState;return a(null===t.choice),t.choice=e,this._useArgs(Object.keys(e).map((function(t){return e[t]}))),this},c.prototype.contains=function(e){const t=this._baseState;return a(null===t.use),t.contains=e,this},c.prototype._decode=function(e,t){const n=this._baseState;if(null===n.parent)return e.wrapResult(n.children[0]._decode(e,t));let r,o=n.default,a=!0,s=null;if(null!==n.key&&(s=e.enterKey(n.key)),n.optional){let r=null;if(null!==n.explicit?r=n.explicit:null!==n.implicit?r=n.implicit:null!==n.tag&&(r=n.tag),null!==r||n.any){if(a=this._peekTag(e,r,n.any),e.isError(a))return a}else{const r=e.save();try{null===n.choice?this._decodeGeneric(n.tag,e,t):this._decodeChoice(e,t),a=!0}catch(e){a=!1}e.restore(r)}}if(n.obj&&a&&(r=e.enterObject()),a){if(null!==n.explicit){const t=this._decodeTag(e,n.explicit);if(e.isError(t))return t;e=t}const r=e.offset;if(null===n.use&&null===n.choice){let t;n.any&&(t=e.save());const r=this._decodeTag(e,null!==n.implicit?n.implicit:n.tag,n.any);if(e.isError(r))return r;n.any?o=e.raw(t):e=r}if(t&&t.track&&null!==n.tag&&t.track(e.path(),r,e.length,"tagged"),t&&t.track&&null!==n.tag&&t.track(e.path(),e.offset,e.length,"content"),n.any||(o=null===n.choice?this._decodeGeneric(n.tag,e,t):this._decodeChoice(e,t)),e.isError(o))return o;if(n.any||null!==n.choice||null===n.children||n.children.forEach((function(n){n._decode(e,t)})),n.contains&&("octstr"===n.tag||"bitstr"===n.tag)){const r=new i(o);o=this._getUse(n.contains,e._reporterState.obj)._decode(r,t)}}return n.obj&&a&&(o=e.leaveObject(r)),null===n.key||null===o&&!0!==a?null!==s&&e.exitKey(s):e.leaveKey(s,n.key,o),o},c.prototype._decodeGeneric=function(e,t,n){const r=this._baseState;return"seq"===e||"set"===e?null:"seqof"===e||"setof"===e?this._decodeList(t,e,r.args[0],n):/str$/.test(e)?this._decodeStr(t,e,n):"objid"===e&&r.args?this._decodeObjid(t,r.args[0],r.args[1],n):"objid"===e?this._decodeObjid(t,null,null,n):"gentime"===e||"utctime"===e?this._decodeTime(t,e,n):"null_"===e?this._decodeNull(t,n):"bool"===e?this._decodeBool(t,n):"objDesc"===e?this._decodeStr(t,e,n):"int"===e||"enum"===e?this._decodeInt(t,r.args&&r.args[0],n):null!==r.use?this._getUse(r.use,t._reporterState.obj)._decode(t,n):t.error("unknown tag: "+e)},c.prototype._getUse=function(e,t){const n=this._baseState;return n.useDecoder=this._use(e,t),a(null===n.useDecoder._baseState.parent),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder},c.prototype._decodeChoice=function(e,t){const n=this._baseState;let r=null,i=!1;return Object.keys(n.choice).some((function(o){const a=e.save(),s=n.choice[o];try{const n=s._decode(e,t);if(e.isError(n))return!1;r={type:o,value:n},i=!0}catch(t){return e.restore(a),!1}return!0}),this),i?r:e.error("Choice not matched")},c.prototype._createEncoderBuffer=function(e){return new r(e,this.reporter)},c.prototype._encode=function(e,t,n){const r=this._baseState;if(null!==r.default&&r.default===e)return;const i=this._encodeValue(e,t,n);return void 0===i||this._skipDefault(i,t,n)?void 0:i},c.prototype._encodeValue=function(e,t,r){const i=this._baseState;if(null===i.parent)return i.children[0]._encode(e,t||new n);let o=null;if(this.reporter=t,i.optional&&void 0===e){if(null===i.default)return;e=i.default}let a=null,s=!1;if(i.any)o=this._createEncoderBuffer(e);else if(i.choice)o=this._encodeChoice(e,t);else if(i.contains)a=this._getUse(i.contains,r)._encode(e,t),s=!0;else if(i.children)a=i.children.map((function(n){if("null_"===n._baseState.tag)return n._encode(null,t,e);if(null===n._baseState.key)return t.error("Child should have a key");const r=t.enterKey(n._baseState.key);if("object"!=typeof e)return t.error("Child expected, but input is not object");const i=n._encode(e[n._baseState.key],t,e);return t.leaveKey(r),i}),this).filter((function(e){return e})),a=this._createEncoderBuffer(a);else if("seqof"===i.tag||"setof"===i.tag){if(!i.args||1!==i.args.length)return t.error("Too many args for : "+i.tag);if(!Array.isArray(e))return t.error("seqof/setof, but data is not Array");const n=this.clone();n._baseState.implicit=null,a=this._createEncoderBuffer(e.map((function(n){const r=this._baseState;return this._getUse(r.args[0],e)._encode(n,t)}),n))}else null!==i.use?o=this._getUse(i.use,r)._encode(e,t):(a=this._encodePrimitive(i.tag,e),s=!0);if(!i.any&&null===i.choice){const e=null!==i.implicit?i.implicit:i.tag,n=null===i.implicit?"universal":"context";null===e?null===i.use&&t.error("Tag could be omitted only for .use()"):null===i.use&&(o=this._encodeComposite(e,s,n,a))}return null!==i.explicit&&(o=this._encodeComposite(i.explicit,!1,"context",o)),o},c.prototype._encodeChoice=function(e,t){const n=this._baseState,r=n.choice[e.type];return r||a(!1,e.type+" not found in "+JSON.stringify(Object.keys(n.choice))),r._encode(e.value,t)},c.prototype._encodePrimitive=function(e,t){const n=this._baseState;if(/str$/.test(e))return this._encodeStr(t,e);if("objid"===e&&n.args)return this._encodeObjid(t,n.reverseArgs[0],n.args[1]);if("objid"===e)return this._encodeObjid(t,null,null);if("gentime"===e||"utctime"===e)return this._encodeTime(t,e);if("null_"===e)return this._encodeNull();if("int"===e||"enum"===e)return this._encodeInt(t,n.args&&n.reverseArgs[0]);if("bool"===e)return this._encodeBool(t);if("objDesc"===e)return this._encodeStr(t,e);throw new Error("Unsupported tag: "+e)},c.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)},c.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '()+,-./:=?]*$/.test(e)}})),o.register("4oaGH",(function(t,n){var r;e(t.exports,"Reporter",(()=>r),(e=>r=e));var i=o("9iXO2");function a(e){this._reporterState={obj:null,path:[],options:e||{},errors:[]}}function s(e,t){this.path=e,this.rethrow(t)}r=a,a.prototype.isError=function(e){return e instanceof s},a.prototype.save=function(){const e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}},a.prototype.restore=function(e){const t=this._reporterState;t.obj=e.obj,t.path=t.path.slice(0,e.pathLen)},a.prototype.enterKey=function(e){return this._reporterState.path.push(e)},a.prototype.exitKey=function(e){const t=this._reporterState;t.path=t.path.slice(0,e-1)},a.prototype.leaveKey=function(e,t,n){const r=this._reporterState;this.exitKey(e),null!==r.obj&&(r.obj[t]=n)},a.prototype.path=function(){return this._reporterState.path.join("/")},a.prototype.enterObject=function(){const e=this._reporterState,t=e.obj;return e.obj={},t},a.prototype.leaveObject=function(e){const t=this._reporterState,n=t.obj;return t.obj=e,n},a.prototype.error=function(e){let t;const n=this._reporterState,r=e instanceof s;if(t=r?e:new s(n.path.map((function(e){return"["+JSON.stringify(e)+"]"})).join(""),e.message||e,e.stack),!n.options.partial)throw t;return r||n.errors.push(t),t},a.prototype.wrapResult=function(e){const t=this._reporterState;return t.options.partial?{result:this.isError(e)?null:e,errors:t.errors}:e},i(s,Error),s.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,s),!this.stack)try{throw new Error(this.message)}catch(e){this.stack=e.stack}return this}})),o.register("jAQPM",(function(t,n){var r,i;e(t.exports,"DecoderBuffer",(()=>r),(e=>r=e)),e(t.exports,"EncoderBuffer",(()=>i),(e=>i=e));var a=o("9iXO2"),s=o("4oaGH").Reporter,u=o("gaHwf").Buffer;function c(e,t){s.call(this,t),u.isBuffer(e)?(this.base=e,this.offset=0,this.length=e.length):this.error("Input not Buffer")}function l(e,t){if(Array.isArray(e))this.length=0,this.value=e.map((function(e){return l.isEncoderBuffer(e)||(e=new l(e,t)),this.length+=e.length,e}),this);else if("number"==typeof e){if(!(0<=e&&e<=255))return t.error("non-byte EncoderBuffer value");this.value=e,this.length=1}else if("string"==typeof e)this.value=e,this.length=u.byteLength(e);else{if(!u.isBuffer(e))return t.error("Unsupported type: "+typeof e);this.value=e,this.length=e.length}}a(c,s),r=c,c.isDecoderBuffer=function(e){if(e instanceof c)return!0;return"object"==typeof e&&u.isBuffer(e.base)&&"DecoderBuffer"===e.constructor.name&&"number"==typeof e.offset&&"number"==typeof e.length&&"function"==typeof e.save&&"function"==typeof e.restore&&"function"==typeof e.isEmpty&&"function"==typeof e.readUInt8&&"function"==typeof e.skip&&"function"==typeof e.raw},c.prototype.save=function(){return{offset:this.offset,reporter:s.prototype.save.call(this)}},c.prototype.restore=function(e){const t=new c(this.base);return t.offset=e.offset,t.length=this.offset,this.offset=e.offset,s.prototype.restore.call(this,e.reporter),t},c.prototype.isEmpty=function(){return this.offset===this.length},c.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")},c.prototype.skip=function(e,t){if(!(this.offset+e<=this.length))return this.error(t||"DecoderBuffer overrun");const n=new c(this.base);return n._reporterState=this._reporterState,n.offset=this.offset,n.length=this.offset+e,this.offset+=e,n},c.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)},i=l,l.isEncoderBuffer=function(e){if(e instanceof l)return!0;return"object"==typeof e&&"EncoderBuffer"===e.constructor.name&&"number"==typeof e.length&&"function"==typeof e.join},l.prototype.join=function(e,t){return e||(e=u.alloc(this.length)),t||(t=0),0===this.length||(Array.isArray(this.value)?this.value.forEach((function(n){n.join(e,t),t+=n.length})):("number"==typeof this.value?e[t]=this.value:"string"==typeof this.value?e.write(this.value,t):u.isBuffer(this.value)&&this.value.copy(e,t),t+=this.length)),e}})),o.register("MH0qh",(function(t,n){var r,i,o,a;function s(e){const t={};return Object.keys(e).forEach((function(n){(0|n)==n&&(n|=0);const r=e[n];t[r]=n})),t}e(t.exports,"tagClass",(()=>r),(e=>r=e)),e(t.exports,"tagClassByName",(()=>i),(e=>i=e)),e(t.exports,"tag",(()=>o),(e=>o=e)),e(t.exports,"tagByName",(()=>a),(e=>a=e)),i=s(r={0:"universal",1:"application",2:"context",3:"private"}),a=s(o={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"})})),o.register("2os5Q",(function(e,t){var n=o("9iXO2"),r=o("fscgm");function i(e){r.call(this,e),this.enc="pem"}n(i,r),e.exports=i,i.prototype.encode=function(e,t){const n=r.prototype.encode.call(this,e).toString("base64"),i=["-----BEGIN "+t.label+"-----"];for(let e=0;e<n.length;e+=64)i.push(n.slice(e,e+64));return i.push("-----END "+t.label+"-----"),i.join("\n")}})),o.register("auozE",(function(e,t){const n=e.exports;n.der=o("2Xdqb"),n.pem=o("mpZFB")})),o.register("2Xdqb",(function(e,t){var n=o("9iXO2"),r=o("ks3fn"),i=o("jAQPM").DecoderBuffer,a=o("5FKTu"),s=o("MH0qh");function u(e){this.enc="der",this.name=e.name,this.entity=e,this.tree=new c,this.tree._init(e.body)}function c(e){a.call(this,"der",e)}function l(e,t){let n=e.readUInt8(t);if(e.isError(n))return n;const r=s.tagClass[n>>6],i=0==(32&n);if(31==(31&n)){let r=n;for(n=0;128==(128&r);){if(r=e.readUInt8(t),e.isError(r))return r;n<<=7,n|=127&r}}else n&=31;return{cls:r,primitive:i,tag:n,tagStr:s.tag[n]}}function f(e,t,n){let r=e.readUInt8(n);if(e.isError(r))return r;if(!t&&128===r)return null;if(0==(128&r))return r;const i=127&r;if(i>4)return e.error("length octect is too long");r=0;for(let t=0;t<i;t++){r<<=8;const t=e.readUInt8(n);if(e.isError(t))return t;r|=t}return r}e.exports=u,u.prototype.decode=function(e,t){return i.isDecoderBuffer(e)||(e=new i(e,t)),this.tree._decode(e,t)},n(c,a),c.prototype._peekTag=function(e,t,n){if(e.isEmpty())return!1;const r=e.save(),i=l(e,'Failed to peek tag: "'+t+'"');return e.isError(i)?i:(e.restore(r),i.tag===t||i.tagStr===t||i.tagStr+"of"===t||n)},c.prototype._decodeTag=function(e,t,n){const r=l(e,'Failed to decode tag of "'+t+'"');if(e.isError(r))return r;let i=f(e,r.primitive,'Failed to get length of "'+t+'"');if(e.isError(i))return i;if(!n&&r.tag!==t&&r.tagStr!==t&&r.tagStr+"of"!==t)return e.error('Failed to match tag: "'+t+'"');if(r.primitive||null!==i)return e.skip(i,'Failed to match body of: "'+t+'"');const o=e.save(),a=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(a)?a:(i=e.offset-o.offset,e.restore(o),e.skip(i,'Failed to match body of: "'+t+'"'))},c.prototype._skipUntilEnd=function(e,t){for(;;){const n=l(e,t);if(e.isError(n))return n;const r=f(e,n.primitive,t);if(e.isError(r))return r;let i;if(i=n.primitive||null!==r?e.skip(r):this._skipUntilEnd(e,t),e.isError(i))return i;if("end"===n.tagStr)break}},c.prototype._decodeList=function(e,t,n,r){const i=[];for(;!e.isEmpty();){const t=this._peekTag(e,"end");if(e.isError(t))return t;const o=n.decode(e,"der",r);if(e.isError(o)&&t)break;i.push(o)}return i},c.prototype._decodeStr=function(e,t){if("bitstr"===t){const t=e.readUInt8();return e.isError(t)?t:{unused:t,data:e.raw()}}if("bmpstr"===t){const t=e.raw();if(t.length%2==1)return e.error("Decoding of string type: bmpstr length mismatch");let n="";for(let e=0;e<t.length/2;e++)n+=String.fromCharCode(t.readUInt16BE(2*e));return n}if("numstr"===t){const t=e.raw().toString("ascii");return this._isNumstr(t)?t:e.error("Decoding of string type: numstr unsupported characters")}if("octstr"===t)return e.raw();if("objDesc"===t)return e.raw();if("printstr"===t){const t=e.raw().toString("ascii");return this._isPrintstr(t)?t:e.error("Decoding of string type: printstr unsupported characters")}return/str$/.test(t)?e.raw().toString():e.error("Decoding of string type: "+t+" unsupported")},c.prototype._decodeObjid=function(e,t,n){let r;const i=[];let o=0,a=0;for(;!e.isEmpty();)a=e.readUInt8(),o<<=7,o|=127&a,0==(128&a)&&(i.push(o),o=0);128&a&&i.push(o);const s=i[0]/40|0,u=i[0]%40;if(r=n?i:[s,u].concat(i.slice(1)),t){let e=t[r.join(" ")];void 0===e&&(e=t[r.join(".")]),void 0!==e&&(r=e)}return r},c.prototype._decodeTime=function(e,t){const n=e.raw().toString();let r,i,o,a,s,u;if("gentime"===t)r=0|n.slice(0,4),i=0|n.slice(4,6),o=0|n.slice(6,8),a=0|n.slice(8,10),s=0|n.slice(10,12),u=0|n.slice(12,14);else{if("utctime"!==t)return e.error("Decoding "+t+" time is not supported yet");r=0|n.slice(0,2),i=0|n.slice(2,4),o=0|n.slice(4,6),a=0|n.slice(6,8),s=0|n.slice(8,10),u=0|n.slice(10,12),r=r<70?2e3+r:1900+r}return Date.UTC(r,i-1,o,a,s,u,0)},c.prototype._decodeNull=function(){return null},c.prototype._decodeBool=function(e){const t=e.readUInt8();return e.isError(t)?t:0!==t},c.prototype._decodeInt=function(e,t){const n=e.raw();let i=new r(n);return t&&(i=t[i.toString(10)]||i),i},c.prototype._use=function(e,t){return"function"==typeof e&&(e=e(t)),e._getDecoder("der").tree}})),o.register("mpZFB",(function(e,t){var n=o("9iXO2"),r=o("gaHwf").Buffer,i=o("2Xdqb");function a(e){i.call(this,e),this.enc="pem"}n(a,i),e.exports=a,a.prototype.decode=function(e,t){const n=e.toString().split(/[\r\n]+/g),o=t.label.toUpperCase(),a=/^-----(BEGIN|END) ([^-]+)-----$/;let s=-1,u=-1;for(let e=0;e<n.length;e++){const t=n[e].match(a);if(null!==t&&t[2]===o){if(-1!==s){if("END"!==t[1])break;u=e;break}if("BEGIN"!==t[1])break;s=e}}if(-1===s||-1===u)throw new Error("PEM section not found for: "+o);const c=n.slice(s+1,u).join("");c.replace(/[^a-z0-9+/=]+/gi,"");const l=r.from(c,"base64");return i.prototype.decode.call(this,l,t)}})),o.register("ls5CE",(function(e,t){const n=e.exports;n.Reporter=o("4oaGH").Reporter,n.DecoderBuffer=o("jAQPM").DecoderBuffer,n.EncoderBuffer=o("jAQPM").EncoderBuffer,n.Node=o("5FKTu")})),o.register("lOEVn",(function(e,t){const n=e.exports;n._reverse=function(e){const t={};return Object.keys(e).forEach((function(n){(0|n)==n&&(n|=0);const r=e[n];t[r]=n})),t},n.der=o("MH0qh")})),o.register("h6QG3",(function(e,t){var n=o("4SGXr"),r=n.define("Time",(function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})})),i=n.define("AttributeTypeValue",(function(){this.seq().obj(this.key("type").objid(),this.key("value").any())})),a=n.define("AlgorithmIdentifier",(function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())})),s=n.define("SubjectPublicKeyInfo",(function(){this.seq().obj(this.key("algorithm").use(a),this.key("subjectPublicKey").bitstr())})),u=n.define("RelativeDistinguishedName",(function(){this.setof(i)})),c=n.define("RDNSequence",(function(){this.seqof(u)})),l=n.define("Name",(function(){this.choice({rdnSequence:this.use(c)})})),f=n.define("Validity",(function(){this.seq().obj(this.key("notBefore").use(r),this.key("notAfter").use(r))})),h=n.define("Extension",(function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())})),d=n.define("TBSCertificate",(function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(a),this.key("issuer").use(l),this.key("validity").use(f),this.key("subject").use(l),this.key("subjectPublicKeyInfo").use(s),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(h).optional())})),p=n.define("X509Certificate",(function(){this.seq().obj(this.key("tbsCertificate").use(d),this.key("signatureAlgorithm").use(a),this.key("signatureValue").bitstr())}));e.exports=p})),o.register("kToZc",(function(e,t){e.exports=JSON.parse('{"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}')})),o.register("k1A0j",(function(e,t){var n=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,r=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,i=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,a=o("jp7Eg"),s=o("1oSxb"),u=o("2BZf1").Buffer;e.exports=function(e,t){var o,c=e.toString(),l=c.match(n);if(l){var f="aes"+l[1],h=u.from(l[2],"hex"),d=u.from(l[3].replace(/[\r\n]/g,""),"base64"),p=a(t,h.slice(0,8),parseInt(l[1],10)).key,m=[],y=s.createDecipheriv(f,p,h);m.push(y.update(d)),m.push(y.final()),o=u.concat(m)}else{var g=c.match(i);o=u.from(g[2].replace(/[\r\n]/g,""),"base64")}return{tag:c.match(r)[1],data:o}}})),o.register("2qXhr",(function(e,t){e.exports=JSON.parse('{"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}')})),o.register("7XJvb",(function(e,t){var n=o("2BZf1").Buffer,r=o("1kdEK"),i=o("as8Ac").ec,a=o("gQsHl"),s=o("2qXhr");function u(e,t){if(e.cmpn(0)<=0)throw new Error("invalid sig");if(e.cmp(t)>=t)throw new Error("invalid sig")}e.exports=function(e,t,o,c,l){var f=a(o);if("ec"===f.type){if("ecdsa"!==c&&"ecdsa/rsa"!==c)throw new Error("wrong public key type");return function(e,t,n){var r=s[n.data.algorithm.curve.join(".")];if(!r)throw new Error("unknown curve "+n.data.algorithm.curve.join("."));var o=new i(r),a=n.data.subjectPrivateKey.data;return o.verify(t,e,a)}(e,t,f)}if("dsa"===f.type){if("dsa"!==c)throw new Error("wrong public key type");return function(e,t,n){var i=n.data.p,o=n.data.q,s=n.data.g,c=n.data.pub_key,l=a.signature.decode(e,"der"),f=l.s,h=l.r;u(f,o),u(h,o);var d=r.mont(i),p=f.invm(o);return 0===s.toRed(d).redPow(new r(t).mul(p).mod(o)).fromRed().mul(c.toRed(d).redPow(h.mul(p).mod(o)).fromRed()).mod(i).mod(o).cmp(h)}(e,t,f)}if("rsa"!==c&&"ecdsa/rsa"!==c)throw new Error("wrong public key type");t=n.concat([l,t]);for(var h=f.modulus.byteLength(),d=[1],p=0;t.length+d.length+2<h;)d.push(255),p++;d.push(0);for(var m=-1;++m<t.length;)d.push(t[m]);d=n.from(d);var y=r.mont(f.modulus);e=(e=new r(e).toRed(y)).redPow(new r(f.publicExponent)),e=n.from(e.fromRed().toArray());var g=p<8?1:0;for(h=Math.min(e.length,d.length),e.length!==d.length&&(g=1),m=-1;++m<h;)g|=e[m]^d[m];return 0===g}})),o.register("bQVPk",(function(e,t){var n=o("150uq").Buffer,r=o("as8Ac"),i=o("ks3fn");e.exports=function(e){return new s(e)};var a={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};function s(e){this.curveType=a[e],this.curveType||(this.curveType={name:e}),this.curve=new r.ec(this.curveType.name),this.keys=void 0}function u(e,t,r){Array.isArray(e)||(e=e.toArray());var i=new n(e);if(r&&i.length<r){var o=new n(r-i.length);o.fill(0),i=n.concat([o,i])}return t?i.toString(t):i}a.p224=a.secp224r1,a.p256=a.secp256r1=a.prime256v1,a.p192=a.secp192r1=a.prime192v1,a.p384=a.secp384r1,a.p521=a.secp521r1,s.prototype.generateKeys=function(e,t){return this.keys=this.curve.genKeyPair(),this.getPublicKey(e,t)},s.prototype.computeSecret=function(e,t,r){return t=t||"utf8",n.isBuffer(e)||(e=new n(e,t)),u(this.curve.keyFromPublic(e).getPublic().mul(this.keys.getPrivate()).getX(),r,this.curveType.byteLength)},s.prototype.getPublicKey=function(e,t){var n=this.keys.getPublic("compressed"===t,!0);return"hybrid"===t&&(n[n.length-1]%2?n[0]=7:n[0]=6),u(n,e)},s.prototype.getPrivateKey=function(e){return u(this.keys.getPrivate(),e)},s.prototype.setPublicKey=function(e,t){return t=t||"utf8",n.isBuffer(e)||(e=new n(e,t)),this.keys._importPublic(e),this},s.prototype.setPrivateKey=function(e,t){t=t||"utf8",n.isBuffer(e)||(e=new n(e,t));var r=new i(e);return r=r.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(r),this}})),o.register("dHzAL",(function(t,n){var r,i,a,s;e(t.exports,"publicEncrypt",(()=>r),(e=>r=e)),e(t.exports,"privateDecrypt",(()=>i),(e=>i=e)),e(t.exports,"privateEncrypt",(()=>a),(e=>a=e)),e(t.exports,"publicDecrypt",(()=>s),(e=>s=e)),r=o("k2ee6"),i=o("7I7qf"),a=function(e,t){return r(e,t,!0)},s=function(e,t){return i(e,t,!0)}})),o.register("k2ee6",(function(e,t){var n=o("gQsHl"),r=o("9qUDb"),i=o("akhbg"),a=o("eNwwZ"),s=o("5Nodi"),u=o("ks3fn"),c=o("7wTz1"),l=o("cfdDN"),f=o("2BZf1").Buffer;e.exports=function(e,t,o){var h;h=e.padding?e.padding:o?1:4;var d,p=n(e);if(4===h)d=function(e,t){var n=e.modulus.byteLength(),o=t.length,c=i("sha1").update(f.alloc(0)).digest(),l=c.length,h=2*l;if(o>n-h-2)throw new Error("message too long");var d=f.alloc(n-o-h-2),p=n-l-1,m=r(l),y=s(f.concat([c,d,f.alloc(1,1),t],p),a(m,p)),g=s(m,a(y,l));return new u(f.concat([f.alloc(1),g,y],n))}(p,t);else if(1===h)d=function(e,t,n){var i,o=t.length,a=e.modulus.byteLength();if(o>a-11)throw new Error("message too long");i=n?f.alloc(a-o-3,255):function(e){var t,n=f.allocUnsafe(e),i=0,o=r(2*e),a=0;for(;i<e;)a===o.length&&(o=r(2*e),a=0),(t=o[a++])&&(n[i++]=t);return n}(a-o-3);return new u(f.concat([f.from([0,n?1:2]),i,f.alloc(1),t],a))}(p,t,o);else{if(3!==h)throw new Error("unknown padding");if((d=new u(t)).cmp(p.modulus)>=0)throw new Error("data too long for modulus")}return o?l(d,p):c(d,p)}})),o.register("eNwwZ",(function(e,t){var n=o("akhbg"),r=o("2BZf1").Buffer;function i(e){var t=r.allocUnsafe(4);return t.writeUInt32BE(e,0),t}e.exports=function(e,t){for(var o,a=r.alloc(0),s=0;a.length<t;)o=i(s++),a=r.concat([a,n("sha1").update(e).update(o).digest()]);return a.slice(0,t)}})),o.register("5Nodi",(function(e,t){e.exports=function(e,t){for(var n=e.length,r=-1;++r<n;)e[r]^=t[r];return e}})),o.register("7wTz1",(function(e,t){var n=o("ks3fn"),r=o("2BZf1").Buffer;e.exports=function(e,t){return r.from(e.toRed(n.mont(t.modulus)).redPow(new n(t.publicExponent)).fromRed().toArray())}})),o.register("7I7qf",(function(e,t){var n=o("gQsHl"),r=o("eNwwZ"),i=o("5Nodi"),a=o("ks3fn"),s=o("cfdDN"),u=o("akhbg"),c=o("7wTz1"),l=o("2BZf1").Buffer;e.exports=function(e,t,o){var f;f=e.padding?e.padding:o?1:4;var h,d=n(e),p=d.modulus.byteLength();if(t.length>p||new a(t).cmp(d.modulus)>=0)throw new Error("decryption error");h=o?c(new a(t),d):s(t,d);var m=l.alloc(p-h.length);if(h=l.concat([m,h],p),4===f)return function(e,t){var n=e.modulus.byteLength(),o=u("sha1").update(l.alloc(0)).digest(),a=o.length;if(0!==t[0])throw new Error("decryption error");var s=t.slice(1,a+1),c=t.slice(a+1),f=i(s,r(c,a)),h=i(c,r(f,n-a-1));if(function(e,t){e=l.from(e),t=l.from(t);var n=0,r=e.length;e.length!==t.length&&(n++,r=Math.min(e.length,t.length));var i=-1;for(;++i<r;)n+=e[i]^t[i];return n}(o,h.slice(0,a)))throw new Error("decryption error");var d=a;for(;0===h[d];)d++;if(1!==h[d++])throw new Error("decryption error");return h.slice(d)}(d,h);if(1===f)return function(e,t,n){var r=t.slice(0,2),i=2,o=0;for(;0!==t[i++];)if(i>=t.length){o++;break}var a=t.slice(2,i-1);("0002"!==r.toString("hex")&&!n||"0001"!==r.toString("hex")&&n)&&o++;a.length<8&&o++;if(o)throw new Error("decryption error");return t.slice(i)}(0,h,o);if(3===f)return h;throw new Error("unknown padding")}})),o.register("5TMqn",(function(n,r){var i,a;e(n.exports,"randomFill",(()=>i),(e=>i=e)),e(n.exports,"randomFillSync",(()=>a),(e=>a=e));var s=o("iThRa");function u(){throw new Error("secure random number generation not supported by this browser\nuse chrome, FireFox or Internet Explorer 11")}var c=o("2BZf1"),l=(o("9qUDb"),c.Buffer),f=c.kMaxLength,h=t.crypto||t.msCrypto,d=Math.pow(2,32)-1;function p(e,t){if("number"!=typeof e||e!=e)throw new TypeError("offset must be a number");if(e>d||e<0)throw new TypeError("offset must be a uint32");if(e>f||e>t)throw new RangeError("offset out of range")}function m(e,t,n){if("number"!=typeof e||e!=e)throw new TypeError("size must be a number");if(e>d||e<0)throw new TypeError("size must be a uint32");if(e+t>n||e>f)throw new RangeError("buffer too small")}function y(e,t,n,r){var i=e.buffer,o=new Uint8Array(i,t,n);if(h.getRandomValues(o),!r)return e;s.nextTick((function(){r(null,e)}))}h&&h.getRandomValues?(i=function(e,n,r,i){if(!(l.isBuffer(e)||e instanceof t.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if("function"==typeof n)i=n,n=0,r=e.length;else if("function"==typeof r)i=r,r=e.length-n;else if("function"!=typeof i)throw new TypeError('"cb" argument must be a function');return p(n,e.length),m(r,n,e.length),y(e,n,r,i)},a=function(e,n,r){void 0===n&&(n=0);if(!(l.isBuffer(e)||e instanceof t.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');p(n,e.length),void 0===r&&(r=e.length-n);return m(r,n,e.length),y(e,n,r)}):(i=u,a=u)})),o.register("9zwav",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Schnorr=void 0;var r=o("7TSDW");s(o("gNLRL"),e.exports);e.exports.Schnorr=class{constructor(e){this.wasm=e}constructSignature(e,t){return this.wasm.transferToHeap(t,64),this.wasm.transferToHeap(e,96),this.wasm.call("construct_signature",96,e.length,64,0,32),new(o("gNLRL").SchnorrSignature)(n.from(this.wasm.sliceMemory(0,64)))}computePublicKey(e){return this.wasm.transferToHeap(e,0),this.wasm.call("compute_public_key",0,32),n.from(this.wasm.sliceMemory(32,96))}verifySignature(e,t,n){return this.wasm.transferToHeap(t,0),this.wasm.transferToHeap(n.s(),64),this.wasm.transferToHeap(n.e(),96),this.wasm.transferToHeap(e,128),!!this.wasm.call("verify_signature",128,e.length,0,64,96)}multiSigComputePublicKey(e){return this.wasm.transferToHeap(e,128),this.wasm.call("multisig_create_multisig_public_key",128,0),n.from(this.wasm.sliceMemory(0,128))}multiSigValidateAndCombinePublicKeys(e){const t=(0,r.serializeBufferArrayToVector)(e);return this.wasm.transferToHeap(t,64),this.wasm.call("multisig_validate_and_combine_signer_pubkeys",64,0),n.from(this.wasm.sliceMemory(0,64))}multiSigRoundOne(){return this.wasm.call("multisig_construct_signature_round_1",0,128),{publicOutput:n.from(this.wasm.sliceMemory(0,128)),privateOutput:n.from(this.wasm.sliceMemory(128,192))}}multiSigRoundTwo(e,t,i,o,a){const s=(0,r.serializeBufferArrayToVector)(o),u=(0,r.serializeBufferArrayToVector)(a);this.wasm.transferToHeap(e,32);const c=32+e.length;this.wasm.transferToHeap(t,c);const l=c+32;this.wasm.transferToHeap(i,l);const f=l+64;this.wasm.transferToHeap(s,f);const h=f+s.length;return this.wasm.transferToHeap(u,h),this.wasm.call("multisig_construct_signature_round_2",32,e.length,c,l,f,h,0),n.from(this.wasm.sliceMemory(0,32))}multiSigCombineSignatures(e,t,i,a){const s=(0,r.serializeBufferArrayToVector)(t),u=(0,r.serializeBufferArrayToVector)(i),c=(0,r.serializeBufferArrayToVector)(a);this.wasm.transferToHeap(e,64);const l=64+e.length;this.wasm.transferToHeap(s,l);const f=l+s.length;this.wasm.transferToHeap(u,f);const h=f+u.length;return this.wasm.transferToHeap(c,h),this.wasm.call("multisig_combine_signatures",64,e.length,l,f,h,0,32),new(o("gNLRL").SchnorrSignature)(n.from(this.wasm.sliceMemory(0,64)))}}})),o.register("gNLRL",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SchnorrSignature=void 0;var r=o("da7qy");class i{constructor(e){if(this.buffer=e,e.length!==i.SIZE)throw new Error("Invalid signature buffer.")}static isSignature(e){return/^(0x)?[0-9a-f]{128}$/i.test(e)}static fromString(e){if(!i.isSignature(e))throw new Error(`Invalid signature string: ${e}`);return new i(n.from(e.replace(/^0x/i,""),"hex"))}static randomSignature(){return new i((0,r.randomBytes)(64))}s(){return this.buffer.slice(0,32)}e(){return this.buffer.slice(32)}toBuffer(){return this.buffer}toString(){return`0x${this.buffer.toString("hex")}`}}e.exports.SchnorrSignature=i,i.SIZE=64})),o.register("4brpV",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Sha256=void 0;e.exports.Sha256=class{constructor(e){this.wasm=e}hash(e){const t=this.wasm.call("bbmalloc",e.length+32);this.wasm.transferToHeap(e,t),this.wasm.call("sha256__hash",t,e.length,t+e.length);const r=n.from(this.wasm.sliceMemory(t+e.length,t+e.length+32));return this.wasm.call("bbfree",t),r}}})),o.register("1C0Wt",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.GrumpkinAddress=void 0;var r=o("1vwiL"),i=o("6HKnN");class a{constructor(e){if(this.buffer=e,e.length!==a.SIZE)throw new Error("Invalid address buffer.")}static isAddress(e){return/^(0x|0X)?[0-9a-fA-F]{128}$/.test(e)}static fromString(e){if(!a.isAddress(e))throw new Error(`Invalid address string: ${e}`);return new a(n.from(e.replace(/^0x/i,""),"hex"))}static random(){return new a((0,r.randomBytes)(64))}static one(){return new a(i.Grumpkin.one)}equals(e){return this.buffer.equals(e.toBuffer())}toBuffer(){return this.buffer}x(){return this.buffer.slice(0,32)}y(){return this.buffer.slice(32)}toString(){return`0x${this.buffer.toString("hex")}`}toShortString(){const e=this.toString();return`${e.slice(0,10)}...${e.slice(-4)}`}}e.exports.GrumpkinAddress=a,a.SIZE=64,a.ZERO=new a(n.alloc(a.SIZE))})),o.register("6HKnN",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Grumpkin=void 0;class r{constructor(e){this.wasm=e}mul(e,t){return this.wasm.transferToHeap(e,0),this.wasm.transferToHeap(t,64),this.wasm.call("ecc_grumpkin__mul",0,64,96),n.from(this.wasm.sliceMemory(96,160))}batchMul(e,t,r){const i=this.wasm.call("bbmalloc",2*e.length);this.wasm.transferToHeap(e,i),this.wasm.transferToHeap(t,0),this.wasm.call("ecc_grumpkin__batch_mul",i,0,r,i+e.length);const o=n.from(this.wasm.sliceMemory(i+e.length,i+e.length+e.length));return this.wasm.call("bbfree",i),o}getRandomFr(){return this.wasm.call("ecc_grumpkin__get_random_scalar_mod_circuit_modulus",0),n.from(this.wasm.sliceMemory(0,32))}reduce512BufferToFr(e){return this.wasm.transferToHeap(e,0),this.wasm.call("ecc_grumpkin__reduce512_buffer_mod_circuit_modulus",0,64),n.from(this.wasm.sliceMemory(64,96))}}e.exports.Grumpkin=r,r.one=n.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,2,207,19,94,117,6,164,93,99,45,39,13,69,241,24,18,148,131,63,196,141,130,63,39,44])})),o.register("3f06J",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AccountAliasId=void 0;var r=o("7u2av");class i{constructor(e,t){this.aliasHash=e,this.accountNonce=t}static fromAlias(e,t,n){return new i(r.AliasHash.fromAlias(e,n),t)}static random(){return new i(r.AliasHash.random(),0)}static fromBuffer(e){if(32!==e.length)throw new Error("Invalid id buffer.");const t=new r.AliasHash(e.slice(4,32)),n=e.readUInt32BE(0);return new i(t,n)}toBuffer(){const e=n.alloc(4);return e.writeUInt32BE(this.accountNonce),n.concat([e,this.aliasHash.toBuffer()])}toString(){return`0x${this.toBuffer().toString("hex")}`}equals(e){return this.aliasHash.equals(e.aliasHash)&&this.accountNonce===e.accountNonce}}e.exports.AccountAliasId=i,i.ZERO=i.fromBuffer(n.alloc(32))})),o.register("7u2av",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AliasHash=void 0;var r=o("1vwiL");class i{constructor(e){if(this.buffer=e,e.length!==i.SIZE)throw new Error("Invalid alias hash buffer.")}static random(){return new i((0,r.randomBytes)(28))}static fromAlias(e,t){return new i(t.hashToField(n.from(e)).slice(0,28))}static fromString(e){return new i(n.from(e.replace(/^0x/i,""),"hex"))}toBuffer(){return this.buffer}toBuffer32(){const e=n.alloc(32);return this.buffer.copy(e,4),e}toString(){return`0x${this.toBuffer().toString("hex")}`}equals(e){return this.toBuffer().equals(e.toBuffer())}}e.exports.AliasHash=i,i.SIZE=28,i.ZERO=new i(n.alloc(i.SIZE))})),o.register("cP5rv",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("3PoGU"),e.exports),s(o("ex47A"),e.exports),s(o("dpPVK"),e.exports)})),o.register("3PoGU",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AccountProver=void 0;var r=o("iWLZZ");e.exports.AccountProver=class{constructor(e,t=!1){this.prover=e,this.mock=t}static getCircuitSize(e=!1){return e?512:32768}async computeKey(){const e=this.prover.getWorker();await e.call("account__init_proving_key",this.mock)}async loadKey(e){const t=this.prover.getWorker(),n=await t.call("bbmalloc",e.length);await t.transferToHeap((0,r.Transfer)(e,[e.buffer]),n),await t.call("account__init_proving_key_from_buffer",n),await t.call("bbfree",n)}async getKey(){const e=this.prover.getWorker();await e.acquire();try{const t=await e.call("account__get_new_proving_key_data",0),r=n.from(await e.sliceMemory(0,4)).readUInt32LE(0),i=n.from(await e.sliceMemory(r,r+t));return await e.call("bbfree",r),i}finally{await e.release()}}async computeSigningData(e){const t=this.prover.getWorker();return await t.transferToHeap(e.toBuffer(),0),await t.call("account__compute_signing_data",0,0),n.from(await t.sliceMemory(0,32))}async createAccountProof(e,t){const r=this.prover.getWorker(),i=n.concat([e.toBuffer(),t.toBuffer()]),o=await r.call("bbmalloc",i.length);await r.transferToHeap(i,o);const a=await r.call("account__new_prover",o,this.mock);await r.call("bbfree",o);const s=await this.prover.createProof(a);return await r.call("account__delete_prover",a),s}getProver(){return this.prover}}})),o.register("kMf2L",(function(t,n){e(t.exports,"Worker",(()=>i)),e(t.exports,"spawn",(()=>o("iQTyO").spawn)),e(t.exports,"Thread",(()=>o("fVCHJ").Thread));var r=o("drBze");o("iQTyO"),o("fVCHJ");r.getWorkerImplementation().blob;const i=r.getWorkerImplementation().default})),o.register("drBze",(function(t,n){e(t.exports,"getWorkerImplementation",(()=>u));var r=o("f2aQU");"undefined"!=typeof navigator&&navigator.hardwareConcurrency&&navigator.hardwareConcurrency;const i=e=>/^[a-zA-Z][a-zA-Z\d+\-.]*:/.test(e);function a(e){const t=new Blob([e],{type:"application/javascript"});return URL.createObjectURL(t)}let s;function u(){return s||(s=function(){if("undefined"==typeof Worker)return class{constructor(){throw Error("No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.")}};class e extends Worker{constructor(e,t){var n,o;"string"==typeof e&&t&&t._baseURL?e=new URL(e,t._baseURL):"string"==typeof e&&!i(e)&&r.getBundleURL().match(/^file:\/\//i)&&(e=new URL(e,r.getBundleURL().replace(/\/[^\/]+$/,"/")),(null===(n=null==t?void 0:t.CORSWorkaround)||void 0===n||n)&&(e=a(`importScripts(${JSON.stringify(e)});`))),"string"==typeof e&&i(e)&&(null===(o=null==t?void 0:t.CORSWorkaround)||void 0===o||o)&&(e=a(`importScripts(${JSON.stringify(e)});`)),super(e,t)}}class t extends e{constructor(e,t){super(window.URL.createObjectURL(e),t)}static fromText(e,n){const r=new window.Blob([e],{type:"text/javascript"});return new t(r,n)}}return{blob:t,default:e}}()),s}})),o.register("f2aQU",(function(t,n){let r;function i(){return r||(r=function(){try{throw new Error}catch(e){const t=(""+e.stack).match(/(https?|file|ftp|chrome-extension|moz-extension):\/\/[^)\n]+/g);if(t)return(""+t[0]).replace(/^((?:https?|file|ftp|chrome-extension|moz-extension):\/\/.+)?\/[^/]+(?:\?.*)?$/,"$1")+"/"}return"/"}()),r}e(t.exports,"getBundleURL",(()=>i))})),o.register("iQTyO",(function(t,r){e(t.exports,"spawn",(()=>g),(e=>g=e));var i=o("7LjTn"),a=o("nXuAs"),s=o("203xM"),u=o("5R190"),c=o("cI2tG"),l=o("7NjHm"),f=o("fGdf0"),h=function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))};const d=n(i)("threads:master:messages"),p=n(i)("threads:master:spawn"),m=n(i)("threads:master:thread-utils");function y(e,t,n,r){const i=n.filter((e=>e.type===l.WorkerEventType.internalError)).map((e=>e.error));return Object.assign(e,{[c.$errors]:i,[c.$events]:n,[c.$terminate]:r,[c.$worker]:t})}function g(e,t){return h(this,void 0,void 0,(function*(){p("Initializing new thread");const n=t&&t.timeout?t.timeout:1e4,r=yield function(e,t,n){return h(this,void 0,void 0,(function*(){let r;const i=new Promise(((e,i)=>{r=setTimeout((()=>i(Error(n))),t)})),o=yield Promise.race([e,i]);return clearTimeout(r),o}))}(function(e){return new Promise(((t,n)=>{const r=i=>{var o;d("Message from worker before finishing initialization:",i.data),(o=i.data)&&"init"===o.type?(e.removeEventListener("message",r),t(i.data)):(e=>e&&"uncaughtError"===e.type)(i.data)&&(e.removeEventListener("message",r),n(s.deserialize(i.data.error)))};e.addEventListener("message",r)}))}(e),n,`Timeout: Did not receive an init message from worker after ${n}ms. Make sure the worker calls expose().`),i=r.exposed,{termination:o,terminate:c}=function(e){const[t,n]=u.createPromiseWithResolver();return{terminate:()=>h(this,void 0,void 0,(function*(){m("Terminating worker"),yield e.terminate(),n()})),termination:t}}(e),g=function(e,t){return new a.default((n=>{const r=e=>{const t={type:l.WorkerEventType.message,data:e.data};n.next(t)},i=e=>{m("Unhandled promise rejection event in thread:",e);const t={type:l.WorkerEventType.internalError,error:Error(e.reason)};n.next(t)};e.addEventListener("message",r),e.addEventListener("unhandledrejection",i),t.then((()=>{const t={type:l.WorkerEventType.termination};e.removeEventListener("message",r),e.removeEventListener("unhandledrejection",i),n.next(t),n.complete()}))}))}(e,o);if("function"===i.type){return y(f.createProxyFunction(e),e,g,c)}if("module"===i.type){return y(f.createProxyModule(e,i.methods),e,g,c)}{const e=i.type;throw Error(`Worker init message states unexpected type of expose(): ${e}`)}}))}})),o.register("4krud",(function(t,n){e(t.exports,"default",(()=>s));var r=o("nXuAs"),i=o("3aT8c"),a=o("jlDhY");var s=function(e){const t=new i.default;let n,o=0;return new r.default((r=>{n||(n=e.subscribe(t));const i=t.subscribe(r);return o++,()=>{o--,i.unsubscribe(),0===o&&(a.default(n),n=void 0)}}))}})),o.register("nXuAs",(function(t,n){e(t.exports,"default",(()=>v));var r=o("eMqJT");const i=r.getSymbol("iterator"),a=r.getSymbol("observable"),s=r.getSymbol("species");function u(e,t){const n=e[t];if(null!=n){if("function"!=typeof n)throw new TypeError(n+" is not a function");return n}}function c(e){let t=e.constructor;return void 0!==t&&(t=t[s],null===t&&(t=void 0)),void 0!==t?t:b}function l(e){l.log?l.log(e):setTimeout((()=>{throw e}),0)}function f(e){Promise.resolve().then((()=>{try{e()}catch(e){l(e)}}))}function h(e){const t=e._cleanup;if(void 0!==t&&(e._cleanup=void 0,t))try{if("function"==typeof t)t();else{const e=u(t,"unsubscribe");e&&e.call(t)}}catch(e){l(e)}}function d(e){e._observer=void 0,e._queue=void 0,e._state="closed"}function p(e,t,n){e._state="running";const r=e._observer;try{const i=r?u(r,t):void 0;switch(t){case"next":i&&i.call(r,n);break;case"error":if(d(e),!i)throw n;i.call(r,n);break;case"complete":d(e),i&&i.call(r)}}catch(e){l(e)}"closed"===e._state?h(e):"running"===e._state&&(e._state="ready")}function m(e,t,n){if("closed"!==e._state)return"buffering"===e._state?(e._queue=e._queue||[],void e._queue.push({type:t,value:n})):"ready"!==e._state?(e._state="buffering",e._queue=[{type:t,value:n}],void f((()=>function(e){const t=e._queue;if(t){e._queue=void 0,e._state="ready";for(const n of t)if(p(e,n.type,n.value),"closed"===e._state)break}}(e)))):void p(e,t,n)}class y{constructor(e,t){this._cleanup=void 0,this._observer=e,this._queue=void 0,this._state="initializing";const n=new g(this);try{this._cleanup=t.call(void 0,n)}catch(e){n.error(e)}"initializing"===this._state&&(this._state="ready")}get closed(){return"closed"===this._state}unsubscribe(){"closed"!==this._state&&(d(this),h(this))}}class g{constructor(e){this._subscription=e}get closed(){return"closed"===this._subscription._state}next(e){m(this._subscription,"next",e)}error(e){m(this._subscription,"error",e)}complete(){m(this._subscription,"complete")}}class b{constructor(e){if(!(this instanceof b))throw new TypeError("Observable cannot be called as a function");if("function"!=typeof e)throw new TypeError("Observable initializer must be a function");this._subscriber=e}subscribe(e,t,n){return"object"==typeof e&&null!==e||(e={next:e,error:t,complete:n}),new y(e,this._subscriber)}pipe(e,...t){let n=this;for(const r of[e,...t])n=r(n);return n}tap(e,t,n){const r="object"!=typeof e||null===e?{next:e,error:t,complete:n}:e;return new b((e=>this.subscribe({next(t){r.next&&r.next(t),e.next(t)},error(t){r.error&&r.error(t),e.error(t)},complete(){r.complete&&r.complete(),e.complete()},start(e){r.start&&r.start(e)}})))}forEach(e){return new Promise(((t,n)=>{if("function"!=typeof e)return void n(new TypeError(e+" is not a function"));function r(){i.unsubscribe(),t(void 0)}const i=this.subscribe({next(t){try{e(t,r)}catch(e){n(e),i.unsubscribe()}},error(e){n(e)},complete(){t(void 0)}})}))}map(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(c(this))((t=>this.subscribe({next(n){let r=n;try{r=e(n)}catch(e){return t.error(e)}t.next(r)},error(e){t.error(e)},complete(){t.complete()}})))}filter(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return new(c(this))((t=>this.subscribe({next(n){try{if(!e(n))return}catch(e){return t.error(e)}t.next(n)},error(e){t.error(e)},complete(){t.complete()}})))}reduce(e,t){if("function"!=typeof e)throw new TypeError(e+" is not a function");const n=c(this),r=arguments.length>1;let i=!1,o=t;return new n((t=>this.subscribe({next(n){const a=!i;if(i=!0,!a||r)try{o=e(o,n)}catch(e){return t.error(e)}else o=n},error(e){t.error(e)},complete(){if(!i&&!r)return t.error(new TypeError("Cannot reduce an empty sequence"));t.next(o),t.complete()}})))}concat(...e){const t=c(this);return new t((n=>{let r,i=0;return function o(a){r=a.subscribe({next(e){n.next(e)},error(e){n.error(e)},complete(){i===e.length?(r=void 0,n.complete()):o(t.from(e[i++]))}})}(this),()=>{r&&(r.unsubscribe(),r=void 0)}}))}flatMap(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");const t=c(this);return new t((n=>{const r=[],i=this.subscribe({next(i){let a;if(e)try{a=e(i)}catch(e){return n.error(e)}else a=i;const s=t.from(a).subscribe({next(e){n.next(e)},error(e){n.error(e)},complete(){const e=r.indexOf(s);e>=0&&r.splice(e,1),o()}});r.push(s)},error(e){n.error(e)},complete(){o()}});function o(){i.closed&&0===r.length&&n.complete()}return()=>{r.forEach((e=>e.unsubscribe())),i.unsubscribe()}}))}[(Symbol.observable,a)](){return this}static from(e){const t="function"==typeof this?this:b;if(null==e)throw new TypeError(e+" is not an object");const n=u(e,a);if(n){const r=n.call(e);if(Object(r)!==r)throw new TypeError(r+" is not an object");return function(e){return e instanceof b}(r)&&r.constructor===t?r:new t((e=>r.subscribe(e)))}if(r.hasSymbol("iterator")){const n=u(e,i);if(n)return new t((t=>{f((()=>{if(!t.closed){for(const r of n.call(e))if(t.next(r),t.closed)return;t.complete()}}))}))}if(Array.isArray(e))return new t((t=>{f((()=>{if(!t.closed){for(const n of e)if(t.next(n),t.closed)return;t.complete()}}))}));throw new TypeError(e+" is not observable")}static of(...e){return new("function"==typeof this?this:b)((t=>{f((()=>{if(!t.closed){for(const n of e)if(t.next(n),t.closed)return;t.complete()}}))}))}static get[s](){return this}}r.hasSymbols()&&Object.defineProperty(b,Symbol("extensions"),{value:{symbol:a,hostReportError:l},configurable:!0});var v=b})),o.register("eMqJT",(function(t,n){e(t.exports,"hasSymbols",(()=>r)),e(t.exports,"hasSymbol",(()=>i)),e(t.exports,"getSymbol",(()=>o));const r=()=>"function"==typeof Symbol,i=e=>r()&&Boolean(Symbol[e]),o=e=>i(e)?Symbol[e]:"@@"+e;i("asyncIterator")||(Symbol.asyncIterator=Symbol.asyncIterator||Symbol.for("Symbol.asyncIterator"))})),o.register("3aT8c",(function(t,n){e(t.exports,"default",(()=>a));var r=o("nXuAs");class i extends r.default{constructor(){super((e=>(this._observers.add(e),()=>this._observers.delete(e)))),this._observers=new Set}next(e){for(const t of this._observers)t.next(e)}error(e){for(const t of this._observers)t.error(e)}complete(){for(const e of this._observers)e.complete()}}var a=i})),o.register("jlDhY",(function(t,n){e(t.exports,"default",(()=>r));var r=function(e){"function"==typeof e?e():e&&"function"==typeof e.unsubscribe&&e.unsubscribe()}})),o.register("203xM",(function(t,n){e(t.exports,"deserialize",(()=>a)),e(t.exports,"serialize",(()=>s));var r=o("hnwfC");let i=r.DefaultSerializer;function a(e){return i.deserialize(e)}function s(e){return i.serialize(e)}})),o.register("hnwfC",(function(t,n){function r(e,t){const n=e.deserialize.bind(e),r=e.serialize.bind(e);return{deserialize:e=>t.deserialize(e,n),serialize:e=>t.serialize(e,r)}}e(t.exports,"extendSerializer",(()=>r)),e(t.exports,"DefaultSerializer",(()=>o));const i={deserialize:e=>Object.assign(Error(e.message),{name:e.name,stack:e.stack}),serialize:e=>({__error_marker:"$$error",message:e.message,name:e.name,stack:e.stack})},o={deserialize(e){return(t=e)&&"object"==typeof t&&"__error_marker"in t&&"$$error"===t.__error_marker?i.deserialize(e):e;var t},serialize:e=>e instanceof Error?i.serialize(e):e}})),o.register("5R190",(function(t,n){e(t.exports,"createPromiseWithResolver",(()=>i));const r=()=>{};function i(){let e,t=!1,n=r;return[new Promise((r=>{t?r(e):n=r})),r=>{t=!0,e=r,n(e)}]}})),o.register("cI2tG",(function(t,n){e(t.exports,"$errors",(()=>r)),e(t.exports,"$events",(()=>i)),e(t.exports,"$terminate",(()=>o)),e(t.exports,"$transferable",(()=>a)),e(t.exports,"$worker",(()=>s));const r=Symbol("thread.errors"),i=Symbol("thread.events"),o=Symbol("thread.terminate"),a=Symbol("thread.transferable"),s=Symbol("thread.worker")})),o.register("7NjHm",(function(t,n){var r;e(t.exports,"WorkerEventType",(()=>r)),function(e){e.internalError="internalError",e.message="message",e.termination="termination"}(r||(r={}))})),o.register("fGdf0",(function(t,r){e(t.exports,"createProxyFunction",(()=>m)),e(t.exports,"createProxyModule",(()=>y));var i=o("7LjTn"),a=o("nXuAs"),s=o("4krud"),u=o("203xM"),c=o("afpi3"),l=o("iWLZZ"),f=o("fn2ff");const h=n(i)("threads:master:messages");let d=1;function p(e,t){return new a.default((n=>{let r;const i=o=>{var a;if(h("Message from worker:",o.data),o.data&&o.data.uid===t)if((a=o.data)&&a.type===f.WorkerMessageType.running)r=o.data.resultType;else if((e=>e&&e.type===f.WorkerMessageType.result)(o.data))"promise"===r?(void 0!==o.data.payload&&n.next(u.deserialize(o.data.payload)),n.complete(),e.removeEventListener("message",i)):(o.data.payload&&n.next(u.deserialize(o.data.payload)),o.data.complete&&(n.complete(),e.removeEventListener("message",i)));else if((e=>e&&e.type===f.WorkerMessageType.error)(o.data)){const t=u.deserialize(o.data.error);n.error(t),e.removeEventListener("message",i)}};return e.addEventListener("message",i),()=>{if("observable"===r||!r){const n={type:f.MasterMessageType.cancel,uid:t};e.postMessage(n)}e.removeEventListener("message",i)}}))}function m(e,t){return(...n)=>{const r=d++,{args:i,transferables:o}=function(e){if(0===e.length)return{args:[],transferables:[]};const t=[],n=[];for(const r of e)l.isTransferDescriptor(r)?(t.push(u.serialize(r.send)),n.push(...r.transferables)):t.push(u.serialize(r));return{args:t,transferables:0===n.length?n:(r=n,Array.from(new Set(r)))};var r}(n),a={type:f.MasterMessageType.run,uid:r,method:t,args:i};h("Sending command to run function to worker:",a);try{e.postMessage(a,o)}catch(e){return c.ObservablePromise.from(Promise.reject(e))}return c.ObservablePromise.from(s.default(p(e,r)))}}function y(e,t){const n={};for(const r of t)n[r]=m(e,r);return n}})),o.register("afpi3",(function(t,n){e(t.exports,"ObservablePromise",(()=>c));var r=o("nXuAs");const i=()=>{},a=e=>e,s=e=>Promise.resolve().then(e);function u(e){throw e}class c extends r.default{constructor(e){super((t=>{const n=this,r=Object.assign(Object.assign({},t),{complete(){t.complete(),n.onCompletion()},error(e){t.error(e),n.onError(e)},next(e){t.next(e),n.onNext(e)}});try{return this.initHasRun=!0,e(r)}catch(e){r.error(e)}})),this.initHasRun=!1,this.fulfillmentCallbacks=[],this.rejectionCallbacks=[],this.firstValueSet=!1,this.state="pending"}onNext(e){this.firstValueSet||(this.firstValue=e,this.firstValueSet=!0)}onError(e){this.state="rejected",this.rejection=e;for(const t of this.rejectionCallbacks)s((()=>t(e)))}onCompletion(){this.state="fulfilled";for(const e of this.fulfillmentCallbacks)s((()=>e(this.firstValue)))}then(e,t){const n=e||a,r=t||u;let i=!1;return new Promise(((e,t)=>{const o=n=>{if(!i){i=!0;try{e(r(n))}catch(e){t(e)}}};return this.initHasRun||this.subscribe({error:o}),"fulfilled"===this.state?e(n(this.firstValue)):"rejected"===this.state?(i=!0,e(r(this.rejection))):(this.fulfillmentCallbacks.push((t=>{try{e(n(t))}catch(e){o(e)}})),void this.rejectionCallbacks.push(o))}))}catch(e){return this.then(void 0,e)}finally(e){const t=e||i;return this.then((e=>(t(),e)),(()=>t()))}static from(e){return function(e){return e&&"function"==typeof e.then}(e)?new c((t=>{e.then((e=>{t.next(e),t.complete()}),(e=>{t.error(e)}))})):super.from(e)}}})),o.register("iWLZZ",(function(t,n){e(t.exports,"isTransferDescriptor",(()=>i)),e(t.exports,"Transfer",(()=>a));var r=o("cI2tG");function i(e){return e&&"object"==typeof e&&e[r.$transferable]}function a(e,t){if(!t){if(!(n=e)||"object"!=typeof n)throw Error();t=[e]}var n;return{[r.$transferable]:!0,send:e,transferables:t}}})),o.register("fn2ff",(function(t,n){var r,i;e(t.exports,"MasterMessageType",(()=>r)),e(t.exports,"WorkerMessageType",(()=>i)),function(e){e.cancel="cancel",e.run="run"}(r||(r={})),function(e){e.error="error",e.init="init",e.result="result",e.running="running",e.uncaughtError="uncaughtError"}(i||(i={}))})),o.register("fVCHJ",(function(t,n){e(t.exports,"Thread",(()=>a));var r=o("cI2tG");function i(e){throw Error(e)}const a={errors:e=>e[r.$errors]||i("Error observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),events:e=>e[r.$events]||i("Events observable not found. Make sure to pass a thread instance as returned by the spawn() promise."),terminate:e=>e[r.$terminate]()}})),o.register("9nZy3",(function(e,t){o("ajyVP");var n=o("203xM"),r=(o("iWLZZ"),o("fn2ff")),i=o("1IT7b"),a=(n=o("203xM"),o("iWLZZ"),o("iThRa"));i.default.isWorkerRuntime;new Map;function s(e){try{const t={type:r.WorkerMessageType.uncaughtError,error:n.serialize(e)};i.default.postMessageToMaster(t)}catch(t){console.error("Not reporting uncaught error back to master thread as it occured while reporting an uncaught error already.\nLatest error:",t,"\nOriginal error:",e)}}"undefined"!=typeof self&&"function"==typeof self.addEventListener&&i.default.isWorkerRuntime()&&(self.addEventListener("error",(e=>{setTimeout((()=>s(e.error||e)),250)})),self.addEventListener("unhandledrejection",(e=>{const t=e.reason;t&&"string"==typeof t.message&&setTimeout((()=>s(t)),250)}))),void 0!==a&&"function"==typeof a.on&&i.default.isWorkerRuntime()&&(a.on("uncaughtException",(e=>{setTimeout((()=>s(e)),250)})),a.on("unhandledRejection",(e=>{e&&"string"==typeof e.message&&setTimeout((()=>s(e)),250)})))})),o.register("ajyVP",(function(e,t){e.exports=e=>!!e&&("symbol"==typeof Symbol.observable&&"function"==typeof e[Symbol.observable]?e===e[Symbol.observable]():"function"==typeof e["@@observable"]&&e===e["@@observable"]())})),o.register("1IT7b",(function(t,n){e(t.exports,"default",(()=>r));var r={isWorkerRuntime:function(){const e="undefined"!=typeof self&&"undefined"!=typeof Window&&self instanceof Window;return!("undefined"==typeof self||!self.postMessage||e)},postMessageToMaster:function(e,t){self.postMessage(e,t)},subscribeToMasterMessages:function(e){const t=t=>{e(t.data)};return self.addEventListener("message",t),()=>{self.removeEventListener("message",t)}}}})),o.register("ex47A",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AccountTx=void 0;var r=o("1T4rt"),i=o("2ZepW"),a=o("7TSDW");class s{constructor(e,t,n,r,i,o,a,s,u,c,l){this.merkleRoot=e,this.accountPublicKey=t,this.newAccountPublicKey=n,this.newSpendingPublicKey1=r,this.newSpendingPublicKey2=i,this.aliasHash=o,this.create=a,this.migrate=s,this.accountIndex=u,this.accountPath=c,this.spendingPublicKey=l}toBuffer(){return n.concat([this.merkleRoot,this.accountPublicKey.toBuffer(),this.newAccountPublicKey.toBuffer(),this.newSpendingPublicKey1.toBuffer(),this.newSpendingPublicKey2.toBuffer(),this.aliasHash.toBuffer32(),n.from([this.create?1:0]),n.from([this.migrate?1:0]),(0,a.numToUInt32BE)(this.accountIndex),this.accountPath.toBuffer(),this.spendingPublicKey.toBuffer()])}static fromBuffer(e){let t=0;const n=e.slice(t,t+32);t+=32;const o=new r.GrumpkinAddress(e.slice(t,t+64));t+=64;const a=new r.GrumpkinAddress(e.slice(t,t+64));t+=64;const u=new r.GrumpkinAddress(e.slice(t,t+64));t+=64;const c=new r.GrumpkinAddress(e.slice(t,t+64));t+=64;const l=new f.AliasHash(e.slice(t+4,t+32));t+=32;const h=!!e[t];t+=1;const d=!!e[t];t+=1;const p=e.readUInt32BE(t);t+=4;const{elem:m,adv:y}=i.HashPath.deserialize(e,t);t+=y;const g=new r.GrumpkinAddress(e.slice(t,t+64));return new s(n,o,a,u,c,l,h,d,p,m,g)}}e.exports.AccountTx=s}));var f={};Object.defineProperty(f,"__esModule",{value:!0}),s(o("575lo"),f),s(o("3f06J"),f),s(o("7u2av"),f),o.register("2ZepW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("gUtZU"),e.exports),s(o("3truY"),e.exports),s(o("965SS"),e.exports),s(o("clrDJ"),e.exports)})),o.register("gUtZU",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.HashPath=void 0;var r=o("7TSDW");class i{constructor(e=[]){this.data=e}toBuffer(){const e=this.data.map((e=>n.concat([e[0],e[1]])));return(0,r.serializeBufferArrayToVector)(e)}static fromBuffer(e,t=0){const{elem:n}=i.deserialize(e,t);return n}static deserialize(e,t=0){const{elem:n,adv:o}=(0,r.deserializeArrayFromVector)(((e,t)=>({elem:[e.slice(t,t+32),e.slice(t+32,t+64)],adv:64})),e,t);return{elem:new i(n),adv:o}}}e.exports.HashPath=i})),o.register("3truY",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MemoryMerkleTree=void 0;var r=o("gUtZU");class i{constructor(e,t){this.notes=e,this.hasher=t,this.hashes=[];if(!(n=e.length)||n&n-1)throw new Error("MemoryMerkleTree can only handle powers of 2.");var n}getHashPath(e){if(e<0||e>=this.notes.length)throw new Error("Index out of bounds");if(!Number.isInteger(e))throw new Error("Index invalid");const t=[];let n=this.notes.length,i=0;for(;n>1;){const r=e+i;i+=n;const o=e%2?[this.hashes[r-1],this.hashes[r]]:[this.hashes[r],this.hashes[r+1]];t.push(o),e>>=1,n>>=1}return new r.HashPath(t)}getRoot(){return this.hashes[this.hashes.length-1]}getSize(){return this.notes.length}static async new(e,t){const n=new i(e,t);return await n.buildTree(),n}async buildTree(){this.hashes=await this.hasher.hashToTree(this.notes)}}e.exports.MemoryMerkleTree=i,i.ZERO_ELEMENT=n.from("0000000000000000000000000000000000000000000000000000000000000000","hex")})),o.register("965SS",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("clrDJ",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.MerkleTree=void 0;var r=o("gUtZU");const i=(0,h.createLogger)("bb:merkle_tree");function a(e,t){return t>=32?e:e&(1<<t)-1}class s{constructor(e,t,n,r,i=0,o,a=s.ZERO_ELEMENT){if(this.db=e,this.hasher=t,this.name=n,this.depth=r,this.size=i,this.initialLeafValue=a,this.zeroHashes=[],!(r>=1&&r<=32))throw Error("Bad depth");let u=a;for(let e=0;e<r;++e)this.zeroHashes[e]=u,u=t.compress(u,u);this.root=o||u}static async new(e,t,n,r,i=s.ZERO_ELEMENT){const o=new s(e,t,n,r,0,void 0,i);return await o.writeMeta(),o}static async fromName(e,t,r,i=s.ZERO_ELEMENT){const o=await e.get(n.from(r)),a=o.slice(0,32),u=o.readUInt32LE(32),c=o.readUInt32LE(36);return new s(e,t,r,u,c,a,i)}async syncFromDb(){const e=await this.db.get(n.from(this.name));this.root=e.slice(0,32),this.depth=e.readUInt32LE(32),this.size=e.readUInt32LE(36)}async writeMeta(e){const t=n.alloc(40);this.root.copy(t),t.writeUInt32LE(this.depth,32),t.writeUInt32LE(this.size,36),e?e.put(this.name,t):await this.db.put(this.name,t)}getRoot(){return this.root}getSize(){return this.size}async getHashPath(e){const t=new r.HashPath;let n=await this.dbGet(this.root);for(let r=this.depth-1;r>=0;--r){if(!n){t.data[r]=[this.zeroHashes[r],this.zeroHashes[r]];continue}if(n.length>64){const i=r+1;let o=2**i,s=0;e=a(e,i);for(let r=0;r<i;++r){const i=s+32*(e-=1&e);t.data[r]=[n.slice(i,i+32),n.slice(i+32,i+64)],s+=32*o,o>>=1,e>>=1}break}const i=n.slice(0,32),o=n.slice(32,64);t.data[r]=[i,o];const s=e>>r&1;n=await this.dbGet(s?o:i)}return t}async updateElement(e,t){return await this.updateLeafHash(e,t.equals(n.alloc(32,0))?this.initialLeafValue:t)}async updateLeafHash(e,t){const n=this.db.batch();this.root=await this.updateElementInternal(this.root,t,e,this.depth,n),this.size=Math.max(this.size,e+1),await this.writeMeta(n),await n.write()}async updateElementInternal(e,t,r,i,o){if(0===i)return t;const s=await this.dbGet(e),u=r>>i-1&1;let c=s?s.slice(0,32):this.zeroHashes[i-1],l=s?s.slice(32,64):this.zeroHashes[i-1];const f=u?l:c,h=await this.updateElementInternal(f,t,a(r,i-1),i-1,o);u?l=h:c=h;const d=this.hasher.compress(c,l);return o.put(d,n.concat([c,l])),e.equals(d)||await o.del(e),d}async updateElements(e,t){i(`update elements at index ${e} with ${t.length} leaves...`);const r=n.alloc(32,0);return await this.updateLeafHashes(e,t.map((e=>e.equals(r)?this.initialLeafValue:e)))}async updateLeafHashes(e,t){for(;t.length;){const n=this.db.batch();let r=Math.ceil(Math.log2(t.length)),i=2**r;for(;t.length<i||e%i!=0;)i>>=1,r--;const o=t.slice(0,i),a=await this.hasher.hashToTree(o);this.root=await this.updateElementsInternal(this.root,a,e,this.depth,r,n),t=t.slice(i),e+=i,this.size=e,await this.writeMeta(n),await n.write()}}async updateElementsInternal(e,t,r,i,o,s){if(i===o){const e=t.pop();return s.put(e,n.concat(t)),e}if(t[t.length-1].equals(this.zeroHashes[i-1]))return e;const u=await this.dbGet(e),c=r>>i-1&1;if(u&&u.length>64){if(!e.equals(t[t.length-1]))throw new Error("Attempting to update pre-existing subtree.");return e}let l=u?u.slice(0,32):this.zeroHashes[i-1],f=u?u.slice(32,64):this.zeroHashes[i-1];const h=c?f:l,d=await this.updateElementsInternal(h,t,a(r,i-1),i-1,o,s);c?f=d:l=d;const p=this.hasher.compress(l,f);return s.put(p,n.concat([l,f])),e.equals(p)||s.del(e),p}async dbGet(e){return await this.db.get(e).catch((()=>{}))}}e.exports.MerkleTree=s,s.ZERO_ELEMENT=n.from("0000000000000000000000000000000000000000000000000000000000000000","hex")}));var h={};Object.defineProperty(h,"__esModule",{value:!0}),h.enableLogs=h.createLogger=void 0;const d=l(o("7LjTn"));h.createLogger=d.default,h.enableLogs=function(e){d.default.enable(e)},o.register("dpPVK",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AccountVerifier=void 0;e.exports.AccountVerifier=class{async computeKey(e,t){this.worker=e.getWorker(),await this.worker.transferToHeap(t,0),await this.worker.call("account__init_verification_key",e.getPointer(),0)}async getKey(){const e=await this.worker.call("account__get_new_verification_key_data",0),t=n.from(await this.worker.sliceMemory(0,4)).readUInt32LE(0),r=n.from(await this.worker.sliceMemory(t,t+e));return await this.worker.call("bbfree",t),r}async loadKey(e,t,n){this.worker=e;const r=await this.worker.call("bbmalloc",t.length);await this.worker.transferToHeap(n,0),await this.worker.transferToHeap(t,r),await this.worker.call("account__init_verification_key_from_buffer",r,0),await this.worker.call("bbfree",r)}async verifyProof(e){const t=await this.worker.call("bbmalloc",e.length);await this.worker.transferToHeap(e,t);const n=!!await this.worker.call("account__verify_proof",t,e.length);return await this.worker.call("bbfree",t),n}}})),o.register("hbqo0",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("8xZrS"),e.exports),s(o("ieEjn"),e.exports),s(o("2CYay"),e.exports)})),o.register("8xZrS",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.JoinSplitProver=void 0;var r=o("iWLZZ");e.exports.JoinSplitProver=class{constructor(e,t=!1){this.prover=e,this.mock=t}static getCircuitSize(e=!1){return e?512:65536}async computeKey(){const e=this.prover.getWorker();await e.call("join_split__init_proving_key",this.mock)}async loadKey(e){const t=this.prover.getWorker(),n=await t.call("bbmalloc",e.length);await t.transferToHeap((0,r.Transfer)(e,[e.buffer]),n),await t.call("join_split__init_proving_key_from_buffer",n),await t.call("bbfree",n)}async getKey(){const e=this.prover.getWorker();await e.acquire();try{const t=await e.call("join_split__get_new_proving_key_data",0),r=n.from(await e.sliceMemory(0,4)).readUInt32LE(0),i=n.from(await e.sliceMemory(r,r+t));return await e.call("bbfree",r),i}finally{await e.release()}}async computeSigningData(e){const t=this.prover.getWorker();return await t.transferToHeap(e.toBuffer(),0),await t.call("join_split__compute_signing_data",0,0),n.from(await t.sliceMemory(0,32))}async createProof(e,t){const r=n.concat([e.toBuffer(),t.toBuffer()]),i=this.prover.getWorker(),o=await i.call("bbmalloc",r.length);await i.transferToHeap(r,o);const a=await i.call("join_split__new_prover",o,this.mock);await i.call("bbfree",o);const s=await this.prover.createProof(a);return await i.call("join_split__delete_prover",a),s}getProver(){return this.prover}}})),o.register("ieEjn",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.JoinSplitVerifier=void 0;e.exports.JoinSplitVerifier=class{async computeKey(e,t){this.worker=e.getWorker(),await this.worker.transferToHeap(t,0),await this.worker.call("join_split__init_verification_key",e.getPointer(),0)}async getKey(){const e=await this.worker.call("join_split__get_new_verification_key_data",0),t=n.from(await this.worker.sliceMemory(0,4)).readUInt32LE(0),r=n.from(await this.worker.sliceMemory(t,t+e));return await this.worker.call("bbfree",t),r}async loadKey(e,t,n){this.worker=e;const r=await this.worker.call("bbmalloc",t.length);await this.worker.transferToHeap(n,0),await this.worker.transferToHeap(t,r),await this.worker.call("join_split__init_verification_key_from_buffer",r,0),await this.worker.call("bbfree",r)}async verifyProof(e){const t=await this.worker.call("bbmalloc",e.length);await this.worker.transferToHeap(e,t);const n=!!await this.worker.call("join_split__verify_proof",t,e.length);return await this.worker.call("bbfree",t),n}}})),o.register("2CYay",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.JoinSplitTx=void 0;var r=o("1T4rt"),i=o("lJwtZ"),a=o("2ZepW"),s=o("4G3uU"),u=o("7TSDW");class c{constructor(e,t,n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b){this.proofId=e,this.publicValue=t,this.publicOwner=n,this.publicAssetId=r,this.numInputNotes=i,this.inputNoteIndices=o,this.merkleRoot=a,this.inputNotePaths=s,this.inputNotes=u,this.outputNotes=c,this.claimNote=l,this.accountPrivateKey=f,this.aliasHash=h,this.accountRequired=d,this.accountIndex=p,this.accountPath=m,this.spendingPublicKey=y,this.backwardLink=g,this.allowChain=b}toBuffer(){return n.concat([(0,u.numToUInt32BE)(this.proofId),(0,i.toBufferBE)(this.publicValue,32),this.publicOwner.toBuffer32(),(0,u.numToUInt32BE)(this.publicAssetId),(0,u.numToUInt32BE)(this.numInputNotes),(0,u.numToUInt32BE)(this.inputNoteIndices[0]),(0,u.numToUInt32BE)(this.inputNoteIndices[1]),this.merkleRoot,this.inputNotePaths[0].toBuffer(),this.inputNotePaths[1].toBuffer(),this.inputNotes[0].toBuffer(),this.inputNotes[1].toBuffer(),this.outputNotes[0].toBuffer(),this.outputNotes[1].toBuffer(),this.claimNote.toBuffer(),this.accountPrivateKey,this.aliasHash.toBuffer32(),n.from([+this.accountRequired]),(0,u.numToUInt32BE)(this.accountIndex),this.accountPath.toBuffer(),this.spendingPublicKey.toBuffer(),this.backwardLink,(0,u.numToUInt32BE)(this.allowChain)])}static fromBuffer(e){let t=0;const n=e.readUInt32BE(t);t+=4;const o=(0,i.toBigIntBE)(e.slice(t,t+32));t+=32;const u=new r.EthAddress(e.slice(t,t+32));t+=32;const l=e.readUInt32BE(t);t+=4;const h=e.readUInt32BE(t);t+=4;const d=[e.readUInt32BE(t),e.readUInt32BE(t+4)];t+=8;const p=e.slice(t,t+32);t+=32;const m=a.HashPath.deserialize(e,t);t+=m.adv;const y=a.HashPath.deserialize(e,t);t+=y.adv;const g=s.TreeNote.fromBuffer(e.slice(t));t+=s.TreeNote.SIZE;const b=s.TreeNote.fromBuffer(e.slice(t));t+=s.TreeNote.SIZE;const v=s.TreeNote.fromBuffer(e.slice(t));t+=s.TreeNote.SIZE;const w=s.TreeNote.fromBuffer(e.slice(t));t+=s.TreeNote.SIZE;const _=s.ClaimNoteTxData.fromBuffer(e.slice(t));t+=s.ClaimNoteTxData.SIZE;const E=e.slice(t,t+32);t+=32;const S=new f.AliasHash(e.slice(t+4,t+32));t+=32;const x=!!e[t];t+=1;const T=e.readUInt32BE(t);t+=4;const M=a.HashPath.deserialize(e,t);t+=M.adv;const A=new r.GrumpkinAddress(e.slice(t,t+64));t+=64;const R=e.slice(t,t+32);t+=32;const I=e.readUInt32BE(t);return new c(n,o,u,l,h,d,p,[m.elem,y.elem],[g,b],[v,w],_,E,S,x,T,M.elem,A,R,I)}}e.exports.JoinSplitTx=c})),o.register("4G3uU",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("8CbMP"),e.exports),s(o("cUejE"),e.exports),s(o("lv94x"),e.exports),s(o("eewJK"),e.exports),s(o("f27Ls"),e.exports),s(o("8amAc"),e.exports),s(o("39rrf"),e.exports),s(o("64vbG"),e.exports),s(o("dDBPg"),e.exports)})),o.register("8CbMP",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.batchDecryptNotes=void 0;var n=o("1T4rt"),r=o("aebg6"),i=o("f27Ls");e.exports.batchDecryptNotes=async(e,t,o,a)=>{const s=await o.batchDecryptNotes(e,t),u=[];for(let o=0,c=0;c<s.length;++o,c+=73){const l=s.slice(c,c+73);if(l.length>0&&l[0]){const s=new n.GrumpkinAddress(e.slice((o+1)*r.ViewingKey.SIZE-64,(o+1)*r.ViewingKey.SIZE)),c=(0,i.deriveNoteSecret)(s,t,a);u[o]={noteBuf:l.slice(1),ephPubKey:s,noteSecret:c}}}return u}})),o.register("aebg6",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ViewingKey=void 0;var r=o("hxZzW"),i=o("1vwiL"),a=o("6HKnN"),s=o("7TSDW");class u{constructor(e){if(e&&e.length>0){if(e.length!==u.SIZE)throw new Error("Invalid hash buffer.");this.buffer=e}else this.buffer=n.alloc(0)}static fromString(e){return new u(n.from(e,"hex"))}static random(){return new u((0,i.randomBytes)(u.SIZE))}static createFromEphPriv(e,t,i,o){if(72!==e.length)throw new Error("Invalid note buffer.");const c=o.mul(a.Grumpkin.one,i),l=function(e,t,i){const o=i.mul(e.toBuffer(),t),a=n.concat([o,(0,s.numToUInt8)(1)]);return(0,r.createHash)("sha256").update(a).digest()}(t,i,o),f=l.slice(0,16),h=l.slice(16,32),d=(0,r.createCipheriv)("aes-128-cbc",f,h);d.setAutoPadding(!1);const p=n.concat([h.slice(0,8),e]);return new u(n.concat([d.update(p),d.final(),c]))}isEmpty(){return 0===this.buffer.length}equals(e){return this.buffer.equals(e.buffer)}toBuffer(){return this.buffer}toString(){return this.toBuffer().toString("hex")}}e.exports.ViewingKey=u,u.SIZE=144,u.EMPTY=new u})),o.register("f27Ls",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.deriveNoteSecret=void 0;var r=o("hxZzW"),i=o("7TSDW");e.exports.deriveNoteSecret=function(e,t,o){const a=o.mul(e.toBuffer(),t),s=n.concat([a,(0,i.numToUInt8)(2)]),u=n.concat([a,(0,i.numToUInt8)(3)]),c=(0,r.createHash)("sha256").update(s).digest(),l=(0,r.createHash)("sha256").update(u).digest(),f=n.concat([c,l]);return o.reduce512BufferToFr(f)}})),o.register("cUejE",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ClaimNoteTxData=void 0;var r=o("lJwtZ"),i=o("jJK4a");class a{constructor(e,t,n,r){this.value=e,this.bridgeId=t,this.partialStateSecret=n,this.inputNullifier=r}toBuffer(){return n.concat([(0,r.toBufferBE)(this.value,32),this.bridgeId.toBuffer(),this.partialStateSecret,this.inputNullifier])}equals(e){return this.toBuffer().equals(e.toBuffer())}static fromBuffer(e){let t=0;const n=(0,r.toBigIntBE)(e.slice(t,t+32));t+=32;const o=i.BridgeId.fromBuffer(e.slice(t,t+32));t+=32;const s=e.slice(t,t+32);t+=32;const u=e.slice(t,t+32);return new a(n,o,s,u)}}e.exports.ClaimNoteTxData=a,a.EMPTY=new a(BigInt(0),i.BridgeId.ZERO,n.alloc(32),n.alloc(32)),a.SIZE=a.EMPTY.toBuffer().length})),o.register("jJK4a",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.virtualAssetIdPlaceholder=e.exports.virtualAssetIdFlag=void 0,s(o("1w47y"),e.exports),s(o("25jn4"),e.exports),s(o("kuEZT"),e.exports);var n=o("iG5TT");Object.defineProperty(e.exports,"virtualAssetIdFlag",{enumerable:!0,get:function(){return n.virtualAssetIdFlag}}),Object.defineProperty(e.exports,"virtualAssetIdPlaceholder",{enumerable:!0,get:function(){return n.virtualAssetIdPlaceholder}})})),o.register("1w47y",(function(e,t){var n;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AUX_DATA_SELECTOR=void 0,(n=e.exports.AUX_DATA_SELECTOR||(e.exports.AUX_DATA_SELECTOR={}))[n.NADA=0]="NADA",n[n.OPEN_LOAN=1]="OPEN_LOAN",n[n.CLOSE_LOAN=2]="CLOSE_LOAN",n[n.OPEN_LP=3]="OPEN_LP",n[n.CLOSE_LP=4]="CLOSE_LP"})),o.register("25jn4",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BridgeId=void 0;var r=o("4ZiGb"),i=o("lJwtZ"),a=o("eKTrM"),s=o("iG5TT");const u=(e=2**30-1)=>Math.floor(Math.random()*(e+1)),c=(e,t,n)=>Number(e>>BigInt(t)&(BigInt(1)<<BigInt(n))-BigInt(1));class l{constructor(e,t,n,r,i,o=0){this.addressId=e,this.inputAssetIdA=t,this.outputAssetIdA=n,this.inputAssetIdB=r,this.outputAssetIdB=i,this.auxData=o,this.bitConfig=new a.BitConfig(void 0!==r,void 0!==i)}static random(){return new l(u(),u(),u(),u(),u(),u())}static fromBigInt(e){const t=c(e,s.ADDRESS_OFFSET,s.ADDRESS_BIT_LEN),n=c(e,s.INPUT_ASSET_ID_A_OFFSET,s.INPUT_ASSET_ID_A_LEN),r=c(e,s.OUTPUT_ASSET_ID_A_OFFSET,s.OUTPUT_ASSET_ID_A_LEN),i=c(e,s.INPUT_ASSET_ID_B_OFFSET,s.INPUT_ASSET_ID_B_LEN),o=c(e,s.OUTPUT_ASSET_ID_B_OFFSET,s.OUTPUT_ASSET_ID_B_LEN),u=c(e,s.AUX_DATA_OFFSET,s.AUX_DATA_LEN),f=a.BitConfig.fromBigInt(BigInt(c(e,s.BITCONFIG_OFFSET,s.BITCONFIG_LEN)));if(!f.secondInputInUse&&i)throw new Error("Inconsistent second input.");if(!f.secondOutputInUse&&o)throw new Error("Inconsistent second output.");return new l(t,n,r,f.secondInputInUse?i:void 0,f.secondOutputInUse?o:void 0,u)}static fromBuffer(e){if(32!==e.length)throw new Error("Invalid buffer.");return l.fromBigInt((0,i.toBigIntBE)(e))}static fromString(e){return l.fromBuffer(n.from(e.replace(/^0x/i,""),"hex"))}get firstInputVirtual(){return(0,r.isVirtualAsset)(this.inputAssetIdA)}get secondInputVirtual(){return!!this.inputAssetIdB&&(0,r.isVirtualAsset)(this.inputAssetIdB)}get firstOutputVirtual(){return(0,r.isVirtualAsset)(this.outputAssetIdA)}get secondOutputVirtual(){return!!this.outputAssetIdB&&(0,r.isVirtualAsset)(this.outputAssetIdB)}get secondInputInUse(){return this.bitConfig.secondInputInUse}get secondOutputInUse(){return this.bitConfig.secondOutputInUse}get numInputAssets(){return this.bitConfig.secondInputInUse?2:1}get numOutputAssets(){return this.bitConfig.secondOutputInUse?2:1}toBigInt(){return BigInt(this.addressId)+(BigInt(this.inputAssetIdA)<<BigInt(s.INPUT_ASSET_ID_A_OFFSET))+(BigInt(this.inputAssetIdB||0)<<BigInt(s.INPUT_ASSET_ID_B_OFFSET))+(BigInt(this.outputAssetIdA)<<BigInt(s.OUTPUT_ASSET_ID_A_OFFSET))+(BigInt(this.outputAssetIdB||0)<<BigInt(s.OUTPUT_ASSET_ID_B_OFFSET))+(this.bitConfig.toBigInt()<<BigInt(s.BITCONFIG_OFFSET))+(BigInt(this.auxData)<<BigInt(s.AUX_DATA_OFFSET))}toBuffer(){return(0,i.toBufferBE)(this.toBigInt(),32)}toString(){return`0x${this.toBuffer().toString("hex")}`}equals(e){return e.toBuffer().equals(this.toBuffer())}}e.exports.BridgeId=l,l.ZERO=new l(0,0,0),l.ENCODED_LENGTH_IN_BYTES=32})),o.register("4ZiGb",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.isVirtualAsset=e.exports.assetValueFromJson=e.exports.assetValueToJson=void 0;e.exports.assetValueToJson=e=>({...e,value:e.value.toString()});e.exports.assetValueFromJson=e=>({...e,value:BigInt(e.value)});e.exports.isVirtualAsset=e=>e>=536870912})),o.register("eKTrM",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BitConfig=void 0;const n=(e,t,n)=>Number(e>>BigInt(t)&(BigInt(1)<<BigInt(n))-BigInt(1));class r{constructor(e,t){this.secondInputInUse=e,this.secondOutputInUse=t}static fromBigInt(e){return new r(0!=n(e,0,1),0!=n(e,1,1))}toBigInt(){return BigInt(this.secondInputInUse)+(BigInt(this.secondOutputInUse)<<BigInt(1))}}e.exports.BitConfig=r,r.EMPTY=new r(!1,!1)})),o.register("iG5TT",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AUX_DATA_OFFSET=e.exports.BITCONFIG_OFFSET=e.exports.OUTPUT_ASSET_ID_B_OFFSET=e.exports.OUTPUT_ASSET_ID_A_OFFSET=e.exports.INPUT_ASSET_ID_B_OFFSET=e.exports.INPUT_ASSET_ID_A_OFFSET=e.exports.ADDRESS_OFFSET=e.exports.AUX_DATA_LEN=e.exports.BITCONFIG_LEN=e.exports.INPUT_ASSET_ID_B_LEN=e.exports.OUTPUT_ASSET_ID_B_LEN=e.exports.OUTPUT_ASSET_ID_A_LEN=e.exports.INPUT_ASSET_ID_A_LEN=e.exports.ADDRESS_BIT_LEN=e.exports.virtualAssetIdPlaceholder=e.exports.virtualAssetIdFlag=void 0,e.exports.virtualAssetIdFlag=536870912,e.exports.virtualAssetIdPlaceholder=536870912,e.exports.ADDRESS_BIT_LEN=32,e.exports.INPUT_ASSET_ID_A_LEN=30,e.exports.OUTPUT_ASSET_ID_A_LEN=30,e.exports.OUTPUT_ASSET_ID_B_LEN=30,e.exports.INPUT_ASSET_ID_B_LEN=30,e.exports.BITCONFIG_LEN=32,e.exports.AUX_DATA_LEN=64,e.exports.ADDRESS_OFFSET=0,e.exports.INPUT_ASSET_ID_A_OFFSET=e.exports.ADDRESS_BIT_LEN,e.exports.INPUT_ASSET_ID_B_OFFSET=e.exports.INPUT_ASSET_ID_A_OFFSET+e.exports.INPUT_ASSET_ID_A_LEN,e.exports.OUTPUT_ASSET_ID_A_OFFSET=e.exports.INPUT_ASSET_ID_B_OFFSET+e.exports.INPUT_ASSET_ID_B_LEN,e.exports.OUTPUT_ASSET_ID_B_OFFSET=e.exports.OUTPUT_ASSET_ID_A_OFFSET+e.exports.OUTPUT_ASSET_ID_A_LEN,e.exports.BITCONFIG_OFFSET=e.exports.OUTPUT_ASSET_ID_B_OFFSET+e.exports.OUTPUT_ASSET_ID_B_LEN,e.exports.AUX_DATA_OFFSET=e.exports.BITCONFIG_OFFSET+e.exports.BITCONFIG_LEN})),o.register("kuEZT",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.validateBridgeId=void 0;e.exports.validateBridgeId=e=>{if(e.inputAssetIdA===e.inputAssetIdB)throw new Error("Identical input assets.");if(!e.secondOutputVirtual&&e.outputAssetIdA===e.outputAssetIdB)throw new Error("Identical output assets.")}})),o.register("lv94x",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("eewJK",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.packInteractionNotes=e.exports.computeInteractionHashes=e.exports.DefiInteractionNote=void 0;var r=o("hxZzW"),i=o("lJwtZ"),a=o("jJK4a"),s=o("1vwiL"),u=o("7TSDW");class c{constructor(e,t,n,r,i,o){this.bridgeId=e,this.nonce=t,this.totalInputValue=n,this.totalOutputValueA=r,this.totalOutputValueB=i,this.result=o}static deserialize(e,t){const n=new u.Deserializer(e,t),r=n.buffer(32),i=a.BridgeId.fromBuffer(r),o=n.bigInt(),s=n.bigInt(),l=n.bigInt(),f=n.uInt32(),h=n.bool();return{elem:new c(i,f,o,s,l,h),adv:n.getOffset()-t}}static random(){return new c(a.BridgeId.random(),(0,s.randomBytes)(4).readUInt32BE(0),(0,i.toBigIntBE)((0,s.randomBytes)(32)),(0,i.toBigIntBE)((0,s.randomBytes)(32)),(0,i.toBigIntBE)((0,s.randomBytes)(32)),!!Math.round(Math.random()))}static fromBuffer(e){return c.deserialize(e,0).elem}toBuffer(){const e=new u.Serializer;return e.buffer(this.bridgeId.toBuffer()),e.bigInt(this.totalInputValue),e.bigInt(this.totalOutputValueA),e.bigInt(this.totalOutputValueB),e.uInt32(this.nonce),e.bool(this.result),e.getBuffer()}equals(e){return this.toBuffer().equals(e.toBuffer())}}e.exports.DefiInteractionNote=c,c.EMPTY=new c(a.BridgeId.ZERO,0,BigInt(0),BigInt(0),BigInt(0),!1),c.groupModulus=BigInt("21888242871839275222246405745257275088548364400416034343698204186575808495617");e.exports.computeInteractionHashes=(e,t=e.length)=>(e=[...e,...Array(t-e.length).fill(c.EMPTY)]).map((e=>(0,r.createHash)("sha256").update(n.concat([e.bridgeId.toBuffer(),(0,u.numToUInt32BE)(e.nonce,32),(0,i.toBufferBE)(e.totalInputValue,32),(0,i.toBufferBE)(e.totalOutputValueA,32),(0,i.toBufferBE)(e.totalOutputValueB,32),n.alloc(31),n.from([+e.result])])).digest())).map((e=>(0,i.toBufferBE)(BigInt("0x"+e.toString("hex"))%c.groupModulus,32)));e.exports.packInteractionNotes=(t,o=t.length)=>{const a=(0,r.createHash)("sha256").update(n.concat((0,e.exports.computeInteractionHashes)(t,o))).digest();return(0,i.toBufferBE)(BigInt("0x"+a.toString("hex"))%c.groupModulus,32)}})),o.register("8amAc",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.NoteAlgorithms=void 0;var r=o("lJwtZ"),i=o("aebg6");e.exports.NoteAlgorithms=class{constructor(e,t=e){this.wasm=e,this.worker=t}valueNoteNullifier(e,t,r=!0){return this.wasm.transferToHeap(e,0),this.wasm.transferToHeap(t,64),this.wasm.call("notes__value_note_nullifier",0,64,r,0),n.from(this.wasm.sliceMemory(0,32))}valueNoteNullifierBigInt(e,t,n=!0){return(0,r.toBigIntBE)(this.valueNoteNullifier(e,t,n))}valueNoteCommitment(e){const t=e.toBuffer(),r=this.wasm.call("bbmalloc",t.length);return this.wasm.transferToHeap(t,r),this.wasm.call("notes__value_note_commitment",r,0),this.wasm.call("bbfree",r),n.from(this.wasm.sliceMemory(0,32))}valueNotePartialCommitment(e,t,r){return this.wasm.transferToHeap(e,0),this.wasm.transferToHeap(t.toBuffer(),32),this.wasm.transferToHeap(n.alloc(32),96),this.wasm.call("notes__value_note_partial_commitment",0,32,96,r,0),n.from(this.wasm.sliceMemory(0,32))}claimNotePartialCommitment(e){const t=e.toBuffer(),r=this.wasm.call("bbmalloc",t.length);return this.wasm.transferToHeap(t,r),this.wasm.call("notes__claim_note_partial_commitment",r,0),this.wasm.call("bbfree",r),n.from(this.wasm.sliceMemory(0,32))}claimNoteCompletePartialCommitment(e,t,i){return this.wasm.transferToHeap(e,0),this.wasm.transferToHeap((0,r.toBufferBE)(i,32),32),this.wasm.call("notes__claim_note_complete_partial_commitment",0,t,32,0),n.from(this.wasm.sliceMemory(0,32))}claimNoteCommitment(e){const t=this.claimNotePartialCommitment(e);return this.claimNoteCompletePartialCommitment(t,e.defiInteractionNonce,e.fee)}claimNoteNullifier(e){return this.wasm.transferToHeap(e,0),this.wasm.call("notes__claim_note_nullifier",0,0),n.from(this.wasm.sliceMemory(0,32))}defiInteractionNoteCommitment(e){const t=e.toBuffer(),r=this.wasm.call("bbmalloc",t.length);return this.wasm.transferToHeap(t,r),this.wasm.call("notes__defi_interaction_note_commitment",r,0),this.wasm.call("bbfree",r),n.from(this.wasm.sliceMemory(0,32))}accountNoteCommitment(e,t,r){return this.wasm.transferToHeap(e.toBuffer32(),0),this.wasm.transferToHeap(t.toBuffer(),32),this.wasm.transferToHeap(r,64),this.wasm.call("notes__account_note_commitment",0,32,64,0),n.from(this.wasm.sliceMemory(0,32))}accountAliasHashNullifier(e){return this.wasm.transferToHeap(e.toBuffer32(),0),this.wasm.call("notes__compute_account_alias_hash_nullifier",0,0),n.from(this.wasm.sliceMemory(0,32))}accountPublicKeyNullifier(e){return this.wasm.transferToHeap(e.toBuffer(),0),this.wasm.call("notes__compute_account_public_key_nullifier",0,0),n.from(this.wasm.sliceMemory(0,32))}async batchDecryptNotes(e,t){const r=e.length/i.ViewingKey.SIZE,o=await this.worker.call("bbmalloc",e.length+t.length);await this.worker.transferToHeap(e,o),await this.worker.transferToHeap(t,o+e.length),await this.worker.call("notes__batch_decrypt_notes",o,o+e.length,r,o);const a=n.from(await this.worker.sliceMemory(o,o+73*r));return await this.worker.call("bbfree",o),a}}})),o.register("39rrf",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.recoverTreeNotes=void 0;var n=o("1T4rt"),r=o("6HKnN"),i=o("dDBPg");const a=(0,h.createLogger)("recover_tree_notes");e.exports.recoverTreeNotes=(e,t,o,s,u,c)=>{const l=new n.GrumpkinAddress(u.mul(r.Grumpkin.one,s));return e.map(((e,n)=>{if(!e)return void a(`index ${n}: no decrypted tree note.`);const r=o[n],s=t[n],u=i.TreeNote.recover(e,s,l);a({note:u});const f=c.valueNoteCommitment(u);if(f.equals(r))return a(`index ${n}: tree commitment ${r.toString("hex")} matches note version 1.`),u;a(`index ${n}: tree commitment ${r.toString("hex")} != encrypted note commitment ${f.toString("hex")}.`)}))}})),o.register("dDBPg",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TreeNote=void 0;var r=o("1T4rt"),i=o("lJwtZ"),a=o("7TSDW"),s=o("aebg6"),u=o("f27Ls");class c{constructor(e,t,n,r,i,o,a){this.ownerPubKey=e,this.value=t,this.assetId=n,this.accountRequired=r,this.noteSecret=i,this.creatorPubKey=o,this.inputNullifier=a}toBuffer(){return n.concat([(0,i.toBufferBE)(this.value,32),(0,a.numToUInt32BE)(this.assetId),n.from([this.accountRequired?1:0]),this.ownerPubKey.toBuffer(),this.noteSecret,this.creatorPubKey,this.inputNullifier])}createViewingKey(e,t){const r=n.concat([(0,i.toBufferBE)(this.value,32),(0,a.numToUInt32BE)(this.assetId),(0,a.numToUInt32BE)(+this.accountRequired),this.creatorPubKey]);return s.ViewingKey.createFromEphPriv(r,this.ownerPubKey,e,t)}static fromBuffer(e){let t=0;const n=(0,i.toBigIntBE)(e.slice(t,t+32));t+=32;const o=e.readUInt32BE(t);t+=4;const a=!!e[t];t+=1;const s=new r.GrumpkinAddress(e.slice(t,t+64));t+=64;const u=e.slice(t,t+32);t+=32;const l=e.slice(t,t+32);t+=32;const f=e.slice(t,t+32);return new c(s,n,o,a,u,l,f)}static createFromEphPriv(e,t,r,i,o,a,s,l=n.alloc(32)){const f=(0,u.deriveNoteSecret)(e,a,s);return new c(e,t,r,i,f,l,o)}static createFromEphPub(e,t,r,i,o,a,s,l,f=n.alloc(32)){const h=(0,u.deriveNoteSecret)(a,s,l);return new c(e,t,r,i,h,f,o)}static recover({noteBuf:e,noteSecret:t},n,r){const o=(0,i.toBigIntBE)(e.slice(0,32)),a=e.readUInt32BE(32),s=!!e.readUInt32BE(36),u=e.slice(40,72);return new c(r,o,a,s,t,u,n)}}e.exports.TreeNote=c,c.EMPTY=new c(r.GrumpkinAddress.one(),BigInt(0),0,!1,n.alloc(32),n.alloc(32),n.alloc(32)),c.SIZE=c.EMPTY.toBuffer().length})),o.register("64vbG",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TreeClaimNote=void 0;var r=o("lJwtZ"),i=o("jJK4a"),a=o("1vwiL"),s=o("7TSDW");class u{constructor(e,t,n,r,i,o){this.value=e,this.bridgeId=t,this.defiInteractionNonce=n,this.fee=r,this.partialState=i,this.inputNullifier=o}static random(){return new u((0,r.toBigIntBE)((0,a.randomBytes)(32)),i.BridgeId.random(),(0,a.randomBytes)(4).readUInt32BE(0),(0,r.toBigIntBE)((0,a.randomBytes)(32)),(0,a.randomBytes)(32),(0,a.randomBytes)(32))}static deserialize(e,t){return{elem:u.fromBuffer(e.slice(t,t+u.LENGTH)),adv:u.LENGTH}}static fromBuffer(e){const t=(0,r.toBigIntBE)(e.slice(0,32));let n=32;const o=i.BridgeId.fromBuffer(e.slice(n,n+i.BridgeId.ENCODED_LENGTH_IN_BYTES));n+=32;const a=e.readUInt32BE(n);n+=4;const s=(0,r.toBigIntBE)(e.slice(n,n+32));n+=32;const c=e.slice(n,n+32);n+=32;const l=e.slice(n,n+32);return new u(t,o,a,s,c,l)}toBuffer(){return n.concat([(0,r.toBufferBE)(this.value,32),this.bridgeId.toBuffer(),(0,s.numToUInt32BE)(this.defiInteractionNonce),(0,r.toBufferBE)(this.fee,32),this.partialState,this.inputNullifier])}equals(e){return this.toBuffer().equals(e.toBuffer())}}e.exports.TreeClaimNote=u,u.EMPTY=new u(BigInt(0),i.BridgeId.ZERO,0,BigInt(0),n.alloc(32),n.alloc(32)),u.LENGTH=u.EMPTY.toBuffer().length})),o.register("bZYGu",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("eqtrW"),e.exports),s(o("dQ820"),e.exports),s(o("PblD2"),e.exports),s(o("aZGol"),e.exports),s(o("hgpcJ"),e.exports),s(o("3EfHf"),e.exports),s(o("27chZ"),e.exports)})),o.register("eqtrW",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.AccountProofData=void 0;var n=o("3EfHf"),r=o("27chZ");class i{constructor(e){if(this.proofData=e,e.proofId!==r.ProofId.ACCOUNT)throw new Error("Not an account proof.")}static fromBuffer(e){return new i(new n.ProofData(e))}}e.exports.AccountProofData=i})),o.register("3EfHf",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ProofData=void 0;var n,r,i,a,s=o("dQ820");(r=n||(n={}))[r.PROOF_ID=0]="PROOF_ID",r[r.NOTE_COMMITMENT_1=1]="NOTE_COMMITMENT_1",r[r.NOTE_COMMITMENT_2=2]="NOTE_COMMITMENT_2",r[r.NULLIFIER_1=3]="NULLIFIER_1",r[r.NULLIFIER_2=4]="NULLIFIER_2",r[r.PUBLIC_VALUE=5]="PUBLIC_VALUE",r[r.PUBLIC_OWNER=6]="PUBLIC_OWNER",r[r.PUBLIC_ASSET_ID=7]="PUBLIC_ASSET_ID",r[r.NOTE_TREE_ROOT=8]="NOTE_TREE_ROOT",r[r.TX_FEE=9]="TX_FEE",r[r.TX_FEE_ASSET_ID=10]="TX_FEE_ASSET_ID",r[r.BRIDGE_ID=11]="BRIDGE_ID",r[r.DEFI_DEPOSIT_VALUE=12]="DEFI_DEPOSIT_VALUE",r[r.DEFI_ROOT=13]="DEFI_ROOT",r[r.BACKWARD_LINK=14]="BACKWARD_LINK",r[r.ALLOW_CHAIN=15]="ALLOW_CHAIN",(a=i||(i={}))[a.PROOF_ID=28]="PROOF_ID",a[a.NOTE_COMMITMENT_1=32]="NOTE_COMMITMENT_1",a[a.NOTE_COMMITMENT_2=64]="NOTE_COMMITMENT_2",a[a.NULLIFIER_1=96]="NULLIFIER_1",a[a.NULLIFIER_2=128]="NULLIFIER_2",a[a.PUBLIC_VALUE=160]="PUBLIC_VALUE",a[a.PUBLIC_OWNER=192]="PUBLIC_OWNER",a[a.PUBLIC_ASSET_ID=224]="PUBLIC_ASSET_ID",a[a.NOTE_TREE_ROOT=256]="NOTE_TREE_ROOT",a[a.TX_FEE=288]="TX_FEE",a[a.TX_FEE_ASSET_ID=320]="TX_FEE_ASSET_ID",a[a.BRIDGE_ID=352]="BRIDGE_ID",a[a.DEFI_DEPOSIT_VALUE=384]="DEFI_DEPOSIT_VALUE",a[a.DEFI_ROOT=416]="DEFI_ROOT",a[a.BACKWARD_LINK=448]="BACKWARD_LINK",a[a.ALLOW_CHAIN=480]="ALLOW_CHAIN";class u{constructor(e){this.rawProofData=e,this.proofId=e.readUInt32BE(i.PROOF_ID),this.noteCommitment1=e.slice(i.NOTE_COMMITMENT_1,i.NOTE_COMMITMENT_1+32),this.noteCommitment2=e.slice(i.NOTE_COMMITMENT_2,i.NOTE_COMMITMENT_2+32),this.nullifier1=e.slice(i.NULLIFIER_1,i.NULLIFIER_1+32),this.nullifier2=e.slice(i.NULLIFIER_2,i.NULLIFIER_2+32),this.publicValue=e.slice(i.PUBLIC_VALUE,i.PUBLIC_VALUE+32),this.publicOwner=e.slice(i.PUBLIC_OWNER,i.PUBLIC_OWNER+32),this.publicAssetId=e.slice(i.PUBLIC_ASSET_ID,i.PUBLIC_ASSET_ID+32),this.noteTreeRoot=e.slice(i.NOTE_TREE_ROOT,i.NOTE_TREE_ROOT+32),this.txFee=e.slice(i.TX_FEE,i.TX_FEE+32),this.txFeeAssetId=e.slice(i.TX_FEE_ASSET_ID,i.TX_FEE_ASSET_ID+32),this.bridgeId=e.slice(i.BRIDGE_ID,i.BRIDGE_ID+32),this.defiDepositValue=e.slice(i.DEFI_DEPOSIT_VALUE,i.DEFI_DEPOSIT_VALUE+32),this.defiRoot=e.slice(i.DEFI_ROOT,i.DEFI_ROOT+32),this.backwardLink=e.slice(i.BACKWARD_LINK,i.BACKWARD_LINK+32),this.allowChain=e.slice(i.ALLOW_CHAIN,i.ALLOW_CHAIN+32),this.txId=(0,s.createTxId)(e.slice(0,32*u.NUM_PUBLISHED_PUBLIC_INPUTS))}static getProofIdFromBuffer(e){return e.readUInt32BE(i.PROOF_ID)}get allowChainFromNote1(){const e=this.allowChain.readUInt32BE(28);return[1,3].includes(e)}get allowChainFromNote2(){const e=this.allowChain.readUInt32BE(28);return[2,3].includes(e)}}e.exports.ProofData=u,u.NUM_PUBLIC_INPUTS=17,u.NUM_PUBLISHED_PUBLIC_INPUTS=8})),o.register("dQ820",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.createTxId=void 0;var r=o("giqbl"),i=o("27chZ");const a=new r.Keccak(256);e.exports.createTxId=function(e){const t=e.readUInt32BE(28)===i.ProofId.DEFI_DEPOSIT?n.concat([e.slice(0,32),n.alloc(32),e.slice(64)]):e;return a.reset(),a.update(t).digest()}})),o.register("27chZ",(function(e,t){var n;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ProofId=void 0,(n=e.exports.ProofId||(e.exports.ProofId={}))[n.PADDING=0]="PADDING",n[n.DEPOSIT=1]="DEPOSIT",n[n.WITHDRAW=2]="WITHDRAW",n[n.SEND=3]="SEND",n[n.ACCOUNT=4]="ACCOUNT",n[n.DEFI_DEPOSIT=5]="DEFI_DEPOSIT",n[n.DEFI_CLAIM=6]="DEFI_CLAIM"})),o.register("PblD2",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.DefiClaimProofData=void 0;var n=o("lJwtZ"),r=o("jJK4a"),i=o("3EfHf"),a=o("27chZ");class s{constructor(e){if(this.proofData=e,e.proofId!==a.ProofId.DEFI_CLAIM)throw new Error("Not a defi claim proof.")}static fromBuffer(e){return new s(new i.ProofData(e))}get txFee(){return(0,n.toBigIntBE)(this.proofData.txFee)}get txFeeAssetId(){return this.proofData.txFeeAssetId.readUInt32BE(28)}get bridgeId(){return r.BridgeId.fromBuffer(this.proofData.bridgeId)}}e.exports.DefiClaimProofData=s})),o.register("aZGol",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.DefiDepositProofData=void 0;var n=o("lJwtZ"),r=o("jJK4a"),i=o("3EfHf"),a=o("27chZ");class s{constructor(e){if(this.proofData=e,e.proofId!==a.ProofId.DEFI_DEPOSIT)throw new Error("Not a defi deposit proof.")}static fromBuffer(e){return new s(new i.ProofData(e))}get txFee(){return(0,n.toBigIntBE)(this.proofData.txFee)}get txFeeAssetId(){return this.proofData.txFeeAssetId.readUInt32BE(28)}get bridgeId(){return r.BridgeId.fromBuffer(this.proofData.bridgeId)}get defiDepositValue(){return(0,n.toBigIntBE)(this.proofData.defiDepositValue)}}e.exports.DefiDepositProofData=s})),o.register("hgpcJ",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.JoinSplitProofData=void 0;var n=o("1T4rt"),r=o("lJwtZ"),i=o("3EfHf");class a{constructor(e){this.proofData=e}static fromBuffer(e){return new a(new i.ProofData(e))}get txId(){return this.proofData.txId}get publicAssetId(){return this.proofData.publicAssetId.readUInt32BE(28)}get publicValue(){return(0,r.toBigIntBE)(this.proofData.publicValue)}get publicOwner(){return new n.EthAddress(this.proofData.publicOwner)}get txFee(){return(0,r.toBigIntBE)(this.proofData.txFee)}get txFeeAssetId(){return this.proofData.txFeeAssetId.readUInt32BE(28)}}e.exports.JoinSplitProofData=a})),o.register("1Bulf",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("a8zLQ"),e.exports),s(o("7oswP"),e.exports)})),o.register("a8zLQ",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Prover=void 0;const r=(0,l(o("7LjTn")).default)("bb:prover");class i{constructor(e){r(e),this.start=(new Date).getTime()}mark(e){const t=(new Date).getTime()-this.start;r(`${e} (ms:${t})`),this.start=(new Date).getTime()}}e.exports.Prover=class{constructor(e,t,n,r=""){this.wasm=e,this.pippenger=t,this.fft=n,this.callPrefix=r}getWorker(){return this.wasm}async proverCall(e,...t){return await this.wasm.call(this.callPrefix+e,...t)}async createProof(e){await this.wasm.acquire();try{const t=await this.proverCall("prover_get_circuit_size",e),r=new i("enter createProof");await this.proverCall("prover_execute_preamble_round",e),r.mark("preamble end"),await this.processProverQueue(e,t),r.mark("first round start"),await this.proverCall("prover_execute_first_round",e),r.mark("first round end"),await this.processProverQueue(e,t),r.mark("second round start"),await this.proverCall("prover_execute_second_round",e),r.mark("second round end"),await this.processProverQueue(e,t),r.mark("third round start"),await this.proverCall("prover_execute_third_round",e),r.mark("third round end"),await this.processProverQueue(e,t),r.mark("fourth round start"),await this.proverCall("prover_execute_fourth_round",e),r.mark("fourth round end"),await this.processProverQueue(e,t),r.mark("fifth round start"),await this.proverCall("prover_execute_fifth_round",e),r.mark("fifth round end"),r.mark("sixth round start"),await this.proverCall("prover_execute_sixth_round",e),r.mark("sixth round end"),await this.processProverQueue(e,t),r.mark("done");const o=await this.proverCall("prover_export_proof",e,0),a=n.from(await this.wasm.sliceMemory(0,4)).readUInt32LE(0);return n.from(await this.wasm.sliceMemory(a,a+o))}finally{await this.wasm.release()}}async processProverQueue(e,t){await this.proverCall("prover_get_work_queue_item_info",e,0);const i=n.from(await this.wasm.sliceMemory(0,12)),o=i.readUInt32LE(0),a=i.readUInt32LE(4),s=i.readUInt32LE(8);r(`starting jobs scalars:${o} ffts:${a} iffts:${s}`);for(let n=0;n<o;++n){const r=await this.proverCall("prover_get_scalar_multiplication_data",e,n),i=await this.wasm.sliceMemory(r,r+32*t),o=await this.pippenger.pippengerUnsafe(i,0,t);await this.wasm.transferToHeap(o,0),await this.proverCall("prover_put_scalar_multiplication_data",e,0,n)}const u=[];for(let n=0;n<a;++n){const r=await this.proverCall("prover_get_fft_data",e,0,n),i=await this.wasm.sliceMemory(r,r+32*t),o=await this.wasm.sliceMemory(0,32);u.push({coefficients:i,constant:o,inverse:!1,i:n})}for(let n=0;n<s;++n){const r=await this.proverCall("prover_get_ifft_data",e,n),i=await this.wasm.sliceMemory(r,r+32*t);u.push({coefficients:i,inverse:!0,i:n})}await Promise.all(u.map((({inverse:n,coefficients:r,constant:i,i:o})=>n?this.doIfft(e,o,t,r):this.doFft(e,o,t,r,i))))}async doFft(e,t,n,r,i){const o=await this.fft.fft(r,i),a=await this.wasm.call("bbmalloc",32*n);await this.wasm.transferToHeap(o,a),await this.proverCall("prover_put_fft_data",e,a,t),await this.wasm.call("bbfree",a)}async doIfft(e,t,n,r){const i=await this.fft.ifft(r),o=await this.wasm.call("bbmalloc",32*n);await this.wasm.transferToHeap(i,o),await this.proverCall("prover_put_ifft_data",e,o,t),await this.wasm.call("bbfree",o)}}})),o.register("7oswP",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.UnrolledProver=void 0;var n=o("a8zLQ");class r extends n.Prover{constructor(e,t,n){super(e,t,n,"unrolled_")}}e.exports.UnrolledProver=r})),o.register("8K0E7",(function(e,t){var n=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n)return n;throw new Error("unable to locate global object")}();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response})),o.register("7WRIX",(function(e,t){var n=o("150uq").Buffer,r="../barretenberg.js/dest/environment/init";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.InitHelpers=void 0;var i=o("kOtop"),a=o("lJwtZ");const s=c(o("9DGMB"));var u=o("5rn7K");const l=32,f=28,h=32,d=32;class p{static getInitData(e){return{roots:p.getInitRoots(e),dataTreeSize:p.getInitDataSize(e)}}static getInitRoots(e){const{initDataRoot:t,initNullRoot:r,initRootsRoot:i}=(0,u.getInitData)(e).initRoots;return{dataRoot:n.from(t,"hex"),nullRoot:n.from(r,"hex"),rootsRoot:n.from(i,"hex")}}static getInitDataSize(e){return(0,u.getInitData)(e).initDataSize}static getInitAccounts(e){return(0,u.getInitData)(e).initAccounts}static getAccountDataFile(e){if(!(0,u.getInitData)(e).accountsData)return;const t=(0,u.getInitData)(e).accountsData;return s.resolve(r,t)}static getRootDataFile(e){if(!(0,u.getInitData)(e).roots)return;const t=(0,u.getInitData)(e).roots;return s.resolve(r,t)}static async writeData(e,t){const n=s.resolve(r,e),o=await i.promises.open(n,"w"),{bytesWritten:a}=await o.write(t);return await o.close(),a}static async readData(e){const t=s.resolve(r,e);try{const e=await i.promises.open(t,"r"),n=await e.readFile();return await e.close(),n}catch(e){return console.log(`Failed to read file: ${t}. Error: ${e}`),n.alloc(0)}}static async writeAccountTreeData(e,t){e.forEach((e=>{if(e.notes.note1.length!==l)throw new Error(`Note1 has length ${e.notes.note1.length}, it should be 32`);if(e.notes.note2.length!==l)throw new Error(`Note2 has length ${e.notes.note2.length}, it should be 32`);if(e.alias.aliasHash.length!==f)throw new Error(`Alias hash has length ${e.alias.aliasHash.length}, it should be 28`);if(64!==e.alias.address.length)throw new Error(`Alias grumpkin address has length ${e.alias.address.length}, it should be 64`);if(e.nullifiers.nullifier1.length!==h)throw new Error(`Nullifier1 has length ${e.nullifiers.nullifier1.length}, it should be 32`);if(e.nullifiers.nullifier2.length!==h)throw new Error(`Nullifier1 has length ${e.nullifiers.nullifier2.length}, it should be 32`);if(e.signingKeys.signingKey1.length!==d)throw new Error(`Signing Key 1 has length ${e.signingKeys.signingKey1.length}, it should be 32`);if(e.signingKeys.signingKey2.length!==d)throw new Error(`Signing Key 2 has length ${e.signingKeys.signingKey2.length}, it should be 32`)}));const r=e.flatMap((e=>[e.alias.aliasHash,e.alias.address,e.notes.note1,e.notes.note2,e.nullifiers.nullifier1,e.nullifiers.nullifier2,e.signingKeys.signingKey1,e.signingKeys.signingKey2]));return await this.writeData(t,n.concat(r))}static parseAccountTreeData(e){const t=e.length/284;if(0===t)return[];const n=new Array(t);for(let r=0;r<t;r++){let t=284*r;const i={aliasHash:e.slice(t,t+f),address:e.slice(t+f,t+92)};t+=92;const o={note1:e.slice(t,t+l),note2:e.slice(t+l,t+64)};t+=64;const a={nullifier1:e.slice(t,t+h),nullifier2:e.slice(t+h,t+64)};t+=64;const s={notes:o,nullifiers:a,alias:i,signingKeys:{signingKey1:e.slice(t,t+d),signingKey2:e.slice(t+d,t+64)}};n[r]=s}return n}static async readAccountTreeData(e){const t=await this.readData(e);return this.parseAccountTreeData(t)}static async populateDataAndRootsTrees(e,t,r,i,o){const a=e.flatMap(((e,t)=>[{treeId:r,index:BigInt(2*t),value:e.notes.note1},{treeId:r,index:BigInt(1+2*t),value:e.notes.note2}]));if(console.log(`Batch inserting ${a.length} notes into data tree...`),await t.batchPut(a),o){const e=(Math.floor(a.length/o)+(a.length%o?1:0))*o;e>a.length&&await t.put(r,BigInt(e-1),n.alloc(32,0))}const s=t.getRoot(r);await t.put(i,BigInt(0),s);return{dataRoot:s,rootsRoot:t.getRoot(i),dataSize:t.getSize(r)}}static async populateNullifierTree(e,t,r){const i=n.alloc(32,0),o=e.flatMap((e=>[e.nullifiers.nullifier1,e.nullifiers.nullifier2])).filter((e=>!e.equals(i))).map((e=>({treeId:r,index:(0,a.toBigIntBE)(e),value:(0,a.toBufferBE)(BigInt(1),32)})));console.log(`Batch inserting ${o.length} notes into nullifier tree...`),await t.batchPut(o);return t.getRoot(r)}}e.exports.InitHelpers=p})),o.register("9DGMB",(function(t,n){var r,i,a,s,u,c,l,f,h,d;e(t.exports,"resolve",(()=>r),(e=>r=e)),e(t.exports,"normalize",(()=>i),(e=>i=e)),e(t.exports,"isAbsolute",(()=>a),(e=>a=e)),e(t.exports,"join",(()=>s),(e=>s=e)),e(t.exports,"relative",(()=>u),(e=>u=e)),e(t.exports,"sep",(()=>c),(e=>c=e)),e(t.exports,"delimiter",(()=>l),(e=>l=e)),e(t.exports,"dirname",(()=>f),(e=>f=e)),e(t.exports,"basename",(()=>h),(e=>h=e)),e(t.exports,"extname",(()=>d),(e=>d=e));var p=o("iThRa");function m(e,t){for(var n=0,r=e.length-1;r>=0;r--){var i=e[r];"."===i?e.splice(r,1):".."===i?(e.splice(r,1),n++):n&&(e.splice(r,1),n--)}if(t)for(;n--;)e.unshift("..");return e}function y(e,t){if(e.filter)return e.filter(t);for(var n=[],r=0;r<e.length;r++)t(e[r],r,e)&&n.push(e[r]);return n}r=function(){for(var e="",t=!1,n=arguments.length-1;n>=-1&&!t;n--){var r=n>=0?arguments[n]:p.cwd();if("string"!=typeof r)throw new TypeError("Arguments to path.resolve must be strings");r&&(e=r+"/"+e,t="/"===r.charAt(0))}return(t?"/":"")+(e=m(y(e.split("/"),(function(e){return!!e})),!t).join("/"))||"."},i=function(e){var t=a(e),n="/"===g(e,-1);return(e=m(y(e.split("/"),(function(e){return!!e})),!t).join("/"))||t||(e="."),e&&n&&(e+="/"),(t?"/":"")+e},a=function(e){return"/"===e.charAt(0)},s=function(){var e=Array.prototype.slice.call(arguments,0);return i(y(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},u=function(e,t){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var n=e.length-1;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}e=r(e).substr(1),t=r(t).substr(1);for(var i=n(e.split("/")),o=n(t.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var c=[];for(u=s;u<i.length;u++)c.push("..");return(c=c.concat(o.slice(s))).join("/")},c="/",l=":",f=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,r=-1,i=!0,o=e.length-1;o>=1;--o)if(47===(t=e.charCodeAt(o))){if(!i){r=o;break}}else i=!1;return-1===r?n?"/":".":n&&1===r?"/":e.slice(0,r)},h=function(e,t){var n=function(e){"string"!=typeof e&&(e+="");var t,n=0,r=-1,i=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!i){n=t+1;break}}else-1===r&&(i=!1,r=t+1);return-1===r?"":e.slice(n,r)}(e);return t&&n.substr(-1*t.length)===t&&(n=n.substr(0,n.length-t.length)),n},d=function(e){"string"!=typeof e&&(e+="");for(var t=-1,n=0,r=-1,i=!0,o=0,a=e.length-1;a>=0;--a){var s=e.charCodeAt(a);if(47!==s)-1===r&&(i=!1,r=a+1),46===s?-1===t?t=a:1!==o&&(o=1):-1!==t&&(o=-1);else if(!i){n=a+1;break}}return-1===t||-1===r||0===o||1===o&&t===r-1&&t===n+1?"":e.slice(t,r)};var g="b"==="ab".substr(-1)?function(e,t,n){return e.substr(t,n)}:function(e,t,n){return t<0&&(t=e.length+t),e.substr(t,n)}})),o.register("5rn7K",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.getInitData=void 0;const n={1:{initRoots:{initDataRoot:"06e00f331c68d8109607a35e1bc247b149864ecee6568697f4a77e3c8ff35472",initNullRoot:"20d5cc81a50d8e54f691566148510eaa8ba66d3ffe3ffbd770188990e45c6cce",initRootsRoot:"2157ebc03adae85518c931f7efe94ef29de35b9a1f1a7a6b6bc9f1a119641628"},initDataSize:147624,accountsData:"./data/mainnet/accounts",firstRollup:0,lastRollup:3120},default:{initRoots:{initDataRoot:"1417c092da90cfd39679299b8e381dd295dba6074b410e830ef6d3b7040b6eac",initNullRoot:"0225131cf7530ba9f617dba641b32020a746a6e0124310c09aac7c7c8a2e0ce5",initRootsRoot:"08ddeab28afc61bd560f0153f7399c9bb437c7cd280d0f4c19322227fcd80e05"},initDataSize:8,accountsData:"./data/default/accounts",initAccounts:{mnemonic:"once cost physical tongue reason coconut trick whip permit novel victory ritual",aliases:["account1","account2","account3","account4"]}}};e.exports.getInitData=function(e){var t;return null!==(t=n[e])&&void 0!==t?t:n.default}})),o.register("3W8hd",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OffchainAccountData=void 0;var r=o("1T4rt"),i=o("7TSDW");class a{constructor(e,t,r=n.alloc(32),i=n.alloc(32),o=0){if(this.accountPublicKey=e,this.aliasHash=t,this.spendingPublicKey1=r,this.spendingPublicKey2=i,this.txRefNo=o,32!==r.length)throw new Error("Expect spendingPublicKey1 to be 32 bytes.");if(32!==i.length)throw new Error("Expect spendingPublicKey2 to be 32 bytes.")}static fromBuffer(e){if(e.length!==a.SIZE)throw new Error("Invalid buffer size.");let t=0;const n=new r.GrumpkinAddress(e.slice(t,t+64));t+=64;const i=new f.AliasHash(e.slice(t,t+f.AliasHash.SIZE));t+=f.AliasHash.SIZE;const o=e.slice(t,t+32);t+=32;const s=e.slice(t,t+32);t+=32;const u=e.readUInt32BE(t);return new a(n,i,o,s,u)}toBuffer(){return n.concat([this.accountPublicKey.toBuffer(),this.aliasHash.toBuffer(),this.spendingPublicKey1,this.spendingPublicKey2,(0,i.numToUInt32BE)(this.txRefNo)])}}e.exports.OffchainAccountData=a,a.EMPTY=new a(r.GrumpkinAddress.ZERO,f.AliasHash.ZERO),a.SIZE=a.EMPTY.toBuffer().length})),o.register("1GaRQ",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OffchainDefiClaimData=void 0;class r{constructor(){}static fromBuffer(e){if(e.length!==r.SIZE)throw new Error("Invalid buffer size.");return new r}toBuffer(){return n.alloc(0)}}e.exports.OffchainDefiClaimData=r,r.EMPTY=new r,r.SIZE=0})),o.register("1g2q3",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OffchainDefiDepositData=void 0;var r=o("1T4rt"),i=o("lJwtZ"),a=o("jJK4a"),s=o("7TSDW"),u=o("aebg6");class c{constructor(e,t,n,r,i,o,a=0){if(this.bridgeId=e,this.partialState=t,this.partialStateSecretEphPubKey=n,this.depositValue=r,this.txFee=i,this.viewingKey=o,this.txRefNo=a,32!==t.length)throw new Error("Expect partialState to be 32 bytes.");if(o.isEmpty())throw new Error("Viewing key cannot be empty.")}static fromBuffer(e){if(e.length!==c.SIZE)throw new Error("Invalid buffer size.");let t=0;const n=a.BridgeId.fromBuffer(e.slice(t,t+32));t+=32;const o=e.slice(t,t+32);t+=32;const s=new r.GrumpkinAddress(e.slice(t,t+64));t+=64;const l=(0,i.toBigIntBE)(e.slice(t,t+32));t+=32;const f=(0,i.toBigIntBE)(e.slice(t,t+32));t+=32;const h=new u.ViewingKey(e.slice(t,t+u.ViewingKey.SIZE));t+=u.ViewingKey.SIZE;const d=e.readUInt32BE(t);return new c(n,o,s,l,f,h,d)}toBuffer(){return n.concat([this.bridgeId.toBuffer(),this.partialState,this.partialStateSecretEphPubKey.toBuffer(),(0,i.toBufferBE)(this.depositValue,32),(0,i.toBufferBE)(this.txFee,32),this.viewingKey.toBuffer(),(0,s.numToUInt32BE)(this.txRefNo)])}}e.exports.OffchainDefiDepositData=c,c.EMPTY=new c(a.BridgeId.ZERO,n.alloc(32),r.GrumpkinAddress.ZERO,BigInt(0),BigInt(0),new u.ViewingKey(n.alloc(u.ViewingKey.SIZE))),c.SIZE=c.EMPTY.toBuffer().length})),o.register("8i3Tm",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.OffchainJoinSplitData=void 0;var r=o("7TSDW"),i=o("aebg6");class a{constructor(e,t=0){if(this.viewingKeys=e,this.txRefNo=t,2!==e.length)throw new Error(`Expect 2 viewing keys. Received ${e.length}.`);if(e.some((e=>e.isEmpty())))throw new Error("Viewing key cannot be empty.")}static fromBuffer(e){if(e.length!==a.SIZE)throw new Error("Invalid buffer size.");let t=0;const n=new i.ViewingKey(e.slice(t,t+i.ViewingKey.SIZE));t+=i.ViewingKey.SIZE;const r=new i.ViewingKey(e.slice(t,t+i.ViewingKey.SIZE));t+=i.ViewingKey.SIZE;const o=e.readUInt32BE(t);return new a([n,r],o)}toBuffer(){return n.concat([...this.viewingKeys.map((e=>e.toBuffer())),(0,r.numToUInt32BE)(this.txRefNo)])}}e.exports.OffchainJoinSplitData=a,a.EMPTY=new a([new i.ViewingKey(n.alloc(i.ViewingKey.SIZE)),new i.ViewingKey(n.alloc(i.ViewingKey.SIZE))]),a.SIZE=a.EMPTY.toBuffer().length})),o.register("3Ca8o",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.sliceOffchainTxData=void 0;var r=o("3W8hd"),i=o("1g2q3"),a=o("8i3Tm");e.exports.sliceOffchainTxData=(e,t)=>{let o=0,s=0;return e.map((e=>{switch(o=s,e){case p.ProofId.DEPOSIT:case p.ProofId.WITHDRAW:case p.ProofId.SEND:return s+=a.OffchainJoinSplitData.SIZE,t.slice(o,s);case p.ProofId.ACCOUNT:return s+=r.OffchainAccountData.SIZE,t.slice(o,s);case p.ProofId.DEFI_DEPOSIT:return s+=i.OffchainDefiDepositData.SIZE,t.slice(o,s);default:return n.alloc(0)}}))}}));var p={};Object.defineProperty(p,"__esModule",{value:!0}),s(o("cP5rv"),p),s(o("hbqo0"),p),s(o("bZYGu"),p),s(o("1Bulf"),p),o.register("JgStB",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.InnerProofData=void 0;var r=o("7TSDW");class i{constructor(e,t,n,r,i,o,a,s){this.proofId=e,this.noteCommitment1=t,this.noteCommitment2=n,this.nullifier1=r,this.nullifier2=i,this.publicValue=o,this.publicOwner=a,this.assetId=s,this.txId=(0,p.createTxId)(this.toBuffer())}getDepositSigningData(){return this.toBuffer()}toBuffer(){return n.concat([(0,r.numToUInt32BE)(this.proofId,32),this.noteCommitment1,this.noteCommitment2,this.nullifier1,this.nullifier2,this.publicValue,this.publicOwner,this.assetId])}isPadding(){return this.proofId===p.ProofId.PADDING}static fromBuffer(e){let t=0;const n=e.readUInt32BE(t+28);t+=32;const r=e.slice(t,t+32);t+=32;const o=e.slice(t,t+32);t+=32;const a=e.slice(t,t+32);t+=32;const s=e.slice(t,t+32);t+=32;const u=e.slice(t,t+32);t+=32;const c=e.slice(t,t+32);t+=32;const l=e.slice(t,t+32);return t+=32,new i(n,r,o,a,s,u,c,l)}}e.exports.InnerProofData=i,i.NUM_PUBLIC_INPUTS=8,i.LENGTH=32*i.NUM_PUBLIC_INPUTS,i.PADDING=i.fromBuffer(n.alloc(i.LENGTH))})),o.register("3jMh8",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RollupAccountProofData=void 0;var r=o("JgStB");class i{constructor(e){if(this.proofData=e,e.proofId!==p.ProofId.ACCOUNT)throw new Error("Not an account proof.")}get ENCODED_LENGTH(){return i.ENCODED_LENGTH}static decode(e){if(e.readUInt8(0)!==p.ProofId.ACCOUNT)throw new Error("Not an account proof.");let t=1;const o=e.slice(t,t+32);t+=32;const a=e.slice(t,t+32);t+=32;const s=e.slice(t,t+32);t+=32;const u=e.slice(t,t+32);return new i(new r.InnerProofData(p.ProofId.ACCOUNT,o,a,s,u,n.alloc(32),n.alloc(32),n.alloc(32)))}encode(){const{noteCommitment1:e,noteCommitment2:t,nullifier1:r,nullifier2:i}=this.proofData;return n.concat([n.from([p.ProofId.ACCOUNT]),e,t,r,i])}}e.exports.RollupAccountProofData=i,i.ENCODED_LENGTH=129})),o.register("2KPI8",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RollupDefiClaimProofData=void 0;var r=o("jJK4a"),i=o("JgStB");class a{constructor(e){if(this.proofData=e,e.proofId!==p.ProofId.DEFI_CLAIM)throw new Error("Not a defi claim proof.")}get ENCODED_LENGTH(){return a.ENCODED_LENGTH}get bridgeId(){return r.BridgeId.fromBuffer(this.proofData.assetId)}static decode(e){if(e.readUInt8(0)!==p.ProofId.DEFI_CLAIM)throw new Error("Not a defi claim proof.");let t=1;const r=e.slice(t,t+32);t+=32;const o=e.slice(t,t+32);t+=32;const s=e.slice(t,t+32);t+=32;const u=e.slice(t,t+32);return new a(new i.InnerProofData(p.ProofId.DEFI_CLAIM,r,o,s,u,n.alloc(32),n.alloc(32),n.alloc(32)))}encode(){const{noteCommitment1:e,noteCommitment2:t,nullifier1:r,nullifier2:i}=this.proofData;return n.concat([n.from([p.ProofId.DEFI_CLAIM]),e,t,r,i])}}e.exports.RollupDefiClaimProofData=a,a.ENCODED_LENGTH=129})),o.register("cjiBI",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RollupDefiDepositProofData=void 0;var r=o("lJwtZ"),i=o("jJK4a"),a=o("JgStB");class s{constructor(e){if(this.proofData=e,e.proofId!==p.ProofId.DEFI_DEPOSIT)throw new Error("Not a defi deposit proof.")}get ENCODED_LENGTH(){return s.ENCODED_LENGTH}get bridgeId(){return i.BridgeId.fromBuffer(this.proofData.assetId)}get deposit(){return(0,r.toBigIntBE)(this.proofData.publicValue)}static decode(e){if(e.readUInt8(0)!==p.ProofId.DEFI_DEPOSIT)throw new Error("Not a defi deposit proof.");let t=1;const r=e.slice(t,t+32);t+=32;const i=e.slice(t,t+32);t+=32;const o=e.slice(t,t+32);t+=32;const u=e.slice(t,t+32);return new s(new a.InnerProofData(p.ProofId.DEFI_DEPOSIT,r,i,o,u,n.alloc(32),n.alloc(32),n.alloc(32)))}encode(){const{noteCommitment1:e,noteCommitment2:t,nullifier1:r,nullifier2:i}=this.proofData;return n.concat([n.from([p.ProofId.DEFI_DEPOSIT]),e,t,r,i])}}e.exports.RollupDefiDepositProofData=s,s.ENCODED_LENGTH=129})),o.register("ly2Yv",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RollupDepositProofData=void 0;var r=o("1T4rt"),i=o("lJwtZ"),a=o("JgStB");class s{constructor(e){if(this.proofData=e,e.proofId!==p.ProofId.DEPOSIT)throw new Error("Not a deposit proof.")}get ENCODED_LENGTH(){return s.ENCODED_LENGTH}get assetId(){return this.proofData.assetId.readUInt32BE(28)}get publicValue(){return(0,i.toBigIntBE)(this.proofData.publicValue)}get publicOwner(){return new r.EthAddress(this.proofData.publicOwner)}static decode(e){if(e.readUInt8(0)!==p.ProofId.DEPOSIT)throw new Error("Not a deposit proof.");let t=1;const r=e.slice(t,t+32);t+=32;const i=e.slice(t,t+32);t+=32;const o=e.slice(t,t+32);t+=32;const u=e.slice(t,t+32);t+=32;const c=e.slice(t,t+32);t+=32;const l=n.concat([n.alloc(12),e.slice(t,t+20)]);t+=20;const f=n.concat([n.alloc(28),e.slice(t,t+4)]);return new s(new a.InnerProofData(p.ProofId.DEPOSIT,r,i,o,u,c,l,f))}encode(){const{noteCommitment1:e,noteCommitment2:t,nullifier1:r,nullifier2:i,publicValue:o,assetId:a}=this.proofData,s=a.slice(28,32);return n.concat([n.from([p.ProofId.DEPOSIT]),e,t,r,i,o,this.publicOwner.toBuffer(),s])}}e.exports.RollupDepositProofData=s,s.ENCODED_LENGTH=185})),o.register("bVMoX",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RollupProofData=e.exports.RollupProofDataOffsets=e.exports.RollupProofDataFields=void 0;var r,i,a,s=o("hxZzW"),u=o("7TSDW"),c=o("7aYEV"),l=o("gjQMp"),f=o("JgStB"),h=o("lJwtZ");(r=e.exports.RollupProofDataFields||(e.exports.RollupProofDataFields={}))[r.ROLLUP_ID=0]="ROLLUP_ID",r[r.ROLLUP_SIZE=1]="ROLLUP_SIZE",r[r.DATA_START_INDEX=2]="DATA_START_INDEX",r[r.OLD_DATA_ROOT=3]="OLD_DATA_ROOT",r[r.NEW_DATA_ROOT=4]="NEW_DATA_ROOT",r[r.OLD_NULL_ROOT=5]="OLD_NULL_ROOT",r[r.NEW_NULL_ROOT=6]="NEW_NULL_ROOT",r[r.OLD_ROOT_ROOT=7]="OLD_ROOT_ROOT",r[r.NEW_ROOT_ROOT=8]="NEW_ROOT_ROOT",r[r.OLD_DEFI_ROOT=9]="OLD_DEFI_ROOT",r[r.NEW_DEFI_ROOT=10]="NEW_DEFI_ROOT",(a=i=e.exports.RollupProofDataOffsets||(e.exports.RollupProofDataOffsets={}))[a.ROLLUP_ID=28]="ROLLUP_ID",a[a.ROLLUP_SIZE=60]="ROLLUP_SIZE",a[a.DATA_START_INDEX=92]="DATA_START_INDEX",a[a.OLD_DATA_ROOT=96]="OLD_DATA_ROOT",a[a.NEW_DATA_ROOT=128]="NEW_DATA_ROOT",a[a.OLD_NULL_ROOT=160]="OLD_NULL_ROOT",a[a.NEW_NULL_ROOT=192]="NEW_NULL_ROOT",a[a.OLD_ROOT_ROOT=224]="OLD_ROOT_ROOT",a[a.NEW_ROOT_ROOT=256]="NEW_ROOT_ROOT",a[a.OLD_DEFI_ROOT=288]="OLD_DEFI_ROOT",a[a.NEW_DEFI_ROOT=320]="NEW_DEFI_ROOT";const d=e=>{const t=y.getRollupIdFromBuffer(e),n=e.readUInt32BE(i.ROLLUP_SIZE),r=e.readUInt32BE(i.DATA_START_INDEX),o=e.slice(i.OLD_DATA_ROOT,i.OLD_DATA_ROOT+32),a=e.slice(i.NEW_DATA_ROOT,i.NEW_DATA_ROOT+32),s=e.slice(i.OLD_NULL_ROOT,i.OLD_NULL_ROOT+32),u=e.slice(i.NEW_NULL_ROOT,i.NEW_NULL_ROOT+32),c=e.slice(i.OLD_ROOT_ROOT,i.OLD_ROOT_ROOT+32),l=e.slice(i.NEW_ROOT_ROOT,i.NEW_ROOT_ROOT+32),f=e.slice(i.OLD_DEFI_ROOT,i.OLD_DEFI_ROOT+32),d=e.slice(i.NEW_DEFI_ROOT,i.NEW_DEFI_ROOT+32);let p=352;const m=[];for(let t=0;t<y.NUM_BRIDGE_CALLS_PER_BLOCK;++t)m.push(e.slice(p,p+32)),p+=32;const g=[];for(let t=0;t<y.NUM_BRIDGE_CALLS_PER_BLOCK;++t)g.push((0,h.toBigIntBE)(e.slice(p,p+32))),p+=32;const b=[];for(let t=0;t<y.NUMBER_OF_ASSETS;++t)b.push(e.readUInt32BE(p+28)),p+=32;const v=[];for(let t=0;t<y.NUMBER_OF_ASSETS;++t)v.push((0,h.toBigIntBE)(e.slice(p,p+32))),p+=32;const w=[];for(let t=0;t<y.NUM_BRIDGE_CALLS_PER_BLOCK;++t)w.push(e.slice(p,p+32)),p+=32;const _=e.slice(p,p+32);p+=32;const E=e.slice(p,p+32);p+=32;const S=e.readUInt32BE(p+28);return p+=32,{rollupId:t,rollupSize:n,dataStartIndex:r,oldDataRoot:o,newDataRoot:a,oldNullRoot:s,newNullRoot:u,oldDataRootsRoot:c,newDataRootsRoot:l,oldDefiRoot:f,newDefiRoot:d,bridgeIds:m,defiDepositSums:g,assetIds:b,totalTxFees:v,defiInteractionNotes:w,prevDefiInteractionHash:_,rollupBeneficiary:E,numRollupTxs:S}};class y{constructor(e,t,r,i,o,a,u,c,l,f,h,d,p,m,g,b,v,w,_,E){if(this.rollupId=e,this.rollupSize=t,this.dataStartIndex=r,this.oldDataRoot=i,this.newDataRoot=o,this.oldNullRoot=a,this.newNullRoot=u,this.oldDataRootsRoot=c,this.newDataRootsRoot=l,this.oldDefiRoot=f,this.newDefiRoot=h,this.bridgeIds=d,this.defiDepositSums=p,this.assetIds=m,this.totalTxFees=g,this.defiInteractionNotes=b,this.prevDefiInteractionHash=v,this.rollupBeneficiary=w,this.numRollupTxs=_,this.innerProofData=E,d.length!==y.NUM_BRIDGE_CALLS_PER_BLOCK)throw new Error(`Expect bridgeIds to be an array of size ${y.NUM_BRIDGE_CALLS_PER_BLOCK}.`);if(p.length!==y.NUM_BRIDGE_CALLS_PER_BLOCK)throw new Error(`Expect defiDepositSums to be an array of size ${y.NUM_BRIDGE_CALLS_PER_BLOCK}.`);if(g.length!==y.NUMBER_OF_ASSETS)throw new Error(`Expect totalTxFees to be an array of size ${y.NUMBER_OF_ASSETS}.`);if(b.length!==y.NUM_BRIDGE_CALLS_PER_BLOCK)throw new Error(`Expect defiInteractionNotes to be an array of size ${y.NUM_BRIDGE_CALLS_PER_BLOCK}.`);const S=this.innerProofData.map((e=>e.txId));this.rollupHash=(0,s.createHash)("sha256").update(n.concat(S)).digest()}toBuffer(){return n.concat([(0,u.numToUInt32BE)(this.rollupId,32),(0,u.numToUInt32BE)(this.rollupSize,32),(0,u.numToUInt32BE)(this.dataStartIndex,32),this.oldDataRoot,this.newDataRoot,this.oldNullRoot,this.newNullRoot,this.oldDataRootsRoot,this.newDataRootsRoot,this.oldDefiRoot,this.newDefiRoot,...this.bridgeIds,...this.defiDepositSums.map((e=>(0,h.toBufferBE)(e,32))),...this.assetIds.map((e=>(0,u.numToUInt32BE)(e,32))),...this.totalTxFees.map((e=>(0,h.toBufferBE)(e,32))),...this.defiInteractionNotes,this.prevDefiInteractionHash,this.rollupBeneficiary,(0,u.numToUInt32BE)(this.numRollupTxs,32),...this.innerProofData.map((e=>e.toBuffer()))])}getTotalDeposited(e){return this.innerProofData.filter((e=>e.proofId===p.ProofId.DEPOSIT)).map((e=>new m.RollupDepositProofData(e))).filter((t=>t.assetId==e)).reduce(((e,t)=>e+t.publicValue),BigInt(0))}getTotalWithdrawn(e){return this.innerProofData.filter((e=>e.proofId===p.ProofId.WITHDRAW)).map((e=>new m.RollupWithdrawProofData(e))).filter((t=>t.assetId==e)).reduce(((e,t)=>e+t.publicValue),BigInt(0))}getTotalDefiDeposit(e){const t=this.assetIds.indexOf(e);return t<0?BigInt(0):this.defiDepositSums[t]}getTotalFees(e){const t=this.assetIds.indexOf(e);return t<0?BigInt(0):this.totalTxFees[t]}encode(){let e=0;this.innerProofData.forEach(((t,n)=>{t.proofId!==p.ProofId.PADDING&&(e=n)}));const t=e+1,r=this.innerProofData.filter(((e,n)=>n<t)).map((e=>(0,l.encodeInnerProof)(e)));return n.concat([(0,u.numToUInt32BE)(this.rollupId,32),(0,u.numToUInt32BE)(this.rollupSize,32),(0,u.numToUInt32BE)(this.dataStartIndex,32),this.oldDataRoot,this.newDataRoot,this.oldNullRoot,this.newNullRoot,this.oldDataRootsRoot,this.newDataRootsRoot,this.oldDefiRoot,this.newDefiRoot,...this.bridgeIds,...this.defiDepositSums.map((e=>(0,h.toBufferBE)(e,32))),...this.assetIds.map((e=>(0,u.numToUInt32BE)(e,32))),...this.totalTxFees.map((e=>(0,h.toBufferBE)(e,32))),...this.defiInteractionNotes,this.prevDefiInteractionHash,this.rollupBeneficiary,(0,u.numToUInt32BE)(this.numRollupTxs,32),(0,u.numToUInt32BE)(t),(0,u.numToUInt32BE)(n.concat(r).length),...r])}static getRollupIdFromBuffer(e){return e.readUInt32BE(i.ROLLUP_ID)}static getRollupSizeFromBuffer(e){return e.readUInt32BE(i.ROLLUP_SIZE)}static getTxIdsFromBuffer(e){const t=y.getRollupSizeFromBuffer(e),n=y.LENGTH_ROLLUP_HEADER_INPUTS;return Array.from({length:t}).map(((t,r)=>{const i=n+r*f.InnerProofData.LENGTH;return(0,p.createTxId)(e.slice(i,i+f.InnerProofData.LENGTH))})).filter((e=>!e.equals(f.InnerProofData.PADDING.txId)))}static fromBuffer(e){const{rollupId:t,rollupSize:n,dataStartIndex:r,oldDataRoot:i,newDataRoot:o,oldNullRoot:a,newNullRoot:s,oldDataRootsRoot:u,newDataRootsRoot:c,oldDefiRoot:l,newDefiRoot:h,bridgeIds:p,defiDepositSums:m,assetIds:g,totalTxFees:b,defiInteractionNotes:v,prevDefiInteractionHash:w,rollupBeneficiary:_,numRollupTxs:E}=d(e);if(!n)throw new Error("Empty rollup.");let S=y.LENGTH_ROLLUP_HEADER_INPUTS;const x=[];for(let t=0;t<n;++t){const n=e.slice(S,S+f.InnerProofData.LENGTH);x[t]=f.InnerProofData.fromBuffer(n),S+=f.InnerProofData.LENGTH}return new y(t,n,r,i,o,a,s,u,c,l,h,p,m,g,b,v,w,_,E,x)}static randomData(e,t,r=0,i,o=[]){const a=void 0===i?new Array(t).fill(0).map((()=>f.InnerProofData.fromBuffer(n.alloc(f.InnerProofData.LENGTH)))):i;return new y(e,t,r,n.alloc(32),n.alloc(32),n.alloc(32),n.alloc(32),n.alloc(32),n.alloc(32),n.alloc(32),n.alloc(32),o.map((e=>e.toBuffer())).concat(new Array(y.NUM_BRIDGE_CALLS_PER_BLOCK-o.length).fill(0).map((()=>n.alloc(32)))),new Array(y.NUM_BRIDGE_CALLS_PER_BLOCK).fill(BigInt(0)),new Array(y.NUMBER_OF_ASSETS).fill(0),new Array(y.NUMBER_OF_ASSETS).fill(BigInt(0)),new Array(y.NUM_BRIDGE_CALLS_PER_BLOCK).fill(0).map((()=>n.alloc(32))),n.alloc(32),n.alloc(32),a.length,a)}static decode(e){const{rollupId:t,rollupSize:n,dataStartIndex:r,oldDataRoot:i,newDataRoot:o,oldNullRoot:a,newNullRoot:s,oldDataRootsRoot:u,newDataRootsRoot:l,oldDefiRoot:h,newDefiRoot:p,bridgeIds:m,defiDepositSums:g,assetIds:b,totalTxFees:v,defiInteractionNotes:w,prevDefiInteractionHash:_,rollupBeneficiary:E,numRollupTxs:S}=d(e);if(!n)throw new Error("Empty rollup.");let x=y.LENGTH_ROLLUP_HEADER_INPUTS;x+=4;let T=e.readUInt32BE(x);x+=4;const M=[];for(;T>0;){const t=(0,c.decodeInnerProof)(e.slice(x));M.push(t.proofData),x+=t.ENCODED_LENGTH,T-=t.ENCODED_LENGTH}for(let e=M.length;e<n;++e)M.push(f.InnerProofData.PADDING);return new y(t,n,r,i,o,a,s,u,l,h,p,m,g,b,v,w,_,E,S,M)}}e.exports.RollupProofData=y,y.NUMBER_OF_ASSETS=16,y.NUM_BRIDGE_CALLS_PER_BLOCK=32,y.NUM_ROLLUP_HEADER_INPUTS=14+2*y.NUMBER_OF_ASSETS+3*y.NUM_BRIDGE_CALLS_PER_BLOCK,y.LENGTH_ROLLUP_HEADER_INPUTS=32*y.NUM_ROLLUP_HEADER_INPUTS})),o.register("7aYEV",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.decodeInnerProof=void 0;var n=o("3jMh8"),r=o("2KPI8"),i=o("cjiBI"),a=o("ly2Yv"),s=o("cIgUJ"),u=o("1bCNc"),c=o("kQeC7");e.exports.decodeInnerProof=e=>(e=>{switch(e.readUInt8(0)){case p.ProofId.DEPOSIT:return a.RollupDepositProofData.decode(e);case p.ProofId.WITHDRAW:return c.RollupWithdrawProofData.decode(e);case p.ProofId.SEND:return u.RollupSendProofData.decode(e);case p.ProofId.ACCOUNT:return n.RollupAccountProofData.decode(e);case p.ProofId.DEFI_DEPOSIT:return i.RollupDefiDepositProofData.decode(e);case p.ProofId.DEFI_CLAIM:return r.RollupDefiClaimProofData.decode(e);case p.ProofId.PADDING:return s.RollupPaddingProofData.decode(e)}})(e)})),o.register("cIgUJ",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RollupPaddingProofData=void 0;var r=o("JgStB");class i{constructor(e){if(this.proofData=e,e.proofId!==p.ProofId.PADDING)throw new Error("Not a padding proof.")}get ENCODED_LENGTH(){return i.ENCODED_LENGTH}static decode(e){if(e.readUInt8(0)!==p.ProofId.PADDING)throw new Error("Not a padding proof.");return new i(new r.InnerProofData(p.ProofId.PADDING,n.alloc(32),n.alloc(32),n.alloc(32),n.alloc(32),n.alloc(32),n.alloc(32),n.alloc(32)))}encode(){return n.from([p.ProofId.PADDING])}}e.exports.RollupPaddingProofData=i,i.ENCODED_LENGTH=1})),o.register("1bCNc",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RollupSendProofData=void 0;var r=o("JgStB");class i{constructor(e){if(this.proofData=e,e.proofId!==p.ProofId.SEND)throw new Error("Not a send proof.")}get ENCODED_LENGTH(){return i.ENCODED_LENGTH}static decode(e){if(e.readUInt8(0)!==p.ProofId.SEND)throw new Error("Not a send proof.");let t=1;const o=e.slice(t,t+32);t+=32;const a=e.slice(t,t+32);t+=32;const s=e.slice(t,t+32);t+=32;const u=e.slice(t,t+32);return new i(new r.InnerProofData(p.ProofId.SEND,o,a,s,u,n.alloc(32),n.alloc(32),n.alloc(32)))}encode(){const{noteCommitment1:e,noteCommitment2:t,nullifier1:r,nullifier2:i}=this.proofData;return n.concat([n.from([p.ProofId.SEND]),e,t,r,i])}}e.exports.RollupSendProofData=i,i.ENCODED_LENGTH=129})),o.register("kQeC7",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.RollupWithdrawProofData=void 0;var r=o("1T4rt"),i=o("lJwtZ"),a=o("JgStB");class s{constructor(e){if(this.proofData=e,e.proofId!==p.ProofId.WITHDRAW)throw new Error("Not a withdraw proof.")}get ENCODED_LENGTH(){return s.ENCODED_LENGTH}get assetId(){return this.proofData.assetId.readUInt32BE(28)}get publicValue(){return(0,i.toBigIntBE)(this.proofData.publicValue)}get publicOwner(){return new r.EthAddress(this.proofData.publicOwner)}static decode(e){if(e.readUInt8(0)!==p.ProofId.WITHDRAW)throw new Error("Not a withdraw proof.");let t=1;const r=e.slice(t,t+32);t+=32;const i=e.slice(t,t+32);t+=32;const o=e.slice(t,t+32);t+=32;const u=e.slice(t,t+32);t+=32;const c=e.slice(t,t+32);t+=32;const l=n.concat([n.alloc(12),e.slice(t,t+20)]);t+=20;const f=n.concat([n.alloc(28),e.slice(t,t+4)]);return new s(new a.InnerProofData(p.ProofId.WITHDRAW,r,i,o,u,c,l,f))}encode(){const{noteCommitment1:e,noteCommitment2:t,nullifier1:r,nullifier2:i,publicValue:o,assetId:a}=this.proofData,s=a.slice(28,32);return n.concat([n.from([p.ProofId.WITHDRAW]),e,t,r,i,o,this.publicOwner.toBuffer(),s])}}e.exports.RollupWithdrawProofData=s,s.ENCODED_LENGTH=185})),o.register("gjQMp",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.encodeInnerProof=void 0;var n=o("3jMh8"),r=o("2KPI8"),i=o("cjiBI"),a=o("ly2Yv"),s=o("1bCNc"),u=o("kQeC7"),c=o("cIgUJ");e.exports.encodeInnerProof=e=>(e=>{switch(e.proofId){case p.ProofId.DEPOSIT:return new a.RollupDepositProofData(e);case p.ProofId.WITHDRAW:return new u.RollupWithdrawProofData(e);case p.ProofId.SEND:return new s.RollupSendProofData(e);case p.ProofId.ACCOUNT:return new n.RollupAccountProofData(e);case p.ProofId.DEFI_DEPOSIT:return new i.RollupDefiDepositProofData(e);case p.ProofId.DEFI_CLAIM:return new r.RollupDefiClaimProofData(e);case p.ProofId.PADDING:return new c.RollupPaddingProofData(e)}})(e).encode()}));var m={};Object.defineProperty(m,"__esModule",{value:!0}),s(o("JgStB"),m),s(o("3jMh8"),m),s(o("2KPI8"),m),s(o("cjiBI"),m),s(o("ly2Yv"),m),s(o("bVMoX"),m),s(o("1bCNc"),m),s(o("kQeC7"),m),o.register("hRYWQ",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.WorldState=void 0;var n=o("2ZepW"),r=o("eE6bJ");const i=(0,l(o("7LjTn")).default)("bb:world_state");e.exports.WorldState=class{constructor(e,t){this.db=e,this.pedersen=t,this.subTreeDepth=0}async init(e){const t=1<<e;this.subTreeDepth=e;const o=Array(t).fill(n.MemoryMerkleTree.ZERO_ELEMENT),a=await n.MemoryMerkleTree.new(o,this.pedersen),s=r.WorldStateConstants.DATA_TREE_DEPTH-e,u=a.getRoot();i(`initialising data tree with depth ${s} and zero element of ${u.toString("hex")}`);try{this.tree=await n.MerkleTree.fromName(this.db,this.pedersen,"data",u)}catch(e){this.tree=await n.MerkleTree.new(this.db,this.pedersen,"data",s,u)}this.logTreeStats()}buildZeroHashPath(e=r.WorldStateConstants.DATA_TREE_DEPTH){let t=n.MemoryMerkleTree.ZERO_ELEMENT;const i=[];for(let n=0;n<e;n++)i.push([t,t]),t=this.pedersen.compress(t,t);return new n.HashPath(i)}convertNoteIndexToSubTreeIndex(e){return e>>this.subTreeDepth}async buildFullHashPath(e,t){const r=this.convertNoteIndexToSubTreeIndex(e),i=await this.getHashPath(r);return new n.HashPath(t.data.concat(i.data))}async insertElement(e,t){const n=this.convertNoteIndexToSubTreeIndex(e);await this.tree.updateElement(n,t),this.logTreeStats()}async insertElements(e,t){const n=this.convertNoteIndexToSubTreeIndex(e);await this.tree.updateElements(n,t),this.logTreeStats()}logTreeStats(){const e=1<<this.subTreeDepth;i("data size: "+this.tree.getSize()*e),i(`data root: ${this.tree.getRoot().toString("hex")}`)}async syncFromDb(){await this.tree.syncFromDb()}async getHashPath(e){return await this.tree.getHashPath(e)}getRoot(){return this.tree.getRoot()}getSize(){return this.tree.getSize()}}})),o.register("eE6bJ",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.WorldStateConstants=void 0;var r=o("eewJK");const i=m.RollupProofData.NUM_BRIDGE_CALLS_PER_BLOCK;class a{}e.exports.WorldStateConstants=a,a.EMPTY_DATA_ROOT=n.from("18ceb5cd201e1cee669a5c3ad96d3c4e933a365b37046fc3178264bede32c68d","hex"),a.EMPTY_NULL_ROOT=n.from("298329c7d0936453f354e4a5eef4897296cc0bf5a66f2a528318508d2088dafa","hex"),a.EMPTY_ROOT_ROOT=n.from("2fd2364bfe47ccb410eba3a958be9f39a8c6aca07db1abd15f5a211f51505071","hex"),a.EMPTY_DEFI_ROOT=n.from("2e4ab7889ab3139204945f9e722c7a8fdb84e66439d787bd066c3d896dba04ea","hex"),a.EMPTY_INTERACTION_HASH=n.from("2d25a1e3a51eb293004c4b56abe12ed0da6bca2b4a21936752a85d102593c1b4","hex"),a.INITIAL_INTERACTION_HASH=(0,r.packInteractionNotes)([],i),a.DATA_TREE_DEPTH=32,a.NUM_NEW_DATA_TREE_NOTES_PER_TX=2})),o.register("3CZp2",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("diP7t",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.joinSplitTxFromJson=e.exports.joinSplitTxToJson=e.exports.accountFromJson=e.exports.accountToJson=e.exports.pendingTxFromJson=e.exports.pendingTxToJson=e.exports.txFromJson=e.exports.txToJson=e.exports.DefiSettlementTime=e.exports.TxSettlementTime=void 0;var r,i,a=o("1T4rt");(r=e.exports.TxSettlementTime||(e.exports.TxSettlementTime={}))[r.NEXT_ROLLUP=0]="NEXT_ROLLUP",r[r.INSTANT=1]="INSTANT",(i=e.exports.DefiSettlementTime||(e.exports.DefiSettlementTime={}))[i.DEADLINE=0]="DEADLINE",i[i.NEXT_ROLLUP=1]="NEXT_ROLLUP",i[i.INSTANT=2]="INSTANT";e.exports.txToJson=({proofData:e,offchainTxData:t,depositSignature:n})=>({proofData:e.toString("hex"),offchainTxData:t.toString("hex"),depositSignature:n?n.toString("hex"):void 0});e.exports.txFromJson=({proofData:e,offchainTxData:t,depositSignature:r})=>({proofData:n.from(e,"hex"),offchainTxData:n.from(t,"hex"),depositSignature:r?n.from(r,"hex"):void 0});e.exports.pendingTxToJson=({txId:e,noteCommitment1:t,noteCommitment2:n})=>({txId:e.toString(),noteCommitment1:t.toString("hex"),noteCommitment2:n.toString("hex")});e.exports.pendingTxFromJson=({txId:e,noteCommitment1:t,noteCommitment2:r})=>({txId:g.TxId.fromString(e),noteCommitment1:n.from(t,"hex"),noteCommitment2:n.from(r,"hex")});e.exports.accountToJson=({accountPublicKey:e,aliasHash:t})=>({accountPublicKey:e.toString(),aliasHash:t.toString()});e.exports.accountFromJson=({accountPublicKey:e,aliasHash:t})=>({accountPublicKey:a.GrumpkinAddress.fromString(e),aliasHash:f.AliasHash.fromString(t)});e.exports.joinSplitTxToJson=({proofData:e,offchainTxData:t})=>({proofData:e.proofData.rawProofData.toString("hex"),offchainTxData:t.toBuffer().toString("hex")});e.exports.joinSplitTxFromJson=({proofData:e,offchainTxData:t})=>({proofData:p.JoinSplitProofData.fromBuffer(n.from(e,"hex")),offchainTxData:y.OffchainJoinSplitData.fromBuffer(n.from(t,"hex"))})}));var y={};Object.defineProperty(y,"__esModule",{value:!0}),s(o("3W8hd"),y),s(o("1GaRQ"),y),s(o("1g2q3"),y),s(o("8i3Tm"),y),s(o("3Ca8o"),y);var g={},b=o("150uq").Buffer;Object.defineProperty(g,"__esModule",{value:!0}),g.TxId=void 0;var v=o("1vwiL");class w{constructor(e){if(this.buffer=e,32!==e.length)throw new Error("Invalid hash buffer.")}static deserialize(e,t){return{elem:new w(e.slice(t,t+32)),adv:32}}static fromString(e){return new w(b.from(e.replace(/^0x/i,""),"hex"))}static random(){return new w((0,v.randomBytes)(32))}equals(e){return this.toBuffer().equals(e.toBuffer())}toBuffer(){return this.buffer}toString(){return`0x${this.toBuffer().toString("hex")}`}toDepositSigningData(){const e=this.toString();return b.concat([b.from("Signing this message will allow your pending funds to be spent in Aztec transaction:\n\n"),b.from(e),b.from("\n\nIMPORTANT: Only sign the message if you trust the client")])}}g.TxId=w,o.register("5s4nN",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.rollupProviderStatusFromJson=e.exports.rollupProviderStatusToJson=e.exports.partialRuntimeConfigFromJson=e.exports.runtimeConfigFromJson=e.exports.runtimeConfigToJson=void 0;var n=o("83Rm3");s(o("87qEp"),e.exports),s(o("ezL6J"),e.exports),s(o("kmSYX"),e.exports);e.exports.runtimeConfigToJson=({maxFeeGasPrice:e,maxProviderGasPrice:t,bridgeConfigs:n,privacySets:r,...i})=>({...i,maxFeeGasPrice:e.toString(),maxProviderGasPrice:t.toString(),bridgeConfigs:n.map(o("87qEp").bridgeConfigToJson),privacySets:(0,o("kmSYX").privacySetsToJson)(r)});e.exports.runtimeConfigFromJson=({maxFeeGasPrice:e,maxProviderGasPrice:t,bridgeConfigs:n,privacySets:r,...i})=>({...i,maxFeeGasPrice:BigInt(e),maxProviderGasPrice:BigInt(t),bridgeConfigs:n.map(o("87qEp").bridgeConfigFromJson),privacySets:(0,o("kmSYX").privacySetsFromJson)(r)});e.exports.partialRuntimeConfigFromJson=({maxFeeGasPrice:e,maxProviderGasPrice:t,bridgeConfigs:n,privacySets:r,...i})=>({...i,...void 0!==e?{maxFeeGasPrice:BigInt(e)}:{},...void 0!==t?{maxProviderGasPrice:BigInt(t)}:{},...n?{bridgeConfigs:n.map(o("87qEp").bridgeConfigFromJson)}:{},...r?{privacySets:(0,o("kmSYX").privacySetsFromJson)(r)}:{}});e.exports.rollupProviderStatusToJson=({blockchainStatus:t,nextPublishTime:r,runtimeConfig:i,bridgeStatus:a,...s})=>({...s,blockchainStatus:(0,n.blockchainStatusToJson)(t),nextPublishTime:r.toISOString(),runtimeConfig:(0,e.exports.runtimeConfigToJson)(i),bridgeStatus:a.map(o("ezL6J").bridgeStatusToJson)});e.exports.rollupProviderStatusFromJson=({blockchainStatus:t,nextPublishTime:r,runtimeConfig:i,bridgeStatus:a,...s})=>({...s,blockchainStatus:(0,n.blockchainStatusFromJson)(t),nextPublishTime:new Date(r),runtimeConfig:(0,e.exports.runtimeConfigFromJson)(i),bridgeStatus:a.map(o("ezL6J").bridgeStatusFromJson)})})),o.register("83Rm3",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),s(o("4n3FP"),e.exports),s(o("iBrEi"),e.exports),s(o("fOkVk"),e.exports),s(o("lHpxr"),e.exports),s(o("8JyE7"),e.exports),s(o("fAGgl"),e.exports),s(o("h7ImA"),e.exports),s(o("EzdVt"),e.exports),s(o("9XRcr"),e.exports)})),o.register("4n3FP",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("iBrEi",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.blockchainStatusFromJson=e.exports.blockchainStatusToJson=e.exports.blockchainBridgeFromJson=e.exports.blockchainBridgeToJson=e.exports.blockchainAssetFromJson=e.exports.blockchainAssetToJson=e.exports.isAccountCreation=e.exports.isDefiDeposit=e.exports.TxType=void 0;var r,i,a=o("1T4rt");(i=r=e.exports.TxType||(e.exports.TxType={}))[i.DEPOSIT=0]="DEPOSIT",i[i.TRANSFER=1]="TRANSFER",i[i.WITHDRAW_TO_WALLET=2]="WITHDRAW_TO_WALLET",i[i.WITHDRAW_TO_CONTRACT=3]="WITHDRAW_TO_CONTRACT",i[i.ACCOUNT=4]="ACCOUNT",i[i.DEFI_DEPOSIT=5]="DEFI_DEPOSIT",i[i.DEFI_CLAIM=6]="DEFI_CLAIM",e.exports.isDefiDeposit=function(e){return e===r.DEFI_DEPOSIT},e.exports.isAccountCreation=function(e){return e===r.ACCOUNT};e.exports.blockchainAssetToJson=({address:e,...t})=>({...t,address:e.toString()});e.exports.blockchainAssetFromJson=({address:e,...t})=>({...t,address:a.EthAddress.fromString(e)});e.exports.blockchainBridgeToJson=({address:e,...t})=>({...t,address:e.toString()});e.exports.blockchainBridgeFromJson=({address:e,...t})=>({...t,address:a.EthAddress.fromString(e)}),e.exports.blockchainStatusToJson=function(t){return{...t,rollupContractAddress:t.rollupContractAddress.toString(),feeDistributorContractAddress:t.feeDistributorContractAddress.toString(),verifierContractAddress:t.verifierContractAddress.toString(),dataRoot:t.dataRoot.toString("hex"),nullRoot:t.nullRoot.toString("hex"),rootRoot:t.rootRoot.toString("hex"),defiRoot:t.defiRoot.toString("hex"),defiInteractionHashes:t.defiInteractionHashes.map((e=>e.toString("hex"))),assets:t.assets.map(e.exports.blockchainAssetToJson),bridges:t.bridges.map(e.exports.blockchainBridgeToJson)}},e.exports.blockchainStatusFromJson=function(t){return{...t,rollupContractAddress:a.EthAddress.fromString(t.rollupContractAddress),feeDistributorContractAddress:a.EthAddress.fromString(t.feeDistributorContractAddress),verifierContractAddress:a.EthAddress.fromString(t.feeDistributorContractAddress),dataRoot:n.from(t.dataRoot,"hex"),nullRoot:n.from(t.nullRoot,"hex"),rootRoot:n.from(t.rootRoot,"hex"),defiRoot:n.from(t.defiRoot,"hex"),defiInteractionHashes:t.defiInteractionHashes.map((e=>n.from(e,"hex"))),assets:t.assets.map(e.exports.blockchainAssetFromJson),bridges:t.bridges.map(e.exports.blockchainBridgeFromJson)}}})),o.register("fOkVk",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.EthereumRpc=void 0;var n=o("1T4rt");e.exports.EthereumRpc=class{constructor(e){this.provider=e}async getChainId(){const e=await this.provider.request({method:"eth_chainId"});return Number(e)}async getAccounts(){return(await this.provider.request({method:"eth_accounts"})).map(n.EthAddress.fromString)}async getTransactionCount(e){const t=await this.provider.request({method:"eth_getTransactionCount",params:[e.toString(),"latest"]});return Number(t)}async getBalance(e){const t=await this.provider.request({method:"eth_getBalance",params:[e.toString(),"latest"]});return BigInt(t)}async getTransactionByHash(e){return await this.provider.request({method:"eth_getTransactionByHash",params:[e.toString()]})}}})),o.register("lHpxr",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("8JyE7",(function(e,t){var n;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ProviderError=void 0,(n=e.exports.ProviderError||(e.exports.ProviderError={}))[n.USER_REJECTED=4001]="USER_REJECTED",n[n.UNAUTHORIZED=4100]="UNAUTHORIZED",n[n.UNSUPPORTED=4200]="UNSUPPORTED",n[n.DISCONNECTED=4900]="DISCONNECTED",n[n.CHAIN_DISCONNECTED=4901]="CHAIN_DISCONNECTED"})),o.register("fAGgl",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("h7ImA",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("EzdVt",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("9XRcr",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.TxHash=void 0;var r=o("1vwiL");class i{constructor(e){if(this.buffer=e,32!==e.length)throw new Error("Invalid hash buffer.")}static fromBuffer(e){return new i(e)}static deserialize(e,t){return{elem:new i(e.slice(t,t+32)),adv:32}}static fromString(e){return new i(n.from(e.replace(/^0x/i,""),"hex"))}static random(){return new i((0,r.randomBytes)(32))}equals(e){return this.toBuffer().equals(e.toBuffer())}toBuffer(){return this.buffer}toString(){return`0x${this.toBuffer().toString("hex")}`}}e.exports.TxHash=i})),o.register("87qEp",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.bridgeConfigFromJson=e.exports.bridgeConfigToJson=void 0;e.exports.bridgeConfigToJson=({bridgeId:e,...t})=>({...t,bridgeId:e.toString()});e.exports.bridgeConfigFromJson=({bridgeId:e,...t})=>({...t,bridgeId:BigInt(e)})})),o.register("ezL6J",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.bridgeStatusFromJson=e.exports.bridgeStatusToJson=void 0;var r=o("lJwtZ");e.exports.bridgeStatusToJson=function({bridgeId:e,nextPublishTime:t,...n}){return{...n,bridgeId:(0,r.toBufferBE)(e,32).toString("hex"),nextPublishTime:null==t?void 0:t.toISOString()}},e.exports.bridgeStatusFromJson=function({bridgeId:e,nextPublishTime:t,...i}){return{...i,bridgeId:(0,r.toBigIntBE)(n.from(e,"hex")),nextPublishTime:t?new Date(t):void 0}}})),o.register("kmSYX",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.getDefaultPrivacySets=e.exports.privacySetsFromJson=e.exports.privacySetsToJson=void 0,e.exports.privacySetsToJson=function(e){const t={};for(const n in e){const r=e[n];t[n]=r.map((e=>({value:e.value.toString(),users:e.users})))}return t},e.exports.privacySetsFromJson=function(e){const t={};for(const n in e){const r=e[n];t[Number(n)]=r.map((e=>({value:BigInt(e.value),users:e.users})))}return t},e.exports.getDefaultPrivacySets=function(){return{0:[],1:[]}}})),o.register("7Kr0G",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ServerRollupProvider=void 0;var r=o("4ZiGb"),i=o("gVTXZ"),a=o("diP7t"),s=o("5s4nN");class u extends i.ServerBlockSource{constructor(e,t=1e4){super(e,t)}async sendTxs(e){const t=e.map(a.txToJson),n=await this.fetch("/txs",t);return(await n.json()).txIds.map((e=>g.TxId.fromString(e)))}async getTxFees(e){const t=await this.fetch("/tx-fees",{assetId:e});return(await t.json()).map((e=>e.map(r.assetValueFromJson)))}async getDefiFees(e){const t=await this.fetch("/defi-fees",{bridgeId:e.toString()});return(await t.json()).map(r.assetValueFromJson)}async getStatus(){const e=await this.fetch("/status");try{return(0,s.rollupProviderStatusFromJson)(await e.json())}catch(e){throw new Error("Bad response: getStatus()")}}async getPendingTxs(){const e=await this.fetch("/get-pending-txs");return(await e.json()).map(a.pendingTxFromJson)}async getPendingNoteNullifiers(){const e=await this.fetch("/get-pending-note-nullifiers");return(await e.json()).map((e=>n.from(e,"hex")))}async clientLog(e){await this.fetch("/client-log",e)}async getInitialWorldState(){const e=await this.fetch("/get-initial-world-state"),t=await e.arrayBuffer();return{initialAccounts:n.from(t)}}async isAccountRegistered(e){const t=await this.fetch("/is-account-registered",{accountPublicKey:e.toString()});return 1==+await t.text()}async isAliasRegistered(e){const t=await this.fetch("/is-alias-registered",{alias:e});return 1==+await t.text()}async accountExists(e,t){const n=await this.fetch("/account-exists",{accountPublicKey:e.toString(),alias:t});return 1==+await n.text()}async getUnsettledAccounts(){const e=await this.fetch("/get-unsettled-accounts");return(await e.json()).map(a.accountFromJson)}async getUnsettledPaymentTxs(){const e=await this.fetch("/get-unsettled-payment-txs");return(await e.json()).map(a.joinSplitTxFromJson)}async fetch(e,t){const n=new URL(`${this.baseUrl}${e}`),r=t?{method:"POST",body:JSON.stringify(t)}:void 0,i=await(0,_.fetch)(n.toString(),r).catch((()=>{}));if(!i)throw new Error("Failed to contact rollup provider.");if(400===i.status){const e=await i.json();throw new Error(e.error)}if(200!==i.status)throw new Error(`Bad response code ${i.status}.`);return i}}e.exports.ServerRollupProvider=u})),o.register("gVTXZ",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.Block=void 0;var r=o("7TSDW"),i=o("83Rm3"),a=o("gMF1t");class u{constructor(e,t,n,r,i,o,a,s,u,c){this.txHash=e,this.created=t,this.rollupId=n,this.rollupSize=r,this.rollupProofData=i,this.offchainTxData=o,this.interactionResult=a,this.gasUsed=s,this.gasPrice=u,this.subtreeRoot=c}static deserialize(e,t=0){const o=new r.Deserializer(e,t),s=o.exec(i.TxHash.deserialize),c=o.date(),l=o.uInt32(),f=o.uInt32(),h=o.vector(),d=o.deserializeArray(r.deserializeBufferFromVector),p=o.deserializeArray(a.DefiInteractionEvent.deserialize),m=o.uInt32(),y=o.bigInt(),g=o.vector();return{elem:new u(s,c,l,f,h,d,p,m,y,g.equals(n.alloc(0))?void 0:g),adv:o.getOffset()-t}}static fromBuffer(e){return u.deserialize(e).elem}toBuffer(){var e;return n.concat([this.txHash.toBuffer(),(0,r.serializeDate)(this.created),(0,r.numToUInt32BE)(this.rollupId),(0,r.numToUInt32BE)(this.rollupSize),(0,r.serializeBufferToVector)(this.rollupProofData),(0,r.serializeBufferArrayToVector)(this.offchainTxData.map((e=>(0,r.serializeBufferToVector)(e)))),(0,r.serializeBufferArrayToVector)(this.interactionResult.map((e=>e.toBuffer()))),(0,r.numToUInt32BE)(this.gasUsed),(0,r.serializeBigInt)(this.gasPrice),(0,r.serializeBufferToVector)(null!==(e=this.subtreeRoot)&&void 0!==e?e:n.alloc(0))])}}e.exports.Block=u,s(o("2B5bY"),e.exports)})),o.register("gMF1t",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.DefiInteractionEvent=void 0;var r=o("4G3uU"),i=o("lJwtZ"),a=o("jJK4a"),s=o("1vwiL"),u=o("7TSDW");class c{constructor(e,t,r,i,o,a,s=n.alloc(0)){this.bridgeId=e,this.nonce=t,this.totalInputValue=r,this.totalOutputValueA=i,this.totalOutputValueB=o,this.result=a,this.errorReason=s}static deserialize(e,t){const n=new u.Deserializer(e,t),r=n.buffer(32),i=a.BridgeId.fromBuffer(r),o=n.bigInt(),s=n.bigInt(),l=n.bigInt(),f=n.uInt32(),h=n.bool(),d=n.vector();return{elem:new c(i,f,o,s,l,h,d),adv:n.getOffset()-t}}static random(){return new c(a.BridgeId.random(),(0,s.randomBytes)(4).readUInt32BE(0),(0,i.toBigIntBE)((0,s.randomBytes)(32)),(0,i.toBigIntBE)((0,s.randomBytes)(32)),(0,i.toBigIntBE)((0,s.randomBytes)(32)),!!Math.round(Math.random()))}static fromBuffer(e){return c.deserialize(e,0).elem}toBuffer(){const e=new u.Serializer;return e.buffer(this.bridgeId.toBuffer()),e.bigInt(this.totalInputValue),e.bigInt(this.totalOutputValueA),e.bigInt(this.totalOutputValueB),e.uInt32(this.nonce),e.bool(this.result),e.vector(this.errorReason),e.getBuffer()}equals(e){return this.toBuffer().equals(e.toBuffer())}toDefiInteractionNote(){return new r.DefiInteractionNote(this.bridgeId,this.nonce,this.totalInputValue,this.totalOutputValueA,this.totalOutputValueB,this.result)}}e.exports.DefiInteractionEvent=c,c.EMPTY=new c(a.BridgeId.ZERO,0,BigInt(0),BigInt(0),BigInt(0),!1)})),o.register("2B5bY",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.ServerBlockSource=void 0;var r=o("gVTXZ"),i=o("cC4OV"),a=o("7TSDW");class s extends i.EventEmitter{constructor(e,t=1e4){super(),this.pollInterval=t,this.running=!1,this.runningPromise=Promise.resolve(),this.interruptPromise=Promise.resolve(),this.interruptResolve=()=>{},this.latestRollupId=-1,this.baseUrl=e.toString().replace(/\/$/,"")}getLatestRollupId(){return this.latestRollupId}async start(e=0){this.running=!0,this.interruptPromise=new Promise((e=>this.interruptResolve=e));const t=async()=>{try{const t=await this.getBlocks(e);for(const n of t)this.emit("block",n),e=n.rollupId+1}catch(e){}};await t();this.runningPromise=(async()=>{for(;this.running;)await t(),await this.sleepOrInterrupted(this.pollInterval)})()}stop(){return this.running=!1,this.interruptResolve(),this.runningPromise}async awaitSucceed(e){for(;;)try{const t=await e();if(200!==t.status)throw new Error(`Bad status code: ${t.status}`);return t}catch(e){console.log(e.message),await new Promise((e=>setTimeout(e,1e4)))}}async getBlocks(e){const t=new URL(`${this.baseUrl}/get-blocks`);t.searchParams.append("from",e.toString());const i=await this.awaitSucceed((()=>(0,_.fetch)(t.toString(),{headers:{"Accept-encoding":"gzip"}}))),o=n.from(await i.arrayBuffer()),s=new a.Deserializer(o);return this.latestRollupId=s.int32(),s.deserializeArray(r.Block.deserialize)}async sleepOrInterrupted(e){let t;const n=new Promise((n=>t=setTimeout(n,e)));await Promise.race([n,this.interruptPromise]),clearTimeout(t)}}e.exports.ServerBlockSource=s}));var _={};Object.defineProperty(_,"__esModule",{value:!0}),_.fetch=void 0;const E=l(o("2vGx5"));_.fetch=function(e,t){if(E.default){return(0,o("8K0E7").default)(e,t)}if("undefined"!=typeof window&&window.fetch)return window.fetch(e,t);if("undefined"!=typeof self&&self.fetch)return self.fetch(e,t);throw new Error("`fetch` api unavailable.")},o.register("dyk5A",(function(e,t){var n=o("iThRa"),r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;e.exports.format=function(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(u(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),s=r[n];n<o;s=r[++n])y(s)||!_(s)?a+=" "+s:a+=" "+u(s);return a},e.exports.deprecate=function(t,r){if(void 0!==n&&!0===n.noDeprecation)return t;if(void 0===n)return function(){return e.exports.deprecate(t,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),i=!0}return t.apply(this,arguments)}};var a={},s=/^$/;function u(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(n)?r.showHidden=n:n&&e.exports._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),f(r,t,r.depth)}function c(e,t){var n=u.styles[t];return n?"["+u.colors[n][0]+"m"+e+"["+u.colors[n][1]+"m":e}function l(e,t){return e}function f(t,n,r){if(t.customInspect&&n&&x(n.inspect)&&n.inspect!==e.exports.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return b(i)||(i=f(t,i,r)),i}var o=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(g(t))return e.stylize(""+t,"number");if(m(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),S(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(x(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(w(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return h(n)}var c,l="",_=!1,T=["{","}"];(p(n)&&(_=!0,T=["[","]"]),x(n))&&(l=" [Function"+(n.name?": "+n.name:"")+"]");return w(n)&&(l=" "+RegExp.prototype.toString.call(n)),E(n)&&(l=" "+Date.prototype.toUTCString.call(n)),S(n)&&(l=" "+h(n)),0!==a.length||_&&0!=n.length?r<0?w(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=_?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)I(t,String(a))?o.push(d(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))})),o}(t,n,r,s,a):a.map((function(e){return d(t,n,r,s,e,_)})),t.seen.pop(),function(e,t,n){var r=0;return e.reduce((function(e,t){r++;if(t.indexOf("\n")>=0)r++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(c,l,T)):T[0]+l+T[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),I(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=y(n)?f(e,u.value,null):f(e,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),v(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function y(e){return null===e}function g(e){return"number"==typeof e}function b(e){return"string"==typeof e}function v(e){return void 0===e}function w(e){return _(e)&&"[object RegExp]"===T(e)}function _(e){return"object"==typeof e&&null!==e}function E(e){return _(e)&&"[object Date]"===T(e)}function S(e){return _(e)&&("[object Error]"===T(e)||e instanceof Error)}function x(e){return"function"==typeof e}function T(e){return Object.prototype.toString.call(e)}function M(e){return e<10?"0"+e.toString(10):e.toString(10)}e.exports.debuglog=function(t){if(t=t.toUpperCase(),!a[t])if(s.test(t)){var r=n.pid;a[t]=function(){var n=e.exports.format.apply(e.exports,arguments);console.error("%s %d: %s",t,r,n)}}else a[t]=function(){};return a[t]},e.exports.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.exports.types=o("iiC1e"),e.exports.isArray=p,e.exports.isBoolean=m,e.exports.isNull=y,e.exports.isNullOrUndefined=function(e){return null==e},e.exports.isNumber=g,e.exports.isString=b,e.exports.isSymbol=function(e){return"symbol"==typeof e},e.exports.isUndefined=v,e.exports.isRegExp=w,e.exports.types.isRegExp=w,e.exports.isObject=_,e.exports.isDate=E,e.exports.types.isDate=E,e.exports.isError=S,e.exports.types.isNativeError=S,e.exports.isFunction=x,e.exports.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},e.exports.isBuffer=o("5phiD");var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var e=new Date,t=[M(e.getHours()),M(e.getMinutes()),M(e.getSeconds())].join(":");return[e.getDate(),A[e.getMonth()],t].join(" ")}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports.log=function(){console.log("%s - %s",R(),e.exports.format.apply(e.exports,arguments))},e.exports.inherits=o("j1UVA"),e.exports._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function N(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}e.exports.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(P&&e[P]){var t;if("function"!=typeof(t=e[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),P&&Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},e.exports.promisify.custom=P,e.exports.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var i=t.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};e.apply(this,t).then((function(e){n.nextTick(a.bind(null,null,e))}),(function(e){n.nextTick(N.bind(null,e,a))}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,r(e)),t}})),o.register("iiC1e",(function(e,t){var n=o("5DOLK"),r=o("azeDt"),i=o("grE20"),a=o("10n2U");function s(e){return e.call.bind(e)}var u="undefined"!=typeof BigInt,c="undefined"!=typeof Symbol,l=s(Object.prototype.toString),f=s(Number.prototype.valueOf),h=s(String.prototype.valueOf),d=s(Boolean.prototype.valueOf);if(u)var p=s(BigInt.prototype.valueOf);if(c)var m=s(Symbol.prototype.valueOf);function y(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(e){return!1}}function g(e){return"[object Map]"===l(e)}function b(e){return"[object Set]"===l(e)}function v(e){return"[object WeakMap]"===l(e)}function w(e){return"[object WeakSet]"===l(e)}function _(e){return"[object ArrayBuffer]"===l(e)}function E(e){return"undefined"!=typeof ArrayBuffer&&(_.working?_(e):e instanceof ArrayBuffer)}function S(e){return"[object DataView]"===l(e)}function x(e){return"undefined"!=typeof DataView&&(S.working?S(e):e instanceof DataView)}e.exports.isArgumentsObject=n,e.exports.isGeneratorFunction=r,e.exports.isTypedArray=a,e.exports.isPromise=function(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},e.exports.isArrayBufferView=function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):a(e)||x(e)},e.exports.isUint8Array=function(e){return"Uint8Array"===i(e)},e.exports.isUint8ClampedArray=function(e){return"Uint8ClampedArray"===i(e)},e.exports.isUint16Array=function(e){return"Uint16Array"===i(e)},e.exports.isUint32Array=function(e){return"Uint32Array"===i(e)},e.exports.isInt8Array=function(e){return"Int8Array"===i(e)},e.exports.isInt16Array=function(e){return"Int16Array"===i(e)},e.exports.isInt32Array=function(e){return"Int32Array"===i(e)},e.exports.isFloat32Array=function(e){return"Float32Array"===i(e)},e.exports.isFloat64Array=function(e){return"Float64Array"===i(e)},e.exports.isBigInt64Array=function(e){return"BigInt64Array"===i(e)},e.exports.isBigUint64Array=function(e){return"BigUint64Array"===i(e)},g.working="undefined"!=typeof Map&&g(new Map),e.exports.isMap=function(e){return"undefined"!=typeof Map&&(g.working?g(e):e instanceof Map)},b.working="undefined"!=typeof Set&&b(new Set),e.exports.isSet=function(e){return"undefined"!=typeof Set&&(b.working?b(e):e instanceof Set)},v.working="undefined"!=typeof WeakMap&&v(new WeakMap),e.exports.isWeakMap=function(e){return"undefined"!=typeof WeakMap&&(v.working?v(e):e instanceof WeakMap)},w.working="undefined"!=typeof WeakSet&&w(new WeakSet),e.exports.isWeakSet=function(e){return w(e)},_.working="undefined"!=typeof ArrayBuffer&&_(new ArrayBuffer),e.exports.isArrayBuffer=E,S.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&S(new DataView(new ArrayBuffer(1),0,1)),e.exports.isDataView=x;var T="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function M(e){return"[object SharedArrayBuffer]"===l(e)}function A(e){return void 0!==T&&(void 0===M.working&&(M.working=M(new T)),M.working?M(e):e instanceof T)}function R(e){return y(e,f)}function I(e){return y(e,h)}function P(e){return y(e,d)}function N(e){return u&&y(e,p)}function O(e){return c&&y(e,m)}e.exports.isSharedArrayBuffer=A,e.exports.isAsyncFunction=function(e){return"[object AsyncFunction]"===l(e)},e.exports.isMapIterator=function(e){return"[object Map Iterator]"===l(e)},e.exports.isSetIterator=function(e){return"[object Set Iterator]"===l(e)},e.exports.isGeneratorObject=function(e){return"[object Generator]"===l(e)},e.exports.isWebAssemblyCompiledModule=function(e){return"[object WebAssembly.Module]"===l(e)},e.exports.isNumberObject=R,e.exports.isStringObject=I,e.exports.isBooleanObject=P,e.exports.isBigIntObject=N,e.exports.isSymbolObject=O,e.exports.isBoxedPrimitive=function(e){return R(e)||I(e)||P(e)||N(e)||O(e)},e.exports.isAnyArrayBuffer=function(e){return"undefined"!=typeof Uint8Array&&(E(e)||A(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(t){Object.defineProperty(e.exports,t,{enumerable:!1,value:function(){throw new Error(t+" is not supported in userland")}})}))})),o.register("5DOLK",(function(e,t){var n=o("fnPPi")(),r=o("pOa7O")("Object.prototype.toString"),i=function(e){return!(n&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===r(e)},a=function(e){return!!i(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==r(e)&&"[object Function]"===r(e.callee)},s=function(){return i(arguments)}();i.isLegacyArguments=a,e.exports=s?i:a})),o.register("fnPPi",(function(e,t){var n=o("dRyaN");e.exports=function(){return n()&&!!Symbol.toStringTag}})),o.register("dRyaN",(function(e,t){e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}})),o.register("pOa7O",(function(e,t){var n=o("86zQT"),r=o("et4V5"),i=r(n("String.prototype.indexOf"));e.exports=function(e,t){var o=n(e,!!t);return"function"==typeof o&&i(e,".prototype.")>-1?r(o):o}})),o.register("86zQT",(function(e,t){var n,r=SyntaxError,i=Function,a=TypeError,s=function(e){try{return i('"use strict"; return ('+e+").constructor;")()}catch(e){}},u=Object.getOwnPropertyDescriptor;if(u)try{u({},"")}catch(e){u=null}var c=function(){throw new a},l=u?function(){try{return c}catch(e){try{return u(arguments,"callee").get}catch(e){return c}}}():c,f=o("gaoPw")(),h=Object.getPrototypeOf||function(e){return e.__proto__},d={},p="undefined"==typeof Uint8Array?n:h(Uint8Array),m={"%AggregateError%":"undefined"==typeof AggregateError?n:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?n:ArrayBuffer,"%ArrayIteratorPrototype%":f?h([][Symbol.iterator]()):n,"%AsyncFromSyncIteratorPrototype%":n,"%AsyncFunction%":d,"%AsyncGenerator%":d,"%AsyncGeneratorFunction%":d,"%AsyncIteratorPrototype%":d,"%Atomics%":"undefined"==typeof Atomics?n:Atomics,"%BigInt%":"undefined"==typeof BigInt?n:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?n:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?n:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?n:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?n:FinalizationRegistry,"%Function%":i,"%GeneratorFunction%":d,"%Int8Array%":"undefined"==typeof Int8Array?n:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?n:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?n:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":f?h(h([][Symbol.iterator]())):n,"%JSON%":"object"==typeof JSON?JSON:n,"%Map%":"undefined"==typeof Map?n:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&f?h((new Map)[Symbol.iterator]()):n,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?n:Promise,"%Proxy%":"undefined"==typeof Proxy?n:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?n:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?n:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&f?h((new Set)[Symbol.iterator]()):n,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?n:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":f?h(""[Symbol.iterator]()):n,"%Symbol%":f?Symbol:n,"%SyntaxError%":r,"%ThrowTypeError%":l,"%TypedArray%":p,"%TypeError%":a,"%Uint8Array%":"undefined"==typeof Uint8Array?n:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?n:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?n:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?n:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?n:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?n:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?n:WeakSet},y=function e(t){var n;if("%AsyncFunction%"===t)n=s("async function () {}");else if("%GeneratorFunction%"===t)n=s("function* () {}");else if("%AsyncGeneratorFunction%"===t)n=s("async function* () {}");else if("%AsyncGenerator%"===t){var r=e("%AsyncGeneratorFunction%");r&&(n=r.prototype)}else if("%AsyncIteratorPrototype%"===t){var i=e("%AsyncGenerator%");i&&(n=h(i.prototype))}return m[t]=n,n},g={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},b=o("pUh9L"),v=o("a2DlQ"),w=b.call(Function.call,Array.prototype.concat),_=b.call(Function.apply,Array.prototype.splice),E=b.call(Function.call,String.prototype.replace),S=b.call(Function.call,String.prototype.slice),x=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,T=/\\(\\)?/g,M=function(e){var t=S(e,0,1),n=S(e,-1);if("%"===t&&"%"!==n)throw new r("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new r("invalid intrinsic syntax, expected opening `%`");var i=[];return E(e,x,(function(e,t,n,r){i[i.length]=n?E(r,T,"$1"):t||e})),i},A=function(e,t){var n,i=e;if(v(g,i)&&(i="%"+(n=g[i])[0]+"%"),v(m,i)){var o=m[i];if(o===d&&(o=y(i)),void 0===o&&!t)throw new a("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:i,value:o}}throw new r("intrinsic "+e+" does not exist!")};e.exports=function(e,t){if("string"!=typeof e||0===e.length)throw new a("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new a('"allowMissing" argument must be a boolean');var n=M(e),i=n.length>0?n[0]:"",o=A("%"+i+"%",t),s=o.name,c=o.value,l=!1,f=o.alias;f&&(i=f[0],_(n,w([0,1],f)));for(var h=1,d=!0;h<n.length;h+=1){var p=n[h],y=S(p,0,1),g=S(p,-1);if(('"'===y||"'"===y||"`"===y||'"'===g||"'"===g||"`"===g)&&y!==g)throw new r("property names with quotes must have matching quotes");if("constructor"!==p&&d||(l=!0),v(m,s="%"+(i+="."+p)+"%"))c=m[s];else if(null!=c){if(!(p in c)){if(!t)throw new a("base intrinsic for "+e+" exists, but the property is not available.");return}if(u&&h+1>=n.length){var b=u(c,p);c=(d=!!b)&&"get"in b&&!("originalValue"in b.get)?b.get:c[p]}else d=v(c,p),c=c[p];d&&!l&&(m[s]=c)}}return c}})),o.register("gaoPw",(function(e,t){var n="undefined"!=typeof Symbol&&Symbol,r=o("9uqrH");e.exports=function(){return"function"==typeof n&&("function"==typeof Symbol&&("symbol"==typeof n("foo")&&("symbol"==typeof Symbol("bar")&&r())))}})),o.register("9uqrH",(function(e,t){e.exports=function(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var r=Object.getOwnPropertySymbols(e);if(1!==r.length||r[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var i=Object.getOwnPropertyDescriptor(e,t);if(42!==i.value||!0!==i.enumerable)return!1}return!0}})),o.register("pUh9L",(function(e,t){var n=o("iob7Z");e.exports=Function.prototype.bind||n})),o.register("iob7Z",(function(e,t){var n="Function.prototype.bind called on incompatible ",r=Array.prototype.slice,i=Object.prototype.toString,o="[object Function]";e.exports=function(e){var t=this;if("function"!=typeof t||i.call(t)!==o)throw new TypeError(n+t);for(var a,s=r.call(arguments,1),u=function(){if(this instanceof a){var n=t.apply(this,s.concat(r.call(arguments)));return Object(n)===n?n:this}return t.apply(e,s.concat(r.call(arguments)))},c=Math.max(0,t.length-s.length),l=[],f=0;f<c;f++)l.push("$"+f);if(a=Function("binder","return function ("+l.join(",")+"){ return binder.apply(this,arguments); }")(u),t.prototype){var h=function(){};h.prototype=t.prototype,a.prototype=new h,h.prototype=null}return a}})),o.register("a2DlQ",(function(e,t){var n=o("pUh9L");e.exports=n.call(Function.call,Object.prototype.hasOwnProperty)})),o.register("et4V5",(function(e,t){var n=o("pUh9L"),r=o("86zQT"),i=r("%Function.prototype.apply%"),a=r("%Function.prototype.call%"),s=r("%Reflect.apply%",!0)||n.call(a,i),u=r("%Object.getOwnPropertyDescriptor%",!0),c=r("%Object.defineProperty%",!0),l=r("%Math.max%");if(c)try{c({},"a",{value:1})}catch(e){c=null}e.exports=function(e){var t=s(n,a,arguments);if(u&&c){var r=u(t,"length");r.configurable&&c(t,"length",{value:1+l(0,e.length-(arguments.length-1))})}return t};var f=function(){return s(n,i,arguments)};c?c(e.exports,"apply",{value:f}):e.exports.apply=f})),o.register("azeDt",(function(e,t){var n,r=Object.prototype.toString,i=Function.prototype.toString,a=/^\s*(?:function)?\*/,s=o("fnPPi")(),u=Object.getPrototypeOf;e.exports=function(e){if("function"!=typeof e)return!1;if(a.test(i.call(e)))return!0;if(!s)return"[object GeneratorFunction]"===r.call(e);if(!u)return!1;if(void 0===n){var t=function(){if(!s)return!1;try{return Function("return function*() {}")()}catch(e){}}();n=!!t&&u(t)}return u(e)===n}})),o.register("grE20",(function(e,n){var r=o("ImuIa"),i=o("lTv4l"),a=o("pOa7O"),s=a("Object.prototype.toString"),u=o("fnPPi")(),c="undefined"==typeof globalThis?t:globalThis,l=i(),f=a("String.prototype.slice"),h={},d=o("kyMfq"),p=Object.getPrototypeOf;u&&d&&p&&r(l,(function(e){if("function"==typeof c[e]){var t=new c[e];if(Symbol.toStringTag in t){var n=p(t),r=d(n,Symbol.toStringTag);if(!r){var i=p(n);r=d(i,Symbol.toStringTag)}h[e]=r.get}}}));var m=o("10n2U");e.exports=function(e){return!!m(e)&&(u&&Symbol.toStringTag in e?function(e){var t=!1;return r(h,(function(n,r){if(!t)try{var i=n.call(e);i===r&&(t=i)}catch(e){}})),t}(e):f(s(e),8,-1))}})),o.register("ImuIa",(function(e,t){var n=o("bhxRc"),r=Object.prototype.toString,i=Object.prototype.hasOwnProperty,a=function(e,t,n){for(var r=0,o=e.length;r<o;r++)i.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))},s=function(e,t,n){for(var r=0,i=e.length;r<i;r++)null==n?t(e.charAt(r),r,e):t.call(n,e.charAt(r),r,e)},u=function(e,t,n){for(var r in e)i.call(e,r)&&(null==n?t(e[r],r,e):t.call(n,e[r],r,e))};e.exports=function(e,t,i){if(!n(t))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=i),"[object Array]"===r.call(e)?a(e,t,o):"string"==typeof e?s(e,t,o):u(e,t,o)}})),o.register("bhxRc",(function(e,t){var n,r,i=Function.prototype.toString,o="object"==typeof Reflect&&null!==Reflect&&Reflect.apply;if("function"==typeof o&&"function"==typeof Object.defineProperty)try{n=Object.defineProperty({},"length",{get:function(){throw r}}),r={},o((function(){throw 42}),null,n)}catch(e){e!==r&&(o=null)}else o=null;var a=/^\s*class\b/,s=function(e){try{var t=i.call(e);return a.test(t)}catch(e){return!1}},u=Object.prototype.toString,c="function"==typeof Symbol&&!!Symbol.toStringTag,l="object"==typeof document&&void 0===document.all&&void 0!==document.all?document.all:{};e.exports=o?function(e){if(e===l)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;try{o(e,null,n)}catch(e){if(e!==r)return!1}return!s(e)}:function(e){if(e===l)return!0;if(!e)return!1;if("function"!=typeof e&&"object"!=typeof e)return!1;if("function"==typeof e&&!e.prototype)return!0;if(c)return function(e){try{return!s(e)&&(i.call(e),!0)}catch(e){return!1}}(e);if(s(e))return!1;var t=u.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t}})),o.register("lTv4l",(function(e,n){var r=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],i="undefined"==typeof globalThis?t:globalThis;e.exports=function(){for(var e=[],t=0;t<r.length;t++)"function"==typeof i[r[t]]&&(e[e.length]=r[t]);return e}})),o.register("kyMfq",(function(e,t){var n=o("86zQT")("%Object.getOwnPropertyDescriptor%",!0);if(n)try{n([],"length")}catch(e){n=null}e.exports=n})),o.register("10n2U",(function(e,n){var r=o("ImuIa"),i=o("lTv4l"),a=o("pOa7O"),s=a("Object.prototype.toString"),u=o("fnPPi")(),c="undefined"==typeof globalThis?t:globalThis,l=i(),f=a("Array.prototype.indexOf",!0)||function(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},h=a("String.prototype.slice"),d={},p=o("kyMfq"),m=Object.getPrototypeOf;u&&p&&m&&r(l,(function(e){var t=new c[e];if(Symbol.toStringTag in t){var n=m(t),r=p(n,Symbol.toStringTag);if(!r){var i=m(n);r=p(i,Symbol.toStringTag)}d[e]=r.get}}));e.exports=function(e){if(!e||"object"!=typeof e)return!1;if(!u||!(Symbol.toStringTag in e)){var t=h(s(e),8,-1);return f(l,t)>-1}return!!p&&function(e){var t=!1;return r(d,(function(n,r){if(!t)try{t=n.call(e)===r}catch(e){}})),t}(e)}})),o.register("5phiD",(function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}})),o.register("j1UVA",(function(e,t){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}})),o.register("5Z2ZN",(function(e,t){var n=o("gZ5lU"),r=T,i=o("5sKS0"),a=o("7hdOB"),s=o("6rVgi"),u=Object.prototype.hasOwnProperty,c="start end gt gte lt lte".split(" ");function l(e){this.status="new",this.supports=n(e,{status:!0})}function f(e,t){var n={};for(var r in t)if(u.call(t,r)){var i=t[r];h(r)&&(i=e._serializeKey(i)),n[r]=i}return n}function h(e){return-1!==c.indexOf(e)}l.prototype.open=function(e,t){var n=this,r=this.status;if("function"==typeof e&&(t=e),"function"!=typeof t)throw new Error("open() requires a callback argument");"object"==typeof e&&null!==e||(e={}),e.createIfMissing=!1!==e.createIfMissing,e.errorIfExists=!!e.errorIfExists,this.status="opening",this._open(e,(function(e){if(e)return n.status=r,t(e);n.status="open",t()}))},l.prototype._open=function(e,t){s(t)},l.prototype.close=function(e){var t=this,n=this.status;if("function"!=typeof e)throw new Error("close() requires a callback argument");this.status="closing",this._close((function(r){if(r)return t.status=n,e(r);t.status="closed",e()}))},l.prototype._close=function(e){s(e)},l.prototype.get=function(e,t,n){if("function"==typeof t&&(n=t),"function"!=typeof n)throw new Error("get() requires a callback argument");var r=this._checkKey(e);if(r)return s(n,r);e=this._serializeKey(e),"object"==typeof t&&null!==t||(t={}),t.asBuffer=!1!==t.asBuffer,this._get(e,t,n)},l.prototype._get=function(e,t,n){s((function(){n(new Error("NotFound"))}))},l.prototype.put=function(e,t,n,r){if("function"==typeof n&&(r=n),"function"!=typeof r)throw new Error("put() requires a callback argument");var i=this._checkKey(e)||this._checkValue(t);if(i)return s(r,i);e=this._serializeKey(e),t=this._serializeValue(t),"object"==typeof n&&null!==n||(n={}),this._put(e,t,n,r)},l.prototype._put=function(e,t,n,r){s(r)},l.prototype.del=function(e,t,n){if("function"==typeof t&&(n=t),"function"!=typeof n)throw new Error("del() requires a callback argument");var r=this._checkKey(e);if(r)return s(n,r);e=this._serializeKey(e),"object"==typeof t&&null!==t||(t={}),this._del(e,t,n)},l.prototype._del=function(e,t,n){s(n)},l.prototype.batch=function(e,t,n){if(!arguments.length)return this._chainedBatch();if("function"==typeof t&&(n=t),"function"==typeof e&&(n=e),"function"!=typeof n)throw new Error("batch(array) requires a callback argument");if(!Array.isArray(e))return s(n,new Error("batch(array) requires an array argument"));if(0===e.length)return s(n);"object"==typeof t&&null!==t||(t={});for(var r=new Array(e.length),i=0;i<e.length;i++){if("object"!=typeof e[i]||null===e[i])return s(n,new Error("batch(array) element must be an object and not `null`"));var o=S(e[i]);if("put"!==o.type&&"del"!==o.type)return s(n,new Error("`type` must be 'put' or 'del'"));var a=this._checkKey(o.key);if(a)return s(n,a);if(o.key=this._serializeKey(o.key),"put"===o.type){var u=this._checkValue(o.value);if(u)return s(n,u);o.value=this._serializeValue(o.value)}r[i]=o}this._batch(r,t,n)},l.prototype._batch=function(e,t,n){s(n)},l.prototype.clear=function(e,t){if("function"==typeof e)t=e;else if("function"!=typeof t)throw new Error("clear() requires a callback argument");(e=f(this,e)).reverse=!!e.reverse,e.limit="limit"in e?e.limit:-1,this._clear(e,t)},l.prototype._clear=function(e,t){e.keys=!0,e.values=!1,e.keyAsBuffer=!0,e.valueAsBuffer=!0;var n=this._iterator(e),r={},i=this,o=function(e){if(e)return n.end((function(){t(e)}));n.next((function(e,a){return e?o(e):void 0===a?n.end(t):void i._del(a,r,o)}))};o()},l.prototype._setupIteratorOptions=function(e){return(e=f(this,e)).reverse=!!e.reverse,e.keys=!1!==e.keys,e.values=!1!==e.values,e.limit="limit"in e?e.limit:-1,e.keyAsBuffer=!1!==e.keyAsBuffer,e.valueAsBuffer=!1!==e.valueAsBuffer,e},l.prototype.iterator=function(e){return"object"==typeof e&&null!==e||(e={}),e=this._setupIteratorOptions(e),this._iterator(e)},l.prototype._iterator=function(e){return new i(this)},l.prototype._chainedBatch=function(){return new a(this)},l.prototype._serializeKey=function(e){return e},l.prototype._serializeValue=function(e){return e},l.prototype._checkKey=function(e){return null==e?new Error("key cannot be `null` or `undefined`"):r.isBuffer(e)&&0===e.length?new Error("key cannot be an empty Buffer"):""===e?new Error("key cannot be an empty String"):Array.isArray(e)&&0===e.length?new Error("key cannot be an empty Array"):void 0},l.prototype._checkValue=function(e){if(null==e)return new Error("value cannot be `null` or `undefined`")},l.prototype._nextTick=s,e.exports=l}));var S={};S=function(){for(var e={},t=0;t<arguments.length;t++){var n=arguments[t];for(var r in n)x.call(n,r)&&(e[r]=n[r])}return e};var x=Object.prototype.hasOwnProperty;o.register("gZ5lU",(function(e,t){var n=o("hLhYh");e.exports=function(){var e=S.apply(null,arguments);return n(e,{bufferKeys:e.bufferKeys||!1,snapshots:e.snapshots||!1,permanence:e.permanence||!1,seek:e.seek||!1,clear:e.clear||!1,status:e.status||!1,createIfMissing:e.createIfMissing||!1,errorIfExists:e.errorIfExists||!1,deferredOpen:e.deferredOpen||!1,openCallback:e.openCallback||!1,promises:e.promises||!1,streams:e.streams||!1,encodings:e.encodings||!1,additionalMethods:S(e.additionalMethods)})}})),o.register("hLhYh",(function(e,t){e.exports=function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var i in r)n.call(r,i)&&(e[i]=r[i])}return e};var n=Object.prototype.hasOwnProperty}));var T,M,A,R,I,P,N={};e(N,"Buffer",(()=>T),(e=>T=e)),e(N,"SlowBuffer",(()=>M),(e=>M=e)),e(N,"INSPECT_MAX_BYTES",(()=>A),(e=>A=e)),e(N,"kMaxLength",(()=>R),(e=>R=e)),I=function(e){var t,n,r=U(e),i=r[0],o=r[1],a=new D(function(e,t,n){return 3*(t+n)/4-n}(0,i,o)),s=0,u=o>0?i-4:i;for(n=0;n<u;n+=4)t=B[e.charCodeAt(n)]<<18|B[e.charCodeAt(n+1)]<<12|B[e.charCodeAt(n+2)]<<6|B[e.charCodeAt(n+3)],a[s++]=t>>16&255,a[s++]=t>>8&255,a[s++]=255&t;2===o&&(t=B[e.charCodeAt(n)]<<2|B[e.charCodeAt(n+1)]>>4,a[s++]=255&t);1===o&&(t=B[e.charCodeAt(n)]<<10|B[e.charCodeAt(n+1)]<<4|B[e.charCodeAt(n+2)]>>2,a[s++]=t>>8&255,a[s++]=255&t);return a},P=function(e){for(var t,n=e.length,r=n%3,i=[],o=16383,a=0,s=n-r;a<s;a+=o)i.push(F(e,a,a+o>s?s:a+o));1===r?(t=e[n-1],i.push(k[t>>2]+k[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(k[t>>10]+k[t>>4&63]+k[t<<2&63]+"="));return i.join("")}
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */;for(var O,C,k=[],B=[],D="undefined"!=typeof Uint8Array?Uint8Array:Array,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",L=0,q=j.length;L<q;++L)k[L]=j[L],B[j.charCodeAt(L)]=L;function U(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function F(e,t,n){for(var r,i,o=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(k[(i=r)>>18&63]+k[i>>12&63]+k[i>>6&63]+k[63&i]);return o.join("")}B["-".charCodeAt(0)]=62,B["_".charCodeAt(0)]=63,O=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,f=n?i-1:0,h=n?-1:1,d=e[t+f];for(f+=h,o=d&(1<<-l)-1,d>>=-l,l+=s;l>0;o=256*o+e[t+f],f+=h,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(d?-1:1);a+=Math.pow(2,r),o-=c}return(d?-1:1)*a*Math.pow(2,o-r)},C=function(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+f>=1?h/u:h*Math.pow(2,1-f))*u>=2&&(a++,u/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(t*u-1)*Math.pow(2,i),a+=f):(s=t*Math.pow(2,f-1)*Math.pow(2,i),a=0));i>=8;e[n+d]=255&s,d+=p,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+d]=255&a,d+=p,a/=256,c-=8);e[n+d-p]|=128*m};var K="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;T=z,M=function(e){+e!=e&&(e=0);return z.alloc(+e)},A=50;function V(e){if(e>2147483647)throw new RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,z.prototype),t}function z(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return G(e)}return W(e,t,n)}function W(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!z.isEncoding(t))throw new TypeError("Unknown encoding: "+t);var n=0|$(e,t),r=V(n),i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(Ee(e,Uint8Array)){var t=new Uint8Array(e);return J(t.buffer,t.byteOffset,t.byteLength)}return Q(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(Ee(e,ArrayBuffer)||e&&Ee(e.buffer,ArrayBuffer))return J(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(Ee(e,SharedArrayBuffer)||e&&Ee(e.buffer,SharedArrayBuffer)))return J(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');var r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return z.from(r,t,n);var i=function(e){if(z.isBuffer(e)){var t=0|Z(e.length),n=V(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||Se(e.length)?V(0):Q(e);if("Buffer"===e.type&&Array.isArray(e.data))return Q(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return z.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function H(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function G(e){return H(e),V(e<0?0:0|Z(e))}function Q(e){for(var t=e.length<0?0:0|Z(e.length),n=V(t),r=0;r<t;r+=1)n[r]=255&e[r];return n}function J(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');var r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,z.prototype),r}function Z(e){if(e>=2147483647)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+2147483647..toString(16)+" bytes");return 0|e}function $(e,t){if(z.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||Ee(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;for(var i=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return ve(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return we(e).length;default:if(i)return r?-1:ve(e).length;t=(""+t).toLowerCase(),i=!0}}function Y(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return fe(this,t,n);case"utf8":case"utf-8":return ue(this,t,n);case"ascii":return ce(this,t,n);case"latin1":case"binary":return le(this,t,n);case"base64":return se(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return he(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function X(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function ee(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Se(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=z.from(t,r)),z.isBuffer(t))return 0===t.length?-1:te(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):te(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function te(e,t,n,r,i){var o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var f=!0,h=0;h<u;h++)if(c(e,o+h)!==c(t,h)){f=!1;break}if(f)return o}return-1}function ne(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(Se(s))return a;e[n+a]=s}return a}function re(e,t,n,r){return _e(ve(t,e.length-n),e,n,r)}function ie(e,t,n,r){return _e(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function oe(e,t,n,r){return _e(we(t),e,n,r)}function ae(e,t,n,r){return _e(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)r=(n=e.charCodeAt(a))>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function se(e,t,n){return 0===t&&n===e.length?P(e):P(e.slice(t,n))}function ue(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,u,c=e[i],l=null,f=c>239?4:c>223?3:c>191?2:1;if(i+f<=n)switch(f){case 1:c<128&&(l=c);break;case 2:128==(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128==(192&o)&&128==(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128==(192&o)&&128==(192&a)&&128==(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=f}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}R=2147483647,z.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),z.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(z.prototype,"parent",{enumerable:!0,get:function(){if(z.isBuffer(this))return this.buffer}}),Object.defineProperty(z.prototype,"offset",{enumerable:!0,get:function(){if(z.isBuffer(this))return this.byteOffset}}),z.poolSize=8192,z.from=function(e,t,n){return W(e,t,n)},Object.setPrototypeOf(z.prototype,Uint8Array.prototype),Object.setPrototypeOf(z,Uint8Array),z.alloc=function(e,t,n){return function(e,t,n){return H(e),e<=0?V(e):void 0!==t?"string"==typeof n?V(e).fill(t,n):V(e).fill(t):V(e)}(e,t,n)},z.allocUnsafe=function(e){return G(e)},z.allocUnsafeSlow=function(e){return G(e)},z.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==z.prototype},z.compare=function(e,t){if(Ee(e,Uint8Array)&&(e=z.from(e,e.offset,e.byteLength)),Ee(t,Uint8Array)&&(t=z.from(t,t.offset,t.byteLength)),!z.isBuffer(e)||!z.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},z.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},z.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return z.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=z.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var o=e[n];if(Ee(o,Uint8Array))i+o.length>r.length?z.from(o).copy(r,i):Uint8Array.prototype.set.call(r,o,i);else{if(!z.isBuffer(o))throw new TypeError('"list" argument must be an Array of Buffers');o.copy(r,i)}i+=o.length}return r},z.byteLength=$,z.prototype._isBuffer=!0,z.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)X(this,t,t+1);return this},z.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)X(this,t,t+3),X(this,t+1,t+2);return this},z.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)X(this,t,t+7),X(this,t+1,t+6),X(this,t+2,t+5),X(this,t+3,t+4);return this},z.prototype.toString=function(){var e=this.length;return 0===e?"":0===arguments.length?ue(this,0,e):Y.apply(this,arguments)},z.prototype.toLocaleString=z.prototype.toString,z.prototype.equals=function(e){if(!z.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===z.compare(this,e)},z.prototype.inspect=function(){var e="",t=A;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},K&&(z.prototype[K]=z.prototype.inspect),z.prototype.compare=function(e,t,n,r,i){if(Ee(e,Uint8Array)&&(e=z.from(e,e.offset,e.byteLength)),!z.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),u=this.slice(r,i),c=e.slice(t,n),l=0;l<s;++l)if(u[l]!==c[l]){o=u[l],a=c[l];break}return o<a?-1:a<o?1:0},z.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},z.prototype.indexOf=function(e,t,n){return ee(this,e,t,n,!0)},z.prototype.lastIndexOf=function(e,t,n){return ee(this,e,t,n,!1)},z.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return ne(this,e,t,n);case"utf8":case"utf-8":return re(this,e,t,n);case"ascii":case"latin1":case"binary":return ie(this,e,t,n);case"base64":return oe(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ae(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},z.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function ce(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function le(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function fe(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=xe[e[o]];return i}function he(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length-1;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function de(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function pe(e,t,n,r,i,o){if(!z.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function me(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function ye(e,t,n,r,i){return t=+t,n>>>=0,i||me(e,0,n,4),C(e,t,n,r,23,4),n+4}function ge(e,t,n,r,i){return t=+t,n>>>=0,i||me(e,0,n,8),C(e,t,n,r,52,8),n+8}z.prototype.slice=function(e,t){var n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);var r=this.subarray(e,t);return Object.setPrototypeOf(r,z.prototype),r},z.prototype.readUintLE=z.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||de(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},z.prototype.readUintBE=z.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||de(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},z.prototype.readUint8=z.prototype.readUInt8=function(e,t){return e>>>=0,t||de(e,1,this.length),this[e]},z.prototype.readUint16LE=z.prototype.readUInt16LE=function(e,t){return e>>>=0,t||de(e,2,this.length),this[e]|this[e+1]<<8},z.prototype.readUint16BE=z.prototype.readUInt16BE=function(e,t){return e>>>=0,t||de(e,2,this.length),this[e]<<8|this[e+1]},z.prototype.readUint32LE=z.prototype.readUInt32LE=function(e,t){return e>>>=0,t||de(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},z.prototype.readUint32BE=z.prototype.readUInt32BE=function(e,t){return e>>>=0,t||de(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},z.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||de(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},z.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||de(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},z.prototype.readInt8=function(e,t){return e>>>=0,t||de(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},z.prototype.readInt16LE=function(e,t){e>>>=0,t||de(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},z.prototype.readInt16BE=function(e,t){e>>>=0,t||de(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},z.prototype.readInt32LE=function(e,t){return e>>>=0,t||de(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},z.prototype.readInt32BE=function(e,t){return e>>>=0,t||de(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},z.prototype.readFloatLE=function(e,t){return e>>>=0,t||de(e,4,this.length),O(this,e,!0,23,4)},z.prototype.readFloatBE=function(e,t){return e>>>=0,t||de(e,4,this.length),O(this,e,!1,23,4)},z.prototype.readDoubleLE=function(e,t){return e>>>=0,t||de(e,8,this.length),O(this,e,!0,52,8)},z.prototype.readDoubleBE=function(e,t){return e>>>=0,t||de(e,8,this.length),O(this,e,!1,52,8)},z.prototype.writeUintLE=z.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||pe(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},z.prototype.writeUintBE=z.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t>>>=0,n>>>=0,r)||pe(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},z.prototype.writeUint8=z.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,1,255,0),this[t]=255&e,t+1},z.prototype.writeUint16LE=z.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},z.prototype.writeUint16BE=z.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},z.prototype.writeUint32LE=z.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},z.prototype.writeUint32BE=z.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},z.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);pe(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},z.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){var i=Math.pow(2,8*n-1);pe(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},z.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},z.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},z.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},z.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},z.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||pe(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},z.prototype.writeFloatLE=function(e,t,n){return ye(this,e,t,!0,n)},z.prototype.writeFloatBE=function(e,t,n){return ye(this,e,t,!1,n)},z.prototype.writeDoubleLE=function(e,t,n){return ge(this,e,t,!0,n)},z.prototype.writeDoubleBE=function(e,t,n){return ge(this,e,t,!1,n)},z.prototype.copy=function(e,t,n,r){if(!z.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},z.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!z.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){var i=e.charCodeAt(0);("utf8"===r&&i<128||"latin1"===r)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=z.isBuffer(e)?e:z.from(e,r),s=a.length;if(0===s)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var be=/[^+/0-9A-Za-z-_]/g;function ve(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function we(e){return I(function(e){if((e=(e=e.split("=")[0]).trim().replace(be,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function _e(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function Ee(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Se(e){return e!=e}var xe=function(){for(var e="0123456789abcdef",t=new Array(256),n=0;n<16;++n)for(var r=16*n,i=0;i<16;++i)t[r+i]=e[n]+e[i];return t}();o.register("5sKS0",(function(e,t){var n=o("6rVgi");function r(e){if("object"!=typeof e||null===e)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=e,this._ended=!1,this._nexting=!1}r.prototype.next=function(e){var t=this;if("function"!=typeof e)throw new Error("next() requires a callback argument");return t._ended?(n(e,new Error("cannot call next() after end()")),t):t._nexting?(n(e,new Error("cannot call next() before previous next() has completed")),t):(t._nexting=!0,t._next((function(){t._nexting=!1,e.apply(null,arguments)})),t)},r.prototype._next=function(e){n(e)},r.prototype.seek=function(e){if(this._ended)throw new Error("cannot call seek() after end()");if(this._nexting)throw new Error("cannot call seek() before next() has completed");e=this.db._serializeKey(e),this._seek(e)},r.prototype._seek=function(e){},r.prototype.end=function(e){if("function"!=typeof e)throw new Error("end() requires a callback argument");if(this._ended)return n(e,new Error("end() already called on iterator"));this._ended=!0,this._end(e)},r.prototype._end=function(e){n(e)},r.prototype._nextTick=n,e.exports=r})),o.register("6rVgi",(function(e,t){e.exports=o("d2gHK")})),o.register("d2gHK",(function(e,t){var n,r,i,a=[o("kOtop"),o("8mjH6"),o("4ZH0Y"),o("hfOQH"),o("hnJVw"),o("bnHtu")],s=-1,u=[],c=!1;function l(){n&&r&&(n=!1,r.length?u=r.concat(u):s=-1,u.length&&f())}function f(){if(!n){c=!1,n=!0;for(var e=u.length,t=setTimeout(l);e;){for(r=u,u=[];r&&++s<e;)r[s].run();s=-1,e=u.length}r=null,s=-1,n=!1,clearTimeout(t)}}for(var h=-1,d=a.length;++h<d;)if(a[h]&&a[h].test&&a[h].test()){i=a[h].install(f);break}function p(e,t){this.fun=e,this.array=t}p.prototype.run=function(){var e=this.fun,t=this.array;switch(t.length){case 0:return e();case 1:return e(t[0]);case 2:return e(t[0],t[1]);case 3:return e(t[0],t[1],t[2]);default:return e.apply(null,t)}},e.exports=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),c||n||(c=!0,i())}})),o.register("8mjH6",(function(n,r){var i,o;e(n.exports,"test",(()=>i),(e=>i=e)),e(n.exports,"install",(()=>o),(e=>o=e)),i=function(){return"function"==typeof t.queueMicrotask},o=function(e){return function(){t.queueMicrotask(e)}}})),o.register("4ZH0Y",(function(n,r){var i,o;e(n.exports,"test",(()=>i),(e=>i=e)),e(n.exports,"install",(()=>o),(e=>o=e));var a=t.MutationObserver||t.WebKitMutationObserver;i=function(){return a},o=function(e){var n=0,r=new a(e),i=t.document.createTextNode("");return r.observe(i,{characterData:!0}),function(){i.data=n=++n%2}}})),o.register("hfOQH",(function(n,r){var i,o;e(n.exports,"test",(()=>i),(e=>i=e)),e(n.exports,"install",(()=>o),(e=>o=e)),i=function(){return!t.setImmediate&&void 0!==t.MessageChannel},o=function(e){var n=new t.MessageChannel;return n.port1.onmessage=e,function(){n.port2.postMessage(0)}}})),o.register("hnJVw",(function(n,r){var i,o;e(n.exports,"test",(()=>i),(e=>i=e)),e(n.exports,"install",(()=>o),(e=>o=e)),i=function(){return"document"in t&&"onreadystatechange"in t.document.createElement("script")},o=function(e){return function(){var n=t.document.createElement("script");return n.onreadystatechange=function(){e(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},t.document.documentElement.appendChild(n),e}}})),o.register("bnHtu",(function(t,n){var r,i;e(t.exports,"test",(()=>r),(e=>r=e)),e(t.exports,"install",(()=>i),(e=>i=e)),r=function(){return!0},i=function(e){return function(){setTimeout(e,0)}}})),o.register("7hdOB",(function(e,t){var n=o("6rVgi");function r(e){if("object"!=typeof e||null===e)throw new TypeError("First argument must be an abstract-leveldown compliant store");this.db=e,this._operations=[],this._written=!1}r.prototype._checkWritten=function(){if(this._written)throw new Error("write() already called on this batch")},r.prototype.put=function(e,t){this._checkWritten();var n=this.db._checkKey(e)||this.db._checkValue(t);if(n)throw n;return e=this.db._serializeKey(e),t=this.db._serializeValue(t),this._put(e,t),this},r.prototype._put=function(e,t){this._operations.push({type:"put",key:e,value:t})},r.prototype.del=function(e){this._checkWritten();var t=this.db._checkKey(e);if(t)throw t;return e=this.db._serializeKey(e),this._del(e),this},r.prototype._del=function(e){this._operations.push({type:"del",key:e})},r.prototype.clear=function(){return this._checkWritten(),this._clear(),this},r.prototype._clear=function(){this._operations=[]},r.prototype.write=function(e,t){if(this._checkWritten(),"function"==typeof e&&(t=e),"function"!=typeof t)throw new Error("write() requires a callback argument");"object"==typeof e&&null!==e||(e={}),this._written=!0,this._write(e,t)},r.prototype._write=function(e,t){this.db._batch(this._operations,e,t)},r.prototype._nextTick=n,e.exports=r})),o.register("kU4py",(function(e,t){(t=e.exports=o("dRHVx")).Stream=t,t.Readable=t,t.Writable=o("3A1hy"),t.Duplex=o("j4dRk"),t.Transform=o("hVtUc"),t.PassThrough=o("jO524"),t.finished=o("korvP"),t.pipeline=o("6LNcL")})),o.register("dRHVx",(function(e,n){var r,i=o("iThRa");e.exports=A,A.ReadableState=M;o("3KgUz").EventEmitter;var a=function(e,t){return e.listeners(t).length},s=o("5bQpE"),u=T,c=t.Uint8Array||function(){};var l,f=o("kOtop");l=f&&f.debuglog?f.debuglog("stream"):function(){};var h,d,p,m=o("itmGj"),y=o("88DEk"),g=o("3NQlq").getHighWaterMark,b=o("hLSLD").codes,v=b.ERR_INVALID_ARG_TYPE,w=b.ERR_STREAM_PUSH_AFTER_EOF,_=b.ERR_METHOD_NOT_IMPLEMENTED,E=b.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;o("j1UVA")(A,s);var S=y.errorOrDestroy,x=["error","close","destroy","pause","resume"];function M(e,t,n){r=r||o("j4dRk"),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.highWaterMark=g(this,e,"readableHighWaterMark",n),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(h||(h=o("10gHr").StringDecoder),this.decoder=new h(e.encoding),this.encoding=e.encoding)}function A(e){if(r=r||o("j4dRk"),!(this instanceof A))return new A(e);var t=this instanceof r;this._readableState=new M(e,this,t),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),s.call(this)}function R(e,t,n,r,i){l("readableAddChunk",t);var o,a=e._readableState;if(null===t)a.reading=!1,function(e,t){if(l("onEofChunk"),t.ended)return;if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,t.sync?O(e):(t.needReadable=!1,t.emittedReadable||(t.emittedReadable=!0,C(e)))}(e,a);else if(i||(o=function(e,t){var n;r=t,u.isBuffer(r)||r instanceof c||"string"==typeof t||void 0===t||e.objectMode||(n=new v("chunk",["string","Buffer","Uint8Array"],t));var r;return n}(a,t)),o)S(e,o);else if(a.objectMode||t&&t.length>0)if("string"==typeof t||a.objectMode||Object.getPrototypeOf(t)===u.prototype||(t=function(e){return u.from(e)}(t)),r)a.endEmitted?S(e,new E):I(e,a,t,!0);else if(a.ended)S(e,new w);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!n?(t=a.decoder.write(t),a.objectMode||0!==t.length?I(e,a,t,!1):k(e,a)):I(e,a,t,!1)}else r||(a.reading=!1,k(e,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function I(e,t,n,r){t.flowing&&0===t.length&&!t.sync?(t.awaitDrain=0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&O(e)),k(e,t)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),A.prototype.destroy=y.destroy,A.prototype._undestroy=y.undestroy,A.prototype._destroy=function(e,t){t(e)},A.prototype.push=function(e,t){var n,r=this._readableState;return r.objectMode?n=!0:"string"==typeof e&&((t=t||r.defaultEncoding)!==r.encoding&&(e=u.from(e,t),t=""),n=!0),R(this,e,t,!1,n)},A.prototype.unshift=function(e){return R(this,e,null,!0,!1)},A.prototype.isPaused=function(){return!1===this._readableState.flowing},A.prototype.setEncoding=function(e){h||(h=o("10gHr").StringDecoder);var t=new h(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;for(var n=this._readableState.buffer.head,r="";null!==n;)r+=t.write(n.data),n=n.next;return this._readableState.buffer.clear(),""!==r&&this._readableState.buffer.push(r),this._readableState.length=r.length,this};var P=1073741824;function N(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=function(e){return e>=P?e=P:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function O(e){var t=e._readableState;l("emitReadable",t.needReadable,t.emittedReadable),t.needReadable=!1,t.emittedReadable||(l("emitReadable",t.flowing),t.emittedReadable=!0,i.nextTick(C,e))}function C(e){var t=e._readableState;l("emitReadable_",t.destroyed,t.length,t.ended),t.destroyed||!t.length&&!t.ended||(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,q(e)}function k(e,t){t.readingMore||(t.readingMore=!0,i.nextTick(B,e,t))}function B(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){var n=t.length;if(l("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function D(e){var t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!t.paused?t.flowing=!0:e.listenerCount("data")>0&&e.resume()}function j(e){l("readable nexttick read 0"),e.read(0)}function L(e,t){l("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),q(e),t.flowing&&!t.reading&&e.read(0)}function q(e){var t=e._readableState;for(l("flow",t.flowing);t.flowing&&null!==e.read(););}function U(e,t){return 0===t.length?null:(t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n);var n}function F(e){var t=e._readableState;l("endReadable",t.endEmitted),t.endEmitted||(t.ended=!0,i.nextTick(K,t,e))}function K(e,t){if(l("endReadableNT",e.endEmitted,e.length),!e.endEmitted&&0===e.length&&(e.endEmitted=!0,t.readable=!1,t.emit("end"),e.autoDestroy)){var n=t._writableState;(!n||n.autoDestroy&&n.finished)&&t.destroy()}}function V(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1}A.prototype.read=function(e){l("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return l("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?F(this):O(this),null;if(0===(e=N(e,t))&&t.ended)return 0===t.length&&F(this),null;var r,i=t.needReadable;return l("need readable",i),(0===t.length||t.length-e<t.highWaterMark)&&l("length less than watermark",i=!0),t.ended||t.reading?l("reading or ended",i=!1):i&&(l("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=N(n,t))),null===(r=e>0?U(e,t):null)?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.awaitDrain=0),0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&F(this)),null!==r&&this.emit("data",r),r},A.prototype._read=function(e){S(this,new _("_read()"))},A.prototype.pipe=function(e,t){var n=this,r=this._readableState;switch(r.pipesCount){case 0:r.pipes=e;break;case 1:r.pipes=[r.pipes,e];break;default:r.pipes.push(e)}r.pipesCount+=1,l("pipe count=%d opts=%j",r.pipesCount,t);var o=(!t||!1!==t.end)&&e!==i.stdout&&e!==i.stderr?u:y;function s(t,i){l("onunpipe"),t===n&&i&&!1===i.hasUnpiped&&(i.hasUnpiped=!0,l("cleanup"),e.removeListener("close",p),e.removeListener("finish",m),e.removeListener("drain",c),e.removeListener("error",d),e.removeListener("unpipe",s),n.removeListener("end",u),n.removeListener("end",y),n.removeListener("data",h),f=!0,!r.awaitDrain||e._writableState&&!e._writableState.needDrain||c())}function u(){l("onend"),e.end()}r.endEmitted?i.nextTick(o):n.once("end",o),e.on("unpipe",s);var c=function(e){return function(){var t=e._readableState;l("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&a(e,"data")&&(t.flowing=!0,q(e))}}(n);e.on("drain",c);var f=!1;function h(t){l("ondata");var i=e.write(t);l("dest.write",i),!1===i&&((1===r.pipesCount&&r.pipes===e||r.pipesCount>1&&-1!==V(r.pipes,e))&&!f&&(l("false write response, pause",r.awaitDrain),r.awaitDrain++),n.pause())}function d(t){l("onerror",t),y(),e.removeListener("error",d),0===a(e,"error")&&S(e,t)}function p(){e.removeListener("finish",m),y()}function m(){l("onfinish"),e.removeListener("close",p),y()}function y(){l("unpipe"),n.unpipe(e)}return n.on("data",h),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",d),e.once("close",p),e.once("finish",m),e.emit("pipe",n),r.flowing||(l("pipe resume"),n.resume()),e},A.prototype.unpipe=function(e){var t=this._readableState,n={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,n)),this;if(!e){var r=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)r[o].emit("unpipe",this,{hasUnpiped:!1});return this}var a=V(t.pipes,e);return-1===a||(t.pipes.splice(a,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,n)),this},A.prototype.on=function(e,t){var n=s.prototype.on.call(this,e,t),r=this._readableState;return"data"===e?(r.readableListening=this.listenerCount("readable")>0,!1!==r.flowing&&this.resume()):"readable"===e&&(r.endEmitted||r.readableListening||(r.readableListening=r.needReadable=!0,r.flowing=!1,r.emittedReadable=!1,l("on readable",r.length,r.reading),r.length?O(this):r.reading||i.nextTick(j,this))),n},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(e,t){var n=s.prototype.removeListener.call(this,e,t);return"readable"===e&&i.nextTick(D,this),n},A.prototype.removeAllListeners=function(e){var t=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==e&&void 0!==e||i.nextTick(D,this),t},A.prototype.resume=function(){var e=this._readableState;return e.flowing||(l("resume"),e.flowing=!e.readableListening,function(e,t){t.resumeScheduled||(t.resumeScheduled=!0,i.nextTick(L,e,t))}(this,e)),e.paused=!1,this},A.prototype.pause=function(){return l("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(l("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},A.prototype.wrap=function(e){var t=this,n=this._readableState,r=!1;for(var i in e.on("end",(function(){if(l("wrapped end"),n.decoder&&!n.ended){var e=n.decoder.end();e&&e.length&&t.push(e)}t.push(null)})),e.on("data",(function(i){(l("wrapped data"),n.decoder&&(i=n.decoder.write(i)),n.objectMode&&null==i)||(n.objectMode||i&&i.length)&&(t.push(i)||(r=!0,e.pause()))})),e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<x.length;o++)e.on(x[o],this.emit.bind(this,x[o]));return this._read=function(t){l("wrapped _read",t),r&&(r=!1,e.resume())},this},"function"==typeof Symbol&&(A.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=o("cnd42")),d(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}}),A._fromList=U,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"==typeof Symbol&&(A.from=function(e,t){return void 0===p&&(p=o("e25jM")),p(A,e,t)})})),o.register("5bQpE",(function(e,t){e.exports=o("3KgUz").EventEmitter})),o.register("itmGj",(function(e,t){function n(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var a=T,s=o("kOtop").inspect,u=s&&s.custom||"inspect";e.exports=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.head=null,this.tail=null,this.length=0}var t,o,c;return t=e,o=[{key:"push",value:function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}},{key:"unshift",value:function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}},{key:"shift",value:function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n}},{key:"concat",value:function(e){if(0===this.length)return a.alloc(0);for(var t,n,r,i=a.allocUnsafe(e>>>0),o=this.head,s=0;o;)t=o.data,n=i,r=s,a.prototype.copy.call(t,n,r),s+=o.data.length,o=o.next;return i}},{key:"consume",value:function(e,t){var n;return e<this.head.data.length?(n=this.head.data.slice(0,e),this.head.data=this.head.data.slice(e)):n=e===this.head.data.length?this.shift():t?this._getString(e):this._getBuffer(e),n}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(e){var t=this.head,n=1,r=t.data;for(e-=r.length;t=t.next;){var i=t.data,o=e>i.length?i.length:e;if(o===i.length?r+=i:r+=i.slice(0,e),0==(e-=o)){o===i.length?(++n,t.next?this.head=t.next:this.head=this.tail=null):(this.head=t,t.data=i.slice(o));break}++n}return this.length-=n,r}},{key:"_getBuffer",value:function(e){var t=a.allocUnsafe(e),n=this.head,r=1;for(n.data.copy(t),e-=n.data.length;n=n.next;){var i=n.data,o=e>i.length?i.length:e;if(i.copy(t,t.length-e,0,o),0==(e-=o)){o===i.length?(++r,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=i.slice(o));break}++r}return this.length-=r,t}},{key:u,value:function(e,t){return s(this,function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?n(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):n(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}({},t,{depth:0,customInspect:!1}))}}],o&&i(t.prototype,o),c&&i(t,c),e}()})),o.register("88DEk",(function(e,t){var n=o("iThRa");function r(e,t){a(e,t),i(e)}function i(e){e._writableState&&!e._writableState.emitClose||e._readableState&&!e._readableState.emitClose||e.emit("close")}function a(e,t){e.emit("error",t)}e.exports={destroy:function(e,t){var o=this,s=this._readableState&&this._readableState.destroyed,u=this._writableState&&this._writableState.destroyed;return s||u?(t?t(e):e&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,n.nextTick(a,this,e)):n.nextTick(a,this,e)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,(function(e){!t&&e?o._writableState?o._writableState.errorEmitted?n.nextTick(i,o):(o._writableState.errorEmitted=!0,n.nextTick(r,o,e)):n.nextTick(r,o,e):t?(n.nextTick(i,o),t(e)):n.nextTick(i,o)})),this)},undestroy:function(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)},errorOrDestroy:function(e,t){var n=e._readableState,r=e._writableState;n&&n.autoDestroy||r&&r.autoDestroy?e.destroy(t):e.emit("error",t)}}})),o.register("3NQlq",(function(e,t){var n=o("hLSLD").codes.ERR_INVALID_OPT_VALUE;e.exports={getHighWaterMark:function(e,t,r,i){var o=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(t,i,r);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0)throw new n(i?r:"highWaterMark",o);return Math.floor(o)}return e.objectMode?16:16384}}})),o.register("hLSLD",(function(t,n){var r;e(t.exports,"codes",(()=>r),(e=>r=e));var i={};function o(e,t,n){n||(n=Error);var r=function(e){var n,r;function i(n,r,i){return e.call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,r,i))||this}return r=e,(n=i).prototype=Object.create(r.prototype),n.prototype.constructor=n,n.__proto__=r,i}(n);r.prototype.name=n.name,r.prototype.code=e,i[e]=r}function a(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}o("ERR_INVALID_OPT_VALUE",(function(e,t){return'The value "'+t+'" is invalid for option "'+e+'"'}),TypeError),o("ERR_INVALID_ARG_TYPE",(function(e,t,n){var r,i,o,s;if("string"==typeof t&&(i="not ",t.substr(!o||o<0?0:+o,i.length)===i)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))s="The ".concat(e," ").concat(r," ").concat(a(t,"type"));else{var u=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";s='The "'.concat(e,'" ').concat(u," ").concat(r," ").concat(a(t,"type"))}return s+=". Received type ".concat(typeof n)}),TypeError),o("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),o("ERR_METHOD_NOT_IMPLEMENTED",(function(e){return"The "+e+" method is not implemented"})),o("ERR_STREAM_PREMATURE_CLOSE","Premature close"),o("ERR_STREAM_DESTROYED",(function(e){return"Cannot call "+e+" after a stream was destroyed"})),o("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),o("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),o("ERR_STREAM_WRITE_AFTER_END","write after end"),o("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),o("ERR_UNKNOWN_ENCODING",(function(e){return"Unknown encoding: "+e}),TypeError),o("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),r=i})),o.register("j4dRk",(function(e,t){var n=o("iThRa"),r=Object.keys||function(e){var t=[];for(var n in e)t.push(n);return t};e.exports=l;var i=o("dRHVx"),a=o("3A1hy");o("j1UVA")(l,i);for(var s=r(a.prototype),u=0;u<s.length;u++){var c=s[u];l.prototype[c]||(l.prototype[c]=a.prototype[c])}function l(e){if(!(this instanceof l))return new l(e);i.call(this,e),a.call(this,e),this.allowHalfOpen=!0,e&&(!1===e.readable&&(this.readable=!1),!1===e.writable&&(this.writable=!1),!1===e.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",f)))}function f(){this._writableState.ended||n.nextTick(h,this)}function h(e){e.end()}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(l.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(l.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(l.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}})})),o.register("3A1hy",(function(e,n){var r,i=o("iThRa");function a(e){var t=this;this.next=null,this.entry=null,this.finish=function(){!function(e,t,n){var r=e.entry;e.entry=null;for(;r;){var i=r.callback;t.pendingcb--,i(n),r=r.next}t.corkedRequestsFree.next=e}(t,e)}}e.exports=A,A.WritableState=M;var s={deprecate:o("7n8wD")},u=o("5bQpE"),c=T,l=t.Uint8Array||function(){};var f,h=o("88DEk"),d=o("3NQlq").getHighWaterMark,p=o("hLSLD").codes,m=p.ERR_INVALID_ARG_TYPE,y=p.ERR_METHOD_NOT_IMPLEMENTED,g=p.ERR_MULTIPLE_CALLBACK,b=p.ERR_STREAM_CANNOT_PIPE,v=p.ERR_STREAM_DESTROYED,w=p.ERR_STREAM_NULL_VALUES,_=p.ERR_STREAM_WRITE_AFTER_END,E=p.ERR_UNKNOWN_ENCODING,S=h.errorOrDestroy;function x(){}function M(e,t,n){r=r||o("j4dRk"),e=e||{},"boolean"!=typeof n&&(n=t instanceof r),this.objectMode=!!e.objectMode,n&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=d(this,e,"writableHighWaterMark",n),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n=e._writableState,r=n.sync,o=n.writecb;if("function"!=typeof o)throw new g;if(function(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}(n),t)!function(e,t,n,r,o){--t.pendingcb,n?(i.nextTick(o,r),i.nextTick(C,e,t),e._writableState.errorEmitted=!0,S(e,r)):(o(r),e._writableState.errorEmitted=!0,S(e,r),C(e,t))}(e,n,r,t,o);else{var a=N(n)||e.destroyed;a||n.corked||n.bufferProcessing||!n.bufferedRequest||P(e,n),r?i.nextTick(I,e,n,a,o):I(e,n,a,o)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==e.emitClose,this.autoDestroy=!!e.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new a(this)}function A(e){var t=this instanceof(r=r||o("j4dRk"));if(!t&&!f.call(A,this))return new A(e);this._writableState=new M(e,this,t),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),u.call(this)}function R(e,t,n,r,i,o,a){t.writelen=r,t.writecb=a,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new v("write")):n?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function I(e,t,n,r){n||function(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}(e,t),t.pendingcb--,r(),C(e,t)}function P(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var r=t.bufferedRequestCount,i=new Array(r),o=t.corkedRequestsFree;o.entry=n;for(var s=0,u=!0;n;)i[s]=n,n.isBuf||(u=!1),n=n.next,s+=1;i.allBuffers=u,R(e,t,!0,t.length,i,"",o.finish),t.pendingcb++,t.lastBufferedRequest=null,o.next?(t.corkedRequestsFree=o.next,o.next=null):t.corkedRequestsFree=new a(t),t.bufferedRequestCount=0}else{for(;n;){var c=n.chunk,l=n.encoding,f=n.callback;if(R(e,t,!1,t.objectMode?1:c.length,c,l,f),n=n.next,t.bufferedRequestCount--,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequest=n,t.bufferProcessing=!1}function N(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function O(e,t){e._final((function(n){t.pendingcb--,n&&S(e,n),t.prefinished=!0,e.emit("prefinish"),C(e,t)}))}function C(e,t){var n=N(t);if(n&&(function(e,t){t.prefinished||t.finalCalled||("function"!=typeof e._final||t.destroyed?(t.prefinished=!0,e.emit("prefinish")):(t.pendingcb++,t.finalCalled=!0,i.nextTick(O,e,t)))}(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"),t.autoDestroy))){var r=e._readableState;(!r||r.autoDestroy&&r.endEmitted)&&e.destroy()}return n}o("j1UVA")(A,u),M.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(M.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}(),"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(f=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(e){return!!f.call(this,e)||this===A&&(e&&e._writableState instanceof M)}})):f=function(e){return e instanceof this},A.prototype.pipe=function(){S(this,new b)},A.prototype.write=function(e,t,n){var r,o=this._writableState,a=!1,s=!o.objectMode&&(r=e,c.isBuffer(r)||r instanceof l);return s&&!c.isBuffer(e)&&(e=function(e){return c.from(e)}(e)),"function"==typeof t&&(n=t,t=null),s?t="buffer":t||(t=o.defaultEncoding),"function"!=typeof n&&(n=x),o.ending?function(e,t){var n=new _;S(e,n),i.nextTick(t,n)}(this,n):(s||function(e,t,n,r){var o;return null===n?o=new w:"string"==typeof n||t.objectMode||(o=new m("chunk",["string","Buffer"],n)),!o||(S(e,o),i.nextTick(r,o),!1)}(this,o,e,n))&&(o.pendingcb++,a=function(e,t,n,r,i,o){if(!n){var a=function(e,t,n){e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=c.from(t,n));return t}(t,r,i);r!==a&&(n=!0,i="buffer",r=a)}var s=t.objectMode?1:r.length;t.length+=s;var u=t.length<t.highWaterMark;u||(t.needDrain=!0);if(t.writing||t.corked){var l=t.lastBufferedRequest;t.lastBufferedRequest={chunk:r,encoding:i,isBuf:n,callback:o,next:null},l?l.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else R(e,t,!1,s,r,i,o);return u}(this,o,s,e,t,n)),a},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.bufferProcessing||!e.bufferedRequest||P(this,e))},A.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new E(e);return this._writableState.defaultEncoding=e,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(e,t,n){n(new y("_write()"))},A.prototype._writev=null,A.prototype.end=function(e,t,n){var r=this._writableState;return"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||function(e,t,n){t.ending=!0,C(e,t),n&&(t.finished?i.nextTick(n):e.once("finish",n));t.ended=!0,e.writable=!1}(this,r,n),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),A.prototype.destroy=h.destroy,A.prototype._undestroy=h.undestroy,A.prototype._destroy=function(e,t){t(e)}})),o.register("7n8wD",(function(e,n){function r(e){try{if(!t.localStorage)return!1}catch(e){return!1}var n=t.localStorage[e];return null!=n&&"true"===String(n).toLowerCase()}e.exports=function(e,t){if(r("noDeprecation"))return e;var n=!1;return function(){if(!n){if(r("throwDeprecation"))throw new Error(t);r("traceDeprecation")?console.trace(t):console.warn(t),n=!0}return e.apply(this,arguments)}}})),o.register("10gHr",(function(t,n){var r;e(t.exports,"StringDecoder",(()=>r),(e=>r=e));var i=o("1EBKZ").Buffer,a=i.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(e){var t;switch(this.encoding=function(e){var t=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(e);if("string"!=typeof t&&(i.isEncoding===a||!a(e)))throw new Error("Unknown encoding: "+e);return t||e}(e),this.encoding){case"utf16le":this.text=l,this.end=f,t=4;break;case"utf8":this.fillLast=c,t=4;break;case"base64":this.text=h,this.end=d,t=3;break;default:return this.write=p,void(this.end=m)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(t)}function u(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function c(e){var t=this.lastTotal-this.lastNeed,n=function(e,t,n){if(128!=(192&t[0]))return e.lastNeed=0,"";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,""}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function f(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function h(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function d(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function p(e){return e.toString(this.encoding)}function m(e){return e&&e.length?this.write(e):""}r=s,s.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},s.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"":t},s.prototype.text=function(e,t){var n=function(e,t,n){var r=t.length-1;if(r<n)return 0;var i=u(t[r]);if(i>=0)return i>0&&(e.lastNeed=i-1),i;if(--r<n||-2===i)return 0;if((i=u(t[r]))>=0)return i>0&&(e.lastNeed=i-2),i;if(--r<n||-2===i)return 0;if((i=u(t[r]))>=0)return i>0&&(2===i?i=0:e.lastNeed=i-3),i;return 0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var r=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,r),e.toString("utf8",t,r)},s.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}})),o.register("1EBKZ",(function(e,t){var n=N.Buffer;function r(e,t){for(var n in e)t[n]=e[n]}function i(e,t,r){return n(e,t,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?e.exports=N:(r(N,e.exports),e.exports.Buffer=i),i.prototype=Object.create(n.prototype),r(n,i),i.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return n(e,t,r)},i.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=n(e);return void 0!==t?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return N.SlowBuffer(e)}})),o.register("cnd42",(function(e,t){var n,r=o("iThRa");function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=o("korvP"),s=Symbol("lastResolve"),u=Symbol("lastReject"),c=Symbol("error"),l=Symbol("ended"),f=Symbol("lastPromise"),h=Symbol("handlePromise"),d=Symbol("stream");function p(e,t){return{value:e,done:t}}function m(e){var t=e[s];if(null!==t){var n=e[d].read();null!==n&&(e[f]=null,e[s]=null,e[u]=null,t(p(n,!1)))}}function y(e){r.nextTick(m,e)}var g=Object.getPrototypeOf((function(){})),b=Object.setPrototypeOf((i(n={get stream(){return this[d]},next:function(){var e=this,t=this[c];if(null!==t)return Promise.reject(t);if(this[l])return Promise.resolve(p(void 0,!0));if(this[d].destroyed)return new Promise((function(t,n){r.nextTick((function(){e[c]?n(e[c]):t(p(void 0,!0))}))}));var n,i=this[f];if(i)n=new Promise(function(e,t){return function(n,r){e.then((function(){t[l]?n(p(void 0,!0)):t[h](n,r)}),r)}}(i,this));else{var o=this[d].read();if(null!==o)return Promise.resolve(p(o,!1));n=new Promise(this[h])}return this[f]=n,n}},Symbol.asyncIterator,(function(){return this})),i(n,"return",(function(){var e=this;return new Promise((function(t,n){e[d].destroy(null,(function(e){e?n(e):t(p(void 0,!0))}))}))})),n),g);e.exports=function(e){var t,n=Object.create(b,(i(t={},d,{value:e,writable:!0}),i(t,s,{value:null,writable:!0}),i(t,u,{value:null,writable:!0}),i(t,c,{value:null,writable:!0}),i(t,l,{value:e._readableState.endEmitted,writable:!0}),i(t,h,{value:function(e,t){var r=n[d].read();r?(n[f]=null,n[s]=null,n[u]=null,e(p(r,!1))):(n[s]=e,n[u]=t)},writable:!0}),t));return n[f]=null,a(e,(function(e){if(e&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code){var t=n[u];return null!==t&&(n[f]=null,n[s]=null,n[u]=null,t(e)),void(n[c]=e)}var r=n[s];null!==r&&(n[f]=null,n[s]=null,n[u]=null,r(p(void 0,!0))),n[l]=!0})),e.on("readable",y.bind(null,n)),n}})),o.register("korvP",(function(e,t){var n=o("hLSLD").codes.ERR_STREAM_PREMATURE_CLOSE;function r(){}e.exports=function e(t,i,o){if("function"==typeof i)return e(t,null,i);i||(i={}),o=function(e){var t=!1;return function(){if(!t){t=!0;for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];e.apply(this,r)}}}(o||r);var a=i.readable||!1!==i.readable&&t.readable,s=i.writable||!1!==i.writable&&t.writable,u=function(){t.writable||l()},c=t._writableState&&t._writableState.finished,l=function(){s=!1,c=!0,a||o.call(t)},f=t._readableState&&t._readableState.endEmitted,h=function(){a=!1,f=!0,s||o.call(t)},d=function(e){o.call(t,e)},p=function(){var e;return a&&!f?(t._readableState&&t._readableState.ended||(e=new n),o.call(t,e)):s&&!c?(t._writableState&&t._writableState.ended||(e=new n),o.call(t,e)):void 0},m=function(){t.req.on("finish",l)};return!function(e){return e.setHeader&&"function"==typeof e.abort}(t)?s&&!t._writableState&&(t.on("end",u),t.on("close",u)):(t.on("complete",l),t.on("abort",p),t.req?m():t.on("request",m)),t.on("end",h),t.on("finish",l),!1!==i.error&&t.on("error",d),t.on("close",p),function(){t.removeListener("complete",l),t.removeListener("abort",p),t.removeListener("request",m),t.req&&t.req.removeListener("finish",l),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",l),t.removeListener("end",h),t.removeListener("error",d),t.removeListener("close",p)}}})),o.register("e25jM",(function(e,t){e.exports=function(){throw new Error("Readable.from is not available in the browser")}})),o.register("hVtUc",(function(e,t){e.exports=l;var n=o("hLSLD").codes,r=n.ERR_METHOD_NOT_IMPLEMENTED,i=n.ERR_MULTIPLE_CALLBACK,a=n.ERR_TRANSFORM_ALREADY_TRANSFORMING,s=n.ERR_TRANSFORM_WITH_LENGTH_0,u=o("j4dRk");function c(e,t){var n=this._transformState;n.transforming=!1;var r=n.writecb;if(null===r)return this.emit("error",new i);n.writechunk=null,n.writecb=null,null!=t&&this.push(t),r(e);var o=this._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&this._read(o.highWaterMark)}function l(e){if(!(this instanceof l))return new l(e);u.call(this,e),this._transformState={afterTransform:c.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",f)}function f(){var e=this;"function"!=typeof this._flush||this._readableState.destroyed?h(this,null,null):this._flush((function(t,n){h(e,t,n)}))}function h(e,t,n){if(t)return e.emit("error",t);if(null!=n&&e.push(n),e._writableState.length)throw new s;if(e._transformState.transforming)throw new a;return e.push(null)}o("j1UVA")(l,u),l.prototype.push=function(e,t){return this._transformState.needTransform=!1,u.prototype.push.call(this,e,t)},l.prototype._transform=function(e,t,n){n(new r("_transform()"))},l.prototype._write=function(e,t,n){var r=this._transformState;if(r.writecb=n,r.writechunk=e,r.writeencoding=t,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},l.prototype._read=function(e){var t=this._transformState;null===t.writechunk||t.transforming?t.needTransform=!0:(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform))},l.prototype._destroy=function(e,t){u.prototype._destroy.call(this,e,(function(e){t(e)}))}})),o.register("jO524",(function(e,t){e.exports=r;var n=o("hVtUc");function r(e){if(!(this instanceof r))return new r(e);n.call(this,e)}o("j1UVA")(r,n),r.prototype._transform=function(e,t,n){n(null,e)}})),o.register("6LNcL",(function(e,t){var n;var r=o("hLSLD").codes,i=r.ERR_MISSING_ARGS,a=r.ERR_STREAM_DESTROYED;function s(e){if(e)throw e}function u(e,t,r,i){i=function(e){var t=!1;return function(){t||(t=!0,e.apply(void 0,arguments))}}(i);var s=!1;e.on("close",(function(){s=!0})),void 0===n&&(n=o("korvP")),n(e,{readable:t,writable:r},(function(e){if(e)return i(e);s=!0,i()}));var u=!1;return function(t){if(!s&&!u)return u=!0,function(e){return e.setHeader&&"function"==typeof e.abort}(e)?e.abort():"function"==typeof e.destroy?e.destroy():void i(t||new a("pipe"))}}function c(e){e()}function l(e,t){return e.pipe(t)}function f(e){return e.length?"function"!=typeof e[e.length-1]?s:e.pop():s}e.exports=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,o=f(t);if(Array.isArray(t[0])&&(t=t[0]),t.length<2)throw new i("streams");var a=t.map((function(e,n){var i=n<t.length-1;return u(e,i,n>0,(function(e){r||(r=e),e&&a.forEach(c),i||(a.forEach(c),o(r))}))}));return t.reduce(l)}})),o.register("1v3TW",(function(e,t){var n=o("7Wnxb");function r(e,t,r){t&&"string"!=typeof t&&(t=t.message||t.name),n(this,{type:e,name:e,cause:"string"!=typeof t?t:r,message:t},"ewr")}function i(e,t){Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor),r.call(this,"CustomError",e,t)}i.prototype=new Error,e.exports=function(e){var t=function(t,n){return function(e,t,n){var o=function(n,i){r.call(this,t,n,i),"FilesystemError"==t&&(this.code=this.cause.code,this.path=this.cause.path,this.errno=this.cause.errno,this.message=(e.errno[this.cause.errno]?e.errno[this.cause.errno].description:this.cause.message)+(this.cause.path?" ["+this.cause.path+"]":"")),Error.call(this),Error.captureStackTrace&&Error.captureStackTrace(this,o)};return o.prototype=n?new n:new i,o}(e,t,n)};return{CustomError:i,FilesystemError:t("FilesystemError"),createError:t}}})),o.register("7Wnxb",(function(e,t){
/*!
  * prr
  * (c) 2013 Rod Vagg <rod@vagg.org>
  * https://github.com/rvagg/prr
  * License: MIT
  */
var n,r;n=e.exports,r=function(){var e="function"==typeof Object.defineProperty?function(e,t,n){return Object.defineProperty(e,t,n),e}:function(e,t,n){return e[t]=n.value,e};return function(t,n,r,i){var o;if(i=function(e,t){var n="object"==typeof t,r=!n&&"string"==typeof t,i=function(e){return n?!!t[e]:!!r&&t.indexOf(e[0])>-1};return{enumerable:i("enumerable"),configurable:i("configurable"),writable:i("writable"),value:e}}(r,i),"object"==typeof n){for(o in n)Object.hasOwnProperty.call(n,o)&&(i.value=n[o],e(t,o,i));return t}return e(t,n,i)}},e.exports?e.exports=r():n.prr=r()})),o.register("2pKBN",(function(e,t){var n=o("iThRa");function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i,a,s=o("crihf").codes,u=s.ERR_AMBIGUOUS_ARGUMENT,c=s.ERR_INVALID_ARG_TYPE,l=s.ERR_INVALID_ARG_VALUE,f=s.ERR_INVALID_RETURN_VALUE,h=s.ERR_MISSING_ARGS,d=o("cN15O"),p=o("dyk5A").inspect,m=o("dyk5A").types,y=m.isPromise,g=m.isRegExp,b=Object.assign?Object.assign:o("5SkZi").assign,v=Object.is?Object.is:o("9xw1I");new Map;function w(){var e=o("1Ie7V");i=e.isDeepEqual,a=e.isDeepStrictEqual}var _=!1,E=e.exports=M,S={};function x(e){if(e.message instanceof Error)throw e.message;throw new d(e)}function T(e,t,n,r){if(!n){var i=!1;if(0===t)i=!0,r="No value argument passed to `assert.ok()`";else if(r instanceof Error)throw r;var o=new d({actual:n,expected:!0,message:r,operator:"==",stackStartFn:e});throw o.generatedMessage=i,o}}function M(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[M,t.length].concat(t))}E.fail=function e(t,r,i,o,a){var s,u=arguments.length;if(0===u)s="Failed";else if(1===u)i=t,t=void 0;else{if(!1===_){_=!0;var c=n.emitWarning?n.emitWarning:console.warn.bind(console);c("assert.fail() with more than one argument is deprecated. Please use assert.strictEqual() instead or only pass a message.","DeprecationWarning","DEP0094")}2===u&&(o="!=")}if(i instanceof Error)throw i;var l={actual:t,expected:r,operator:void 0===o?"fail":o,stackStartFn:a||e};void 0!==i&&(l.message=i);var f=new d(l);throw s&&(f.message=s,f.generatedMessage=!0),f},E.AssertionError=d,E.ok=M,E.equal=function e(t,n,r){if(arguments.length<2)throw new h("actual","expected");t!=n&&x({actual:t,expected:n,message:r,operator:"==",stackStartFn:e})},E.notEqual=function e(t,n,r){if(arguments.length<2)throw new h("actual","expected");t==n&&x({actual:t,expected:n,message:r,operator:"!=",stackStartFn:e})},E.deepEqual=function e(t,n,r){if(arguments.length<2)throw new h("actual","expected");void 0===i&&w(),i(t,n)||x({actual:t,expected:n,message:r,operator:"deepEqual",stackStartFn:e})},E.notDeepEqual=function e(t,n,r){if(arguments.length<2)throw new h("actual","expected");void 0===i&&w(),i(t,n)&&x({actual:t,expected:n,message:r,operator:"notDeepEqual",stackStartFn:e})},E.deepStrictEqual=function e(t,n,r){if(arguments.length<2)throw new h("actual","expected");void 0===i&&w(),a(t,n)||x({actual:t,expected:n,message:r,operator:"deepStrictEqual",stackStartFn:e})},E.notDeepStrictEqual=function e(t,n,r){if(arguments.length<2)throw new h("actual","expected");void 0===i&&w();a(t,n)&&x({actual:t,expected:n,message:r,operator:"notDeepStrictEqual",stackStartFn:e})},E.strictEqual=function e(t,n,r){if(arguments.length<2)throw new h("actual","expected");v(t,n)||x({actual:t,expected:n,message:r,operator:"strictEqual",stackStartFn:e})},E.notStrictEqual=function e(t,n,r){if(arguments.length<2)throw new h("actual","expected");v(t,n)&&x({actual:t,expected:n,message:r,operator:"notStrictEqual",stackStartFn:e})};var A=function e(t,n,r){var i=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.forEach((function(e){e in t&&(void 0!==r&&"string"==typeof r[e]&&g(t[e])&&t[e].test(r[e])?i[e]=r[e]:i[e]=t[e])}))};function R(e,t,n,r,i,o){if(!(n in e)||!a(e[n],t[n])){if(!r){var s=new A(e,i),u=new A(t,i,e),c=new d({actual:s,expected:u,operator:"deepStrictEqual",stackStartFn:o});throw c.actual=e,c.expected=t,c.operator=o.name,c}x({actual:e,expected:t,message:r,operator:o.name,stackStartFn:o})}}function I(e,t,n,o){if("function"!=typeof t){if(g(t))return t.test(e);if(2===arguments.length)throw new c("expected",["Function","RegExp"],t);if("object"!==r(e)||null===e){var a=new d({actual:e,expected:t,message:n,operator:"deepStrictEqual",stackStartFn:o});throw a.operator=o.name,a}var s=Object.keys(t);if(t instanceof Error)s.push("name","message");else if(0===s.length)throw new l("error",t,"may not be an empty object");return void 0===i&&w(),s.forEach((function(r){"string"==typeof e[r]&&g(t[r])&&t[r].test(e[r])||R(e,t,r,n,s,o)})),!0}return void 0!==t.prototype&&e instanceof t||!Error.isPrototypeOf(t)&&!0===t.call({},e)}function P(e){if("function"!=typeof e)throw new c("fn","Function",e);try{e()}catch(e){return e}return S}function N(e){return y(e)||null!==e&&"object"===r(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function O(e){return Promise.resolve().then((function(){var t;if("function"==typeof e){if(!N(t=e()))throw new f("instance of Promise","promiseFn",t)}else{if(!N(e))throw new c("promiseFn",["Function","Promise"],e);t=e}return Promise.resolve().then((function(){return t})).then((function(){return S})).catch((function(e){return e}))}))}function C(e,t,n,i){if("string"==typeof n){if(4===arguments.length)throw new c("error",["Object","Error","Function","RegExp"],n);if("object"===r(t)&&null!==t){if(t.message===n)throw new u("error/message",'The error message "'.concat(t.message,'" is identical to the message.'))}else if(t===n)throw new u("error/message",'The error "'.concat(t,'" is identical to the message.'));i=n,n=void 0}else if(null!=n&&"object"!==r(n)&&"function"!=typeof n)throw new c("error",["Object","Error","Function","RegExp"],n);if(t===S){var o="";n&&n.name&&(o+=" (".concat(n.name,")")),o+=i?": ".concat(i):".";var a="rejects"===e.name?"rejection":"exception";x({actual:void 0,expected:n,operator:e.name,message:"Missing expected ".concat(a).concat(o),stackStartFn:e})}if(n&&!I(t,n,i,e))throw t}function k(e,t,n,r){if(t!==S){if("string"==typeof n&&(r=n,n=void 0),!n||I(t,n)){var i=r?": ".concat(r):".",o="doesNotReject"===e.name?"rejection":"exception";x({actual:t,expected:n,operator:e.name,message:"Got unwanted ".concat(o).concat(i,"\n")+'Actual message: "'.concat(t&&t.message,'"'),stackStartFn:e})}throw t}}function B(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];T.apply(void 0,[B,t.length].concat(t))}E.throws=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];C.apply(void 0,[e,P(t)].concat(r))},E.rejects=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return O(t).then((function(t){return C.apply(void 0,[e,t].concat(r))}))},E.doesNotThrow=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];k.apply(void 0,[e,P(t)].concat(r))},E.doesNotReject=function e(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return O(t).then((function(t){return k.apply(void 0,[e,t].concat(r))}))},E.ifError=function e(t){if(null!=t){var n="ifError got unwanted exception: ";"object"===r(t)&&"string"==typeof t.message?0===t.message.length&&t.constructor?n+=t.constructor.name:n+=t.message:n+=p(t);var i=new d({actual:t,expected:null,operator:"ifError",message:n,stackStartFn:e}),o=t.stack;if("string"==typeof o){var a=o.split("\n");a.shift();for(var s=i.stack.split("\n"),u=0;u<a.length;u++){var c=s.indexOf(a[u]);if(-1!==c){s=s.slice(0,c);break}}i.stack="".concat(s.join("\n"),"\n").concat(a.join("\n"))}throw i}},E.strict=b(B,E,{equal:E.strictEqual,deepEqual:E.deepStrictEqual,notEqual:E.notStrictEqual,notDeepEqual:E.notDeepStrictEqual}),E.strict.strict=E.strict})),o.register("crihf",(function(t,n){var r;function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}e(t.exports,"codes",(()=>r),(e=>r=e));var c,l,f={};function h(e,t,n){n||(n=Error);var r=function(n){function r(n,i,o){var u;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),u=a(this,s(r).call(this,function(e,n,r){return"string"==typeof t?t:t(e,n,r)}(n,i,o))),u.code=e,u}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}(r,n),r}(n);f[e]=r}function d(e,t){if(Array.isArray(e)){var n=e.length;return e=e.map((function(e){return String(e)})),n>2?"one of ".concat(t," ").concat(e.slice(0,n-1).join(", "),", or ")+e[n-1]:2===n?"one of ".concat(t," ").concat(e[0]," or ").concat(e[1]):"of ".concat(t," ").concat(e[0])}return"of ".concat(t," ").concat(String(e))}h("ERR_AMBIGUOUS_ARGUMENT",'The "%s" argument is ambiguous. %s',TypeError),h("ERR_INVALID_ARG_TYPE",(function(e,t,n){var r,a,s,u;if(void 0===c&&(c=o("2pKBN")),c("string"==typeof e,"'name' must be a string"),"string"==typeof t&&(a="not ",t.substr(!s||s<0?0:+s,a.length)===a)?(r="must not be",t=t.replace(/^not /,"")):r="must be",function(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}(e," argument"))u="The ".concat(e," ").concat(r," ").concat(d(t,"type"));else{var l=function(e,t,n){return"number"!=typeof n&&(n=0),!(n+t.length>e.length)&&-1!==e.indexOf(t,n)}(e,".")?"property":"argument";u='The "'.concat(e,'" ').concat(l," ").concat(r," ").concat(d(t,"type"))}return u+=". Received type ".concat(i(n))}),TypeError),h("ERR_INVALID_ARG_VALUE",(function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"is invalid";void 0===l&&(l=o("dyk5A"));var r=l.inspect(t);return r.length>128&&(r="".concat(r.slice(0,128),"...")),"The argument '".concat(e,"' ").concat(n,". Received ").concat(r)}),TypeError,RangeError),h("ERR_INVALID_RETURN_VALUE",(function(e,t,n){var r;return r=n&&n.constructor&&n.constructor.name?"instance of ".concat(n.constructor.name):"type ".concat(i(n)),"Expected ".concat(e,' to be returned from the "').concat(t,'"')+" function but got ".concat(r,".")}),TypeError),h("ERR_MISSING_ARGS",(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];void 0===c&&(c=o("2pKBN")),c(t.length>0,"At least one arg needs to be specified");var r="The ",i=t.length;switch(t=t.map((function(e){return'"'.concat(e,'"')})),i){case 1:r+="".concat(t[0]," argument");break;case 2:r+="".concat(t[0]," and ").concat(t[1]," arguments");break;default:r+=t.slice(0,i-1).join(", "),r+=", and ".concat(t[i-1]," arguments")}return"".concat(r," must be specified")}),TypeError),r=f})),o.register("cN15O",(function(e,t){var n=o("iThRa");function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return!t||"object"!==d(t)&&"function"!=typeof t?s(e):t}function s(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function u(e){var t="function"==typeof Map?new Map:void 0;return u=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return l(e,arguments,h(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)},u(e)}function c(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function l(e,t,n){return(l=c()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&f(i,n.prototype),i}).apply(null,arguments)}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e){return(d="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var p=o("dyk5A").inspect,m=o("crihf").codes.ERR_INVALID_ARG_TYPE;function y(e,t,n){return(void 0===n||n>e.length)&&(n=e.length),e.substring(n-t.length,n)===t}var g="",b="",v="",w="",_={deepStrictEqual:"Expected values to be strictly deep-equal:",strictEqual:"Expected values to be strictly equal:",strictEqualObject:'Expected "actual" to be reference-equal to "expected":',deepEqual:"Expected values to be loosely deep-equal:",equal:"Expected values to be loosely equal:",notDeepStrictEqual:'Expected "actual" not to be strictly deep-equal to:',notStrictEqual:'Expected "actual" to be strictly unequal to:',notStrictEqualObject:'Expected "actual" not to be reference-equal to "expected":',notDeepEqual:'Expected "actual" not to be loosely deep-equal to:',notEqual:'Expected "actual" to be loosely unequal to:',notIdentical:"Values identical but not reference-equal:"};function E(e){var t=Object.keys(e),n=Object.create(Object.getPrototypeOf(e));return t.forEach((function(t){n[t]=e[t]})),Object.defineProperty(n,"message",{value:e.message}),n}function S(e){return p(e,{compact:!1,customInspect:!1,depth:1e3,maxArrayLength:1/0,showHidden:!1,breakLength:1/0,showProxy:!1,sorted:!0,getters:!0})}function x(e,t,r){var i="",o="",a=0,s="",u=!1,c=S(e),l=c.split("\n"),f=S(t).split("\n"),h=0,p="";if("strictEqual"===r&&"object"===d(e)&&"object"===d(t)&&null!==e&&null!==t&&(r="strictEqualObject"),1===l.length&&1===f.length&&l[0]!==f[0]){var m=l[0].length+f[0].length;if(m<=10){if(!("object"===d(e)&&null!==e||"object"===d(t)&&null!==t||0===e&&0===t))return"".concat(_[r],"\n\n")+"".concat(l[0]," !== ").concat(f[0],"\n")}else if("strictEqualObject"!==r){if(m<(n.stderr&&n.stderr.isTTY?n.stderr.columns:80)){for(;l[0][h]===f[0][h];)h++;h>2&&(p="\n  ".concat(function(e,t){if(t=Math.floor(t),0==e.length||0==t)return"";var n=e.length*t;for(t=Math.floor(Math.log(t)/Math.log(2));t;)e+=e,t--;return e+e.substring(0,n-e.length)}(" ",h),"^"),h=0)}}}for(var E=l[l.length-1],x=f[f.length-1];E===x&&(h++<2?s="\n  ".concat(E).concat(s):i=E,l.pop(),f.pop(),0!==l.length&&0!==f.length);)E=l[l.length-1],x=f[f.length-1];var T=Math.max(l.length,f.length);if(0===T){var M=c.split("\n");if(M.length>30)for(M[26]="".concat(g,"...").concat(w);M.length>27;)M.pop();return"".concat(_.notIdentical,"\n\n").concat(M.join("\n"),"\n")}h>3&&(s="\n".concat(g,"...").concat(w).concat(s),u=!0),""!==i&&(s="\n  ".concat(i).concat(s),i="");var A=0,R=_[r]+"\n".concat(b,"+ actual").concat(w," ").concat(v,"- expected").concat(w),I=" ".concat(g,"...").concat(w," Lines skipped");for(h=0;h<T;h++){var P=h-a;if(l.length<h+1)P>1&&h>2&&(P>4?(o+="\n".concat(g,"...").concat(w),u=!0):P>3&&(o+="\n  ".concat(f[h-2]),A++),o+="\n  ".concat(f[h-1]),A++),a=h,i+="\n".concat(v,"-").concat(w," ").concat(f[h]),A++;else if(f.length<h+1)P>1&&h>2&&(P>4?(o+="\n".concat(g,"...").concat(w),u=!0):P>3&&(o+="\n  ".concat(l[h-2]),A++),o+="\n  ".concat(l[h-1]),A++),a=h,o+="\n".concat(b,"+").concat(w," ").concat(l[h]),A++;else{var N=f[h],O=l[h],C=O!==N&&(!y(O,",")||O.slice(0,-1)!==N);C&&y(N,",")&&N.slice(0,-1)===O&&(C=!1,O+=","),C?(P>1&&h>2&&(P>4?(o+="\n".concat(g,"...").concat(w),u=!0):P>3&&(o+="\n  ".concat(l[h-2]),A++),o+="\n  ".concat(l[h-1]),A++),a=h,o+="\n".concat(b,"+").concat(w," ").concat(O),i+="\n".concat(v,"-").concat(w," ").concat(N),A+=2):(o+=i,i="",1!==P&&0!==h||(o+="\n  ".concat(O),A++))}if(A>20&&h<T-2)return"".concat(R).concat(I,"\n").concat(o,"\n").concat(g,"...").concat(w).concat(i,"\n")+"".concat(g,"...").concat(w)}return"".concat(R).concat(u?I:"","\n").concat(o).concat(i).concat(s).concat(p)}var T=function(e){function t(e){var r;if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),"object"!==d(e)||null===e)throw new m("options","Object",e);var i=e.message,o=e.operator,u=e.stackStartFn,c=e.actual,l=e.expected,f=Error.stackTraceLimit;if(Error.stackTraceLimit=0,null!=i)r=a(this,h(t).call(this,String(i)));else if(n.stderr&&n.stderr.isTTY&&(n.stderr&&n.stderr.getColorDepth&&1!==n.stderr.getColorDepth()?(g="[34m",b="[32m",w="[39m",v="[31m"):(g="",b="",w="",v="")),"object"===d(c)&&null!==c&&"object"===d(l)&&null!==l&&"stack"in c&&c instanceof Error&&"stack"in l&&l instanceof Error&&(c=E(c),l=E(l)),"deepStrictEqual"===o||"strictEqual"===o)r=a(this,h(t).call(this,x(c,l,o)));else if("notDeepStrictEqual"===o||"notStrictEqual"===o){var p=_[o],y=S(c).split("\n");if("notStrictEqual"===o&&"object"===d(c)&&null!==c&&(p=_.notStrictEqualObject),y.length>30)for(y[26]="".concat(g,"...").concat(w);y.length>27;)y.pop();r=1===y.length?a(this,h(t).call(this,"".concat(p," ").concat(y[0]))):a(this,h(t).call(this,"".concat(p,"\n\n").concat(y.join("\n"),"\n")))}else{var T=S(c),M="",A=_[o];"notDeepEqual"===o||"notEqual"===o?(T="".concat(_[o],"\n\n").concat(T)).length>1024&&(T="".concat(T.slice(0,1021),"...")):(M="".concat(S(l)),T.length>512&&(T="".concat(T.slice(0,509),"...")),M.length>512&&(M="".concat(M.slice(0,509),"...")),"deepEqual"===o||"equal"===o?T="".concat(A,"\n\n").concat(T,"\n\nshould equal\n\n"):M=" ".concat(o," ").concat(M)),r=a(this,h(t).call(this,"".concat(T).concat(M)))}return Error.stackTraceLimit=f,r.generatedMessage=!i,Object.defineProperty(s(r),"name",{value:"AssertionError [ERR_ASSERTION]",enumerable:!1,writable:!0,configurable:!0}),r.code="ERR_ASSERTION",r.actual=c,r.expected=l,r.operator=o,Error.captureStackTrace&&Error.captureStackTrace(s(r),u),r.stack,r.name="AssertionError",a(r)}var o,u,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(t,e),o=t,u=[{key:"toString",value:function(){return"".concat(this.name," [").concat(this.code,"]: ").concat(this.message)}},{key:p.custom,value:function(e,t){return p(this,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){r(e,t,n[t])}))}return e}({},t,{customInspect:!1,depth:0}))}}],u&&i(o.prototype,u),c&&i(o,c),t}(u(Error));e.exports=T})),o.register("5SkZi",(function(e,t){function n(e,t){if(null==e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),r=1;r<arguments.length;r++){var i=arguments[r];if(null!=i)for(var o=Object.keys(Object(i)),a=0,s=o.length;a<s;a++){var u=o[a],c=Object.getOwnPropertyDescriptor(i,u);void 0!==c&&c.enumerable&&(n[u]=i[u])}}return n}e.exports={assign:n,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:n})}}})),o.register("9xw1I",(function(e,t){var n=o("2uahE"),r=o("et4V5"),i=o("8pgeg"),a=o("j24Lm"),s=o("bHsVV"),u=r(a(),Object);n(u,{getPolyfill:a,implementation:i,shim:s}),e.exports=u})),o.register("2uahE",(function(e,t){var n=o("6ZlTb"),r="function"==typeof Symbol&&"symbol"==typeof Symbol("foo"),i=Object.prototype.toString,a=Array.prototype.concat,s=Object.defineProperty,u=o("65FQW")(),c=s&&u,l=function(e,t,n,r){var o;(!(t in e)||"function"==typeof(o=r)&&"[object Function]"===i.call(o)&&r())&&(c?s(e,t,{configurable:!0,enumerable:!1,value:n,writable:!0}):e[t]=n)},f=function(e,t){var i=arguments.length>2?arguments[2]:{},o=n(t);r&&(o=a.call(o,Object.getOwnPropertySymbols(t)));for(var s=0;s<o.length;s+=1)l(e,o[s],t[o[s]],i[o[s]])};f.supportsDescriptors=!!c,e.exports=f})),o.register("6ZlTb",(function(e,t){var n=Array.prototype.slice,r=o("jCIuA"),i=Object.keys,a=i?function(e){return i(e)}:o("l7j9q"),s=Object.keys;a.shim=function(){if(Object.keys){var e=function(){var e=Object.keys(arguments);return e&&e.length===arguments.length}(1,2);e||(Object.keys=function(e){return r(e)?s(n.call(e)):s(e)})}else Object.keys=a;return Object.keys||a},e.exports=a})),o.register("jCIuA",(function(e,t){var n=Object.prototype.toString;e.exports=function(e){var t=n.call(e),r="[object Arguments]"===t;return r||(r="[object Array]"!==t&&null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Function]"===n.call(e.callee)),r}})),o.register("l7j9q",(function(e,t){var n;if(!Object.keys){var r=Object.prototype.hasOwnProperty,i=Object.prototype.toString,a=o("jCIuA"),s=Object.prototype.propertyIsEnumerable,u=!s.call({toString:null},"toString"),c=s.call((function(){}),"prototype"),l=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],f=function(e){var t=e.constructor;return t&&t.prototype===e},h={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},d=function(){if("undefined"==typeof window)return!1;for(var e in window)try{if(!h["$"+e]&&r.call(window,e)&&null!==window[e]&&"object"==typeof window[e])try{f(window[e])}catch(e){return!0}}catch(e){return!0}return!1}();n=function(e){var t=null!==e&&"object"==typeof e,n="[object Function]"===i.call(e),o=a(e),s=t&&"[object String]"===i.call(e),h=[];if(!t&&!n&&!o)throw new TypeError("Object.keys called on a non-object");var p=c&&n;if(s&&e.length>0&&!r.call(e,0))for(var m=0;m<e.length;++m)h.push(String(m));if(o&&e.length>0)for(var y=0;y<e.length;++y)h.push(String(y));else for(var g in e)p&&"prototype"===g||!r.call(e,g)||h.push(String(g));if(u)for(var b=function(e){if("undefined"==typeof window||!d)return f(e);try{return f(e)}catch(e){return!1}}(e),v=0;v<l.length;++v)b&&"constructor"===l[v]||!r.call(e,l[v])||h.push(l[v]);return h}}e.exports=n})),o.register("65FQW",(function(e,t){var n=o("86zQT")("%Object.defineProperty%",!0),r=function(){if(n)try{return n({},"a",{value:1}),!0}catch(e){return!1}return!1};r.hasArrayLengthDefineBug=function(){if(!r())return null;try{return 1!==n([],"length",{value:1}).length}catch(e){return!0}},e.exports=r})),o.register("8pgeg",(function(e,t){var n=function(e){return e!=e};e.exports=function(e,t){return 0===e&&0===t?1/e==1/t:e===t||!(!n(e)||!n(t))}})),o.register("j24Lm",(function(e,t){var n=o("8pgeg");e.exports=function(){return"function"==typeof Object.is?Object.is:n}})),o.register("bHsVV",(function(e,t){var n=o("j24Lm"),r=o("2uahE");e.exports=function(){var e=n();return r(Object,{is:e},{is:function(){return Object.is!==e}}),e}})),o.register("1Ie7V",(function(e,t){function n(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var i=void 0!==/a/g.flags,a=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),t},s=function(e){var t=[];return e.forEach((function(e,n){return t.push([n,e])})),t},u=Object.is?Object.is:o("9xw1I"),c=Object.getOwnPropertySymbols?Object.getOwnPropertySymbols:function(){return[]},l=Number.isNaN?Number.isNaN:o("8NqQz");function f(e){return e.call.bind(e)}var h=f(Object.prototype.hasOwnProperty),d=f(Object.prototype.propertyIsEnumerable),p=f(Object.prototype.toString),m=o("dyk5A").types,y=m.isAnyArrayBuffer,g=m.isArrayBufferView,b=m.isDate,v=m.isMap,w=m.isRegExp,_=m.isSet,E=m.isNativeError,S=m.isBoxedPrimitive,x=m.isNumberObject,T=m.isStringObject,M=m.isBooleanObject,A=m.isBigIntObject,R=m.isSymbolObject,I=m.isFloat32Array,P=m.isFloat64Array;function N(e){if(0===e.length||e.length>10)return!0;for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(n<48||n>57)return!0}return 10===e.length&&e>=Math.pow(2,32)}function O(e){return Object.keys(e).filter(N).concat(c(e).filter(Object.prototype.propertyIsEnumerable.bind(e)))}
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>
 * @license  MIT
 */function C(e,t){if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0}function k(e,t,n,o){if(e===t)return 0!==e||(!n||u(e,t));if(n){if("object"!==r(e))return"number"==typeof e&&l(e)&&l(t);if("object"!==r(t)||null===e||null===t)return!1;if(Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1}else{if(null===e||"object"!==r(e))return(null===t||"object"!==r(t))&&e==t;if(null===t||"object"!==r(t))return!1}var a,s,c,f,h=p(e);if(h!==p(t))return!1;if(Array.isArray(e)){if(e.length!==t.length)return!1;var d=O(e),m=O(t);return d.length===m.length&&D(e,t,n,o,1,d)}if("[object Object]"===h&&(!v(e)&&v(t)||!_(e)&&_(t)))return!1;if(b(e)){if(!b(t)||Date.prototype.getTime.call(e)!==Date.prototype.getTime.call(t))return!1}else if(w(e)){if(!w(t)||(c=e,f=t,!(i?c.source===f.source&&c.flags===f.flags:RegExp.prototype.toString.call(c)===RegExp.prototype.toString.call(f))))return!1}else if(E(e)||e instanceof Error){if(e.message!==t.message||e.name!==t.name)return!1}else{if(g(e)){if(n||!I(e)&&!P(e)){if(!function(e,t){return e.byteLength===t.byteLength&&0===C(new Uint8Array(e.buffer,e.byteOffset,e.byteLength),new Uint8Array(t.buffer,t.byteOffset,t.byteLength))}(e,t))return!1}else if(!function(e,t){if(e.byteLength!==t.byteLength)return!1;for(var n=0;n<e.byteLength;n++)if(e[n]!==t[n])return!1;return!0}(e,t))return!1;var N=O(e),k=O(t);return N.length===k.length&&D(e,t,n,o,0,N)}if(_(e))return!(!_(t)||e.size!==t.size)&&D(e,t,n,o,2);if(v(e))return!(!v(t)||e.size!==t.size)&&D(e,t,n,o,3);if(y(e)){if(s=t,(a=e).byteLength!==s.byteLength||0!==C(new Uint8Array(a),new Uint8Array(s)))return!1}else if(S(e)&&!function(e,t){return x(e)?x(t)&&u(Number.prototype.valueOf.call(e),Number.prototype.valueOf.call(t)):T(e)?T(t)&&String.prototype.valueOf.call(e)===String.prototype.valueOf.call(t):M(e)?M(t)&&Boolean.prototype.valueOf.call(e)===Boolean.prototype.valueOf.call(t):A(e)?A(t)&&BigInt.prototype.valueOf.call(e)===BigInt.prototype.valueOf.call(t):R(t)&&Symbol.prototype.valueOf.call(e)===Symbol.prototype.valueOf.call(t)}(e,t))return!1}return D(e,t,n,o,0)}function B(e,t){return t.filter((function(t){return d(e,t)}))}function D(e,t,n,r,i,o){if(5===arguments.length){o=Object.keys(e);var a=Object.keys(t);if(o.length!==a.length)return!1}for(var s=0;s<o.length;s++)if(!h(t,o[s]))return!1;if(n&&5===arguments.length){var u=c(e);if(0!==u.length){var l=0;for(s=0;s<u.length;s++){var f=u[s];if(d(e,f)){if(!d(t,f))return!1;o.push(f),l++}else if(d(t,f))return!1}var p=c(t);if(u.length!==p.length&&B(t,p).length!==l)return!1}else{var m=c(t);if(0!==m.length&&0!==B(t,m).length)return!1}}if(0===o.length&&(0===i||1===i&&0===e.length||0===e.size))return!0;if(void 0===r)r={val1:new Map,val2:new Map,position:0};else{var y=r.val1.get(e);if(void 0!==y){var g=r.val2.get(t);if(void 0!==g)return y===g}r.position++}r.val1.set(e,r.position),r.val2.set(t,r.position);var b=K(e,t,n,o,r,i);return r.val1.delete(e),r.val2.delete(t),b}function j(e,t,n,r){for(var i=a(e),o=0;o<i.length;o++){var s=i[o];if(k(t,s,n,r))return e.delete(s),!0}return!1}function L(e){switch(r(e)){case"undefined":return null;case"object":return;case"symbol":return!1;case"string":e=+e;case"number":if(l(e))return!1}return!0}function q(e,t,n){var r=L(n);return null!=r?r:t.has(r)&&!e.has(r)}function U(e,t,n,r,i){var o=L(n);if(null!=o)return o;var a=t.get(o);return!(void 0===a&&!t.has(o)||!k(r,a,!1,i))&&(!e.has(o)&&k(r,a,!1,i))}function F(e,t,n,r,i,o){for(var s=a(e),u=0;u<s.length;u++){var c=s[u];if(k(n,c,i,o)&&k(r,t.get(c),i,o))return e.delete(c),!0}return!1}function K(e,t,i,o,u,c){var l=0;if(2===c){if(!function(e,t,n,i){for(var o=null,s=a(e),u=0;u<s.length;u++){var c=s[u];if("object"===r(c)&&null!==c)null===o&&(o=new Set),o.add(c);else if(!t.has(c)){if(n)return!1;if(!q(e,t,c))return!1;null===o&&(o=new Set),o.add(c)}}if(null!==o){for(var l=a(t),f=0;f<l.length;f++){var h=l[f];if("object"===r(h)&&null!==h){if(!j(o,h,n,i))return!1}else if(!n&&!e.has(h)&&!j(o,h,n,i))return!1}return 0===o.size}return!0}(e,t,i,u))return!1}else if(3===c){if(!function(e,t,i,o){for(var a=null,u=s(e),c=0;c<u.length;c++){var l=n(u[c],2),f=l[0],h=l[1];if("object"===r(f)&&null!==f)null===a&&(a=new Set),a.add(f);else{var d=t.get(f);if(void 0===d&&!t.has(f)||!k(h,d,i,o)){if(i)return!1;if(!U(e,t,f,h,o))return!1;null===a&&(a=new Set),a.add(f)}}}if(null!==a){for(var p=s(t),m=0;m<p.length;m++){var y=n(p[m],2),g=(f=y[0],y[1]);if("object"===r(f)&&null!==f){if(!F(a,e,f,g,i,o))return!1}else if(!(i||e.has(f)&&k(e.get(f),g,!1,o)||F(a,e,f,g,!1,o)))return!1}return 0===a.size}return!0}(e,t,i,u))return!1}else if(1===c)for(;l<e.length;l++){if(!h(e,l)){if(h(t,l))return!1;for(var f=Object.keys(e);l<f.length;l++){var d=f[l];if(!h(t,d)||!k(e[d],t[d],i,u))return!1}return f.length===Object.keys(t).length}if(!h(t,l)||!k(e[l],t[l],i,u))return!1}for(l=0;l<o.length;l++){var p=o[l];if(!k(e[p],t[p],i,u))return!1}return!0}e.exports={isDeepEqual:function(e,t){return k(e,t,false)},isDeepStrictEqual:function(e,t){return k(e,t,true)}}})),o.register("8NqQz",(function(e,t){var n=o("et4V5"),r=o("2uahE"),i=o("kxDiN"),a=o("lbT92"),s=o("dBeMi"),u=n(a(),Number);r(u,{getPolyfill:a,implementation:i,shim:s}),e.exports=u})),o.register("kxDiN",(function(e,t){e.exports=function(e){return e!=e}})),o.register("lbT92",(function(e,t){var n=o("kxDiN");e.exports=function(){return Number.isNaN&&Number.isNaN(NaN)&&!Number.isNaN("a")?Number.isNaN:n}})),o.register("dBeMi",(function(e,t){var n=o("2uahE"),r=o("lbT92");e.exports=function(){var e=r();return n(Number,{isNaN:e},{isNaN:function(){return Number.isNaN!==e}}),e}})),o.register("iiY8F",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("gSoBg",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SingleFftFactory=e.exports.SingleFft=void 0;var n=o("iWLZZ");class r{constructor(e){this.wasm=e}async init(e){this.domainPtr=await this.wasm.call("new_evaluation_domain",e)}async destroy(){await this.wasm.call("delete_evaluation_domain",this.domainPtr)}async fft(e,t){const r=e.length/32,i=await this.wasm.call("bbmalloc",e.length);await this.wasm.transferToHeap((0,n.Transfer)(e,[e.buffer]),i),await this.wasm.transferToHeap((0,n.Transfer)(t,[t.buffer]),0),await this.wasm.call("coset_fft_with_generator_shift",i,0,this.domainPtr);const o=await this.wasm.sliceMemory(i,i+32*r);return await this.wasm.call("bbfree",i),o}async ifft(e){const t=e.length/32,r=await this.wasm.call("bbmalloc",e.length);await this.wasm.transferToHeap((0,n.Transfer)(e,[e.buffer]),r),await this.wasm.call("ifft",r,this.domainPtr);const i=await this.wasm.sliceMemory(r,r+32*t);return await this.wasm.call("bbfree",r),i}}e.exports.SingleFft=r;e.exports.SingleFftFactory=class{constructor(e){this.wasm=e,this.ffts={}}async createFft(e){if(!this.ffts[e]){const t=new r(this.wasm);await t.init(e),this.ffts[e]=t}return this.ffts[e]}async destroy(){}}})),o.register("k2qnY",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PooledFftFactory=e.exports.PooledFft=void 0;const n=l(o("7LjTn"));var r=o("gSoBg");const i=(0,n.default)("bb:fft");class a{constructor(e){this.queue=new Te.MemoryFifo,this.ffts=e.workers.map((e=>new r.SingleFft(e)))}async init(e){const t=(new Date).getTime();i(`initializing fft of size: ${e}`),await Promise.all(this.ffts.map((t=>t.init(e)))),this.ffts.forEach((e=>this.processJobs(e))),i(`initialization took: ${(new Date).getTime()-t}ms`)}async destroy(){this.queue.cancel(),await Promise.all(this.ffts.map((e=>e.destroy())))}async processJobs(e){for(;;){const t=await this.queue.get();if(!t)break;const n=await(t.inverse?e.ifft(t.coefficients):e.fft(t.coefficients,t.constant));t.resolve(n)}}async fft(e,t){return await new Promise((n=>this.queue.put({coefficients:e,constant:t,inverse:!1,resolve:n})))}async ifft(e){return await new Promise((t=>this.queue.put({coefficients:e,inverse:!0,resolve:t})))}}e.exports.PooledFft=a;e.exports.PooledFftFactory=class{constructor(e){this.workerPool=e,this.ffts={}}async createFft(e){if(!this.ffts[e]){const t=new a(this.workerPool);await t.init(e),this.ffts[e]=t}return this.ffts[e]}async destroy(){await Promise.all(Object.values(this.ffts).map((e=>e.destroy())))}}}));var Te={};Object.defineProperty(Te,"__esModule",{value:!0}),Te.MemoryFifo=void 0;Te.MemoryFifo=class{constructor(){this.waiting=[],this.items=[],this.flushing=!1}length(){return this.items.length}get(e){return this.items.length?Promise.resolve(this.items.shift()):0===this.items.length&&this.flushing?Promise.resolve(null):new Promise(((t,n)=>{this.waiting.push(t),e&&setTimeout((()=>{const e=this.waiting.findIndex((e=>e===t));if(e>-1){this.waiting.splice(e,1);const t=new Error("Timeout getting item from queue.");n(t)}}),1e3*e)}))}put(e){this.flushing||(this.waiting.length?this.waiting.shift()(e):this.items.push(e))}end(){this.flushing=!0,this.waiting.forEach((e=>e(null)))}cancel(){this.flushing=!0,this.items=[],this.waiting.forEach((e=>e(null)))}async process(e){try{for(;;){const t=await this.get();if(null===t)break;await e(t)}}catch(e){console.error("Queue handler exception:",e)}}},o.register("jsQJq",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0})})),o.register("4aqig",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.SinglePippenger=void 0;var r=o("iWLZZ");e.exports.SinglePippenger=class{constructor(e){this.wasm=e}async init(e){const t=await this.wasm.call("bbmalloc",e.length);this.numPoints=e.length/64,await this.wasm.transferToHeap(e,t),this.pippengerPtr=await this.wasm.call("new_pippenger",t,this.numPoints),await this.wasm.call("bbfree",t)}async destroy(){await this.wasm.call("delete_pippenger",this.pippengerPtr)}async pippengerUnsafe(e,t,i){const o=await this.wasm.call("bbmalloc",e.length);return await this.wasm.transferToHeap((0,r.Transfer)(e,[e.buffer]),o),await this.wasm.call("pippenger_unsafe",this.pippengerPtr,o,t,i,0),await this.wasm.call("bbfree",o),n.from(await this.wasm.sliceMemory(0,96))}async sumElements(e){const t=await this.wasm.call("bbmalloc",e.length);return await this.wasm.transferToHeap(e,t),await this.wasm.call("g1_sum",t,e.length/96,0),await this.wasm.call("bbfree",t),n.from(await this.wasm.sliceMemory(0,96))}getPointer(){return this.pippengerPtr}getWorker(){return this.wasm}}})),o.register("e5vRy",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.PooledPippenger=void 0;var r=o("4aqig");const i=(0,l(o("7LjTn")).default)("bb:pippenger");e.exports.PooledPippenger=class{constructor(e){this.workerPool=e,this.pool=[]}async init(e){const t=(new Date).getTime();i(`initializing: ${(new Date).getTime()-t}ms`),this.pool=await Promise.all(this.workerPool.workers.map((async t=>{const n=new r.SinglePippenger(t);return await n.init(e),n}))),i(`initialization took: ${(new Date).getTime()-t}ms`)}async pippengerUnsafe(e,t,r){const o=r/this.pool.length,a=(new Date).getTime(),s=await Promise.all(this.pool.map(((t,n)=>{const r=e.slice(o*n*32,o*(n+1)*32);return t.pippengerUnsafe(r,o*n,o)})));return i(`pippenger run took: ${(new Date).getTime()-a}ms`),await this.sumElements(n.concat(s))}async sumElements(e){return await this.pool[0].sumElements(e)}}})),o.register("7IjzK",(function(e,t){var n=o("iThRa"),r=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++)n[t[r]]=Object.getOwnPropertyDescriptor(e,t[r]);return n},i=/%[sdj%]/g;e.exports.format=function(e){if(!b(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(u(arguments[n]));return t.join(" ")}n=1;for(var r=arguments,o=r.length,a=String(e).replace(i,(function(e){if("%%"===e)return"%";if(n>=o)return e;switch(e){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return e}})),s=r[n];n<o;s=r[++n])y(s)||!_(s)?a+=" "+s:a+=" "+u(s);return a},e.exports.deprecate=function(t,r){if(void 0!==n&&!0===n.noDeprecation)return t;if(void 0===n)return function(){return e.exports.deprecate(t,r).apply(this,arguments)};var i=!1;return function(){if(!i){if(n.throwDeprecation)throw new Error(r);n.traceDeprecation?console.trace(r):console.error(r),i=!0}return t.apply(this,arguments)}};var a,s={};function u(t,n){var r={seen:[],stylize:l};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(n)?r.showHidden=n:n&&e.exports._extend(r,n),v(r.showHidden)&&(r.showHidden=!1),v(r.depth)&&(r.depth=2),v(r.colors)&&(r.colors=!1),v(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=c),f(r,t,r.depth)}function c(e,t){var n=u.styles[t];return n?"["+u.colors[n][0]+"m"+e+"["+u.colors[n][1]+"m":e}function l(e,t){return e}function f(t,n,r){if(t.customInspect&&n&&x(n.inspect)&&n.inspect!==e.exports.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return b(i)||(i=f(t,i,r)),i}var o=function(e,t){if(v(t))return e.stylize("undefined","undefined");if(b(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(g(t))return e.stylize(""+t,"number");if(m(t))return e.stylize(""+t,"boolean");if(y(t))return e.stylize("null","null")}(t,n);if(o)return o;var a=Object.keys(n),s=function(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),S(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return h(n);if(0===a.length){if(x(n)){var u=n.name?": "+n.name:"";return t.stylize("[Function"+u+"]","special")}if(w(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(E(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return h(n)}var c,l="",_=!1,T=["{","}"];(p(n)&&(_=!0,T=["[","]"]),x(n))&&(l=" [Function"+(n.name?": "+n.name:"")+"]");return w(n)&&(l=" "+RegExp.prototype.toString.call(n)),E(n)&&(l=" "+Date.prototype.toUTCString.call(n)),S(n)&&(l=" "+h(n)),0!==a.length||_&&0!=n.length?r<0?w(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),c=_?function(e,t,n,r,i){for(var o=[],a=0,s=t.length;a<s;++a)I(t,String(a))?o.push(d(e,t,n,r,String(a),!0)):o.push("");return i.forEach((function(i){i.match(/^\d+$/)||o.push(d(e,t,n,r,i,!0))})),o}(t,n,r,s,a):a.map((function(e){return d(t,n,r,s,e,_)})),t.seen.pop(),function(e,t,n){var r=0;return e.reduce((function(e,t){r++;if(t.indexOf("\n")>=0)r++;return e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(c,l,T)):T[0]+l+T[1]}function h(e){return"["+Error.prototype.toString.call(e)+"]"}function d(e,t,n,r,i,o){var a,s,u;if((u=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]}).get?s=u.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):u.set&&(s=e.stylize("[Setter]","special")),I(r,i)||(a="["+i+"]"),s||(e.seen.indexOf(u.value)<0?(s=y(n)?f(e,u.value,null):f(e,u.value,n-1)).indexOf("\n")>-1&&(s=o?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),v(a)){if(o&&i.match(/^\d+$/))return s;(a=JSON.stringify(""+i)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+s}function p(e){return Array.isArray(e)}function m(e){return"boolean"==typeof e}function y(e){return null===e}function g(e){return"number"==typeof e}function b(e){return"string"==typeof e}function v(e){return void 0===e}function w(e){return _(e)&&"[object RegExp]"===T(e)}function _(e){return"object"==typeof e&&null!==e}function E(e){return _(e)&&"[object Date]"===T(e)}function S(e){return _(e)&&("[object Error]"===T(e)||e instanceof Error)}function x(e){return"function"==typeof e}function T(e){return Object.prototype.toString.call(e)}function M(e){return e<10?"0"+e.toString(10):e.toString(10)}e.exports.debuglog=function(t){if(v(a)&&(a=""),t=t.toUpperCase(),!s[t])if(new RegExp("\\b"+t+"\\b","i").test(a)){var r=n.pid;s[t]=function(){var n=e.exports.format.apply(e.exports,arguments);console.error("%s %d: %s",t,r,n)}}else s[t]=function(){};return s[t]},e.exports.inspect=u,u.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},u.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.exports.isArray=p,e.exports.isBoolean=m,e.exports.isNull=y,e.exports.isNullOrUndefined=function(e){return null==e},e.exports.isNumber=g,e.exports.isString=b,e.exports.isSymbol=function(e){return"symbol"==typeof e},e.exports.isUndefined=v,e.exports.isRegExp=w,e.exports.isObject=_,e.exports.isDate=E,e.exports.isError=S,e.exports.isFunction=x,e.exports.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},e.exports.isBuffer=o("7TaTW");var A=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function R(){var e=new Date,t=[M(e.getHours()),M(e.getMinutes()),M(e.getSeconds())].join(":");return[e.getDate(),A[e.getMonth()],t].join(" ")}function I(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports.log=function(){console.log("%s - %s",R(),e.exports.format.apply(e.exports,arguments))},e.exports.inherits=o("gbBaF"),e.exports._extend=function(e,t){if(!t||!_(t))return e;for(var n=Object.keys(t),r=n.length;r--;)e[n[r]]=t[n[r]];return e};var P="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function N(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}e.exports.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(P&&e[P]){var t;if("function"!=typeof(t=e[P]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,r=new Promise((function(e,r){t=e,n=r})),i=[],o=0;o<arguments.length;o++)i.push(arguments[o]);i.push((function(e,r){e?n(e):t(r)}));try{e.apply(this,i)}catch(e){n(e)}return r}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),P&&Object.defineProperty(t,P,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,r(e))},e.exports.promisify.custom=P,e.exports.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function t(){for(var t=[],r=0;r<arguments.length;r++)t.push(arguments[r]);var i=t.pop();if("function"!=typeof i)throw new TypeError("The last argument must be of type Function");var o=this,a=function(){return i.apply(o,arguments)};e.apply(this,t).then((function(e){n.nextTick(a,null,e)}),(function(e){n.nextTick(N,e,a)}))}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),Object.defineProperties(t,r(e)),t}})),o.register("7TaTW",(function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}})),o.register("gbBaF",(function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}})),o.register("1U2aA",(function(e,t){var n=o("150uq").Buffer;Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.BarretenbergWasm=e.exports.fetchCode=void 0;var r=o("kOtop");const i=l(o("2vGx5"));var a=o("cC4OV");const s=l(o("7LjTn"));var u=o("1vwiL");async function c(){if(i.default)return await(0,o("7IjzK").promisify)(r.readFile)("../barretenberg.js/dest/wasm/barretenberg.wasm");{const e=await fetch("/barretenberg.wasm");return n.from(await e.arrayBuffer())}}a.EventEmitter.defaultMaxListeners=30,e.exports.fetchCode=c;class f extends a.EventEmitter{constructor(){super(),this.mutexQ=new Te.MemoryFifo,this.mutexQ.put(!0)}static async new(e="wasm",t){const n=new f;return n.on("log",(0,s.default)(`bb:${e}`)),await n.init(void 0,t),n}async init(e,t=256){this.emit("log",`intial mem: ${t}`),this.memory=new WebAssembly.Memory({initial:t,maximum:65536}),this.heap=new Uint8Array(this.memory.buffer);const n={wasi_snapshot_preview1:{environ_get:()=>{},environ_sizes_get:()=>{},fd_close:()=>{},fd_read:()=>{},fd_write:()=>{},fd_seek:()=>{},fd_fdstat_get:()=>{},fd_fdstat_set_flags:()=>{},path_open:()=>{},path_filestat_get:()=>{},proc_exit:()=>{},random_get:(e,t)=>{e>>>=0;const n=new Uint8Array(this.memory.buffer),r=(0,u.randomBytes)(t);for(let i=e;i<e+t;++i)n[i]=r[i-e]}},module:{},env:{logstr:e=>{e>>>=0;const t=this.getMemory();let n=e;for(;0!==t[n];++n);const r=`${(i.default?new(o("7IjzK").TextDecoder):new TextDecoder).decode(t.slice(e,n))} (mem:${t.length})`;this.emit("log",r)},memory:this.memory}};if(e)this.instance=await WebAssembly.instantiate(e,n),this.module=e;else{const{instance:e,module:t}=await WebAssembly.instantiate(await c(),n);this.instance=e,this.module=t}}exports(){return this.instance.exports}call(e,...t){if(!this.exports()[e])throw new Error(`WASM function ${e} not found.`);try{return this.exports()[e](...t)>>>0}catch(t){const n=`WASM function ${e} aborted, error: ${t}`;throw this.emit("log",n),new Error(n)}}getMemory(){return 0===this.heap.length?new Uint8Array(this.memory.buffer):this.heap}sliceMemory(e,t){return this.getMemory().slice(e,t)}transferToHeap(e,t){const n=this.getMemory();for(let r=0;r<e.length;r++)n[r+t]=e[r]}async acquire(){await this.mutexQ.get()}release(){if(0!==this.mutexQ.length())throw new Error("Release called but not acquired.");this.mutexQ.put(!0)}}e.exports.BarretenbergWasm=f})),o.register("eaYik",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.WorkerPool=void 0;const n=l(o("7LjTn"));var r=o("g389p");const i=(0,n.default)("bb:worker_pool");class a{constructor(){this.workers=[]}static async new(e,t){const n=new a;return await n.init(e.module,t),n}async init(e,t){i(`creating ${t} workers...`);const n=(new Date).getTime();this.workers=await Promise.all(Array(t).fill(0).map(((t,n)=>(0,r.createWorker)(`${n}`,e,0===n?1e4:256)))),i(`created workers: ${(new Date).getTime()-n}ms`)}async destroy(){await Promise.all(this.workers.map(r.destroyWorker))}}e.exports.WorkerPool=a})),o.register("g389p",(function(e,t){Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.destroyWorker=e.exports.createWorker=void 0;var n=o("iQTyO"),r=o("kMf2L"),i=o("fVCHJ");const a=l(o("7LjTn"));e.exports.createWorker=async function(e,t,i){const o=(0,a.default)("bb:wasm"+(e?":"+e:"")),s=await(0,n.spawn)(new r.Worker("./worker.js"));return s.logs().subscribe(o),await s.init(t,i),s},e.exports.destroyWorker=async function(e){await i.Thread.terminate(e)}})),o.register("9oHsE",(function(t,n){var r,i;e(t.exports,"Buffer",(()=>r),(e=>r=e)),e(t.exports,"INSPECT_MAX_BYTES",(()=>i),(e=>i=e));const o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;r=u,i=50;const a=2147483647;function s(e){if(e>a)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,u.prototype),t}function u(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return f(e)}return c(e,t,n)}function c(e,t,n){if("string"==typeof e)return function(e,t){"string"==typeof t&&""!==t||(t="utf8");if(!u.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|m(e,t);let r=s(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(X(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return h(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,ArrayBuffer)||e&&X(e.buffer,ArrayBuffer))return d(e,t,n);if("undefined"!=typeof SharedArrayBuffer&&(X(e,SharedArrayBuffer)||e&&X(e.buffer,SharedArrayBuffer)))return d(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return u.from(r,t,n);const i=function(e){if(u.isBuffer(e)){const t=0|p(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!=typeof e.length||ee(e.length)?s(0):h(e);if("Buffer"===e.type&&Array.isArray(e.data))return h(e.data)}(e);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return u.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function f(e){return l(e),s(e<0?0:0|p(e))}function h(e){const t=e.length<0?0:0|p(e.length),n=s(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function d(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,u.prototype),r}function p(e){if(e>=a)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a.toString(16)+" bytes");return 0|e}function m(e,t){if(u.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||X(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return Z(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return $(e).length;default:if(i)return r?-1:Z(e).length;t=(""+t).toLowerCase(),i=!0}}function y(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return k(this,t,n);case"utf8":case"utf-8":return M(this,t,n);case"ascii":return R(this,t,n);case"latin1":case"binary":return N(this,t,n);case"base64":return T(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function b(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),ee(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:v(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):v(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(e,t,n,r,i){let o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){let r=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===u)return r*a}else-1!==r&&(o-=o-r),r=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){let n=!0;for(let r=0;r<u;r++)if(c(e,o+r)!==c(t,r)){n=!1;break}if(n)return o}return-1}function w(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=t.length;let a;for(r>o/2&&(r=o/2),a=0;a<r;++a){const r=parseInt(t.substr(2*a,2),16);if(ee(r))return a;e[n+a]=r}return a}function _(e,t,n,r){return Y(Z(t,e.length-n),e,n,r)}function E(e,t,n,r){return Y(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function S(e,t,n,r){return Y($(t),e,n,r)}function x(e,t,n,r){return Y(function(e,t){let n,r,i;const o=[];for(let a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function T(e,t,n){return 0===t&&n===e.length?P(e):P(e.slice(t,n))}function M(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let o=null,a=t>239?4:t>223?3:t>191?2:1;if(i+a<=n){let n,r,s,u;switch(a){case 1:t<128&&(o=t);break;case 2:n=e[i+1],128==(192&n)&&(u=(31&t)<<6|63&n,u>127&&(o=u));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(u=(15&t)<<12|(63&n)<<6|63&r,u>2047&&(u<55296||u>57343)&&(o=u));break;case 4:n=e[i+1],r=e[i+2],s=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&s)&&(u=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&s,u>65535&&u<1114112&&(o=u))}}null===o?(o=65533,a=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=a}return function(e){const t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=A));return n}(r)}u.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),u.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(e,t,n){return c(e,t,n)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},u.allocUnsafe=function(e){return f(e)},u.allocUnsafeSlow=function(e){return f(e)},u.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==u.prototype},u.compare=function(e,t){if(X(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=u.from(t,t.offset,t.byteLength)),!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=u.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(X(t,Uint8Array))i+t.length>r.length?(u.isBuffer(t)||(t=u.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!u.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},u.byteLength=m,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},u.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},u.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},u.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?M(this,0,e):y.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){let e="";const t=i;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"},o&&(u.prototype[o]=u.prototype.inspect),u.prototype.compare=function(e,t,n,r,i){if(X(e,Uint8Array)&&(e=u.from(e,e.offset,e.byteLength)),!u.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const s=Math.min(o,a),c=this.slice(r,i),l=e.slice(t,n);for(let e=0;e<s;++e)if(c[e]!==l[e]){o=c[e],a=l[e];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return b(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return b(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return w(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":case"latin1":case"binary":return E(this,e,t,n);case"base64":return S(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function R(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function N(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function k(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=te[e[r]];return i}function B(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function D(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function j(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function L(e,t,n,r,i){H(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,a>>=8,e[n++]=a,n}function q(e,t,n,r,i){H(t,r,i,e,n,7);let o=Number(t&BigInt(4294967295));e[n+7]=o,o>>=8,e[n+6]=o,o>>=8,e[n+5]=o,o>>=8,e[n+4]=o;let a=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=a,a>>=8,e[n+2]=a,a>>=8,e[n+1]=a,a>>=8,e[n]=a,n+8}function U(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function F(e,t,n,r,i){return t=+t,n>>>=0,i||U(e,0,n,4),C(e,t,n,r,23,4),n+4}function K(e,t,n,r,i){return t=+t,n>>>=0,i||U(e,0,n,8),C(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,u.prototype),r},u.prototype.readUintLE=u.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUintBE=u.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUint8=u.prototype.readUInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),this[e]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(e,t){return e>>>=0,t||D(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readBigUInt64LE=ne((function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Q(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),u.prototype.readBigUInt64BE=ne((function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Q(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),u.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=this[e],i=1,o=0;for(;++o<t&&(i*=256);)r+=this[e+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||D(e,t,this.length);let r=t,i=1,o=this[e+--r];for(;r>0&&(i*=256);)o+=this[e+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return e>>>=0,t||D(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){e>>>=0,t||D(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){e>>>=0,t||D(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return e>>>=0,t||D(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readBigInt64LE=ne((function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Q(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),u.prototype.readBigInt64BE=ne((function(e){G(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||Q(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),u.prototype.readFloatLE=function(e,t){return e>>>=0,t||D(e,4,this.length),O(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return e>>>=0,t||D(e,4,this.length),O(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return e>>>=0,t||D(e,8,this.length),O(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return e>>>=0,t||D(e,8,this.length),O(this,e,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){j(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){j(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUint8=u.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,255,0),this[t]=255&e,t+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigUInt64LE=ne((function(e,t=0){return L(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeBigUInt64BE=ne((function(e,t=0){return q(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);j(this,e,t,n,r-1,-r)}let i=0,o=1,a=0;for(this[t]=255&e;++i<n&&(o*=256);)e<0&&0===a&&0!==this[t+i-1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);j(this,e,t,n,r-1,-r)}let i=n-1,o=1,a=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===a&&0!==this[t+i+1]&&(a=1),this[t+i]=(e/o>>0)-a&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||j(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},u.prototype.writeBigInt64LE=ne((function(e,t=0){return L(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeBigInt64BE=ne((function(e,t=0){return q(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),u.prototype.writeFloatLE=function(e,t,n){return F(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return F(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return K(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return K(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(!u.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},u.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const o=u.isBuffer(e)?e:u.from(e,r),a=o.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=o[i%a]}return this};const V={};function z(e,t,n){V[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function W(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function H(e,t,n,r,i,o){if(e>n||e<t){const r="bigint"==typeof t?"n":"";let i;throw i=o>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new V.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){G(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||Q(t,e.length-(n+1))}(r,i,o)}function G(e,t){if("number"!=typeof e)throw new V.ERR_INVALID_ARG_TYPE(t,"number",e)}function Q(e,t,n){if(Math.floor(e)!==e)throw G(e,n),new V.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new V.ERR_BUFFER_OUT_OF_BOUNDS;throw new V.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}z("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),z("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),z("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=W(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=W(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const J=/[^+/0-9A-Za-z-_]/g;function Z(e,t){let n;t=t||1/0;const r=e.length;let i=null;const o=[];for(let a=0;a<r;++a){if(n=e.charCodeAt(a),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function $(e){return I(function(e){if((e=(e=e.split("=")[0]).trim().replace(J,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function Y(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function ee(e){return e!=e}const te=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function ne(e){return"undefined"==typeof BigInt?re:e}function re(){throw new Error("BigInt not supported")}})),o.register("eUcgX",(function(e,t){var n=o("j1UVA"),r=o("1w2yj"),i=o("1EBKZ").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function u(){this.init(),this._w=s,r.call(this,64,56)}function c(e){return e<<30|e>>>2}function l(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}n(u,r),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,u=0|this._e,f=0;f<16;++f)n[f]=e.readInt32BE(4*f);for(;f<80;++f)n[f]=n[f-3]^n[f-8]^n[f-14]^n[f-16];for(var h=0;h<80;++h){var d=~~(h/20),p=0|((t=r)<<5|t>>>27)+l(d,i,o,s)+u+n[h]+a[d];u=s,s=o,o=c(i),i=r,r=p}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0},u.prototype._hash=function(){var e=i.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=u})),o.register("1w2yj",(function(e,t){var n=o("1EBKZ").Buffer;function r(e,t){this._block=n.alloc(e),this._finalSize=t,this._blockSize=e,this._len=0}r.prototype.update=function(e,t){"string"==typeof e&&(t=t||"utf8",e=n.from(e,t));for(var r=this._block,i=this._blockSize,o=e.length,a=this._len,s=0;s<o;){for(var u=a%i,c=Math.min(o-s,i-u),l=0;l<c;l++)r[u+l]=e[s+l];s+=c,(a+=c)%i==0&&this._update(r)}return this._len+=o,this},r.prototype.digest=function(e){var t=this._len%this._blockSize;this._block[t]=128,this._block.fill(0,t+1),t>=this._finalSize&&(this._update(this._block),this._block.fill(0));var n=8*this._len;if(n<=4294967295)this._block.writeUInt32BE(n,this._blockSize-4);else{var r=(4294967295&n)>>>0,i=(n-r)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(r,this._blockSize-4)}this._update(this._block);var o=this._hash();return e?o.toString(e):o},r.prototype._update=function(){throw new Error("_update must be implemented by subclass")},e.exports=r})),o.register("4kV9u",(function(e,t){var n=o("j1UVA"),r=o("1w2yj"),i=o("1EBKZ").Buffer,a=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function u(){this.init(),this._w=s,r.call(this,64,56)}function c(e){return e<<5|e>>>27}function l(e){return e<<30|e>>>2}function f(e,t,n,r){return 0===e?t&n|~t&r:2===e?t&n|t&r|n&r:t^n^r}n(u,r),u.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this},u.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,u=0|this._e,h=0;h<16;++h)n[h]=e.readInt32BE(4*h);for(;h<80;++h)n[h]=(t=n[h-3]^n[h-8]^n[h-14]^n[h-16])<<1|t>>>31;for(var d=0;d<80;++d){var p=~~(d/20),m=c(r)+f(p,i,o,s)+u+n[d]+a[p]|0;u=s,s=o,o=l(i),i=r,r=m}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0},u.prototype._hash=function(){var e=i.allocUnsafe(20);return e.writeInt32BE(0|this._a,0),e.writeInt32BE(0|this._b,4),e.writeInt32BE(0|this._c,8),e.writeInt32BE(0|this._d,12),e.writeInt32BE(0|this._e,16),e},e.exports=u})),o.register("1jSvY",(function(e,t){var n=o("j1UVA"),r=o("tPXrs"),i=o("1w2yj"),a=o("1EBKZ").Buffer,s=new Array(64);function u(){this.init(),this._w=s,i.call(this,64,56)}n(u,r),u.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this},u.prototype._hash=function(){var e=a.allocUnsafe(28);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e},e.exports=u})),o.register("tPXrs",(function(e,t){var n=o("j1UVA"),r=o("1w2yj"),i=o("1EBKZ").Buffer,a=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],s=new Array(64);function u(){this.init(),this._w=s,r.call(this,64,56)}function c(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function f(e){return(e>>>2|e<<30)^(e>>>13|e<<19)^(e>>>22|e<<10)}function h(e){return(e>>>6|e<<26)^(e>>>11|e<<21)^(e>>>25|e<<7)}function d(e){return(e>>>7|e<<25)^(e>>>18|e<<14)^e>>>3}n(u,r),u.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this},u.prototype._update=function(e){for(var t,n=this._w,r=0|this._a,i=0|this._b,o=0|this._c,s=0|this._d,u=0|this._e,p=0|this._f,m=0|this._g,y=0|this._h,g=0;g<16;++g)n[g]=e.readInt32BE(4*g);for(;g<64;++g)n[g]=0|(((t=n[g-2])>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+n[g-7]+d(n[g-15])+n[g-16];for(var b=0;b<64;++b){var v=y+h(u)+c(u,p,m)+a[b]+n[b]|0,w=f(r)+l(r,i,o)|0;y=m,m=p,p=u,u=s+v|0,s=o,o=i,i=r,r=v+w|0}this._a=r+this._a|0,this._b=i+this._b|0,this._c=o+this._c|0,this._d=s+this._d|0,this._e=u+this._e|0,this._f=p+this._f|0,this._g=m+this._g|0,this._h=y+this._h|0},u.prototype._hash=function(){var e=i.allocUnsafe(32);return e.writeInt32BE(this._a,0),e.writeInt32BE(this._b,4),e.writeInt32BE(this._c,8),e.writeInt32BE(this._d,12),e.writeInt32BE(this._e,16),e.writeInt32BE(this._f,20),e.writeInt32BE(this._g,24),e.writeInt32BE(this._h,28),e},e.exports=u})),o.register("5m5ze",(function(e,t){var n=o("j1UVA"),r=o("42dds"),i=o("1w2yj"),a=o("1EBKZ").Buffer,s=new Array(160);function u(){this.init(),this._w=s,i.call(this,128,112)}n(u,r),u.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this},u.prototype._hash=function(){var e=a.allocUnsafe(48);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),e},e.exports=u})),o.register("42dds",(function(e,t){var n=o("j1UVA"),r=o("1w2yj"),i=o("1EBKZ").Buffer,a=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],s=new Array(160);function u(){this.init(),this._w=s,r.call(this,128,112)}function c(e,t,n){return n^e&(t^n)}function l(e,t,n){return e&t|n&(e|t)}function f(e,t){return(e>>>28|t<<4)^(t>>>2|e<<30)^(t>>>7|e<<25)}function h(e,t){return(e>>>14|t<<18)^(e>>>18|t<<14)^(t>>>9|e<<23)}function d(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^e>>>7}function p(e,t){return(e>>>1|t<<31)^(e>>>8|t<<24)^(e>>>7|t<<25)}function m(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^e>>>6}function y(e,t){return(e>>>19|t<<13)^(t>>>29|e<<3)^(e>>>6|t<<26)}function g(e,t){return e>>>0<t>>>0?1:0}n(u,r),u.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this},u.prototype._update=function(e){for(var t=this._w,n=0|this._ah,r=0|this._bh,i=0|this._ch,o=0|this._dh,s=0|this._eh,u=0|this._fh,b=0|this._gh,v=0|this._hh,w=0|this._al,_=0|this._bl,E=0|this._cl,S=0|this._dl,x=0|this._el,T=0|this._fl,M=0|this._gl,A=0|this._hl,R=0;R<32;R+=2)t[R]=e.readInt32BE(4*R),t[R+1]=e.readInt32BE(4*R+4);for(;R<160;R+=2){var I=t[R-30],P=t[R-30+1],N=d(I,P),O=p(P,I),C=m(I=t[R-4],P=t[R-4+1]),k=y(P,I),B=t[R-14],D=t[R-14+1],j=t[R-32],L=t[R-32+1],q=O+D|0,U=N+B+g(q,O)|0;U=(U=U+C+g(q=q+k|0,k)|0)+j+g(q=q+L|0,L)|0,t[R]=U,t[R+1]=q}for(var F=0;F<160;F+=2){U=t[F],q=t[F+1];var K=l(n,r,i),V=l(w,_,E),z=f(n,w),W=f(w,n),H=h(s,x),G=h(x,s),Q=a[F],J=a[F+1],Z=c(s,u,b),$=c(x,T,M),Y=A+G|0,X=v+H+g(Y,A)|0;X=(X=(X=X+Z+g(Y=Y+$|0,$)|0)+Q+g(Y=Y+J|0,J)|0)+U+g(Y=Y+q|0,q)|0;var ee=W+V|0,te=z+K+g(ee,W)|0;v=b,A=M,b=u,M=T,u=s,T=x,s=o+X+g(x=S+Y|0,S)|0,o=i,S=E,i=r,E=_,r=n,_=w,n=X+te+g(w=Y+ee|0,Y)|0}this._al=this._al+w|0,this._bl=this._bl+_|0,this._cl=this._cl+E|0,this._dl=this._dl+S|0,this._el=this._el+x|0,this._fl=this._fl+T|0,this._gl=this._gl+M|0,this._hl=this._hl+A|0,this._ah=this._ah+n+g(this._al,w)|0,this._bh=this._bh+r+g(this._bl,_)|0,this._ch=this._ch+i+g(this._cl,E)|0,this._dh=this._dh+o+g(this._dl,S)|0,this._eh=this._eh+s+g(this._el,x)|0,this._fh=this._fh+u+g(this._fl,T)|0,this._gh=this._gh+b+g(this._gl,M)|0,this._hh=this._hh+v+g(this._hl,A)|0},u.prototype._hash=function(){var e=i.allocUnsafe(64);function t(t,n,r){e.writeInt32BE(t,r),e.writeInt32BE(n,r+4)}return t(this._ah,this._al,0),t(this._bh,this._bl,8),t(this._ch,this._cl,16),t(this._dh,this._dl,24),t(this._eh,this._el,32),t(this._fh,this._fl,40),t(this._gh,this._gl,48),t(this._hh,this._hl,56),e},e.exports=u})),o.register("8iajb",(function(t,n){e(t.exports,"SelectQueryBuilder",(()=>h));var r=o("eMTs3"),i=o("j1eS8"),a=o("7ARel"),s=o("k9pWs"),u=o("5JSrj"),c=o("bIgDF"),l=o("5RI5I"),f=o("6RKZv"),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),t.prototype.getQuery=function(){var e=this.createComment();return e+=this.createSelectExpression(),e+=this.createJoinExpression(),e+=this.createWhereExpression(),e+=this.createGroupByExpression(),e+=this.createHavingExpression(),e+=this.createOrderByExpression(),e+=this.createLimitOffsetExpression(),e=(e+=this.createLockExpression()).trim(),this.expressionMap.subQuery&&(e="("+e+")"),e},t.prototype.subQuery=function(){var e=this.createQueryBuilder();return e.expressionMap.subQuery=!0,e.parentQueryBuilder=this,e},t.prototype.select=function(e,t){if(this.expressionMap.queryType="select",Array.isArray(e))this.expressionMap.selects=e.map((function(e){return{selection:e}}));else if(e instanceof Function){var n=e(this.subQuery());this.setParameters(n.getParameters()),this.expressionMap.selects.push({selection:n.getQuery(),aliasName:t})}else e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);return this},t.prototype.addSelect=function(e,t){if(!e)return this;if(Array.isArray(e))this.expressionMap.selects=this.expressionMap.selects.concat(e.map((function(e){return{selection:e}})));else if(e instanceof Function){var n=e(this.subQuery());this.setParameters(n.getParameters()),this.expressionMap.selects.push({selection:n.getQuery(),aliasName:t})}else e&&this.expressionMap.selects.push({selection:e,aliasName:t});return this},t.prototype.maxExecutionTime=function(e){return this.expressionMap.maxExecutionTime=e,this},t.prototype.distinct=function(e){return void 0===e&&(e=!0),this.expressionMap.selectDistinct=e,this},t.prototype.distinctOn=function(e){return this.expressionMap.selectDistinctOn=e,this},t.prototype.from=function(e,t){var n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this},t.prototype.addFrom=function(e,t){var n=this.createFromAlias(e,t);return this.expressionMap.mainAlias||this.expressionMap.setMainAlias(n),this},t.prototype.innerJoin=function(e,t,n,r){return this.join("INNER",e,t,n,r),this},t.prototype.leftJoin=function(e,t,n,r){return this.join("LEFT",e,t,n,r),this},t.prototype.innerJoinAndSelect=function(e,t,n,r){return this.addSelect(t),this.innerJoin(e,t,n,r),this},t.prototype.leftJoinAndSelect=function(e,t,n,r){return this.addSelect(t),this.leftJoin(e,t,n,r),this},t.prototype.innerJoinAndMapMany=function(e,t,n,r,i){return this.addSelect(n),this.join("INNER",t,n,r,i,e,!0),this},t.prototype.innerJoinAndMapOne=function(e,t,n,r,i){return this.addSelect(n),this.join("INNER",t,n,r,i,e,!1),this},t.prototype.leftJoinAndMapMany=function(e,t,n,r,i){return this.addSelect(n),this.join("LEFT",t,n,r,i,e,!0),this},t.prototype.leftJoinAndMapOne=function(e,t,n,r,i){return this.addSelect(n),this.join("LEFT",t,n,r,i,e,!1),this},t.prototype.loadRelationIdAndMap=function(e,t,n,r){var i=new a.RelationIdAttribute(this.expressionMap);return i.mapToProperty=e,i.relationName=t,"string"==typeof n&&(i.alias=n),n instanceof Object&&n.disableMixedMap&&(i.disableMixedMap=!0),i.queryBuilderFactory=r,this.expressionMap.relationIdAttributes.push(i),i.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:i.junctionAlias,metadata:i.relation.junctionEntityMetadata}),this},t.prototype.loadRelationCountAndMap=function(e,t,n,r){var i=new s.RelationCountAttribute(this.expressionMap);return i.mapToProperty=e,i.relationName=t,i.alias=n,i.queryBuilderFactory=r,this.expressionMap.relationCountAttributes.push(i),this.expressionMap.createAlias({type:"other",name:i.junctionAlias}),i.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"other",name:i.junctionAlias,metadata:i.relation.junctionEntityMetadata}),this},t.prototype.loadAllRelationIds=function(e){var t=this;return this.expressionMap.mainAlias.metadata.relations.forEach((function(n){void 0!==e&&void 0!==e.relations&&-1===e.relations.indexOf(n.propertyPath)||t.loadRelationIdAndMap(t.expressionMap.mainAlias.name+"."+n.propertyPath,t.expressionMap.mainAlias.name+"."+n.propertyPath,e)})),this},t.prototype.where=function(e,t){this.expressionMap.wheres=[];var n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this},t.prototype.andWhere=function(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this},t.prototype.orWhere=function(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this},t.prototype.whereInIds=function(e){return this.where(this.getWhereInIdsCondition(e))},t.prototype.andWhereInIds=function(e){return this.andWhere(this.getWhereInIdsCondition(e))},t.prototype.orWhereInIds=function(e){return this.orWhere(this.getWhereInIdsCondition(e))},t.prototype.having=function(e,t){return this.expressionMap.havings.push({type:"simple",condition:e}),t&&this.setParameters(t),this},t.prototype.andHaving=function(e,t){return this.expressionMap.havings.push({type:"and",condition:e}),t&&this.setParameters(t),this},t.prototype.orHaving=function(e,t){return this.expressionMap.havings.push({type:"or",condition:e}),t&&this.setParameters(t),this},t.prototype.groupBy=function(e){return this.expressionMap.groupBys=e?[e]:[],this},t.prototype.addGroupBy=function(e){return this.expressionMap.groupBys.push(e),this},t.prototype.orderBy=function(e,t,n){var r,i;if(void 0===t&&(t="ASC"),void 0!==t&&"ASC"!==t&&"DESC"!==t)throw new rt('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(void 0!==n&&"NULLS FIRST"!==n&&"NULLS LAST"!==n)throw new rt('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return this.expressionMap.orderBys=e?e instanceof Object?e:n?((r={})[e]={order:t,nulls:n},r):((i={})[e]=t,i):{},this},t.prototype.addOrderBy=function(e,t,n){if(void 0===t&&(t="ASC"),void 0!==t&&"ASC"!==t&&"DESC"!==t)throw new rt('SelectQueryBuilder.addOrderBy "order" can accept only "ASC" and "DESC" values.');if(void 0!==n&&"NULLS FIRST"!==n&&"NULLS LAST"!==n)throw new rt('SelectQueryBuilder.addOrderBy "nulls" can accept only "NULLS FIRST" and "NULLS LAST" values.');return this.expressionMap.orderBys[e]=n?{order:t,nulls:n}:t,this},t.prototype.limit=function(e){if(this.expressionMap.limit=this.normalizeNumber(e),void 0!==this.expressionMap.limit&&isNaN(this.expressionMap.limit))throw new rt('Provided "limit" value is not a number. Please provide a numeric value.');return this},t.prototype.offset=function(e){if(this.expressionMap.offset=this.normalizeNumber(e),void 0!==this.expressionMap.offset&&isNaN(this.expressionMap.offset))throw new rt('Provided "offset" value is not a number. Please provide a numeric value.');return this},t.prototype.take=function(e){if(this.expressionMap.take=this.normalizeNumber(e),void 0!==this.expressionMap.take&&isNaN(this.expressionMap.take))throw new rt('Provided "take" value is not a number. Please provide a numeric value.');return this},t.prototype.skip=function(e){if(this.expressionMap.skip=this.normalizeNumber(e),void 0!==this.expressionMap.skip&&isNaN(this.expressionMap.skip))throw new rt('Provided "skip" value is not a number. Please provide a numeric value.');return this},t.prototype.setLock=function(e,t,n){return this.expressionMap.lockMode=e,this.expressionMap.lockVersion=t,this.expressionMap.lockTables=n,this},t.prototype.withDeleted=function(){return this.expressionMap.withDeleted=!0,this},t.prototype.getRawOne=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return[4,this.getRawMany()];case 1:return[2,e.sent()[0]]}}))}))},t.prototype.getRawMany=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r;return Oe(this,(function(i){switch(i.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new st;this.expressionMap.queryEntity=!1,e=this.obtainQueryRunner(),t=!1,i.label=1;case 1:return i.trys.push([1,7,12,15]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:i.sent(),t=!0,i.label=3;case 3:return[4,this.loadRawResults(e)];case 4:return n=i.sent(),t?[4,e.commitTransaction()]:[3,6];case 5:i.sent(),i.label=6;case 6:return[2,n];case 7:if(r=i.sent(),!t)return[3,11];i.label=8;case 8:return i.trys.push([8,10,,11]),[4,e.rollbackTransaction()];case 9:return i.sent(),[3,11];case 10:return i.sent(),[3,11];case 11:throw r;case 12:return e===this.queryRunner?[3,14]:[4,e.release()];case 13:i.sent(),i.label=14;case 14:return[7];case 15:return[2]}}))}))},t.prototype.getRawAndEntities=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r;return Oe(this,(function(i){switch(i.label){case 0:e=this.obtainQueryRunner(),t=!1,i.label=1;case 1:return i.trys.push([1,7,12,15]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:i.sent(),t=!0,i.label=3;case 3:return this.expressionMap.queryEntity=!0,[4,this.executeEntitiesAndRawResults(e)];case 4:return n=i.sent(),t?[4,e.commitTransaction()]:[3,6];case 5:i.sent(),i.label=6;case 6:return[2,n];case 7:if(r=i.sent(),!t)return[3,11];i.label=8;case 8:return i.trys.push([8,10,,11]),[4,e.rollbackTransaction()];case 9:return i.sent(),[3,11];case 10:return i.sent(),[3,11];case 11:throw r;case 12:return e===this.queryRunner?[3,14]:[4,e.release()];case 13:i.sent(),i.label=14;case 14:return[7];case 15:return[2]}}))}))},t.prototype.getOne=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r;return Oe(this,(function(i){switch(i.label){case 0:return[4,this.getRawAndEntities()];case 1:if(e=i.sent(),(t=e.entities[0])&&"optimistic"===this.expressionMap.lockMode&&this.expressionMap.lockVersion)if(n=this.expressionMap.mainAlias.metadata,this.expressionMap.lockVersion instanceof Date){if((r=n.updateDateColumn.getEntityValue(t)).getTime()!==this.expressionMap.lockVersion.getTime())throw new at(n.name,this.expressionMap.lockVersion,r)}else if((r=n.versionColumn.getEntityValue(t))!==this.expressionMap.lockVersion)throw new at(n.name,this.expressionMap.lockVersion,r);return[2,t]}}))}))},t.prototype.getOneOrFail=function(){return Ne(this,void 0,void 0,(function(){var e;return Oe(this,(function(t){switch(t.label){case 0:return[4,this.getOne()];case 1:if(!(e=t.sent()))throw new _t(this.expressionMap.mainAlias.target,this);return[2,e]}}))}))},t.prototype.getMany=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new st;return[4,this.getRawAndEntities()];case 1:return[2,e.sent().entities]}}))}))},t.prototype.getCount=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r;return Oe(this,(function(i){switch(i.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new st;e=this.obtainQueryRunner(),t=!1,i.label=1;case 1:return i.trys.push([1,7,12,15]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:i.sent(),t=!0,i.label=3;case 3:return this.expressionMap.queryEntity=!1,[4,this.executeCountQuery(e)];case 4:return n=i.sent(),t?[4,e.commitTransaction()]:[3,6];case 5:i.sent(),i.label=6;case 6:return[2,n];case 7:if(r=i.sent(),!t)return[3,11];i.label=8;case 8:return i.trys.push([8,10,,11]),[4,e.rollbackTransaction()];case 9:return i.sent(),[3,11];case 10:return i.sent(),[3,11];case 11:throw r;case 12:return e===this.queryRunner?[3,14]:[4,e.release()];case 13:i.sent(),i.label=14;case 14:return[7];case 15:return[2]}}))}))},t.prototype.getManyAndCount=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:if("optimistic"===this.expressionMap.lockMode)throw new st;e=this.obtainQueryRunner(),t=!1,a.label=1;case 1:return a.trys.push([1,8,13,16]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:a.sent(),t=!0,a.label=3;case 3:return this.expressionMap.queryEntity=!0,[4,this.executeEntitiesAndRawResults(e)];case 4:return n=a.sent(),this.expressionMap.queryEntity=!1,[4,this.executeCountQuery(e)];case 5:return r=a.sent(),i=[n.entities,r],t?[4,e.commitTransaction()]:[3,7];case 6:a.sent(),a.label=7;case 7:return[2,i];case 8:if(o=a.sent(),!t)return[3,12];a.label=9;case 9:return a.trys.push([9,11,,12]),[4,e.rollbackTransaction()];case 10:return a.sent(),[3,12];case 11:return a.sent(),[3,12];case 12:throw o;case 13:return e===this.queryRunner?[3,15]:[4,e.release()];case 14:a.sent(),a.label=15;case 15:return[7];case 16:return[2]}}))}))},t.prototype.stream=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:this.expressionMap.queryEntity=!1,e=ke(this.getQueryAndParameters(),2),t=e[0],n=e[1],r=this.obtainQueryRunner(),i=!1,c.label=1;case 1:return c.trys.push([1,6,,11]),!0!==this.expressionMap.useTransaction||!1!==r.isTransactionActive?[3,3]:[4,r.startTransaction()];case 2:c.sent(),i=!0,c.label=3;case 3:return o=function(){if(r!==u.queryRunner)return r.release()},a=r.stream(t,n,o,o),i?[4,r.commitTransaction()]:[3,5];case 4:c.sent(),c.label=5;case 5:return[2,a];case 6:if(s=c.sent(),!i)return[3,10];c.label=7;case 7:return c.trys.push([7,9,,10]),[4,r.rollbackTransaction()];case 8:return c.sent(),[3,10];case 9:return c.sent(),[3,10];case 10:throw s;case 11:return[2]}}))}))},t.prototype.cache=function(e,t){return"boolean"==typeof e?this.expressionMap.cache=e:"number"==typeof e?(this.expressionMap.cache=!0,this.expressionMap.cacheDuration=e):"string"!=typeof e&&"number"!=typeof e||(this.expressionMap.cache=!0,this.expressionMap.cacheId=e),t&&(this.expressionMap.cacheDuration=t),this},t.prototype.setOption=function(e){return this.expressionMap.options.push(e),this},t.prototype.join=function(e,t,n,r,o,a,s){this.setParameters(o||{});var u=new i.JoinAttribute(this.connection,this.expressionMap);if(u.direction=e,u.mapToProperty=a,u.isMappingMany=s,u.entityOrProperty=t,u.condition=r||void 0,this.expressionMap.joinAttributes.push(u),u.metadata){if(u.metadata.deleteDateColumn&&!this.expressionMap.withDeleted){var c=n+"."+u.metadata.deleteDateColumn.propertyName+" IS NULL";u.condition=u.condition?" "+u.condition+" AND "+c:""+c}u.alias=this.expressionMap.createAlias({type:"join",name:n,metadata:u.metadata}),u.relation&&u.relation.junctionEntityMetadata&&this.expressionMap.createAlias({type:"join",name:u.junctionAlias,metadata:u.relation.junctionEntityMetadata})}else{var l="";if(t instanceof Function){var f=t(this.subQuery());this.setParameters(f.getParameters()),l=f.getQuery()}else l=t;var h=t instanceof Function||"("===t.substr(0,1)&&")"===t.substr(-1);u.alias=this.expressionMap.createAlias({type:"join",name:n,tablePath:!1===h?t:void 0,subQuery:!0===h?l:void 0})}},t.prototype.createSelectExpression=function(){var e=this;if(!this.expressionMap.mainAlias)throw new rt("Cannot build query because main alias is not set (call qb#from method)");var t=[],n=[];if(this.expressionMap.mainAlias.hasMetadata){var r=this.expressionMap.mainAlias.metadata;t.push.apply(t,Be([],ke(this.buildEscapedEntityColumnSelects(this.expressionMap.mainAlias.name,r)))),n.push.apply(n,Be([],ke(this.findEntityColumnSelects(this.expressionMap.mainAlias.name,r))))}this.expressionMap.joinAttributes.forEach((function(r){if(r.metadata)t.push.apply(t,Be([],ke(e.buildEscapedEntityColumnSelects(r.alias.name,r.metadata)))),n.push.apply(n,Be([],ke(e.findEntityColumnSelects(r.alias.name,r.metadata))));else if(e.expressionMap.selects.some((function(e){return e.selection===r.alias.name}))){t.push({selection:e.escape(r.alias.name)+".*"});var i=e.expressionMap.selects.find((function(e){return e.selection===r.alias.name}));n.push(i)}})),this.expressionMap.selects.filter((function(e){return-1===n.indexOf(e)})).forEach((function(n){return t.push({selection:e.replacePropertyNames(n.selection),aliasName:n.aliasName})})),0===t.length&&t.push({selection:"*"});var i="";if(this.connection.driver instanceof Ve)switch(this.expressionMap.lockMode){case"pessimistic_read":i=" WITH (HOLDLOCK, ROWLOCK)";break;case"pessimistic_write":i=" WITH (UPDLOCK, ROWLOCK)";break;case"dirty_read":i=" WITH (NOLOCK)"}var o=this.expressionMap.aliases.filter((function(e){return"from"===e.type&&(e.tablePath||e.subQuery)})).map((function(t){return t.subQuery?t.subQuery+" "+e.escape(t.name):e.getTableName(t.tablePath)+" "+e.escape(t.name)}));return this.createSelectDistinctExpression()+t.map((function(t){return t.selection+(t.aliasName?" AS "+e.escape(t.aliasName):"")})).join(", ")+" FROM "+o.join(", ")+i},t.prototype.createSelectDistinctExpression=function(){var e=this,t=this.expressionMap,n=t.selectDistinct,r=t.selectDistinctOn,i=t.maxExecutionTime,o=this.connection.driver,a="SELECT ";(i>0&&o instanceof We&&(a+="/*+ MAX_EXECUTION_TIME("+this.expressionMap.maxExecutionTime+") */ "),o instanceof Ue&&r.length>0)?a="SELECT DISTINCT ON ("+r.map((function(t){return e.replacePropertyNames(t)})).join(", ")+") ":n&&(a="SELECT DISTINCT ");return a},t.prototype.createJoinExpression=function(){var e=this;return this.expressionMap.joinAttributes.map((function(t){var n=t.relation,r=t.tablePath,i=t.alias.name,o=t.condition?" AND ("+t.condition+")":"",a=t.parentAlias;if(!a||!n){var s=t.alias.subQuery?t.alias.subQuery:e.getTableName(r);return" "+t.direction+" JOIN "+s+" "+e.escape(i)+(t.condition?" ON "+e.replacePropertyNames(t.condition):"")}if(n.isManyToOne||n.isOneToOneOwner){var u=n.joinColumns.map((function(e){return i+"."+e.referencedColumn.propertyPath+"="+a+"."+n.propertyPath+"."+e.referencedColumn.propertyPath})).join(" AND ");return" "+t.direction+" JOIN "+e.getTableName(r)+" "+e.escape(i)+" ON "+e.replacePropertyNames(u+o)}if(n.isOneToMany||n.isOneToOneNotOwner){u=n.inverseRelation.joinColumns.map((function(e){return"entity-child"===n.inverseEntityMetadata.tableType&&n.inverseEntityMetadata.discriminatorColumn&&(o+=" AND "+i+"."+n.inverseEntityMetadata.discriminatorColumn.databaseName+"='"+n.inverseEntityMetadata.discriminatorValue+"'"),i+"."+n.inverseRelation.propertyPath+"."+e.referencedColumn.propertyPath+"="+a+"."+e.referencedColumn.propertyPath})).join(" AND ");return" "+t.direction+" JOIN "+e.getTableName(r)+" "+e.escape(i)+" ON "+e.replacePropertyNames(u+o)}var c=n.junctionEntityMetadata.tablePath,l=t.junctionAlias,f="",h="";return n.isOwning?(f=n.joinColumns.map((function(e){return l+"."+e.propertyPath+"="+a+"."+e.referencedColumn.propertyPath})).join(" AND "),h=n.inverseJoinColumns.map((function(e){return i+"."+e.referencedColumn.propertyPath+"="+l+"."+e.propertyPath})).join(" AND ")):(f=n.inverseRelation.inverseJoinColumns.map((function(e){return l+"."+e.propertyPath+"="+a+"."+e.referencedColumn.propertyPath})).join(" AND "),h=n.inverseRelation.joinColumns.map((function(e){return i+"."+e.referencedColumn.propertyPath+"="+l+"."+e.propertyPath})).join(" AND "))," "+t.direction+" JOIN "+e.getTableName(c)+" "+e.escape(l)+" ON "+e.replacePropertyNames(f)+" "+t.direction+" JOIN "+e.getTableName(r)+" "+e.escape(i)+" ON "+e.replacePropertyNames(h+o)})).join(" ")},t.prototype.createGroupByExpression=function(){return this.expressionMap.groupBys&&this.expressionMap.groupBys.length?" GROUP BY "+this.replacePropertyNames(this.expressionMap.groupBys.join(", ")):""},t.prototype.createOrderByExpression=function(){var e=this,t=this.expressionMap.allOrderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map((function(n){return"string"==typeof t[n]?e.replacePropertyNames(n)+" "+t[n]:e.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls})).join(", "):""},t.prototype.createLimitOffsetExpression=function(){var e=this.expressionMap.offset,t=this.expressionMap.limit;if(e||t||0!==this.expressionMap.joinAttributes.length||(e=this.expressionMap.skip,t=this.expressionMap.take),this.connection.driver instanceof Ve){var n="";if((t||e)&&Object.keys(this.expressionMap.allOrderBys).length<=0&&(n=" ORDER BY (SELECT NULL)"),t&&e)return n+" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return n+" OFFSET 0 ROWS FETCH NEXT "+t+" ROWS ONLY";if(e)return n+" OFFSET "+e+" ROWS"}else if(this.connection.driver instanceof We||this.connection.driver instanceof Fe||this.connection.driver instanceof ze){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)throw new Zt}else if(this.connection.driver instanceof bn){if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" LIMIT -1 OFFSET "+e}else if(this.connection.driver instanceof He){if(t&&e)return" OFFSET "+e+" ROWS FETCH NEXT "+t+" ROWS ONLY";if(t)return" FETCH NEXT "+t+" ROWS ONLY";if(e)return" OFFSET "+e+" ROWS"}else{if(t&&e)return" LIMIT "+t+" OFFSET "+e;if(t)return" LIMIT "+t;if(e)return" OFFSET "+e}return""},t.prototype.createLockExpression=function(){var e=this.connection.driver,t="";if(this.expressionMap.lockTables){if(!(e instanceof Ue))throw new rt("Lock tables not supported in selected driver");if(this.expressionMap.lockTables.length<1)throw new rt("lockTables cannot be an empty array");t=" OF "+this.expressionMap.lockTables.join(", ")}switch(this.expressionMap.lockMode){case"pessimistic_read":if(e instanceof We||e instanceof Fe)return" LOCK IN SHARE MODE";if(e instanceof Ue)return" FOR SHARE"+t;if(e instanceof He)return" FOR UPDATE";if(e instanceof Ve)return"";throw new ht;case"pessimistic_write":if(e instanceof We||e instanceof Fe||e instanceof He)return" FOR UPDATE";if(e instanceof Ue)return" FOR UPDATE"+t;if(e instanceof Ve)return"";throw new ht;case"pessimistic_partial_write":if(e instanceof Ue)return" FOR UPDATE"+t+" SKIP LOCKED";if(e instanceof We)return" FOR UPDATE SKIP LOCKED";throw new ht;case"pessimistic_write_or_fail":if(e instanceof Ue)return" FOR UPDATE"+t+" NOWAIT";if(e instanceof We)return" FOR UPDATE NOWAIT";throw new ht;case"for_no_key_update":if(e instanceof Ue)return" FOR NO KEY UPDATE"+t;throw new ht;default:return""}},t.prototype.createHavingExpression=function(){var e=this;if(!this.expressionMap.havings||!this.expressionMap.havings.length)return"";var t=this.expressionMap.havings.map((function(t,n){switch(t.type){case"and":return(n>0?"AND ":"")+e.replacePropertyNames(t.condition);case"or":return(n>0?"OR ":"")+e.replacePropertyNames(t.condition);default:return e.replacePropertyNames(t.condition)}})).join(" ");return t.length?" HAVING "+t:""},t.prototype.buildEscapedEntityColumnSelects=function(e,t){var n=this,r=this.expressionMap.selects.some((function(t){return t.selection===e})),i=[];if(r&&i.push.apply(i,Be([],ke(t.columns.filter((function(e){return!0===e.isSelect}))))),i.push.apply(i,Be([],ke(t.columns.filter((function(t){return n.expressionMap.selects.some((function(n){return n.selection===e+"."+t.propertyPath}))}))))),0===i.length)return[];var o=this.expressionMap.queryEntity?t.primaryColumns.filter((function(e){return-1===i.indexOf(e)})):[];return Be(Be([],ke(i)),ke(o)).map((function(t){var i=n.expressionMap.selects.find((function(n){return n.selection===e+"."+t.propertyPath})),o=n.escape(e)+"."+n.escape(t.databaseName);if(-1!==n.connection.driver.spatialTypes.indexOf(t.type)){if(n.connection.driver instanceof We||n.connection.driver instanceof Fe)o=(n.connection.driver.options.legacySpatialSupport?"AsText":"ST_AsText")+"("+o+")";n.connection.driver instanceof Ue&&(o=t.precision?"ST_AsGeoJSON("+o+", "+t.precision+")::json":"ST_AsGeoJSON("+o+")::json"),n.connection.driver instanceof Ve&&(o+=".ToString()")}return{selection:o,aliasName:i&&i.aliasName?i.aliasName:nt.buildAlias(n.connection.driver,e,t.databaseName),virtual:i?!0===i.virtual:!r}}))},t.prototype.findEntityColumnSelects=function(e,t){var n=this.expressionMap.selects.find((function(t){return t.selection===e}));return n?[n]:this.expressionMap.selects.filter((function(n){return t.columns.some((function(t){return n.selection===e+"."+t.propertyPath}))}))},t.prototype.computeCountExpression=function(){var e=this,t=this.expressionMap.mainAlias.name,n=this.expressionMap.mainAlias.metadata.primaryColumns,r=this.escape(t);if(0===this.expressionMap.joinAttributes.length&&0===this.expressionMap.relationIdAttributes.length&&0===this.expressionMap.relationCountAttributes.length)return"COUNT(1)";if(this.connection.driver instanceof Ke||this.connection.driver instanceof Ue)return"COUNT(DISTINCT("+n.map((function(t){return r+"."+e.escape(t.databaseName)})).join(", ")+"))";if(this.connection.driver instanceof We)return"COUNT(DISTINCT "+n.map((function(t){return r+"."+e.escape(t.databaseName)})).join(", ")+")";if(this.connection.driver instanceof Ve){var i=n.map((function(t){return r+"."+e.escape(t.databaseName)})).join(", '|;|', ");return 1===n.length?"COUNT(DISTINCT("+i+"))":"COUNT(DISTINCT(CONCAT("+i+")))"}return"COUNT(DISTINCT("+n.map((function(t){return r+"."+e.escape(t.databaseName)})).join(" || '|;|' || ")+"))"},t.prototype.executeCountQuery=function(e){return Ne(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:return t=this.computeCountExpression(),[4,this.clone().orderBy().groupBy().offset(void 0).limit(void 0).skip(void 0).take(void 0).select(t,"cnt").setOption("disable-global-order").loadRawResults(e)];case 1:return(n=r.sent())&&n[0]&&n[0].cnt?[2,parseInt(n[0].cnt)]:[2,0]}}))}))},t.prototype.executeEntitiesAndRawResults=function(e){return Ne(this,void 0,void 0,(function(){var n,i,o,a,s,h,d,p,m,y,g,b,v,w,_,E,S,x,T,M=this;return Oe(this,(function(A){switch(A.label){case 0:if(!this.expressionMap.mainAlias)throw new rt('Alias is not set. Use "from" method to set an alias.');if(("pessimistic_read"===this.expressionMap.lockMode||"pessimistic_write"===this.expressionMap.lockMode||"pessimistic_partial_write"===this.expressionMap.lockMode||"pessimistic_write_or_fail"===this.expressionMap.lockMode||"for_no_key_update"===this.expressionMap.lockMode)&&!e.isTransactionActive)throw new it;if("optimistic"===this.expressionMap.lockMode&&!(n=this.expressionMap.mainAlias.metadata).versionColumn&&!n.updateDateColumn)throw new ot(n.name);return i=new u.RelationIdLoader(this.connection,e,this.expressionMap.relationIdAttributes),o=new l.RelationCountLoader(this.connection,e,this.expressionMap.relationCountAttributes),new c.RelationIdMetadataToAttributeTransformer(this.expressionMap).transform(),new f.RelationCountMetadataToAttributeTransformer(this.expressionMap).transform(),a=[],s=[],(this.expressionMap.skip||this.expressionMap.take)&&this.expressionMap.joinAttributes.length>0?(h=ke(this.createOrderByCombinedWithSelectExpression("distinctAlias"),2),d=h[0],p=h[1],m=this.expressionMap.mainAlias.metadata,y=this.expressionMap.mainAlias.name,g=m.primaryColumns.map((function(e){var t=M.escape("distinctAlias"),n=M.escape(nt.buildAlias(M.connection.driver,y,e.databaseName));return p[n]||(p[n]="ASC"),t+"."+n+' as "'+nt.buildAlias(M.connection.driver,"ids_"+y,e.databaseName)+'"'})),[4,new t(this.connection,e).select("DISTINCT "+g.join(", ")).addSelect(d).from("("+this.clone().orderBy().getQuery()+")","distinctAlias").offset(this.expressionMap.skip).limit(this.expressionMap.take).orderBy(p).cache(this.expressionMap.cache?this.expressionMap.cache:this.expressionMap.cacheId,this.expressionMap.cacheDuration).setParameters(this.getParameters()).setNativeParameters(this.expressionMap.nativeParameters).getRawMany()]):[3,4];case 1:return(a=A.sent()).length>0?(b="",v={},m.hasMultiplePrimaryKeys?b=a.map((function(e,t){return m.primaryColumns.map((function(n){var r="orm_distinct_ids_"+t+"_"+n.databaseName;return v[r]=e["ids_"+y+"_"+n.databaseName],y+"."+n.propertyPath+"=:"+r})).join(" AND ")})).join(" OR "):(w=nt.buildAlias(this.connection.driver,"ids_"+y,m.primaryColumns[0].databaseName),_=a.map((function(e){return e[w]})),_.every((function(e){return"number"==typeof e}))?b=y+"."+m.primaryColumns[0].propertyPath+" IN ("+_.join(", ")+")":(v.orm_distinct_ids=_,b=y+"."+m.primaryColumns[0].propertyPath+" IN (:...orm_distinct_ids)")),[4,this.clone().mergeExpressionMap({extraAppendedAndWhereCondition:b}).setParameters(v).loadRawResults(e)]):[3,3];case 2:a=A.sent(),A.label=3;case 3:return[3,6];case 4:return[4,this.loadRawResults(e)];case 5:a=A.sent(),A.label=6;case 6:return a.length>0?[4,i.load(a)]:[3,10];case 7:return E=A.sent(),[4,o.load(a)];case 8:return S=A.sent(),x=new r.RawSqlResultsToEntityTransformer(this.expressionMap,this.connection.driver,E,S,this.queryRunner),s=x.transform(a,this.expressionMap.mainAlias),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(T=new vn,e.broadcaster.broadcastLoadEventsForAll(T,this.expressionMap.mainAlias.metadata,s),T.promises.length>0?[4,Promise.all(T.promises)]:[3,10]):[3,10];case 9:A.sent(),A.label=10;case 10:return[2,{raw:a,entities:s}]}}))}))},t.prototype.createOrderByCombinedWithSelectExpression=function(e){var t=this,n=this.expressionMap.allOrderBys,r=Object.keys(n).map((function(n){if(-1!==n.indexOf(".")){var r=n.split("."),i=r[0],o=r.slice(1).join("."),a=t.expressionMap.findAliasByName(i).metadata.findColumnWithPropertyPath(o);return t.escape(e)+"."+t.escape(nt.buildAlias(t.connection.driver,i,a.databaseName))}return t.expressionMap.selects.find((function(e){return e.selection===n||e.aliasName===n}))?t.escape(e)+"."+n:""})).join(", "),i={};return Object.keys(n).forEach((function(r){if(-1!==r.indexOf(".")){var o=r.split("."),a=o[0],s=o.slice(1).join("."),u=t.expressionMap.findAliasByName(a).metadata.findColumnWithPropertyPath(s);i[t.escape(e)+"."+t.escape(nt.buildAlias(t.connection.driver,a,u.databaseName))]=n[r]}else t.expressionMap.selects.find((function(e){return e.selection===r||e.aliasName===r}))?i[t.escape(e)+"."+r]=n[r]:i[r]=n[r]})),[r,i]},t.prototype.loadRawResults=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l;return Oe(this,(function(f){switch(f.label){case 0:if(t=ke(this.getQueryAndParameters(),2),n=t[0],r=t[1],i=n+" -- PARAMETERS: "+JSON.stringify(r),o="object"==typeof this.connection.options.cache?this.connection.options.cache:{},a=void 0,s=!1,!this.connection.queryResultCache||!this.expressionMap.cache&&!o.alwaysEnabled)return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.connection.queryResultCache.getFromCache({identifier:this.expressionMap.cacheId,query:i,duration:this.expressionMap.cacheDuration||o.duration||1e3},e)];case 2:return(a=f.sent())&&!this.connection.queryResultCache.isExpired(a)?[2,JSON.parse(a.result)]:[3,4];case 3:if(u=f.sent(),!o.ignoreErrors)throw u;return s=!0,[3,4];case 4:return[4,e.query(n,r,!0)];case 5:if(c=f.sent(),s||!this.connection.queryResultCache||!this.expressionMap.cache&&!o.alwaysEnabled)return[3,9];f.label=6;case 6:return f.trys.push([6,8,,9]),[4,this.connection.queryResultCache.storeInCache({identifier:this.expressionMap.cacheId,query:i,time:(new Date).getTime(),duration:this.expressionMap.cacheDuration||o.duration||1e3,result:JSON.stringify(c.records)},a,e)];case 7:return f.sent(),[3,9];case 8:if(l=f.sent(),!o.ignoreErrors)throw l;return[3,9];case 9:return[2,c.records]}}))}))},t.prototype.mergeExpressionMap=function(e){return ut.assign(this.expressionMap,e),this},t.prototype.normalizeNumber=function(e){return"number"==typeof e||null==e?e:Number(e)},t.prototype.obtainQueryRunner=function(){return this.queryRunner||this.connection.createQueryRunner("slave")},t}(o("lawob").QueryBuilder)}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Me=function(e,t){return(Me=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function Ae(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}Me(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var Re=function(){return Re=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Re.apply(this,arguments)};function Ie(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a}function Pe(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function Ne(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(e){o(e)}}function s(e){try{u(r.throw(e))}catch(e){o(e)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function Oe(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o}Object.create;function Ce(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ke(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function Be(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}Object.create;var De=function(){},je=function(){},Le=function(){},qe=function(){},Ue=function(){},Fe=function(){},Ke=function(){},Ve=function(){},ze=function(){},We=function(){},He=function(){},Ge=function(){},Qe=function(){};o.register("eMTs3",(function(t,n){e(t.exports,"RawSqlResultsToEntityTransformer",(()=>i));var r=o("9oHsE").Buffer,i=function(){function e(e,t,n,r,i){this.expressionMap=e,this.driver=t,this.rawRelationIdResults=n,this.rawRelationCountResults=r,this.queryRunner=i}return e.prototype.transform=function(e,t){var n=this,r=this.group(e,t),i=[];return r.forEach((function(e){var r=n.transformRawResultsGroup(e,t);void 0===r||Object.values(r).every((function(e){return null===e}))||i.push(r)})),i},e.prototype.group=function(e,t){var n=this,i=new Map,o=[];return"view"===t.metadata.tableType?o.push.apply(o,Be([],ke(t.metadata.columns.map((function(e){return nt.buildAlias(n.driver,t.name,e.databaseName)}))))):o.push.apply(o,Be([],ke(t.metadata.primaryColumns.map((function(e){return nt.buildAlias(n.driver,t.name,e.databaseName)}))))),e.forEach((function(e){var t=o.map((function(t){var n=e[t];return r.isBuffer(n)?n.toString("hex"):"object"==typeof n?JSON.stringify(n):n})).join("_"),n=i.get(t);n?n.push(e):i.set(t,[e])})),i},e.prototype.transformRawResultsGroup=function(e,t){var n=this,r=t.metadata;if(r.discriminatorColumn){var i=e.map((function(e){return e[nt.buildAlias(n.driver,t.name,t.metadata.discriminatorColumn.databaseName)]})),o=r.childEntityMetadatas.find((function(e){return void 0!==i.find((function(t){return t===e.discriminatorValue}))}));o&&(r=o)}var a=-1!==this.expressionMap.options.indexOf("create-pojo")?{}:r.create(this.queryRunner,{fromDeserializer:!0}),s=this.transformColumns(e,t,a,r),u=this.transformJoins(e,a,t,r),c=this.transformRelationIds(e,t,a,r),l=this.transformRelationCounts(e,t,a);return s||0===r.primaryColumns.filter((function(e){return!1===e.isVirtual})).length&&(u||c||l)?a:void 0},e.prototype.transformColumns=function(e,t,n,r){var i=this,o=!1;return r.columns.forEach((function(a){if(!(r.childEntityMetadatas.length>0&&-1!==r.childEntityMetadatas.map((function(e){return e.target})).indexOf(a.target))){var s=e[0][nt.buildAlias(i.driver,t.name,a.databaseName)];void 0===s||a.isVirtual||i.expressionMap.selects.find((function(e){return e.selection===t.name||e.selection===t.name+"."+a.propertyPath}))&&(a.setEntityValue(n,i.driver.prepareHydratedValue(s,a)),null!==s&&(o=!0))}})),o},e.prototype.transformJoins=function(e,t,n,r){var i=this,o=!1;return this.expressionMap.joinAttributes.forEach((function(a){if(a.metadata&&a.isSelected){if(a.relation){var s=r.relations.find((function(e){return e.propertyPath===a.relation.propertyPath}));if(!s)return;s.inverseEntityMetadata&&(a.alias.metadata=s.inverseEntityMetadata)}if(a.mapToProperty){if(a.mapToPropertyParentAlias!==n.name)return}else if(!a.relation||a.parentAlias!==n.name||a.relationPropertyPath!==a.relation.propertyPath)return;var u=i.transform(e,a.alias);u=a.isMany?u:u[0],void 0!==(u=a.isMany||void 0!==u?u:null)&&(a.mapToPropertyPropertyName?t[a.mapToPropertyPropertyName]=u:a.relation.setEntityValue(t,u),o=!0)}})),o},e.prototype.transformRelationIds=function(e,t,n,r){var i=this,o=!1;return this.rawRelationIdResults.forEach((function(r){if(r.relationIdAttribute.parentAlias===t.name){var a=r.relationIdAttribute.relation,s=i.createValueMapFromJoinColumns(a,r.relationIdAttribute.parentAlias,e);if(null!=s){var u=r.results.map((function(e){var t=i.extractEntityPrimaryIds(a,e);if(!1!==Ze.compareIds(t,s)){var n,o=(n=a.isManyToOne||a.isOneToOneOwner?a.joinColumns.map((function(e){return e})):a.isOneToMany||a.isOneToOneNotOwner?a.inverseEntityMetadata.primaryColumns.map((function(e){return e})):a.isOwning?a.inverseJoinColumns.map((function(e){return e})):a.inverseRelation.joinColumns.map((function(e){return e}))).reduce((function(t,n){var r=e[n.databaseName];return a.isOneToMany||a.isOneToOneNotOwner?(n.isVirtual&&n.referencedColumn&&n.referencedColumn.propertyName!==n.propertyName&&(r=n.referencedColumn.createValueMap(r)),Ze.mergeDeep(t,n.createValueMap(r))):(n.referencedColumn.referencedColumn&&(r=n.referencedColumn.referencedColumn.createValueMap(r)),Ze.mergeDeep(t,n.referencedColumn.createValueMap(r)))}),{});return 1===n.length&&!1===r.relationIdAttribute.disableMixedMap?a.isOneToMany||a.isOneToOneNotOwner?n[0].getEntityValue(o):n[0].referencedColumn.getEntityValue(o):o}})).filter((function(e){return void 0!==e})),c=r.relationIdAttribute.mapToPropertyPropertyPath.split("."),l=function(e,t,n){var r=e.shift();return r&&0===e.length?(t[r]=n,t):r&&e.length>0?void l(e,t[r],n):t};a.isOneToOne||a.isManyToOne?void 0!==u[0]&&(l(c,n,u[0]),o=!0):(l(c,n,u),u.length>0&&(o=!0))}}})),o},e.prototype.transformRelationCounts=function(e,t,n){var r=this,i=!1;return this.rawRelationCountResults.filter((function(e){return e.relationCountAttribute.parentAlias===t.name})).forEach((function(o){var a,s=o.relationCountAttribute.relation;a=s.isOneToMany?s.inverseRelation.joinColumns[0].referencedColumn.databaseName:s.isOwning?s.joinColumns[0].referencedColumn.databaseName:s.inverseRelation.joinColumns[0].referencedColumn.databaseName;var u=e[0][nt.buildAlias(r.driver,t.name,a)];null!=u&&(n[o.relationCountAttribute.mapToPropertyPropertyName]=0,o.results.filter((function(e){return e.parentId===u})).forEach((function(e){n[o.relationCountAttribute.mapToPropertyPropertyName]=parseInt(e.cnt),i=!0})))})),i},e.prototype.createValueMapFromJoinColumns=function(e,t,n){var r=this;return(e.isManyToOne||e.isOneToOneOwner?e.entityMetadata.primaryColumns.map((function(e){return e})):e.isOneToMany||e.isOneToOneNotOwner?e.inverseRelation.joinColumns.map((function(e){return e})):e.isOwning?e.joinColumns.map((function(e){return e})):e.inverseRelation.inverseJoinColumns.map((function(e){return e}))).reduce((function(i,o){return n.forEach((function(n){e.isManyToOne||e.isOneToOneOwner?i[o.databaseName]=r.driver.prepareHydratedValue(n[nt.buildAlias(r.driver,t,o.databaseName)],o):i[o.databaseName]=r.driver.prepareHydratedValue(n[nt.buildAlias(r.driver,t,o.referencedColumn.databaseName)],o)})),i}),{})},e.prototype.extractEntityPrimaryIds=function(e,t){return(e.isManyToOne||e.isOneToOneOwner?e.entityMetadata.primaryColumns.map((function(e){return e})):e.isOneToMany||e.isOneToOneNotOwner?e.inverseRelation.joinColumns.map((function(e){return e})):e.isOwning?e.joinColumns.map((function(e){return e})):e.inverseRelation.inverseJoinColumns.map((function(e){return e}))).reduce((function(e,n){return e[n.databaseName]=t[n.databaseName],e}),{})},e}()}));var Je,Ze=function(){function e(){}return e.chunk=function(e,t){return Array.from(Array(Math.ceil(e.length/t)),(function(n,r){return e.slice(r*t,r*t+t)}))},e.splitClassesAndStrings=function(e){return[e.filter((function(e){return"string"!=typeof e})),e.filter((function(e){return"string"==typeof e}))]},e.groupBy=function(e,t){return e.reduce((function(e,n){var r=t(n),i=e.find((function(e){return e.id===r}));return i||(i={id:r,items:[]},e.push(i)),i.items.push(n),e}),[])},e.uniq=function(e,t){return e.reduce((function(e,n){var r=!1;if(t instanceof Function){var i=t(n);r=!!e.find((function(e){return t(e)===i}))}else r="string"==typeof t?!!e.find((function(e){return e[t]===n[t]})):-1!==e.indexOf(n);return r||e.push(n),e}),[])},e.isPlainObject=function(e){return null!=e&&(!e.constructor||e.constructor===Object)},e.mergeArrayKey=function(e,t,n,r){r.has(n)?e[t]=r.get(n):n instanceof Promise||(this.isPlainObject(n)||Array.isArray(n)?(e[t]||(e[t]=Array.isArray(n)?[]:{}),r.set(n,e[t]),this.merge(e[t],n,r),r.delete(n)):e[t]=n)},e.mergeObjectKey=function(e,t,n,r){var i,o,a;r.has(n)?Object.assign(e,((i={})[t]=r.get(n),i)):n instanceof Promise||(this.isPlainObject(n)||Array.isArray(n)?(e[t]||Object.assign(e,((a={})[t]=Array.isArray(n)?[]:{},a)),r.set(n,e[t]),this.merge(e[t],n,r),r.delete(n)):Object.assign(e,((o={})[t]=n,o)))},e.merge=function(e,t,n){var r,i;if(void 0===n&&(n=new Map),this.isPlainObject(e)&&this.isPlainObject(t))try{for(var o=Ce(Object.keys(t)),a=o.next();!a.done;a=o.next()){var s=a.value;this.mergeObjectKey(e,s,t[s],n)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}if(Array.isArray(e)&&Array.isArray(t))for(s=0;s<t.length;s++)this.mergeArrayKey(e,s,t[s],n)},e.mergeDeep=function(t){for(var n,r,i=[],o=1;o<arguments.length;o++)i[o-1]=arguments[o];if(!i.length)return t;try{for(var a=Ce(i),s=a.next();!s.done;s=a.next()){var u=s.value;e.merge(t,u)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return t},e.deepCompare=function(){for(var e,t,n,r,i=[],o=0;o<arguments.length;o++)i[o]=arguments[o];if(arguments.length<1)return!0;for(e=1,t=arguments.length;e<t;e++)if(n=[],r=[],!this.compare2Objects(n,r,arguments[0],arguments[e]))return!1;return!0},e.compareIds=function(t,n){return null!=t&&null!=n&&(("string"==typeof t.id&&"string"==typeof n.id||"number"==typeof t.id&&"number"==typeof n.id)&&1===Object.keys(t).length&&1===Object.keys(n).length?t.id===n.id:e.deepCompare(t,n))},e.toBoolean=function(e){return"boolean"==typeof e?e:"string"==typeof e?"true"===e||"1"===e:"number"==typeof e&&e>0},e.zipObject=function(e,t){return e.reduce((function(e,n,r){return e[n]=t[r],e}),{})},e.isArraysEqual=function(e,t){return e.length===t.length&&e.every((function(e){return-1!==t.indexOf(e)}))},e.compare2Objects=function(e,t,n,r){var i;if(Number.isNaN(n)&&Number.isNaN(r))return!0;if(n===r)return!0;if(null===n||null===r||void 0===n||void 0===r)return!1;if(("function"==typeof n.equals||n.equals instanceof Function)&&n.equals(r))return!0;if("function"==typeof n&&"function"==typeof r||n instanceof Date&&r instanceof Date||n instanceof RegExp&&r instanceof RegExp||n instanceof String&&r instanceof String||n instanceof Number&&r instanceof Number)return n.toString()===r.toString();if(!(n instanceof Object&&r instanceof Object))return!1;if(n.isPrototypeOf(r)||r.isPrototypeOf(n))return!1;if(n.constructor!==r.constructor)return!1;if(n.prototype!==r.prototype)return!1;if(e.indexOf(n)>-1||t.indexOf(r)>-1)return!1;for(i in r){if(r.hasOwnProperty(i)!==n.hasOwnProperty(i))return!1;if(typeof r[i]!=typeof n[i])return!1}for(i in n){if(r.hasOwnProperty(i)!==n.hasOwnProperty(i))return!1;if(typeof r[i]!=typeof n[i])return!1;switch(typeof n[i]){case"object":case"function":if(e.push(n),t.push(r),!this.compare2Objects(e,t,n[i],r[i]))return!1;e.pop(),t.pop();break;default:if(n[i]!==r[i])return!1}}return!0},e}(),$e=Je=function(e){e=e.toLowerCase();var t=$e[e];if(!t)throw new Error(e+" is not supported (we accept pull requests)");return new t};function Ye(e,t){return void 0===t&&(t=!1),e.replace(/^([A-Z])|[\s-_](\w)/g,(function(e,n,r,i){return!0===t&&0===i?n:r?r.toUpperCase():n.toLowerCase()}))}function Xe(e){return e.replace(/([A-Z])([A-Z])([a-z])/g,"$1_$2$3").replace(/([a-z0-9])([A-Z])/g,"$1_$2").toLowerCase()}function et(e,t){void 0===t&&(t={});var n=t.segmentLength,r=void 0===n?4:n,i=t.separator,o=void 0===i?"__":i,a=t.termLength,s=void 0===a?2:a;return e.split(o).reduce((function(e,t){var n=t.replace(/([a-z\xE0-\xFF])([A-Z\xC0-\xDF])/g,"$1 $2").split(" "),i=n.length>1?s:r,o=n.map((function(e){return e.substr(0,i)})).join("");return e.push(o),e}),[]).join(o)}function tt(e,t){void 0===t&&(t={});var r=n(Je)("sha256");r.update(e,"utf8");var i=r.digest("hex");return t.length?i.slice(0,t.length):i}$e.sha=o("eUcgX"),$e.sha1=o("4kV9u"),$e.sha224=o("1jSvY"),$e.sha256=o("tPXrs"),$e.sha384=o("5m5ze"),$e.sha512=o("42dds");var nt=function(){function e(){}return e.buildDriverOptions=function(e,t){var n,r;if(e.url){var i=this.parseConnectionUrl(e.url);t&&t.useSid&&i.database&&(i.sid=i.database);try{for(var o=Ce(Object.keys(i)),a=o.next();!a.done;a=o.next()){var s=a.value;void 0===i[s]&&delete i[s]}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return Object.assign({},e,i)}return Object.assign({},e)},e.buildMongoDBDriverOptions=function(e,t){var n,r;if(e.url){var i=this.parseMongoDBConnectionUrl(e.url);t&&t.useSid&&i.database&&(i.sid=i.database);try{for(var o=Ce(Object.keys(i)),a=o.next();!a.done;a=o.next()){var s=a.value;void 0===i[s]&&delete i[s]}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return Object.assign({},e,i)}return Object.assign({},e)},e.buildAlias=function(e,t){for(var n=e.maxAliasLength,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];"string"==typeof t?(r.unshift(t),t={shorten:!1,joiner:"_"}):t=Object.assign({shorten:!1,joiner:"_"},t);var o=1===r.length?r[0]:r.join(t.joiner);if(n&&n>0&&o.length>n){if(!0===t.shorten){var a=et(o);if(a.length<n)return a}return tt(o,{length:n})}return o},e.buildColumnAlias=function(e,t){for(var n=e.maxAliasLength,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return this.buildAlias.apply(this,Be([{maxAliasLength:n},t],ke(r)))},e.parseConnectionUrl=function(e){var t=e.split(":")[0],n=e.indexOf("//"),r=e.substr(n+2),i=r.indexOf("/"),o=-1!==i?r.substr(0,i):r,a=-1!==i?r.substr(i+1):void 0;a&&-1!==a.indexOf("?")&&(a=a.substr(0,a.indexOf("?")));var s=o.lastIndexOf("@"),u=o.substr(0,s),c=o.substr(s+1),l=u,f="",h=u.indexOf(":");-1!==h&&(l=u.substr(0,h),f=u.substr(h+1));var d=ke(c.split(":"),2),p=d[0],m=d[1];return{type:t,host:p,username:decodeURIComponent(l),password:decodeURIComponent(f),port:m?parseInt(m):void 0,database:a||void 0}},e.parseMongoDBConnectionUrl=function(e){var t,n,r,i,o,a=e.split(":")[0],s=e.indexOf("//"),u=e.substr(s+2),c=u.indexOf("/"),l=-1!==c?u.substr(0,c):u,f=-1!==c?u.substr(c+1):void 0,h=void 0,d=void 0,p=void 0,m=void 0,y={};f&&-1!==f.indexOf("?")&&(f.substr(f.indexOf("?")+1,f.length).split("&").forEach((function(e){i=e.split("=")[0],o=e.split("=")[1],y[i]=o})),m=y.replicaSet,f=f.substr(0,f.indexOf("?")));var g=l.lastIndexOf("@"),b=l.substr(0,g),v=l.substr(g+1),w=b,_="",E=b.indexOf(":");-1!==E&&(w=b.substr(0,E),_=b.substr(E+1)),m?p=v:(h=(t=ke(v.split(":"),2))[0],d=t[1]);var S={type:a,host:h,hostReplicaSet:p,username:decodeURIComponent(w),password:decodeURIComponent(_),port:d?parseInt(d):void 0,database:f||void 0};try{for(var x=Ce(Object.entries(y)),T=x.next();!T.done;T=x.next()){var M=ke(T.value,2),A=M[0],R=M[1];S[A]=R}}catch(e){n={error:e}}finally{try{T&&!T.done&&(r=x.return)&&r.call(x)}finally{if(n)throw n.error}}return S},e}(),rt=function(e){function t(t){var n=this.constructor,r=e.call(this,t)||this;return Object.setPrototypeOf?Object.setPrototypeOf(r,n.prototype):r.__proto__=n.prototype,r}return Ae(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this.constructor.name},enumerable:!1,configurable:!0}),t}(Error),it=function(e){function t(){return e.call(this,"An open transaction is required for pessimistic lock.")||this}return Ae(t,e),t}(rt),ot=function(e){function t(t){return e.call(this,"Entity "+t+" does not have version or update date columns.")||this}return Ae(t,e),t}(rt),at=function(e){function t(t,n,r){return e.call(this,"The optimistic lock on entity "+t+" failed, version "+n+" was expected, but is actually "+r+".")||this}return Ae(t,e),t}(rt),st=function(e){function t(){return e.call(this,"The optimistic lock can be used only with getOne() method.")||this}return Ae(t,e),t}(rt);o.register("j1eS8",(function(t,n){e(t.exports,"JoinAttribute",(()=>i));var r=o("2A1j4"),i=function(){function e(e,t,n){this.connection=e,this.queryExpressionMap=t,this.isSelectedEvaluated=!1,this.relationEvaluated=!1,ut.assign(this,n||{})}return Object.defineProperty(e.prototype,"isMany",{get:function(){return void 0!==this.isMappingMany?this.isMappingMany:!!this.relation&&(this.relation.isManyToMany||this.relation.isOneToMany)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isSelected",{get:function(){var e=this;if(!this.isSelectedEvaluated){this.isSelectedCache=function(){var t,n,r=function(t){return t.selection===e.alias.name||e.metadata&&e.metadata.columns.find((function(n){return t.selection===e.alias.name+"."+n.propertyPath}))?{value:!0}:void 0};try{for(var i=Ce(e.queryExpressionMap.selects),o=i.next();!o.done;o=i.next()){var a=r(o.value);if("object"==typeof a)return a.value}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return!1}(),this.isSelectedEvaluated=!0}return this.isSelectedCache},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tablePath",{get:function(){return this.metadata?this.metadata.tablePath:this.entityOrProperty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentAlias",{get:function(){if(r.QueryBuilderUtils.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(0,this.entityOrProperty.indexOf("."))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relationPropertyPath",{get:function(){if(r.QueryBuilderUtils.isAliasProperty(this.entityOrProperty))return this.entityOrProperty.substr(this.entityOrProperty.indexOf(".")+1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relation",{get:function(){var e=this;if(!this.relationEvaluated){this.relationCache=function(){if(r.QueryBuilderUtils.isAliasProperty(e.entityOrProperty)){var t=e.queryExpressionMap.findAliasByName(e.parentAlias),n=t.metadata.findRelationWithPropertyPath(e.relationPropertyPath);if(n)return n;if(t.metadata.parentEntityMetadata&&(n=t.metadata.parentEntityMetadata.findRelationWithPropertyPath(e.relationPropertyPath)))return n;throw new rt("Relation with property path "+e.relationPropertyPath+" in entity was not found.")}}.bind(this)(),this.relationEvaluated=!0}return this.relationCache},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this.relation?this.relation.inverseEntityMetadata:this.connection.hasMetadata(this.entityOrProperty)?this.connection.getMetadata(this.entityOrProperty):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"junctionAlias",{get:function(){if(!this.relation)throw new rt("Cannot get junction table for join without relation.");return this.relation.isOwning?this.parentAlias+"_"+this.alias.name:this.alias.name+"_"+this.parentAlias},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyParentAlias",{get:function(){if(this.mapToProperty)return this.mapToProperty.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyPropertyName",{get:function(){if(this.mapToProperty)return this.mapToProperty.split(".")[1]},enumerable:!1,configurable:!0}),e}()})),o.register("2A1j4",(function(t,n){e(t.exports,"QueryBuilderUtils",(()=>r));var r=function(){function e(){}return e.isAliasProperty=function(e){if("string"!=typeof e||-1===e.indexOf("."))return!1;var t=ke(e.split("."),2),n=t[0],r=t[1];return!(!n||!r)&&(-1===e.indexOf("(")&&-1===e.indexOf(")"))},e}()}));var ut=function(){function e(){}return e.assign=function(e){for(var t,n,r,i,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];try{for(var s=Ce(o),u=s.next();!u.done;u=s.next()){var c=u.value;try{for(var l=(r=void 0,Ce(Object.getOwnPropertyNames(c))),f=l.next();!f.done;f=l.next()){var h=f.value;e[h]=c[h]}}catch(e){r={error:e}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}},e}(),ct=(function(e){function t(t,n){return e.call(this,'Cannot get reflected type for a "'+n+'" method\'s parameter of "'+t.name+'" class. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application.')||this}Ae(t,e)}(rt),function(e){function t(t){return e.call(this,'Cannot create a new connection named "'+t+'", because connection with such name already exist and it now has an active connection session.')||this}return Ae(t,e),t}(rt)),lt=function(e){function t(t){return e.call(this,"Internal error. Subject "+t.metadata.targetName+" must have an identifier to perform operation.")||this}return Ae(t,e),t}(rt),ft=function(e){function t(t){return e.call(this,'Cannot create a "'+t+'" connection because connection to the database already established.')||this}return Ae(t,e),t}(rt),ht=function(e){function t(){return e.call(this,"Locking not supported on given driver.")||this}return Ae(t,e),t}(rt),dt=(function(e){function t(t){return e.call(this,"Connection with "+t+" database is not established. Check connection configuration.")||this}Ae(t,e)}(rt),function(e){function t(t,n){var r=e.call(this)||this,i=t.primaryColumns.reduce((function(e,t,n){return t.setEntityValue(e,n+1),e}),{});return r.message='Cannot use given entity id "'+n+'" because "'+t.targetName+'" contains multiple primary columns, you must provide object in following form: '+JSON.stringify(i)+" as an id.",r}return Ae(t,e),t}(rt)),pt=(function(e){function t(t,n,r){return e.call(this,t+" metadata already exists for the class constructor "+JSON.stringify(n)+(r?" on property "+r:". If you previously renamed or moved entity class, make sure that compiled version of old entity class source wasn't left in the compiler output directory."))||this}Ae(t,e)}(rt),function(e){function t(t){return e.call(this,"Cannot "+t+", given value must be instance of entity class, instead object literal is given. Or you must specify an entity target to method call.")||this}return Ae(t,e),t}(rt)),mt=function(e){function t(){return e.call(this,'Cannot perform update query because update values are not defined. Call "qb.set(...)" method to specify updated values.')||this}return Ae(t,e),t}(rt),yt=function(e){function t(t){return e.call(this,"Tree repositories are not supported in "+t.options.type+" driver.")||this}return Ae(t,e),t}(rt),gt=function(e){function t(t){return e.call(this,"Custom repository "+(t instanceof Function?t.name:t.constructor.name)+" was not found. Did you forgot to put @EntityRepository decorator on it?")||this}return Ae(t,e),t}(rt),bt=function(e){function t(){return e.call(this,"Transaction is not started yet, start transaction before committing or rolling it back.")||this}return Ae(t,e),t}(rt),vt=function(e){function t(){return e.call(this,"Transaction already started for the given connection, commit current transaction before starting a new one.")||this}return Ae(t,e),t}(rt),wt=function(e){this.options=e},_t=function(e){function t(t,n){var r=e.call(this)||this;return r.message='Could not find any entity of type "'+r.stringifyTarget(t)+'" matching: '+r.stringifyCriteria(n),r}return Ae(t,e),t.prototype.stringifyTarget=function(e){return e instanceof wt?e.options.name:"function"==typeof e||"object"==typeof e&&"name"in e?e.name:e},t.prototype.stringifyCriteria=function(e){try{return JSON.stringify(e,null,4)}catch(e){}return""+e},t}(rt),Et=function(e){function t(t){var n=e.call(this)||this;return n.message='No metadata for "'+n.stringifyTarget(t)+'" was found.',n}return Ae(t,e),t.prototype.stringifyTarget=function(e){return e instanceof wt?e.options.name:"function"==typeof e||"object"==typeof e&&"name"in e?e.name:e},t}(rt),St=function(e){function t(t,n){return e.call(this,"Cannot "+t+', given value must be an entity, instead "'+n+'" is given.')||this}return Ae(t,e),t}(rt),xt=function(e){function t(){return e.call(this,"Your database does not support LIMIT on UPDATE statements.")||this}return Ae(t,e),t}(rt),Tt=function(e){function t(t,n){return e.call(this,"Primary column "+t.constructor.name+"#"+n+" cannot be nullable. Its not allowed for primary keys. Try to remove nullable option.")||this}return Ae(t,e),t}(rt),Mt=function(e){function t(t){return e.call(this,"Custom entity repository "+(t instanceof Function?t.name:t.constructor.name)+"  cannot inherit Repository class without entity being set in the @EntityRepository decorator.")||this}return Ae(t,e),t}(rt),At=function(e){function t(){return e.call(this,"Database connection provided by a query runner was already released, cannot continue to use its querying methods anymore.")||this}return Ae(t,e),t}(rt),Rt=function(e){function t(t){return e.call(this,'Cannot attach entity "'+t+'" to its parent. Please make sure parent is saved in the database before saving children nodes.')||this}return Ae(t,e),t}(rt),It=function(e){function t(t){return e.call(this,"Custom repository "+(t instanceof Function?t.name:t.constructor.name)+" does not have managed entity. Did you forget to specify entity for it @EntityRepository(MyEntity)? ")||this}return Ae(t,e),t}(rt),Pt=function(e){function t(t){return e.call(this,'Entity "'+t.name+'" does not have delete date columns.')||this}return Ae(t,e),t}(rt),Nt=(function(e){function t(t){return e.call(this,'Cannot get a Repository for "'+t+" connection, because connection with the database is not established yet. Call connection#connect method to establish connection.")||this}Ae(t,e)}(rt),function(e){function t(t){return e.call(this,"Circular relations detected: "+t+". To resolve this issue you need to set nullable: true somewhere in this dependency structure.")||this}return Ae(t,e),t}(rt)),Ot=function(e){function t(){return e.call(this,"OUTPUT or RETURNING clause only supported by Microsoft SQL Server or PostgreSQL databases.")||this}return Ae(t,e),t}(rt),Ct=(function(e){function t(t,n){return e.call(this,"Using JoinTable on "+t.name+"#"+n.propertyName+" is wrong. "+t.name+"#"+n.propertyName+" has "+n.relationType+" relation, however you can use JoinTable only on many-to-many relations.")||this}Ae(t,e)}(rt),function(e){function t(t,n){var r=e.call(this)||this;return n.inverseRelation?r.message="JoinColumn is missing on both sides of "+t.name+"#"+n.propertyName+" and "+n.inverseEntityMetadata.name+"#"+n.inverseRelation.propertyName+" one-to-one relationship. You need to put JoinColumn decorator on one of the sides.":r.message="JoinColumn is missing on "+t.name+"#"+n.propertyName+" one-to-one relationship. You need to put JoinColumn decorator on it.",r}Ae(t,e)}(rt),function(e){function t(t){return e.call(this,'Entity "'+t.name+'" does not have a primary column. Primary column is required to have in all your entities. Use @PrimaryColumn decorator to add a primary column to your entity.')||this}return Ae(t,e),t}(rt)),kt=function(e){function t(t){return e.call(this,'No entity column "'+t+'" was found.')||this}return Ae(t,e),t}(rt),Bt=function(e){function t(t,n){return void 0===n&&(n=[]),e.call(this,'Wrong driver: "'+t+'" given. Supported drivers are: '+n.map((function(e){return'"'+e+'"'})).join(", ")+".")||this}return Ae(t,e),t}(rt),Dt=function(e){function t(t,n){return e.call(this,t+" package has not been found installed. Try to install it: npm install "+n+" --save")||this}return Ae(t,e),t}(rt),jt=(function(e){function t(t){return e.call(this,'Cannot get entity manager for "'+t+'" connection because connection is not yet established.')||this}Ae(t,e)}(rt),function(e){function t(t){return e.call(this,'Connection "'+t+'" was not found.')||this}return Ae(t,e),t}(rt)),Lt=function(e){function t(){return e.call(this,'Cannot perform insert query because values are not defined. Call "qb.values(...)" method to specify inserted values.')||this}return Ae(t,e),t}(rt),qt=(function(e){function t(t,n){return e.call(this,t+" metadata with such name "+n+" already exists. Do you apply decorator twice? Or maybe try to change a name?")||this}Ae(t,e)}(rt),function(e){function t(t){return e.call(this,"Driver option ("+t+") is not set. Please set it to perform connection to the database.")||this}return Ae(t,e),t}(rt)),Ut=function(e){function t(t){var n=e.call(this)||this;return 1===t.length?n.message='Relation "'+t[0]+'" was not found; please check if it is correct and really exists in your entity.':n.message="Relations "+t.map((function(e){return'"'+e+'"'})).join(", ")+" were not found; please check if relations are correct and they exist in your entities.",n}return Ae(t,e),t}(rt),Ft=function(e){function t(t,n){var r,i=e.call(this)||this;return r=n instanceof wt?n.options.name:"function"==typeof n||"object"==typeof n&&"name"in n?n.name:n,i.message='No repository for "'+r+'" was found. Looks like this entity is not registered in current "'+t+'" connection?',i}return Ae(t,e),t}(rt),Kt=(function(e){function t(t,n){var r=e.call(this)||this,i=t instanceof Function?t.name:t;return r.message='Naming strategy "'+i+'" was not found. Looks like this naming strategy does not exist or it was not registered in current "'+n+'" connection?',r}Ae(t,e)}(rt),function(e){function t(t){var n,r=e.call(this)||this;return n=t instanceof wt?t.options.name:"function"==typeof t||"object"==typeof t&&"name"in t?t.name:t,r.message='Repository of the "'+n+'" class is not a TreeRepository. Try to apply @Tree decorator on your entity.',r}return Ae(t,e),t}(rt)),Vt=function(e){function t(t,n,r){var i=e.call(this)||this,o="string"==typeof n?n:n.name;return i.message='Data type "'+o+'" in "'+t.entityMetadata.targetName+"."+t.propertyName+'" is not supported by "'+r+'" database.',i}return Ae(t,e),t}(rt),zt=function(e){function t(t){return e.call(this,'Array initializations are not allowed in entity relations. Please remove array initialization (= []) from "'+t.entityMetadata.targetName+"#"+t.propertyPath+'". This is ORM requirement to make relations to work properly. Refer docs for more information.')||this}return Ae(t,e),t}(rt),Wt=(function(e){function t(t,n){var r=e.call(this)||this;return n.inverseRelation?r.message="JoinTable is missing on both sides of "+t.name+"#"+n.propertyName+" and "+n.inverseEntityMetadata.name+"#"+n.inverseRelation.propertyName+" many-to-many relationship. You need to put decorator decorator on one of the sides.":r.message="JoinTable is missing on "+t.name+"#"+n.propertyName+" many-to-many relationship. You need to put JoinTable decorator on it.",r}Ae(t,e)}(rt),function(e){function t(t,n,r){var i=e.call(this,r.toString().replace(/^error: /,"").replace(/^Error: /,"").replace(/^Request/,""))||this;if(i.query=t,i.parameters=n,i.driverError=r,r){r.name;var o=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(r,["name"]);ut.assign(i,Re({},o))}return i}return Ae(t,e),t}(rt)),Ht=function(e){function t(){return e.call(this,"Entity manager is not using single database connection and cannot be released. Only entity managers created by connection#createEntityManagerWithSingleDatabaseConnection methods have a single database connection and they should be released.")||this}return Ae(t,e),t}(rt),Gt=(function(e){function t(t,n){return e.call(this,"Using JoinColumn is allowed only on one side of the one-to-one relationship. Both "+t.name+"#"+n.propertyName+" and "+n.inverseEntityMetadata.name+"#"+n.inverseRelation.propertyName+" has JoinTable decorators. Choose one of them and left JoinTable decorator only on it.")||this}Ae(t,e)}(rt),function(e){function t(t,n){return e.call(this,"Using JoinTable is allowed only on one side of the many-to-many relationship. Both "+t.name+"#"+n.propertyName+" and "+n.inverseEntityMetadata.name+"#"+n.inverseRelation.propertyName+" has JoinTable decorators. Choose one of them and left JoinColumn decorator only on it.")||this}Ae(t,e)}(rt),function(e){function t(t){return e.call(this,'Removed entity "'+t.metadata.name+'" is also scheduled for update operation. Make sure you are not updating and removing same object (note that update or remove may be executed by cascade operations).')||this}return Ae(t,e),t}(rt)),Qt=(function(e){function t(){return e.call(this,"Internal error. Persisted entity was not found in the list of prepared operated entities.")||this}Ae(t,e)}(rt),function(e){function t(t,n){return e.call(this,"Using JoinColumn on "+t.name+"#"+n.propertyName+" is wrong. You can use JoinColumn only on one-to-one and many-to-one relations.")||this}Ae(t,e)}(rt),function(e){function t(t,n){return e.call(this,"Column type for "+t.constructor.name+"#"+n+' is not defined and cannot be guessed. Make sure you have turned on an "emitDecoratorMetadata": true option in tsconfig.json. Also make sure you have imported "reflect-metadata" on top of the main entry file in your application (before any entity imported).If you are using JavaScript instead of TypeScript you must explicitly provide a column type.')||this}return Ae(t,e),t}(rt)),Jt=function(e){function t(){return e.call(this,"Query runner already released. Cannot run queries anymore.")||this}return Ae(t,e),t}(rt),Zt=function(e){function t(){return e.call(this,"RDBMS does not support OFFSET without LIMIT in SELECT statements. You must use limit in conjunction with offset function (or take in conjunction with skip function if you are using pagination).")||this}return Ae(t,e),t}(rt),$t=function(e){function t(t){return e.call(this,'Cannot execute operation on "'+t+'" connection because connection is not yet established.')||this}return Ae(t,e),t}(rt),Yt=function(e){function t(t){return e.call(this,'Option "'+t+'" is not set in your connection options, please define "'+t+'" option in your connection options or ormconfig.json')||this}return Ae(t,e),t}(rt);o.register("7ARel",(function(t,n){e(t.exports,"RelationIdAttribute",(()=>i));var r=o("2A1j4"),i=function(){function e(e,t){this.queryExpressionMap=e,this.disableMixedMap=!1,ut.assign(this,t||{})}return Object.defineProperty(e.prototype,"joinInverseSideMetadata",{get:function(){return this.relation.inverseEntityMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentAlias",{get:function(){if(!r.QueryBuilderUtils.isAliasProperty(this.relationName))throw new rt("Given value must be a string representation of alias property");return this.relationName.substr(0,this.relationName.indexOf("."))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relationPropertyPath",{get:function(){if(!r.QueryBuilderUtils.isAliasProperty(this.relationName))throw new rt("Given value must be a string representation of alias property");return this.relationName.substr(this.relationName.indexOf(".")+1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relation",{get:function(){if(!r.QueryBuilderUtils.isAliasProperty(this.relationName))throw new rt("Given value must be a string representation of alias property");var e=this.queryExpressionMap.findAliasByName(this.parentAlias).metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new rt("Relation with property path "+this.relationPropertyPath+" in entity was not found.");return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"junctionAlias",{get:function(){var e=ke(this.relationName.split("."),2);return e[0]+"_"+e[1]+"_rid"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"junctionMetadata",{get:function(){return this.relation.junctionEntityMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyParentAlias",{get:function(){return this.mapToProperty.substr(0,this.mapToProperty.indexOf("."))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyPropertyPath",{get:function(){return this.mapToProperty.substr(this.mapToProperty.indexOf(".")+1)},enumerable:!1,configurable:!0}),e}()})),o.register("k9pWs",(function(t,n){e(t.exports,"RelationCountAttribute",(()=>i));var r=o("2A1j4"),i=function(){function e(e,t){this.expressionMap=e,ut.assign(this,t||{})}return Object.defineProperty(e.prototype,"joinInverseSideMetadata",{get:function(){return this.relation.inverseEntityMetadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parentAlias",{get:function(){if(!r.QueryBuilderUtils.isAliasProperty(this.relationName))throw new rt("Given value must be a string representation of alias property");return this.relationName.split(".")[0]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relationProperty",{get:function(){if(!r.QueryBuilderUtils.isAliasProperty(this.relationName))throw new rt("Given value is a string representation of alias property");return this.relationName.split(".")[1]},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"junctionAlias",{get:function(){var e=ke(this.relationName.split("."),2);return e[0]+"_"+e[1]+"_rc"},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"relation",{get:function(){if(!r.QueryBuilderUtils.isAliasProperty(this.relationName))throw new rt("Given value is a string representation of alias property");var e=ke(this.relationName.split("."),2),t=e[0],n=e[1],i=this.expressionMap.findAliasByName(t).metadata.findRelationWithPropertyPath(n);if(!i)throw new rt("Relation with property path "+n+" in entity was not found.");return i},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){if(!r.QueryBuilderUtils.isAliasProperty(this.relationName))throw new rt("Given value is a string representation of alias property");var e=this.relationName.split(".")[0];return this.expressionMap.findAliasByName(e).metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapToPropertyPropertyName",{get:function(){return this.mapToProperty.split(".")[1]},enumerable:!1,configurable:!0}),e}()})),o.register("5JSrj",(function(t,n){e(t.exports,"RelationIdLoader",(()=>r));var r=function(){function e(e,t,n){this.connection=e,this.queryRunner=t,this.relationIdAttributes=n}return e.prototype.load=function(e){return Ne(this,void 0,void 0,(function(){var t,n=this;return Oe(this,(function(r){return t=this.relationIdAttributes.map((function(t){return Ne(n,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b,v,w,_,E,S,x,T,M=this;return Oe(this,(function(A){switch(A.label){case 0:if(!t.relation.isManyToOne&&!t.relation.isOneToOneOwner)return[3,1];if(t.queryBuilderFactory)throw new rt("Additional condition can not be used with ManyToOne or OneToOne owner relations.");return n=[],T=e.map((function(e){var r={},i=[];t.relation.joinColumns.forEach((function(n){r[n.databaseName]=M.connection.driver.prepareHydratedValue(e[nt.buildAlias(M.connection.driver,t.parentAlias,n.databaseName)],n.referencedColumn);var o=n.databaseName+":"+r[n.databaseName];-1===i.indexOf(o)&&i.push(o)})),t.relation.entityMetadata.primaryColumns.forEach((function(n){r[n.databaseName]=M.connection.driver.prepareHydratedValue(e[nt.buildAlias(M.connection.driver,t.parentAlias,n.databaseName)],n);var o=n.databaseName+":"+r[n.databaseName];-1===i.indexOf(o)&&i.push(o)})),i.sort();var o=i.join("::");return-1!==n.indexOf(o)?null:(n.push(o),r)})).filter((function(e){return e})),[2,{relationIdAttribute:t,results:T}];case 1:return t.relation.isOneToMany||t.relation.isOneToOneNotOwner?(r=t.relation,i=r.isOwning?r.joinColumns:r.inverseRelation.joinColumns,o=r.inverseEntityMetadata.target,a=r.inverseEntityMetadata.tableName,s=t.alias||a,u=[],c={},(S=e.map((function(e,n){var r=[],o={},a=i.map((function(i){var a=i.databaseName+n,u=e[nt.buildAlias(M.connection.driver,t.parentAlias,i.referencedColumn.databaseName)],c=s+":"+i.propertyPath+":"+u;return-1!==r.indexOf(c)?"":(r.push(c),o[a]=u,s+"."+i.propertyPath+" = :"+a)})).filter((function(e){return e})).join(" AND ");r.sort();var l=r.join("::");return-1!==u.indexOf(l)?"":(u.push(l),Object.assign(c,o),a)})).filter((function(e){return e})).map((function(e){return"("+e+")"})).join(" OR "))?(l=this.connection.createQueryBuilder(this.queryRunner),i.forEach((function(e){l.addSelect(s+"."+e.propertyPath,e.databaseName)})),r.inverseRelation.entityMetadata.primaryColumns.forEach((function(e){l.addSelect(s+"."+e.propertyPath,e.databaseName)})),l.from(o,s).where("("+S+")").setParameters(c),t.queryBuilderFactory&&t.queryBuilderFactory(l),[4,l.getRawMany()]):[2,{relationIdAttribute:t,results:[]}]):[3,3];case 2:return(T=A.sent()).forEach((function(e){i.forEach((function(t){e[t.databaseName]=M.connection.driver.prepareHydratedValue(e[t.databaseName],t.referencedColumn)})),r.inverseRelation.entityMetadata.primaryColumns.forEach((function(t){e[t.databaseName]=M.connection.driver.prepareHydratedValue(e[t.databaseName],t)}))})),[2,{relationIdAttribute:t,results:T}];case 3:return f=t.relation,h=f.isOwning?f.joinColumns:f.inverseRelation.inverseJoinColumns,d=f.isOwning?f.inverseJoinColumns:f.inverseRelation.joinColumns,p=t.junctionAlias,m=t.joinInverseSideMetadata.tableName,y=t.alias||m,g=f.isOwning?f.junctionEntityMetadata.tableName:f.inverseRelation.junctionEntityMetadata.tableName,0===(b=e.map((function(e){return h.reduce((function(n,r){return n[r.propertyPath]=e[nt.buildAlias(M.connection.driver,t.parentAlias,r.referencedColumn.databaseName)],n}),{})}))).length?[2,{relationIdAttribute:t,results:[]}]:(v={},w=[],_=b.map((function(e,t){var n=[],r={},i=Object.keys(e).map((function(i){var o=i+t,a=e[i],s=p+":"+i+":"+a;return-1!==n.indexOf(s)?"":(n.push(s),r[o]=a,p+"."+i+" = :"+o)})).filter((function(e){return e})).join(" AND ");n.sort();var o=n.join("::");return-1!==w.indexOf(o)?"":(w.push(o),Object.assign(v,r),i)})).filter((function(e){return e})),E=d.map((function(e){return p+"."+e.propertyPath+" = "+y+"."+e.referencedColumn.propertyPath})).join(" AND "),S=_.map((function(e){return"("+e+" AND "+E+")"})).join(" OR "),x=this.connection.createQueryBuilder(this.queryRunner),d.forEach((function(e){x.addSelect(p+"."+e.propertyPath,e.databaseName).addOrderBy(p+"."+e.propertyPath)})),h.forEach((function(e){x.addSelect(p+"."+e.propertyPath,e.databaseName).addOrderBy(p+"."+e.propertyPath)})),x.from(m,y).innerJoin(g,p,S).setParameters(v),t.queryBuilderFactory&&t.queryBuilderFactory(x),[4,x.getRawMany()]);case 4:return(T=A.sent()).forEach((function(e){Be(Be([],ke(h)),ke(d)).forEach((function(t){e[t.databaseName]=M.connection.driver.prepareHydratedValue(e[t.databaseName],t.referencedColumn)}))})),[2,{relationIdAttribute:t,results:T}]}}))}))})),[2,Promise.all(t)]}))}))},e}()})),o.register("bIgDF",(function(t,n){e(t.exports,"RelationIdMetadataToAttributeTransformer",(()=>i));var r=o("7ARel"),i=function(){function e(e){this.expressionMap=e}return e.prototype.transform=function(){var e=this;this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationIds.forEach((function(t){var n=e.metadataToAttribute(e.expressionMap.mainAlias.name,t);e.expressionMap.relationIdAttributes.push(n)})),this.expressionMap.joinAttributes.forEach((function(t){t.metadata&&!t.metadata.isJunction&&t.metadata.relationIds.forEach((function(n){var r=e.metadataToAttribute(t.alias.name,n);e.expressionMap.relationIdAttributes.push(r)}))}))},e.prototype.metadataToAttribute=function(e,t){return new r.RelationIdAttribute(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})},e}()})),o.register("5RI5I",(function(t,n){e(t.exports,"RelationCountLoader",(()=>r));var r=function(){function e(e,t,n){this.connection=e,this.queryRunner=t,this.relationCountAttributes=n}return e.prototype.load=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r=this;return Oe(this,(function(i){return t=function(e,t,n){return n.indexOf(e)===t},n=this.relationCountAttributes.map((function(n){return Ne(r,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b,v,w;return Oe(this,(function(_){switch(_.label){case 0:return n.relation.isOneToMany?(r=n.relation,i=r.inverseRelation,o=i.joinColumns[0].referencedColumn.propertyName,a=r.inverseEntityMetadata.target,p=r.inverseEntityMetadata.tableName,m=n.alias||p,s=i.propertyName,0===(h=(h=e.map((function(e){return e[n.parentAlias+"_"+o]})).filter((function(e){return!!e}))).filter(t)).length?[2,{relationCountAttribute:n,results:[]}]:((b=this.connection.createQueryBuilder(this.queryRunner)).select(m+"."+s,"parentId").addSelect("COUNT(*)","cnt").from(a,m).where(m+"."+s+" IN (:...ids)").addGroupBy(m+"."+s).setParameter("ids",h),n.queryBuilderFactory&&n.queryBuilderFactory(b),v={relationCountAttribute:n},[4,b.getRawMany()])):[3,2];case 1:return[2,(v.results=_.sent(),v)];case 2:return c=void 0,l=void 0,f=void 0,n.relation.isOwning?(u=n.relation.joinColumns[0].referencedColumn.databaseName,c=n.relation.inverseJoinColumns[0].referencedColumn.databaseName,l=n.relation.junctionEntityMetadata.columns[0],f=n.relation.junctionEntityMetadata.columns[1]):(u=n.relation.inverseRelation.inverseJoinColumns[0].referencedColumn.databaseName,c=n.relation.inverseRelation.joinColumns[0].referencedColumn.databaseName,l=n.relation.junctionEntityMetadata.columns[1],f=n.relation.junctionEntityMetadata.columns[0]),0===(h=(h=e.map((function(e){return e[n.parentAlias+"_"+u]})).filter((function(e){return!!e}))).filter(t)).length?[2,{relationCountAttribute:n,results:[]}]:(d=n.junctionAlias,p=n.joinInverseSideMetadata.tableName,m=n.alias||p,y=n.relation.junctionEntityMetadata.tableName,g=d+"."+l.propertyName+" IN ("+h.map((function(e){return isNaN(e)?"'"+e+"'":e}))+") AND "+d+"."+f.propertyName+" = "+m+"."+c,(b=this.connection.createQueryBuilder(this.queryRunner)).select(d+"."+l.propertyName,"parentId").addSelect("COUNT("+b.escape(m)+"."+b.escape(c)+")","cnt").from(p,m).innerJoin(y,d,g).addGroupBy(d+"."+l.propertyName),n.queryBuilderFactory&&n.queryBuilderFactory(b),w={relationCountAttribute:n},[4,b.getRawMany()]);case 3:return[2,(w.results=_.sent(),w)]}}))}))})),[2,Promise.all(n)]}))}))},e}()})),o.register("6RKZv",(function(t,n){e(t.exports,"RelationCountMetadataToAttributeTransformer",(()=>i));var r=o("k9pWs"),i=function(){function e(e){this.expressionMap=e}return e.prototype.transform=function(){var e=this;this.expressionMap.mainAlias&&this.expressionMap.mainAlias.metadata.relationCounts.forEach((function(t){var n=e.metadataToAttribute(e.expressionMap.mainAlias.name,t);e.expressionMap.relationCountAttributes.push(n)})),this.expressionMap.joinAttributes.forEach((function(t){t.metadata&&!t.metadata.isJunction&&t.metadata.relationCounts.forEach((function(n){var r=e.metadataToAttribute(t.alias.name,n);e.expressionMap.relationCountAttributes.push(r)}))}))},e.prototype.metadataToAttribute=function(e,t){return new r.RelationCountAttribute(this.expressionMap,{relationName:e+"."+t.relation.propertyName,mapToProperty:e+"."+t.propertyName,alias:t.alias,queryBuilderFactory:t.queryBuilderFactory})},e}()})),o.register("lawob",(function(t,n){e(t.exports,"QueryBuilder",(()=>s));var r=o("89Ljw"),i=o("7OEKV"),a=o("iHHst"),s=function(){function e(t,n){this.parameterIndex=0,t instanceof e?(this.connection=t.connection,this.queryRunner=t.queryRunner,this.expressionMap=t.expressionMap.clone()):(this.connection=t,this.queryRunner=n,this.expressionMap=new r.QueryExpressionMap(this.connection))}return Object.defineProperty(e.prototype,"alias",{get:function(){if(!this.expressionMap.mainAlias)throw new rt("Main alias is not set");return this.expressionMap.mainAlias.name},enumerable:!1,configurable:!0}),e.prototype.select=function(e,t){this.expressionMap.queryType="select",Array.isArray(e)?this.expressionMap.selects=e.map((function(e){return{selection:e}})):e&&(this.expressionMap.selects=[{selection:e,aliasName:t}]);var n=o("8iajb").SelectQueryBuilder;return this instanceof n?this:new n(this)},e.prototype.insert=function(){this.expressionMap.queryType="insert";var e=o("dtkPP").InsertQueryBuilder;return this instanceof e?this:new e(this)},e.prototype.update=function(e,t){var n=t||e;if((e=e instanceof wt?e.options.name:e)instanceof Function||"string"==typeof e){var r=this.createFromAlias(e);this.expressionMap.setMainAlias(r)}this.expressionMap.queryType="update",this.expressionMap.valuesSet=n;var i=o("d3jyk").UpdateQueryBuilder;return this instanceof i?this:new i(this)},e.prototype.delete=function(){this.expressionMap.queryType="delete";var e=o("9nUs1").DeleteQueryBuilder;return this instanceof e?this:new e(this)},e.prototype.softDelete=function(){this.expressionMap.queryType="soft-delete";var e=o("g1b81").SoftDeleteQueryBuilder;return this instanceof e?this:new e(this)},e.prototype.restore=function(){this.expressionMap.queryType="restore";var e=o("g1b81").SoftDeleteQueryBuilder;return this instanceof e?this:new e(this)},e.prototype.relation=function(e,t){var n=2===arguments.length?e:void 0,r=2===arguments.length?t:e;if(this.expressionMap.queryType="relation",this.expressionMap.relationPropertyPath=r,n){var i=this.createFromAlias(n);this.expressionMap.setMainAlias(i)}var a=o("3RnXi").RelationQueryBuilder;return this instanceof a?this:new a(this)},e.prototype.hasRelation=function(e,t){var n=this.connection.getMetadata(e);return(Array.isArray(t)?t:[t]).every((function(e){return!!n.findRelationWithPropertyPath(e)}))},e.prototype.hasParameter=function(e){var t;return(null===(t=this.parentQueryBuilder)||void 0===t?void 0:t.hasParameter(e))||e in this.expressionMap.parameters},e.prototype.setParameter=function(e,t){if(t instanceof Function)throw new rt("Function parameter isn't supported in the parameters. Please check \""+e+'" parameter.');if(!e.match(/^([A-Za-z0-9_.]+)$/))throw new rt("QueryBuilder parameter keys may only contain numbers, letters, underscores, or periods.");return this.parentQueryBuilder&&this.parentQueryBuilder.setParameter(e,t),this.expressionMap.parameters[e]=t,this},e.prototype.setParameters=function(e){var t,n;try{for(var r=Ce(Object.entries(e)),i=r.next();!i.done;i=r.next()){var o=ke(i.value,2),a=o[0],s=o[1];this.setParameter(a,s)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return this},e.prototype.createParameter=function(e){var t;do{t="orm_param_"+this.parameterIndex++}while(this.hasParameter(t));return this.setParameter(t,e),":"+t},e.prototype.setNativeParameters=function(e){var t=this;return this.parentQueryBuilder&&this.parentQueryBuilder.setNativeParameters(e),Object.keys(e).forEach((function(n){t.expressionMap.nativeParameters[n]=e[n]})),this},e.prototype.getParameters=function(){var e=Object.assign({},this.expressionMap.parameters);if(this.expressionMap.mainAlias&&this.expressionMap.mainAlias.hasMetadata){var t=this.expressionMap.mainAlias.metadata;if(t.discriminatorColumn&&t.parentEntityMetadata){var n=t.childEntityMetadatas.filter((function(e){return e.discriminatorColumn})).map((function(e){return e.discriminatorValue}));n.push(t.discriminatorValue),e.discriminatorColumnValues=n}}return e},e.prototype.printSql=function(){var e=ke(this.getQueryAndParameters(),2),t=e[0],n=e[1];return this.connection.logger.logQuery(t,n),this},e.prototype.getSql=function(){return this.getQueryAndParameters()[0]},e.prototype.getQueryAndParameters=function(){var e=this.getQuery(),t=this.getParameters();return this.connection.driver.escapeQueryWithParameters(e,t,this.expressionMap.nativeParameters)},e.prototype.execute=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r;return Oe(this,(function(i){switch(i.label){case 0:e=ke(this.getQueryAndParameters(),2),t=e[0],n=e[1],r=this.obtainQueryRunner(),i.label=1;case 1:return i.trys.push([1,,3,6]),[4,r.query(t,n)];case 2:return[2,i.sent()];case 3:return r===this.queryRunner?[3,5]:[4,r.release()];case 4:i.sent(),i.label=5;case 5:return[7];case 6:return[2]}}))}))},e.prototype.createQueryBuilder=function(){return new this.constructor(this.connection,this.queryRunner)},e.prototype.clone=function(){return new this.constructor(this)},e.prototype.comment=function(e){return this.expressionMap.comment=e,this},e.prototype.disableEscaping=function(){return this.expressionMap.disableEscaping=!1,this},e.prototype.escape=function(e){return this.expressionMap.disableEscaping?this.connection.driver.escape(e):e},e.prototype.setQueryRunner=function(e){return this.queryRunner=e,this},e.prototype.callListeners=function(e){return this.expressionMap.callListeners=e,this},e.prototype.useTransaction=function(e){return this.expressionMap.useTransaction=e,this},e.prototype.getTableName=function(e){var t=this;return e.split(".").map((function(e){return""===e?e:t.escape(e)})).join(".")},e.prototype.getMainTableName=function(){if(!this.expressionMap.mainAlias)throw new rt('Entity where values should be inserted is not specified. Call "qb.into(entity)" method to specify it.');return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.tablePath:this.expressionMap.mainAlias.tablePath},e.prototype.createFromAlias=function(e,t){if(this.connection.hasMetadata(e)){var n=this.connection.getMetadata(e);return this.expressionMap.createAlias({type:"from",name:t,metadata:this.connection.getMetadata(e),tablePath:n.tablePath})}if("string"==typeof e){var r="("===e.substr(0,1)&&")"===e.substr(-1);return this.expressionMap.createAlias({type:"from",name:t,tablePath:r?void 0:e,subQuery:r?e:void 0})}var i=e(this.subQuery());this.setParameters(i.getParameters());var o=i.getQuery();return this.expressionMap.createAlias({type:"from",name:t,subQuery:o})},e.prototype.replacePropertyNames=function(e){var t,n,r=this,i=function(e){return e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&")},o=function(t){var n,o,s,u,c,l,f,h,d,p,m,y;if(!t.hasMetadata)return"continue";var g=a.expressionMap.aliasNamePrefixingEnabled?t.name+".":"",b=a.expressionMap.aliasNamePrefixingEnabled?a.escape(t.name)+".":"",v={};try{for(var w=(n=void 0,Ce(t.metadata.relations)),_=w.next();!_.done;_=w.next()){(x=_.value).joinColumns.length>0&&(v[x.propertyPath]=x.joinColumns[0].databaseName)}}catch(e){n={error:e}}finally{try{_&&!_.done&&(o=w.return)&&o.call(w)}finally{if(n)throw n.error}}try{for(var E=(s=void 0,Ce(t.metadata.relations)),S=E.next();!S.done;S=E.next()){var x=S.value;try{for(var T=(c=void 0,Ce(Be(Be([],ke(x.joinColumns)),ke(x.inverseJoinColumns)))),M=T.next();!M.done;M=T.next()){var A=M.value,R=x.propertyPath+"."+A.referencedColumn.propertyPath;v[R]=A.databaseName}}catch(e){c={error:e}}finally{try{M&&!M.done&&(l=T.return)&&l.call(T)}finally{if(c)throw c.error}}}}catch(e){s={error:e}}finally{try{S&&!S.done&&(u=E.return)&&u.call(E)}finally{if(s)throw s.error}}try{for(var I=(f=void 0,Ce(t.metadata.columns)),P=I.next();!P.done;P=I.next()){var N=P.value;v[N.databaseName]=N.databaseName}}catch(e){f={error:e}}finally{try{P&&!P.done&&(h=I.return)&&h.call(I)}finally{if(f)throw f.error}}try{for(var O=(d=void 0,Ce(t.metadata.columns)),C=O.next();!C.done;C=O.next()){N=C.value;v[N.propertyName]=N.databaseName}}catch(e){d={error:e}}finally{try{C&&!C.done&&(p=O.return)&&p.call(O)}finally{if(d)throw d.error}}try{for(var k=(m=void 0,Ce(t.metadata.columns)),B=k.next();!B.done;B=k.next()){N=B.value;v[N.propertyPath]=N.databaseName}}catch(e){m={error:e}}finally{try{B&&!B.done&&(y=k.return)&&y.call(k)}finally{if(m)throw m.error}}var D=Object.keys(v);D.length&&(e=e.replace(new RegExp("([ =(]|^.{0})"+i(g)+"("+D.map(i).join("|")+")(?=[ =),]|.{0}$)","gm"),(function(e,t,n){return""+t+b+r.escape(v[n])})))},a=this;try{for(var s=Ce(this.expressionMap.aliases),u=s.next();!u.done;u=s.next()){o(u.value)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}return e},e.prototype.createComment=function(){return this.expressionMap.comment?"/* "+this.expressionMap.comment.replace("*/","")+" */ ":""},e.prototype.createWhereExpression=function(){var e=[],t=this.createWhereClausesExpression(this.expressionMap.wheres);if(t.length>0&&"1=1"!==t&&e.push(this.replacePropertyNames(t)),this.expressionMap.mainAlias.hasMetadata){var n=this.expressionMap.mainAlias.metadata;if("select"===this.expressionMap.queryType&&!this.expressionMap.withDeleted&&n.deleteDateColumn){var r=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+n.deleteDateColumn.propertyName:n.deleteDateColumn.propertyName,i=this.replacePropertyNames(r)+" IS NULL";e.push(i)}if(n.discriminatorColumn&&n.parentEntityMetadata){r=this.expressionMap.aliasNamePrefixingEnabled?this.expressionMap.mainAlias.name+"."+n.discriminatorColumn.databaseName:n.discriminatorColumn.databaseName,i=this.replacePropertyNames(r)+" IN (:...discriminatorColumnValues)";e.push(i)}}if(this.expressionMap.extraAppendedAndWhereCondition){i=this.replacePropertyNames(this.expressionMap.extraAppendedAndWhereCondition);e.push(i)}return e.length?1===e.length?" WHERE "+e[0]:" WHERE ( "+e.join(" ) AND ( ")+" )":""},e.prototype.createReturningExpression=function(){var e=this,t=this.getReturningColumns(),n=this.connection.driver;if("string"!=typeof this.expressionMap.returning&&this.expressionMap.extraReturningColumns.length>0&&n.isReturningSqlSupported()&&t.push.apply(t,Be([],ke(this.expressionMap.extraReturningColumns.filter((function(e){return-1===t.indexOf(e)}))))),t.length){var r=t.map((function(t){var r=e.escape(t.databaseName);return n instanceof Ve?"insert"===e.expressionMap.queryType||"update"===e.expressionMap.queryType||"soft-delete"===e.expressionMap.queryType||"restore"===e.expressionMap.queryType?"INSERTED."+r:e.escape(e.getMainTableName())+"."+r:r})).join(", ");return n instanceof He&&(r+=" INTO "+t.map((function(t){return e.createParameter({type:n.columnTypeToNativeParameter(t.type),dir:n.oracle.BIND_OUT})})).join(", ")),n instanceof Ve&&("insert"!==this.expressionMap.queryType&&"update"!==this.expressionMap.queryType||(r+=" INTO @OutputTable")),r}return"string"==typeof this.expressionMap.returning?this.expressionMap.returning:""},e.prototype.getReturningColumns=function(){var e=this,t=[];return Array.isArray(this.expressionMap.returning)&&this.expressionMap.returning.forEach((function(n){e.expressionMap.mainAlias.hasMetadata&&t.push.apply(t,Be([],ke(e.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(n))))})),t},e.prototype.createWhereClausesExpression=function(e){var t=this;return e.map((function(e,n){var r=t.createWhereConditionExpression(e.condition);switch(e.type){case"and":return(n>0?"AND ":"")+r;case"or":return(n>0?"OR ":"")+r}return r})).join(" ").trim()},e.prototype.createWhereConditionExpression=function(e,t){if(void 0===t&&(t=!1),"string"==typeof e)return e;if(Array.isArray(e))return 0===e.length?"1=1":1!==e.length||t?"("+this.createWhereClausesExpression(e)+")":this.createWhereClausesExpression(e);var n=this.connection.driver;switch(e.operator){case"lessThan":return e.parameters[0]+" < "+e.parameters[1];case"lessThanOrEqual":return e.parameters[0]+" <= "+e.parameters[1];case"moreThan":return e.parameters[0]+" > "+e.parameters[1];case"moreThanOrEqual":return e.parameters[0]+" >= "+e.parameters[1];case"notEqual":return e.parameters[0]+" != "+e.parameters[1];case"equal":return e.parameters[0]+" = "+e.parameters[1];case"ilike":return n instanceof Ue||n instanceof Ke?e.parameters[0]+" ILIKE "+e.parameters[1]:"UPPER("+e.parameters[0]+") LIKE UPPER("+e.parameters[1]+")";case"like":return e.parameters[0]+" LIKE "+e.parameters[1];case"between":return e.parameters[0]+" BETWEEN "+e.parameters[1]+" AND "+e.parameters[2];case"in":return e.parameters.length<=1?"0=1":e.parameters[0]+" IN ("+e.parameters.slice(1).join(", ")+")";case"any":return e.parameters[0]+" = ANY("+e.parameters[1]+")";case"isNull":return e.parameters[0]+" IS NULL";case"not":return"NOT("+this.createWhereConditionExpression(e.condition)+")";case"brackets":return""+this.createWhereConditionExpression(e.condition,!0)}throw new TypeError("Unsupported FindOperator "+Xt.constructor.name)},e.prototype.getWhereInIdsCondition=function(e){var t,n=this.expressionMap.mainAlias.metadata,r=(Array.isArray(e)?e:[e]).map((function(e){return n.ensureEntityIdMap(e)}));if(!n.hasMultiplePrimaryKeys){var o=n.primaryColumns[0];if(!o.transformer&&!o.relationMetadata&&!o.embeddedMetadata)return(t={})[o.propertyName]=a.In(r.map((function(e){return o.getEntityValue(e,!1)}))),t}return new i.Brackets((function(e){var t,n,o=function(t){e.orWhere(new i.Brackets((function(e){return e.where(t)})))};try{for(var a=Ce(r),s=a.next();!s.done;s=a.next()){o(s.value)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}}))},e.prototype.findColumnsForPropertyPath=function(e){for(var t=this.expressionMap.mainAlias,n=[],r=e.split("."),i=function(){var e=r[0];if(!(null==t?void 0:t.hasMetadata))return"break";if(t.metadata.hasEmbeddedWithPropertyPath(e))return r.unshift(r.shift()+"."+r.shift()),"continue";if(t.metadata.hasRelationWithPropertyPath(e)){var i=o.expressionMap.joinAttributes.find((function(t){return t.relationPropertyPath===e}));if(!(null==i?void 0:i.alias)){var a=n.length>0?n.join(".")+"."+e:e;throw new Error("Cannot find alias for relation at "+a)}return t=i.alias,n.push.apply(n,Be([],ke(e.split(".")))),r.shift(),"continue"}return"break"},o=this;r.length>1;){if("break"===i())break}if(!t)throw new Error("Cannot find alias for property "+e);var a=r.join("."),s=t.metadata.findColumnsWithPropertyPath(a);if(!s.length)throw new kt(e);return[t,n,s]},e.prototype.createPropertyPath=function(e,t,n){var r,i;void 0===n&&(n="");var o=[],a=function(r){var i=n?n+"."+r:r;if(null===t[r]||"object"!=typeof t[r]||t[r]instanceof Xt)return o.push(i),"continue";if(e.hasEmbeddedWithPropertyPath(i)){var a=s.createPropertyPath(e,t[r],i);return o.push.apply(o,Be([],ke(a))),"continue"}if(e.hasRelationWithPropertyPath(i)){var u=e.findRelationWithPropertyPath(i);if("one-to-one"===u.relationType||"many-to-one"===u.relationType){var c=u.joinColumns.map((function(e){return e.referencedColumn})).filter((function(e){return!!e}));if(c.length>0&&c.every((function(e){return e.getEntityValue(t[r],!1)})))return o.push(i),"continue"}if("one-to-many"===u.relationType||"many-to-many"===u.relationType)throw new Error("Cannot query across "+u.relationType+" for property "+i);var l=u.inverseEntityMetadata.primaryColumns;if(l.length>0&&l.every((function(e){return e.getEntityValue(t[r],!1)}))){var f=l.map((function(e){return i+"."+e.propertyPath}));return o.push.apply(o,Be([],ke(f))),"continue"}a=s.createPropertyPath(u.inverseEntityMetadata,t[r]).map((function(e){return i+"."+e}));return o.push.apply(o,Be([],ke(a))),"continue"}o.push(i)},s=this;try{for(var u=Ce(Object.keys(t)),c=u.next();!c.done;c=u.next()){a(c.value)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(r)throw r.error}}return o},e.prototype.getPredicates=function(e){var t,n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b,v,w,_,E,S,x,T,M,A,R,I,P,N;return Oe(this,(function(O){switch(O.label){case 0:if(!this.expressionMap.mainAlias.hasMetadata)return[3,15];t=this.createPropertyPath(this.expressionMap.mainAlias.metadata,e),O.label=1;case 1:O.trys.push([1,12,13,14]),n=Ce(t),r=n.next(),O.label=2;case 2:if(r.done)return[3,11];i=r.value,o=ke(this.findColumnsForPropertyPath(i),3),a=o[0],s=o[1],u=o[2],O.label=3;case 3:O.trys.push([3,8,9,10]),M=void 0,c=Ce(u),l=c.next(),O.label=4;case 4:if(l.done)return[3,7];f=l.value,h=e;try{for(R=void 0,d=Ce(s),p=d.next();!p.done;p=d.next()){if(m=p.value,!h||!(m in h)){h={};break}h=h[m]}}catch(e){R={error:e}}finally{try{p&&!p.done&&(I=d.return)&&I.call(d)}finally{if(R)throw R.error}}return E=this.expressionMap.aliasNamePrefixingEnabled?a.name+"."+f.propertyPath:f.propertyPath,_=f.getEntityValue(h,!0),[4,[E,_]];case 5:O.sent(),O.label=6;case 6:return l=c.next(),[3,4];case 7:return[3,10];case 8:return y=O.sent(),M={error:y},[3,10];case 9:try{l&&!l.done&&(A=c.return)&&A.call(c)}finally{if(M)throw M.error}return[7];case 10:return r=n.next(),[3,2];case 11:return[3,14];case 12:return g=O.sent(),x={error:g},[3,14];case 13:try{r&&!r.done&&(T=n.return)&&T.call(n)}finally{if(x)throw x.error}return[7];case 14:return[3,22];case 15:O.trys.push([15,20,21,22]),b=Ce(Object.keys(e)),v=b.next(),O.label=16;case 16:return v.done?[3,19]:(w=v.value,_=e[w],[4,[E=this.expressionMap.aliasNamePrefixingEnabled?this.alias+"."+w:w,_]]);case 17:O.sent(),O.label=18;case 18:return v=b.next(),[3,16];case 19:return[3,22];case 20:return S=O.sent(),P={error:S},[3,22];case 21:try{v&&!v.done&&(N=b.return)&&N.call(b)}finally{if(P)throw P.error}return[7];case 22:return[2]}}))},e.prototype.getWherePredicateCondition=function(e,t){var n,r;if(t instanceof Xt){var i=[];if(t.useParameter)if(t.objectLiteralParameters)this.setParameters(t.objectLiteralParameters);else if(t.multipleParameters)try{for(var o=Ce(t.value),a=o.next();!a.done;a=o.next()){var s=a.value;i.push(this.createParameter(s))}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}else i.push(this.createParameter(t.value));return"raw"===t.type?t.getSql?t.getSql(e):{operator:"equal",parameters:[e,t.value]}:"not"===t.type?t.child?{operator:t.type,condition:this.getWherePredicateCondition(e,t.child)}:{operator:"notEqual",parameters:Be([e],ke(i))}:{operator:t.type,parameters:Be([e],ke(i))}}return null===t?{operator:"isNull",parameters:[e]}:{operator:"equal",parameters:[e,this.createParameter(t)]}},e.prototype.getWhereCondition=function(e){var t,n,r,o;if("string"==typeof e)return e;if(e instanceof i.Brackets){var a=this.createQueryBuilder();return a.parentQueryBuilder=this,a.expressionMap.mainAlias=this.expressionMap.mainAlias,a.expressionMap.aliasNamePrefixingEnabled=this.expressionMap.aliasNamePrefixingEnabled,a.expressionMap.parameters=this.expressionMap.parameters,a.expressionMap.nativeParameters=this.expressionMap.nativeParameters,a.expressionMap.wheres=[],e.whereFactory(a),{operator:"brackets",condition:a.expressionMap.wheres}}if(e instanceof Function)return e(this);var s=Array.isArray(e)?e:[e],u=[];try{for(var c=Ce(s),l=c.next();!l.done;l=c.next()){var f=l.value,h=[];try{for(var d=(r=void 0,Ce(this.getPredicates(f))),p=d.next();!p.done;p=d.next()){var m=ke(p.value,2),y=m[0],g=m[1];h.push({type:"and",condition:this.getWherePredicateCondition(y,g)})}}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=d.return)&&o.call(d)}finally{if(r)throw r.error}}u.push({type:"or",condition:h})}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return 1===u.length?u[0].condition:u},e.prototype.obtainQueryRunner=function(){return this.queryRunner||this.connection.createQueryRunner()},e}()})),o.register("89Ljw",(function(t,n){e(t.exports,"QueryExpressionMap",(()=>u));var r=o("cVg8w"),i=o("j1eS8"),a=o("7ARel"),s=o("k9pWs"),u=function(){function e(e){this.connection=e,this.queryEntity=!1,this.aliases=[],this.queryType="select",this.selects=[],this.maxExecutionTime=0,this.selectDistinct=!1,this.selectDistinctOn=[],this.extraReturningColumns=[],this.onConflict="",this.onIgnore=!1,this.joinAttributes=[],this.relationIdAttributes=[],this.relationCountAttributes=[],this.wheres=[],this.havings=[],this.orderBys={},this.groupBys=[],this.withDeleted=!1,this.parameters={},this.disableEscaping=!0,this.enableRelationIdValues=!1,this.extraAppendedAndWhereCondition="",this.subQuery=!1,this.aliasNamePrefixingEnabled=!0,this.cache=!1,this.options=[],this.insertColumns=[],this.whereEntities=[],this.updateEntity=!0,this.callListeners=!0,this.useTransaction=!1,this.nativeParameters={},this.locallyGenerated={}}return Object.defineProperty(e.prototype,"allOrderBys",{get:function(){var e=this;if(!Object.keys(this.orderBys).length&&this.mainAlias.hasMetadata&&-1===this.options.indexOf("disable-global-order")){var t=this.mainAlias.metadata.orderBy||{};return Object.keys(t).reduce((function(n,r){return n[e.mainAlias.name+"."+r]=t[r],n}),{})}return this.orderBys},enumerable:!1,configurable:!0}),e.prototype.setMainAlias=function(e){return this.mainAlias=e,e},e.prototype.createAlias=function(e){var t=e.name;!t&&e.tablePath&&(t=e.tablePath),!t&&e.target instanceof Function&&(t=e.target.name),t||"string"!=typeof e.target||(t=e.target);var n=new r.Alias;return n.type=e.type,t&&(n.name=t),e.metadata&&(n.metadata=e.metadata),e.target&&!n.hasMetadata&&(n.metadata=this.connection.getMetadata(e.target)),e.tablePath&&(n.tablePath=e.tablePath),e.subQuery&&(n.subQuery=e.subQuery),this.aliases.push(n),n},e.prototype.findAliasByName=function(e){var t=this.aliases.find((function(t){return t.name===e}));if(!t)throw new rt('"'+e+'" alias was not found. Maybe you forgot to join it?');return t},e.prototype.findColumnByAliasExpression=function(e){var t=ke(e.split("."),2),n=t[0],r=t[1];return this.findAliasByName(n).metadata.findColumnWithPropertyName(r)},Object.defineProperty(e.prototype,"relationMetadata",{get:function(){if(!this.mainAlias)throw new rt("Entity to work with is not specified!");var e=this.mainAlias.metadata.findRelationWithPropertyPath(this.relationPropertyPath);if(!e)throw new rt("Relation "+this.relationPropertyPath+" was not found in entity "+this.mainAlias.name);return e},enumerable:!1,configurable:!0}),e.prototype.clone=function(){var t=this,n=new e(this.connection);return n.queryType=this.queryType,n.selects=this.selects.map((function(e){return e})),n.maxExecutionTime=this.maxExecutionTime,n.selectDistinct=this.selectDistinct,n.selectDistinctOn=this.selectDistinctOn,this.aliases.forEach((function(e){return n.aliases.push(new r.Alias(e))})),n.mainAlias=this.mainAlias,n.valuesSet=this.valuesSet,n.returning=this.returning,n.onConflict=this.onConflict,n.onIgnore=this.onIgnore,n.onUpdate=this.onUpdate,n.joinAttributes=this.joinAttributes.map((function(e){return new i.JoinAttribute(t.connection,t,e)})),n.relationIdAttributes=this.relationIdAttributes.map((function(e){return new a.RelationIdAttribute(t,e)})),n.relationCountAttributes=this.relationCountAttributes.map((function(e){return new s.RelationCountAttribute(t,e)})),n.wheres=this.wheres.map((function(e){return Re({},e)})),n.havings=this.havings.map((function(e){return Re({},e)})),n.orderBys=Object.assign({},this.orderBys),n.groupBys=this.groupBys.map((function(e){return e})),n.limit=this.limit,n.offset=this.offset,n.skip=this.skip,n.take=this.take,n.lockMode=this.lockMode,n.lockVersion=this.lockVersion,n.lockTables=this.lockTables,n.withDeleted=this.withDeleted,n.parameters=Object.assign({},this.parameters),n.disableEscaping=this.disableEscaping,n.enableRelationIdValues=this.enableRelationIdValues,n.extraAppendedAndWhereCondition=this.extraAppendedAndWhereCondition,n.subQuery=this.subQuery,n.aliasNamePrefixingEnabled=this.aliasNamePrefixingEnabled,n.cache=this.cache,n.cacheId=this.cacheId,n.cacheDuration=this.cacheDuration,n.relationPropertyPath=this.relationPropertyPath,n.of=this.of,n.insertColumns=this.insertColumns,n.whereEntities=this.whereEntities,n.updateEntity=this.updateEntity,n.callListeners=this.callListeners,n.useTransaction=this.useTransaction,n.nativeParameters=Object.assign({},this.nativeParameters),n.comment=this.comment,n},e}()})),o.register("cVg8w",(function(t,n){e(t.exports,"Alias",(()=>r));var r=function(){function e(e){ut.assign(this,e||{})}return Object.defineProperty(e.prototype,"target",{get:function(){return this.metadata.target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasMetadata",{get:function(){return!!this._metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){if(!this._metadata)throw new rt('Cannot get entity metadata for the given alias "'+this.name+'"');return this._metadata},set:function(e){this._metadata=e},enumerable:!1,configurable:!0}),e}()})),o.register("7OEKV",(function(t,n){e(t.exports,"Brackets",(()=>r));var r=function(e){this.whereFactory=e}}));var Xt=function(){function e(e,t,n,r,i,o){void 0===n&&(n=!0),void 0===r&&(r=!1),this._type=e,this._value=t,this._useParameter=n,this._multipleParameters=r,this._getSql=i,this._objectLiteralParameters=o}return Object.defineProperty(e.prototype,"useParameter",{get:function(){return this._value instanceof e?this._value.useParameter:this._useParameter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multipleParameters",{get:function(){return this._value instanceof e?this._value.multipleParameters:this._multipleParameters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._value instanceof e?this._value.value:this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"objectLiteralParameters",{get:function(){return this._value instanceof e?this._value.objectLiteralParameters:this._objectLiteralParameters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"child",{get:function(){if(this._value instanceof e)return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"getSql",{get:function(){return this._value instanceof e?this._value.getSql:this._getSql},enumerable:!1,configurable:!0}),e}();o.register("iHHst",(function(t,n){function r(e){return new Xt("in",e,!0,!0)}e(t.exports,"In",(()=>r))})),o.register("dtkPP",(function(t,n){e(t.exports,"InsertQueryBuilder",(()=>s));var r=o("lawob"),i=o("hMYFp"),a=o("e6c9k"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),t.prototype.getQuery=function(){var e=this.createComment();return(e+=this.createInsertExpression()).trim()},t.prototype.execute=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,o,s,u,c,l,f,h,d,p,m,y,g,b,v,w,_,E,S=this;return Oe(this,(function(x){switch(x.label){case 0:if(0===(e=this.getValueSets()).length)return[2,new i.InsertResult];t=this.obtainQueryRunner(),n=!1,x.label=1;case 1:return x.trys.push([1,13,18,21]),!0!==this.expressionMap.useTransaction||!1!==t.isTransactionActive?[3,3]:[4,t.startTransaction()];case 2:x.sent(),n=!0,x.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(r=new vn,e.forEach((function(e){t.broadcaster.broadcastBeforeInsertEvent(r,S.expressionMap.mainAlias.metadata,e)})),r.promises.length>0?[4,Promise.all(r.promises)]:[3,5]):[3,5];case 4:x.sent(),x.label=5;case 5:if(o=null,s=null,u=new a.ReturningResultsEntityUpdator(t,this.expressionMap),c=[],Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)try{for(l=Ce(this.expressionMap.returning),f=l.next();!f.done;f=l.next())h=f.value,c.push.apply(c,Be([],ke(this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(h))))}catch(e){_={error:e}}finally{try{f&&!f.done&&(E=l.return)&&E.call(l)}finally{if(_)throw _.error}}return!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&(e.length>1&&this.connection.driver instanceof He||(this.expressionMap.extraReturningColumns=u.getInsertionReturningColumns()),c.push.apply(c,Be([],ke(this.expressionMap.extraReturningColumns.filter((function(e){return!c.includes(e)})))))),c.length>0&&this.connection.driver instanceof Ve&&(o=this.connection.driver.buildTableVariableDeclaration("@OutputTable",c),s="SELECT * FROM @OutputTable"),d=ke(this.getQueryAndParameters(),2),p=d[0],m=d[1],y=[o,p,s].filter((function(e){return null!=e})).join(";\n\n"),[4,t.query(y,m,!0)];case 6:return g=x.sent(),b=i.InsertResult.from(g),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata?[4,u.insert(b,e)]:[3,8];case 7:x.sent(),x.label=8;case 8:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(v=new vn,e.forEach((function(e){t.broadcaster.broadcastAfterInsertEvent(v,S.expressionMap.mainAlias.metadata,e)})),v.promises.length>0?[4,Promise.all(v.promises)]:[3,10]):[3,10];case 9:x.sent(),x.label=10;case 10:return n?[4,t.commitTransaction()]:[3,12];case 11:x.sent(),x.label=12;case 12:return[2,b];case 13:if(w=x.sent(),!n)return[3,17];x.label=14;case 14:return x.trys.push([14,16,,17]),[4,t.rollbackTransaction()];case 15:return x.sent(),[3,17];case 16:return x.sent(),[3,17];case 17:throw w;case 18:return t===this.queryRunner?[3,20]:[4,t.release()];case 19:x.sent(),x.label=20;case 20:return[7];case 21:return[2]}}))}))},t.prototype.into=function(e,t){e=e instanceof wt?e.options.name:e;var n=this.createFromAlias(e);return this.expressionMap.setMainAlias(n),this.expressionMap.insertColumns=t||[],this},t.prototype.values=function(e){return this.expressionMap.valuesSet=e,this},t.prototype.output=function(e){return this.returning(e)},t.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new Ot;return this.expressionMap.returning=e,this},t.prototype.updateEntity=function(e){return this.expressionMap.updateEntity=e,this},t.prototype.onConflict=function(e){return this.expressionMap.onConflict=e,this},t.prototype.orIgnore=function(e){return void 0===e&&(e=!0),this.expressionMap.onIgnore=!!e,this},t.prototype.orUpdate=function(e,t){return Array.isArray(e)?(this.expressionMap.onUpdate={overwrite:e,conflict:t},this):(this.expressionMap.onUpdate={conflict:null==e?void 0:e.conflict_target,columns:null==e?void 0:e.columns,overwrite:null==e?void 0:e.overwrite},this)},t.prototype.createInsertExpression=function(){var e=this,t=this.getTableName(this.getMainTableName()),n=this.createValuesExpression(),r=this.connection.driver instanceof He&&this.getValueSets().length>1?null:this.createReturningExpression(),i=this.createColumnNamesExpression(),o="INSERT ";if((this.connection.driver instanceof We||this.connection.driver instanceof Fe)&&(o+=this.expressionMap.onIgnore?" IGNORE ":""),o+="INTO "+t,i?o+="("+i+")":!n&&(this.connection.driver instanceof We||this.connection.driver instanceof Fe)&&(o+="()"),r&&this.connection.driver instanceof Ve&&(o+=" OUTPUT "+r),n?this.connection.driver instanceof He&&this.getValueSets().length>1?o+=" "+n:o+=" VALUES "+n:this.connection.driver instanceof We||this.connection.driver instanceof Fe?o+=" VALUES ()":o+=" DEFAULT VALUES",this.connection.driver instanceof Ue||this.connection.driver instanceof bn||this.connection.driver instanceof Ke)if(this.expressionMap.onIgnore)o+=" ON CONFLICT DO NOTHING ";else if(this.expressionMap.onConflict)o+=" ON CONFLICT "+this.expressionMap.onConflict+" ";else if(this.expressionMap.onUpdate){var a=this.expressionMap.onUpdate,s=a.overwrite,u=a.columns,c=a.conflict,l="ON CONFLICT";Array.isArray(c)?l+=" ( "+c.map((function(t){return e.escape(t)})).join(", ")+" )":c&&(l+=" ON CONSTRAINT "+this.escape(c)),Array.isArray(s)?(o+=" "+l+" DO UPDATE SET ",o+=null==s?void 0:s.map((function(t){return e.escape(t)+" = EXCLUDED."+e.escape(t)})).join(", "),o+=" "):u&&(o+=" "+l+" DO UPDATE SET ",o+=u.map((function(t){return e.escape(t)+" = :"+t})).join(", "),o+=" ")}if((this.connection.driver instanceof We||this.connection.driver instanceof Fe)&&this.expressionMap.onUpdate){var f=this.expressionMap.onUpdate;s=f.overwrite,u=f.columns;Array.isArray(s)?(o+=" ON DUPLICATE KEY UPDATE ",o+=s.map((function(t){return e.escape(t)+" = VALUES("+e.escape(t)+")"})).join(", "),o+=" "):Array.isArray(u)&&(o+=" ON DUPLICATE KEY UPDATE ",o+=u.map((function(t){return e.escape(t)+" = :"+t})).join(", "),o+=" ")}return r&&(this.connection.driver instanceof Ue||this.connection.driver instanceof He||this.connection.driver instanceof Ke)&&(o+=" RETURNING "+r),this.connection.driver instanceof Ve&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.mainAlias.metadata.columns.filter((function(t){return e.expressionMap.insertColumns.length>0?-1!==e.expressionMap.insertColumns.indexOf(t.propertyPath):t.isInsert})).some((function(t){return e.isOverridingAutoIncrementBehavior(t)}))&&(o="SET IDENTITY_INSERT "+t+" ON; "+o+"; SET IDENTITY_INSERT "+t+" OFF"),o},t.prototype.getInsertedColumns=function(){var e=this;return this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata.columns.filter((function(t){return e.expressionMap.insertColumns.length?-1!==e.expressionMap.insertColumns.indexOf(t.propertyPath):!!t.isInsert&&!!(!t.isGenerated||"increment"!==t.generationStrategy||e.connection.driver instanceof He||e.connection.driver instanceof bn||e.connection.driver instanceof We||e.connection.driver instanceof Fe||e.connection.driver instanceof Ve&&e.isOverridingAutoIncrementBehavior(t))})):[]},t.prototype.createColumnNamesExpression=function(){var e=this,t=this.getInsertedColumns();if(t.length>0)return t.map((function(t){return e.escape(t.databaseName)})).join(", ");if(!this.expressionMap.mainAlias.hasMetadata&&!this.expressionMap.insertColumns.length){var n=this.getValueSets();if(1===n.length)return Object.keys(n[0]).map((function(t){return e.escape(t)})).join(", ")}return this.expressionMap.insertColumns.map((function(t){return e.escape(t)})).join(", ")},t.prototype.createValuesExpression=function(){var e=this,t=this.getValueSets(),n=this.getInsertedColumns();if(n.length>0){var r="";return t.forEach((function(i,o){n.forEach((function(a,s){0===s&&(e.connection.driver instanceof He&&t.length>1?r+=" SELECT ":r+="(");var u=a.getEntityValue(i);if(u instanceof Function||(u=e.connection.driver.preparePersistentValue(u,a)),a.isVersion&&void 0===u)r+="1";else if(a.isDiscriminator)r+=e.createParameter(e.expressionMap.mainAlias.metadata.discriminatorValue);else if(a.isGenerated&&"uuid"===a.generationStrategy&&!e.connection.driver.isUUIDGenerationSupported()&&void 0===u)u=en.uuid4(),r+=e.createParameter(u),o in e.expressionMap.locallyGenerated||(e.expressionMap.locallyGenerated[o]={}),a.setEntityValue(e.expressionMap.locallyGenerated[o],u);else if(void 0===u)e.connection.driver instanceof He&&t.length>1||e.connection.driver instanceof bn||e.connection.driver instanceof ze?void 0!==a.default&&null!==a.default?r+=e.connection.driver.normalizeDefault(a):r+="NULL":r+="DEFAULT";else if(u instanceof Function)r+=u();else{e.connection.driver instanceof Ve&&(u=e.connection.driver.parametrizeValue(a,u));var c=e.createParameter(u);if((e.connection.driver instanceof We||e.connection.driver instanceof Fe)&&-1!==e.connection.driver.spatialTypes.indexOf(a.type)){var l=e.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";null!=a.srid?r+=l+"("+c+", "+a.srid+")":r+=l+"("+c+")"}else e.connection.driver instanceof Ue&&-1!==e.connection.driver.spatialTypes.indexOf(a.type)?null!=a.srid?r+="ST_SetSRID(ST_GeomFromGeoJSON("+c+"), "+a.srid+")::"+a.type:r+="ST_GeomFromGeoJSON("+c+")::"+a.type:e.connection.driver instanceof Ve&&-1!==e.connection.driver.spatialTypes.indexOf(a.type)?r+=a.type+"::STGeomFromText("+c+", "+(a.srid||"0")+")":r+=c}s===n.length-1?o===t.length-1?e.connection.driver instanceof He&&t.length>1?r+=" FROM DUAL ":r+=")":e.connection.driver instanceof He&&t.length>1?r+=" FROM DUAL UNION ALL ":r+="), ":r+=", "}))})),"()"===r?"":r}var i="";return t.forEach((function(n,r){Object.keys(n).forEach((function(o,a){0===a&&(i+="(");var s=n[o];s instanceof Function?i+=s():void 0===s?e.connection.driver instanceof bn||e.connection.driver instanceof ze?i+="NULL":i+="DEFAULT":i+=e.createParameter(s),a===Object.keys(n).length-1?r===t.length-1?i+=")":i+="), ":i+=", "}))})),"()"===i?"":i},t.prototype.getValueSets=function(){if(Array.isArray(this.expressionMap.valuesSet))return this.expressionMap.valuesSet;if(this.expressionMap.valuesSet instanceof Object)return[this.expressionMap.valuesSet];throw new Lt},t.prototype.isOverridingAutoIncrementBehavior=function(e){return e.isPrimary&&e.isGenerated&&"increment"===e.generationStrategy&&this.getValueSets().some((function(t){return void 0!==e.getEntityValue(t)&&null!==e.getEntityValue(t)}))},t}(r.QueryBuilder)}));var en=function(){function e(){}return e.sha1=function(e){var t,n,r,i,o,a,s,u,c,l=function(e,t){return e<<t|e>>>32-t},f=function(e){var t,n="";for(t=7;t>=0;t--)n+=(e>>>4*t&15).toString(16);return n},h=new Array(80),d=1732584193,p=4023233417,m=2562383102,y=271733878,g=3285377520,b=(e=encodeURIComponent(e)).length,v=[];for(n=0;n<b-3;n+=4)r=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),v.push(r);switch(b%4){case 0:n=2147483648;break;case 1:n=e.charCodeAt(b-1)<<24|8388608;break;case 2:n=e.charCodeAt(b-2)<<24|e.charCodeAt(b-1)<<16|32768;break;case 3:n=e.charCodeAt(b-3)<<24|e.charCodeAt(b-2)<<16|e.charCodeAt(b-1)<<8|128}for(v.push(n);v.length%16!=14;)v.push(0);for(v.push(b>>>29),v.push(b<<3&4294967295),t=0;t<v.length;t+=16){for(n=0;n<16;n++)h[n]=v[t+n];for(n=16;n<=79;n++)h[n]=l(h[n-3]^h[n-8]^h[n-14]^h[n-16],1);for(i=d,o=p,a=m,s=y,u=g,n=0;n<=19;n++)c=l(i,5)+(o&a|~o&s)+u+h[n]+1518500249&4294967295,u=s,s=a,a=l(o,30),o=i,i=c;for(n=20;n<=39;n++)c=l(i,5)+(o^a^s)+u+h[n]+1859775393&4294967295,u=s,s=a,a=l(o,30),o=i,i=c;for(n=40;n<=59;n++)c=l(i,5)+(o&a|o&s|a&s)+u+h[n]+2400959708&4294967295,u=s,s=a,a=l(o,30),o=i,i=c;for(n=60;n<=79;n++)c=l(i,5)+(o^a^s)+u+h[n]+3395469782&4294967295,u=s,s=a,a=l(o,30),o=i,i=c;d=d+i&4294967295,p=p+o&4294967295,m=m+a&4294967295,y=y+s&4294967295,g=g+u&4294967295}return(c=f(d)+f(p)+f(m)+f(y)+f(g)).toLowerCase()},e.uuid4=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},e}();o.register("hMYFp",(function(t,n){e(t.exports,"InsertResult",(()=>r));var r=function(){function e(){this.identifiers=[],this.generatedMaps=[]}return e.from=function(e){var t=new this;return t.raw=e.raw,t},e}()})),o.register("e6c9k",(function(t,n){e(t.exports,"ReturningResultsEntityUpdator",(()=>r));var r=function(){function e(e,t){this.queryRunner=e,this.expressionMap=t}return e.prototype.update=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return n=this.expressionMap.mainAlias.metadata,[4,Promise.all(t.map((function(t,i){return Ne(r,void 0,void 0,(function(){var r,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:return this.queryRunner.connection.driver.isReturningSqlSupported()?(this.queryRunner.connection.driver instanceof He&&Array.isArray(e.raw)&&this.expressionMap.extraReturningColumns.length>0&&(e.raw=e.raw.reduce((function(e,t,n){return e[u.expressionMap.extraReturningColumns[n].databaseName]=t[0],e}),{})),r=Array.isArray(e.raw)?e.raw[i]:e.raw,(o=this.queryRunner.connection.driver.createGeneratedMap(n,r))&&(this.queryRunner.manager.merge(n.target,t,o),e.generatedMaps.push(o)),[3,3]):[3,1];case 1:if(!(this.getUpdationReturningColumns().length>0))return[3,3];if(!(a=this.expressionMap.mainAlias.metadata.getEntityIdMap(t)))throw new rt("Cannot update entity because entity id is not set in the entity.");return[4,this.queryRunner.manager.createQueryBuilder().select(n.primaryColumns.map((function(e){return n.targetName+"."+e.propertyPath}))).addSelect(this.getUpdationReturningColumns().map((function(e){return n.targetName+"."+e.propertyPath}))).from(n.target,n.targetName).where(a).setOption("create-pojo").getOne()];case 2:(s=c.sent())&&(this.queryRunner.manager.merge(n.target,t,s),e.generatedMaps.push(s)),c.label=3;case 3:return[2]}}))}))})))];case 1:return i.sent(),[2]}}))}))},e.prototype.insert=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s=this;return Oe(this,(function(u){switch(u.label){case 0:return n=this.expressionMap.mainAlias.metadata,r=this.getInsertionReturningColumns(),i=t.map((function(r,i){s.queryRunner.connection.driver instanceof He&&Array.isArray(e.raw)&&s.expressionMap.extraReturningColumns.length>0&&(e.raw=e.raw.reduce((function(e,t,n){return e[s.expressionMap.extraReturningColumns[n].databaseName]=t[0],e}),{}));var o=Array.isArray(e.raw)?e.raw[i]:e.raw,a=s.queryRunner.connection.driver.createGeneratedMap(n,o,i,t.length)||{};return i in s.expressionMap.locallyGenerated&&s.queryRunner.manager.merge(n.target,a,s.expressionMap.locallyGenerated[i]),s.queryRunner.manager.merge(n.target,r,a),a})),!1===this.queryRunner.connection.driver.isReturningSqlSupported()&&r.length>0?(o=t.map((function(e){var t=n.getEntityIdMap(e);if(!t)throw new rt("Cannot update entity because entity id is not set in the entity.");return t})),[4,this.queryRunner.manager.createQueryBuilder().select(n.primaryColumns.map((function(e){return n.targetName+"."+e.propertyPath}))).addSelect(r.map((function(e){return n.targetName+"."+e.propertyPath}))).from(n.target,n.targetName).where(o).setOption("create-pojo").getMany()]):[3,2];case 1:a=u.sent(),t.forEach((function(e,t){s.queryRunner.manager.merge(n.target,i[t],a[t]),s.queryRunner.manager.merge(n.target,e,a[t])})),u.label=2;case 2:return t.forEach((function(t,r){var o=n.getEntityIdMap(t);e.identifiers.push(o),e.generatedMaps.push(i[r])})),[2]}}))}))},e.prototype.getInsertionReturningColumns=function(){var e=this.queryRunner.connection.driver.isReturningSqlSupported();return this.expressionMap.mainAlias.metadata.columns.filter((function(t){return void 0!==t.default||e&&t.isGenerated||t.isCreateDate||t.isUpdateDate||t.isDeleteDate||t.isVersion}))},e.prototype.getUpdationReturningColumns=function(){return this.expressionMap.mainAlias.metadata.columns.filter((function(e){return e.isUpdateDate||e.isVersion}))},e}()}));var tn,nn,rn,on=function(){function e(){}return e.normalizeHydratedDate=function(e){return e&&"string"==typeof e?new Date(e):e},e.mixedDateToDateString=function(e){return e instanceof Date?this.formatZerolessValue(e.getFullYear())+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate()):e},e.mixedDateToDate=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!0);var r="string"==typeof e?new Date(e):e;return t&&(r=new Date(r.getUTCFullYear(),r.getUTCMonth(),r.getUTCDate(),r.getUTCHours(),r.getUTCMinutes(),r.getUTCSeconds(),r.getUTCMilliseconds())),n||r.setUTCMilliseconds(0),r},e.mixedDateToTimeString=function(e,t){return void 0===t&&(t=!1),e instanceof Date?this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+(t?"":":"+this.formatZerolessValue(e.getSeconds())):e},e.mixedTimeToDate=function(e){if("string"==typeof e){var t=ke(e.split(":"),3),n=t[0],r=t[1],i=t[2],o=new Date;return n&&o.setHours(parseInt(n)),r&&o.setMinutes(parseInt(r)),i&&o.setSeconds(parseInt(i)),o}return e},e.mixedTimeToString=function(e,t){return void 0===t&&(t=!1),"string"==typeof(e=e instanceof Date?e.getHours()+":"+e.getMinutes()+(t?"":":"+e.getSeconds()):e)?e.split(":").map((function(e){return 1===e.length?"0"+e:e})).join(":"):e},e.mixedDateToDatetimeString=function(e,t){if("string"==typeof e&&(e=new Date(e)),e instanceof Date){var n=this.formatZerolessValue(e.getFullYear())+"-"+this.formatZerolessValue(e.getMonth()+1)+"-"+this.formatZerolessValue(e.getDate())+" "+this.formatZerolessValue(e.getHours())+":"+this.formatZerolessValue(e.getMinutes())+":"+this.formatZerolessValue(e.getSeconds());t&&(n+="."+this.formatMilliseconds(e.getMilliseconds())),e=n}return e},e.mixedDateToUtcDatetimeString=function(e){return"string"==typeof e&&(e=new Date(e)),e instanceof Date?this.formatZerolessValue(e.getUTCFullYear())+"-"+this.formatZerolessValue(e.getUTCMonth()+1)+"-"+this.formatZerolessValue(e.getUTCDate())+" "+this.formatZerolessValue(e.getUTCHours())+":"+this.formatZerolessValue(e.getUTCMinutes())+":"+this.formatZerolessValue(e.getUTCSeconds())+"."+this.formatMilliseconds(e.getUTCMilliseconds()):e},e.simpleArrayToString=function(e){return Array.isArray(e)?e.map((function(e){return String(e)})).join(","):e},e.stringToSimpleArray=function(e){return e instanceof String||"string"==typeof e?e.length>0?e.split(","):[]:e},e.simpleJsonToString=function(e){return JSON.stringify(e)},e.stringToSimpleJson=function(e){return"string"==typeof e?JSON.parse(e):e},e.simpleEnumToString=function(e){return""+e},e.stringToSimpleEnum=function(e,t){return t.enum&&!isNaN(e)&&t.enum.indexOf(parseInt(e))>=0&&(e=parseInt(e)),e},e.formatZerolessValue=function(e){return e<10?"0"+e:String(e)},e.formatMilliseconds=function(e){return e<10?"00"+e:e<100?"0"+e:String(e)},e}(),an=function(){function e(e){this.isNullable=!1,this.isGenerated=!1,this.isPrimary=!1,this.isUnique=!1,this.isArray=!1,this.length="",this.zerofill=!1,this.unsigned=!1,e&&(this.name=e.name,this.type=e.type||"",this.length=e.length||"",this.width=e.width,this.charset=e.charset,this.collation=e.collation,this.precision=e.precision,this.scale=e.scale,this.zerofill=e.zerofill||!1,this.unsigned=!!this.zerofill||(e.unsigned||!1),this.default=e.default,this.onUpdate=e.onUpdate,this.isNullable=e.isNullable||!1,this.isGenerated=e.isGenerated||!1,this.generationStrategy=e.generationStrategy,this.isPrimary=e.isPrimary||!1,this.isUnique=e.isUnique||!1,this.isArray=e.isArray||!1,this.comment=e.comment,this.enum=e.enum,this.enumName=e.enumName,this.asExpression=e.asExpression,this.generatedType=e.generatedType,this.spatialFeatureType=e.spatialFeatureType,this.srid=e.srid)}return e.prototype.clone=function(){return new e({name:this.name,type:this.type,length:this.length,width:this.width,charset:this.charset,collation:this.collation,precision:this.precision,scale:this.scale,zerofill:this.zerofill,unsigned:this.unsigned,enum:this.enum,enumName:this.enumName,asExpression:this.asExpression,generatedType:this.generatedType,default:this.default,onUpdate:this.onUpdate,isNullable:this.isNullable,isGenerated:this.isGenerated,generationStrategy:this.generationStrategy,isPrimary:this.isPrimary,isUnique:this.isUnique,isArray:this.isArray,comment:this.comment,spatialFeatureType:this.spatialFeatureType,srid:this.srid})},e}(),sn=function(){function e(e){this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.isUnique=!!e.isUnique,this.isSpatial=!!e.isSpatial,this.isFulltext=!!e.isFulltext,this.parser=e.parser,this.where=e.where?e.where:""}return e.prototype.clone=function(){return new e({name:this.name,columnNames:Be([],ke(this.columnNames)),isUnique:this.isUnique,isSpatial:this.isSpatial,isFulltext:this.isFulltext,parser:this.parser,where:this.where})},e.create=function(t){return new e({name:t.name,columnNames:t.columns.map((function(e){return e.databaseName})),isUnique:t.isUnique,isSpatial:t.isSpatial,isFulltext:t.isFulltext,parser:t.parser,where:t.where})},e}(),un=function(){function e(e){this.columnNames=[],this.referencedColumnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.referencedColumnNames=e.referencedColumnNames,this.referencedDatabase=e.referencedDatabase,this.referencedSchema=e.referencedSchema,this.referencedTableName=e.referencedTableName,this.onDelete=e.onDelete,this.onUpdate=e.onUpdate,this.deferrable=e.deferrable}return e.prototype.clone=function(){return new e({name:this.name,columnNames:Be([],ke(this.columnNames)),referencedColumnNames:Be([],ke(this.referencedColumnNames)),referencedDatabase:this.referencedDatabase,referencedSchema:this.referencedSchema,referencedTableName:this.referencedTableName,onDelete:this.onDelete,onUpdate:this.onUpdate,deferrable:this.deferrable})},e.create=function(t,n){return new e({name:t.name,columnNames:t.columnNames,referencedColumnNames:t.referencedColumnNames,referencedDatabase:t.referencedEntityMetadata.database,referencedSchema:t.referencedEntityMetadata.schema,referencedTableName:t.referencedTablePath,onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable})},e}(),cn=function(){function e(){}return e.createTableColumnOptions=function(e,t){return{name:e.databaseName,length:t.getColumnLength(e),width:e.width,charset:e.charset,collation:e.collation,precision:e.precision,scale:e.scale,zerofill:e.zerofill,unsigned:e.unsigned,asExpression:e.asExpression,generatedType:e.generatedType,default:t.normalizeDefault(e),onUpdate:e.onUpdate,comment:e.comment,isGenerated:e.isGenerated,generationStrategy:e.generationStrategy,isNullable:e.isNullable,type:t.normalizeType(e),isPrimary:e.isPrimary,isUnique:t.normalizeIsUnique(e),isArray:e.isArray||!1,enum:e.enum?e.enum.map((function(e){return e+""})):e.enum,enumName:e.enumName,spatialFeatureType:e.spatialFeatureType,srid:e.srid}},e}(),ln=function(){function e(e){this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames}return e.prototype.clone=function(){return new e({name:this.name,columnNames:Be([],ke(this.columnNames))})},e.create=function(t){return new e({name:t.name,columnNames:t.columns.map((function(e){return e.databaseName}))})},e}(),fn=function(){function e(e){this.columnNames=[],this.name=e.name,this.columnNames=e.columnNames,this.expression=e.expression}return e.prototype.clone=function(){return new e({name:this.name,columnNames:this.columnNames?Be([],ke(this.columnNames)):[],expression:this.expression})},e.create=function(t){return new e({name:t.name,expression:t.expression})},e}(),hn=function(){function e(e){this.name=e.name,this.expression=e.expression}return e.prototype.clone=function(){return new e({name:this.name,expression:this.expression})},e.create=function(t){return new e({name:t.name,expression:t.expression})},e}(),dn=function(){function e(e){this.columns=[],this.indices=[],this.foreignKeys=[],this.uniques=[],this.checks=[],this.exclusions=[],this.justCreated=!1,e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,e.columns&&(this.columns=e.columns.map((function(e){return new an(e)}))),e.indices&&(this.indices=e.indices.map((function(e){return new sn(e)}))),e.foreignKeys&&(this.foreignKeys=e.foreignKeys.map((function(t){return new un(Re(Re({},t),{referencedDatabase:(null==t?void 0:t.referencedDatabase)||e.database,referencedSchema:(null==t?void 0:t.referencedSchema)||e.schema}))}))),e.uniques&&(this.uniques=e.uniques.map((function(e){return new ln(e)}))),e.checks&&(this.checks=e.checks.map((function(e){return new fn(e)}))),e.exclusions&&(this.exclusions=e.exclusions.map((function(e){return new hn(e)}))),void 0!==e.justCreated&&(this.justCreated=e.justCreated),this.engine=e.engine)}return Object.defineProperty(e.prototype,"primaryColumns",{get:function(){return this.columns.filter((function(e){return e.isPrimary}))},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e({schema:this.schema,database:this.database,name:this.name,columns:this.columns.map((function(e){return e.clone()})),indices:this.indices.map((function(e){return e.clone()})),foreignKeys:this.foreignKeys.map((function(e){return e.clone()})),uniques:this.uniques.map((function(e){return e.clone()})),checks:this.checks.map((function(e){return e.clone()})),exclusions:this.exclusions.map((function(e){return e.clone()})),justCreated:this.justCreated,engine:this.engine})},e.prototype.addColumn=function(e){this.columns.push(e)},e.prototype.removeColumn=function(e){var t=this.columns.find((function(t){return t.name===e.name}));t&&this.columns.splice(this.columns.indexOf(t),1)},e.prototype.addUniqueConstraint=function(e){if(this.uniques.push(e),1===e.columnNames.length){var t=this.columns.find((function(t){return t.name===e.columnNames[0]}));t&&(t.isUnique=!0)}},e.prototype.removeUniqueConstraint=function(e){var t=this.uniques.find((function(t){return t.name===e.name}));if(t&&(this.uniques.splice(this.uniques.indexOf(t),1),1===t.columnNames.length)){var n=this.columns.find((function(e){return e.name===t.columnNames[0]}));n&&(n.isUnique=!1)}},e.prototype.addCheckConstraint=function(e){this.checks.push(e)},e.prototype.removeCheckConstraint=function(e){var t=this.checks.find((function(t){return t.name===e.name}));t&&this.checks.splice(this.checks.indexOf(t),1)},e.prototype.addExclusionConstraint=function(e){this.exclusions.push(e)},e.prototype.removeExclusionConstraint=function(e){var t=this.exclusions.find((function(t){return t.name===e.name}));t&&this.exclusions.splice(this.exclusions.indexOf(t),1)},e.prototype.addForeignKey=function(e){this.foreignKeys.push(e)},e.prototype.removeForeignKey=function(e){var t=this.foreignKeys.find((function(t){return t.name===e.name}));t&&this.foreignKeys.splice(this.foreignKeys.indexOf(t),1)},e.prototype.addIndex=function(e,t){if(void 0===t&&(t=!1),this.indices.push(e),1===e.columnNames.length&&e.isUnique&&t){var n=this.columns.find((function(t){return t.name===e.columnNames[0]}));n&&(n.isUnique=!0)}},e.prototype.removeIndex=function(e,t){void 0===t&&(t=!1);var n=this.indices.find((function(t){return t.name===e.name}));if(n&&(this.indices.splice(this.indices.indexOf(n),1),1===n.columnNames.length&&n.isUnique&&t)){var r=this.columns.find((function(e){return e.name===n.columnNames[0]}));r&&(r.isUnique=this.indices.some((function(e){return 1===e.columnNames.length&&e.columnNames[0]===r.name&&!!n.isUnique})))}},e.prototype.findColumnByName=function(e){return this.columns.find((function(t){return t.name===e}))},e.prototype.findColumnIndices=function(e){return this.indices.filter((function(t){return!!t.columnNames.find((function(t){return t===e.name}))}))},e.prototype.findColumnForeignKeys=function(e){return this.foreignKeys.filter((function(t){return!!t.columnNames.find((function(t){return t===e.name}))}))},e.prototype.findColumnUniques=function(e){return this.uniques.filter((function(t){return!!t.columnNames.find((function(t){return t===e.name}))}))},e.prototype.findColumnChecks=function(e){return this.checks.filter((function(t){return!!t.columnNames.find((function(t){return t===e.name}))}))},e.create=function(t,n){var r=t.database===n.database?void 0:t.database,i=t.schema===n.options.schema?void 0:t.schema;return new e({database:t.database,schema:t.schema,name:n.buildTableName(t.tableName,i,r),engine:t.engine,columns:t.columns.filter((function(e){return e})).map((function(e){return cn.createTableColumnOptions(e,n)})),indices:t.indices.filter((function(e){return!0===e.synchronize})).map((function(e){return sn.create(e)})),uniques:t.uniques.map((function(e){return ln.create(e)})),checks:t.checks.map((function(e){return fn.create(e)})),exclusions:t.exclusions.map((function(e){return hn.create(e)}))})},e}(),pn=function(){function e(e){e&&(this.database=e.database,this.schema=e.schema,this.name=e.name,this.expression=e.expression,this.materialized=!!e.materialized)}return e.prototype.clone=function(){return new e({database:this.database,schema:this.schema,name:this.name,expression:this.expression,materialized:this.materialized})},e.create=function(t,n){return new e({database:t.database,schema:t.schema,name:n.buildTableName(t.tableName,t.schema,t.database),expression:t.expression,materialized:t.tableMetadataArgs.materialized})},e}(),mn=function(){function e(e){this.connection=e}return e.prototype.build=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return this.queryRunner=this.connection.createQueryRunner(),this.currentDatabase=this.connection.driver.database,this.currentSchema=this.connection.driver.schema,(e=!(this.connection.driver instanceof Ke)&&"none"!==this.connection.options.migrationsTransactionMode)?[4,this.queryRunner.startTransaction()]:[3,2];case 1:i.sent(),i.label=2;case 2:return i.trys.push([2,12,18,20]),this.viewEntityToSyncMetadatas.length>0?[4,this.createTypeormMetadataTable()]:[3,4];case 3:i.sent(),i.label=4;case 4:return t=this.entityToSyncMetadatas.map((function(e){return r.getTablePath(e)})),[4,this.queryRunner.getTables(t)];case 5:return i.sent(),[4,this.queryRunner.getViews([])];case 6:return i.sent(),[4,this.executeSchemaSyncOperationsInProperOrder()];case 7:return i.sent(),this.connection.queryResultCache?[4,this.connection.queryResultCache.synchronize(this.queryRunner)]:[3,9];case 8:i.sent(),i.label=9;case 9:return e?[4,this.queryRunner.commitTransaction()]:[3,11];case 10:i.sent(),i.label=11;case 11:return[3,20];case 12:n=i.sent(),i.label=13;case 13:return i.trys.push([13,16,,17]),e?[4,this.queryRunner.rollbackTransaction()]:[3,15];case 14:i.sent(),i.label=15;case 15:return[3,17];case 16:return i.sent(),[3,17];case 17:throw n;case 18:return[4,this.queryRunner.release()];case 19:return i.sent(),[7];case 20:return[2]}}))}))},e.prototype.log=function(){return Ne(this,void 0,void 0,(function(){var e,t=this;return Oe(this,(function(n){switch(n.label){case 0:this.queryRunner=this.connection.createQueryRunner(),n.label=1;case 1:return n.trys.push([1,,9,11]),this.viewEntityToSyncMetadatas.length>0?[4,this.createTypeormMetadataTable()]:[3,3];case 2:n.sent(),n.label=3;case 3:return e=this.entityToSyncMetadatas.map((function(e){return t.getTablePath(e)})),[4,this.queryRunner.getTables(e)];case 4:return n.sent(),[4,this.queryRunner.getViews([])];case 5:return n.sent(),this.queryRunner.enableSqlMemory(),[4,this.executeSchemaSyncOperationsInProperOrder()];case 6:return n.sent(),this.connection.queryResultCache?[4,this.connection.queryResultCache.synchronize(this.queryRunner)]:[3,8];case 7:n.sent(),n.label=8;case 8:return[2,this.queryRunner.getMemorySql()];case 9:return this.queryRunner.disableSqlMemory(),[4,this.queryRunner.release()];case 10:return n.sent(),[7];case 11:return[2]}}))}))},Object.defineProperty(e.prototype,"entityToSyncMetadatas",{get:function(){return this.connection.entityMetadatas.filter((function(e){return e.synchronize&&"entity-child"!==e.tableType&&"view"!==e.tableType}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"viewEntityToSyncMetadatas",{get:function(){return this.connection.entityMetadatas.filter((function(e){return"view"===e.tableType&&e.synchronize}))},enumerable:!1,configurable:!0}),e.prototype.executeSchemaSyncOperationsInProperOrder=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return[4,this.dropOldViews()];case 1:return e.sent(),[4,this.dropOldForeignKeys()];case 2:return e.sent(),[4,this.dropOldIndices()];case 3:return e.sent(),[4,this.dropOldChecks()];case 4:return e.sent(),[4,this.dropOldExclusions()];case 5:return e.sent(),[4,this.dropCompositeUniqueConstraints()];case 6:return e.sent(),[4,this.renameColumns()];case 7:return e.sent(),[4,this.createNewTables()];case 8:return e.sent(),[4,this.dropRemovedColumns()];case 9:return e.sent(),[4,this.addNewColumns()];case 10:return e.sent(),[4,this.updatePrimaryKeys()];case 11:return e.sent(),[4,this.updateExistColumns()];case 12:return e.sent(),[4,this.createNewIndices()];case 13:return e.sent(),[4,this.createNewChecks()];case 14:return e.sent(),[4,this.createNewExclusions()];case 15:return e.sent(),[4,this.createCompositeUniqueConstraints()];case 16:return e.sent(),[4,this.createForeignKeys()];case 17:return e.sent(),[4,this.createViews()];case 18:return e.sent(),[2]}}))}))},e.prototype.getTablePath=function(e){var t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema||this.currentSchema,t.database||this.currentDatabase)},e.prototype.dropOldForeignKeys=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=n.foreignKeys.filter((function(t){var n=e.foreignKeys.find((function(e){return t.name===e.name&&u.getTablePath(t)===u.getTablePath(e.referencedEntityMetadata)}));return!n||n.onDelete&&n.onDelete!==t.onDelete||n.onUpdate&&n.onUpdate!==t.onUpdate}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("dropping old foreign keys of "+n.name+": "+r.map((function(e){return e.name})).join(", ")),[4,t.queryRunner.dropForeignKeys(n,r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.renameTables=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2]}))}))},e.prototype.renameColumns=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?e.columns.length!==n.columns.length||0===(r=e.columns.filter((function(e){return!n.columns.find((function(t){return t.name===e.databaseName&&t.type===u.connection.driver.normalizeType(e)&&t.isNullable===e.isNullable&&t.isUnique===u.connection.driver.normalizeIsUnique(e)}))}))).length||r.length>1||0===(i=n.columns.filter((function(t){return!e.columns.find((function(e){return e.databaseName===t.name&&u.connection.driver.normalizeType(e)===t.type&&e.isNullable===t.isNullable&&u.connection.driver.normalizeIsUnique(e)===t.isUnique}))}))).length||i.length>1?[2,"continue"]:((o=i[0].clone()).name=r[0].databaseName,t.connection.logger.logSchemaBuild('renaming column "'+i[0].name+'" in to "'+o.name+'"'),[4,t.queryRunner.renameColumn(n,i[0],o)]):[2,"continue"];case 1:return a.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.dropOldIndices=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?(r=n.indices.filter((function(t){var n=e.indices.find((function(e){return e.name===t.name}));return!n||!1!==n.synchronize&&(n.isUnique!==t.isUnique||(n.isSpatial!==t.isSpatial||(!(!u.connection.driver.isFullTextColumnTypeSupported()||n.isFulltext===t.isFulltext)||(n.columns.length!==t.columnNames.length||!n.columns.every((function(e){return-1!==t.columnNames.indexOf(e.databaseName)}))))))})).map((function(e){return Ne(u,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return this.connection.logger.logSchemaBuild('dropping an index: "'+e.name+'" from table '+n.name),[4,this.queryRunner.dropIndex(n,e)];case 1:return t.sent(),[2]}}))}))})),[4,Promise.all(r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.dropOldChecks=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:if(this.connection.driver instanceof We||this.connection.driver instanceof Fe)return[2];e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=n.checks.filter((function(t){return!e.checks.find((function(e){return e.name===t.name}))}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("dropping old check constraint: "+r.map((function(e){return'"'+e.name+'"'})).join(", ")+' from table "'+n.name+'"'),[4,t.queryRunner.dropCheckConstraints(n,r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.dropCompositeUniqueConstraints=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=n.uniques.filter((function(t){return t.columnNames.length>1&&!e.uniques.find((function(e){return e.name===t.name}))}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("dropping old unique constraint: "+r.map((function(e){return'"'+e.name+'"'})).join(", ")+' from table "'+n.name+'"'),[4,t.queryRunner.dropUniqueConstraints(n,r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.dropOldExclusions=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:if(!(this.connection.driver instanceof Ue))return[2];e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=n.exclusions.filter((function(t){return!e.exclusions.find((function(e){return e.name===t.name}))}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("dropping old exclusion constraint: "+r.map((function(e){return'"'+e.name+'"'})).join(", ")+' from table "'+n.name+'"'),[4,t.queryRunner.dropExclusionConstraints(n,r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.createNewTables=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n;return Oe(this,(function(r){switch(r.label){case 0:return t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)}))?[2,"continue"]:(t.connection.logger.logSchemaBuild("creating a new table: "+t.getTablePath(e)),n=dn.create(e,t.connection.driver),[4,t.queryRunner.createTable(n,!1,!1)]);case 1:return r.sent(),t.queryRunner.loadedTables.push(n),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.createViews=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n;return Oe(this,(function(r){switch(r.label){case 0:return t.queryRunner.loadedViews.find((function(t){var n="string"==typeof t.expression?t.expression.trim():t.expression(u.connection).getQuery(),r="string"==typeof e.expression?e.expression.trim():e.expression(u.connection).getQuery();return u.getTablePath(t)===u.getTablePath(e)&&n===r}))?[2,"continue"]:(t.connection.logger.logSchemaBuild("creating a new view: "+t.getTablePath(e)),n=pn.create(e,t.connection.driver),[4,t.queryRunner.createView(n)]);case 1:return r.sent(),t.queryRunner.loadedViews.push(n),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.viewEntityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.dropOldViews=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u,c=this;return Oe(this,(function(l){switch(l.label){case 0:e=new Set,t=function(t){return Oe(this,(function(r){switch(r.label){case 0:return n.viewEntityToSyncMetadatas.find((function(e){var n="string"==typeof t.expression?t.expression.trim():t.expression(c.connection).getQuery(),r="string"==typeof e.expression?e.expression.trim():e.expression(c.connection).getQuery();return c.getTablePath(t)===c.getTablePath(e)&&n===r}))?[2,"continue"]:(n.connection.logger.logSchemaBuild("dropping an old view: "+t.name),[4,n.queryRunner.dropView(t)]);case 1:return r.sent(),e.add(t),[2]}}))},n=this,l.label=1;case 1:l.trys.push([1,6,7,8]),r=Ce(this.queryRunner.loadedViews),i=r.next(),l.label=2;case 2:return i.done?[3,5]:(o=i.value,[5,t(o)]);case 3:l.sent(),l.label=4;case 4:return i=r.next(),[3,2];case 5:return[3,8];case 6:return a=l.sent(),s={error:a},[3,8];case 7:try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}return[7];case 8:return this.queryRunner.loadedViews=this.queryRunner.loadedViews.filter((function(t){return!e.has(t)})),[2]}}))}))},e.prototype.dropRemovedColumns=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=n.columns.filter((function(t){return!e.columns.find((function(e){return e.databaseName===t.name}))}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("columns dropped in "+n.name+": "+r.map((function(e){return e.name})).join(", ")),[4,t.queryRunner.dropColumns(n,r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.addNewColumns=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=e.columns.filter((function(e){return!n.columns.find((function(t){return t.name===e.databaseName}))}))).length?[2,"continue"]:(i=t.metadataColumnsToTableColumnOptions(r),0===(o=i.map((function(e){return new an(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("new columns added: "+r.map((function(e){return e.databaseName})).join(", ")),[4,t.queryRunner.addColumns(n,o)])):[2,"continue"];case 1:return a.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.updatePrimaryKeys=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?(r=e.columns.filter((function(e){return e.isPrimary})),n.columns.filter((function(e){return e.isPrimary})).length!==r.length&&r.length>1?(i=r.map((function(e){return new an(cn.createTableColumnOptions(e,u.connection.driver))})),[4,t.queryRunner.updatePrimaryKeys(n,i)]):[3,2]):[2,"continue"];case 1:o.sent(),o.label=2;case 2:return[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.updateExistColumns=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r,i,o,a,s,c,l,f,h,d,p,m,y,g,b,v,w,_;return Oe(this,(function(E){switch(E.label){case 0:if(!(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)}))))return[2,"continue"];if(0===(r=t.connection.driver.findChangedColumns(n.columns,e.columns)).length)return[2,"continue"];E.label=1;case 1:E.trys.push([1,6,7,8]),y=void 0,i=Ce(r),o=i.next(),E.label=2;case 2:return o.done?[3,5]:(d=o.value,[4,t.dropColumnReferencedForeignKeys(t.getTablePath(e),d.databaseName)]);case 3:E.sent(),E.label=4;case 4:return o=i.next(),[3,2];case 5:return[3,8];case 6:return a=E.sent(),y={error:a},[3,8];case 7:try{o&&!o.done&&(g=i.return)&&g.call(i)}finally{if(y)throw y.error}return[7];case 8:E.trys.push([8,13,14,15]),b=void 0,s=Ce(r),c=s.next(),E.label=9;case 9:return c.done?[3,12]:(d=c.value,[4,t.dropColumnCompositeIndices(t.getTablePath(e),d.databaseName)]);case 10:E.sent(),E.label=11;case 11:return c=s.next(),[3,9];case 12:return[3,15];case 13:return l=E.sent(),b={error:l},[3,15];case 14:try{c&&!c.done&&(v=s.return)&&v.call(s)}finally{if(b)throw b.error}return[7];case 15:if(t.connection.driver instanceof We||t.connection.driver instanceof Fe)return[3,23];E.label=16;case 16:E.trys.push([16,21,22,23]),w=void 0,f=Ce(r),h=f.next(),E.label=17;case 17:return h.done?[3,20]:(d=h.value,[4,t.dropColumnCompositeUniques(t.getTablePath(e),d.databaseName)]);case 18:E.sent(),E.label=19;case 19:return h=f.next(),[3,17];case 20:return[3,23];case 21:return p=E.sent(),w={error:p},[3,23];case 22:try{h&&!h.done&&(_=f.return)&&_.call(f)}finally{if(w)throw w.error}return[7];case 23:return 0===(m=r.map((function(e){var t=n.columns.find((function(t){return t.name===e.databaseName})),r=cn.createTableColumnOptions(e,u.connection.driver);return{oldColumn:t,newColumn:new an(r)}}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild('columns changed in "'+n.name+'". updating: '+r.map((function(e){return e.databaseName})).join(", ")),[4,t.queryRunner.changeColumns(n,m)]);case 24:return E.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.createNewIndices=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=e.indices.filter((function(e){return!n.indices.find((function(t){return t.name===e.name}))&&!0===e.synchronize})).map((function(e){return sn.create(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("adding new indices "+r.map((function(e){return'"'+e.name+'"'})).join(", ")+' in table "'+n.name+'"'),[4,t.queryRunner.createIndices(n,r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.createNewChecks=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:if(this.connection.driver instanceof We||this.connection.driver instanceof Fe)return[2];e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=e.checks.filter((function(e){return!n.checks.find((function(t){return t.name===e.name}))})).map((function(e){return fn.create(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("adding new check constraints: "+r.map((function(e){return'"'+e.name+'"'})).join(", ")+' in table "'+n.name+'"'),[4,t.queryRunner.createCheckConstraints(n,r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.createCompositeUniqueConstraints=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=e.uniques.filter((function(e){return e.columns.length>1&&!n.uniques.find((function(t){return t.name===e.name}))})).map((function(e){return ln.create(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("adding new unique constraints: "+r.map((function(e){return'"'+e.name+'"'})).join(", ")+' in table "'+n.name+'"'),[4,t.queryRunner.createUniqueConstraints(n,r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.createNewExclusions=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:if(!(this.connection.driver instanceof Ue))return[2];e=function(e){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=e.exclusions.filter((function(e){return!n.exclusions.find((function(t){return t.name===e.name}))})).map((function(e){return hn.create(e)}))).length?[2,"continue"]:(t.connection.logger.logSchemaBuild("adding new exclusion constraints: "+r.map((function(e){return'"'+e.name+'"'})).join(", ")+' in table "'+n.name+'"'),[4,t.queryRunner.createExclusionConstraints(n,r)]):[2,"continue"];case 1:return i.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.createForeignKeys=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:e=function(e){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return(n=t.queryRunner.loadedTables.find((function(t){return u.getTablePath(t)===u.getTablePath(e)})))?0===(r=e.foreignKeys.filter((function(e){return!n.foreignKeys.find((function(t){return t.name===e.name&&u.getTablePath(t)===u.getTablePath(e.referencedEntityMetadata)}))}))).length?[2,"continue"]:(i=r.map((function(e){return un.create(e,u.connection.driver)})),t.connection.logger.logSchemaBuild("creating a foreign keys: "+r.map((function(e){return e.name})).join(", ")+' on table "'+n.name+'"'),[4,t.queryRunner.createForeignKeys(n,i)]):[2,"continue"];case 1:return o.sent(),[2]}}))},t=this,c.label=1;case 1:c.trys.push([1,6,7,8]),n=Ce(this.entityToSyncMetadatas),r=n.next(),c.label=2;case 2:return r.done?[3,5]:(i=r.value,[5,e(i)]);case 3:c.sent(),c.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return o=c.sent(),a={error:o},[3,8];case 7:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 8:return[2]}}))}))},e.prototype.dropColumnReferencedForeignKeys=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b=this;return Oe(this,(function(v){switch(v.label){case 0:if(!(n=this.queryRunner.loadedTables.find((function(t){return b.getTablePath(t)===e}))))return[2];r=[],(i=n.foreignKeys.find((function(e){return-1!==e.columnNames.indexOf(t)})))&&((o=n.clone()).foreignKeys=[i],r.push(o),n.removeForeignKey(i)),a=function(n){var i=n.foreignKeys.filter((function(n){return b.getTablePath(n)===e&&-1!==n.referencedColumnNames.indexOf(t)}));if(i.length>0){var o=n.clone();o.foreignKeys=i,r.push(o),i.forEach((function(e){return n.removeForeignKey(e)}))}};try{for(s=Ce(this.queryRunner.loadedTables),u=s.next();!u.done;u=s.next())c=u.value,a(c)}catch(e){p={error:e}}finally{try{u&&!u.done&&(m=s.return)&&m.call(s)}finally{if(p)throw p.error}}if(!(r.length>0))return[3,8];v.label=1;case 1:v.trys.push([1,6,7,8]),l=Ce(r),f=l.next(),v.label=2;case 2:return f.done?[3,5]:(h=f.value,this.connection.logger.logSchemaBuild("dropping related foreign keys of "+h.name+": "+h.foreignKeys.map((function(e){return e.name})).join(", ")),[4,this.queryRunner.dropForeignKeys(h,h.foreignKeys)]);case 3:v.sent(),v.label=4;case 4:return f=l.next(),[3,2];case 5:return[3,8];case 6:return d=v.sent(),y={error:d},[3,8];case 7:try{f&&!f.done&&(g=l.return)&&g.call(l)}finally{if(y)throw y.error}return[7];case 8:return[2]}}))}))},e.prototype.dropColumnCompositeIndices=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i=this;return Oe(this,(function(o){switch(o.label){case 0:return(n=this.queryRunner.loadedTables.find((function(t){return i.getTablePath(t)===e})))?0===(r=n.indices.filter((function(e){return e.columnNames.length>1&&-1!==e.columnNames.indexOf(t)}))).length?[2]:(this.connection.logger.logSchemaBuild('dropping related indices of "'+e+'"."'+t+'": '+r.map((function(e){return e.name})).join(", ")),[4,this.queryRunner.dropIndices(n,r)]):[2];case 1:return o.sent(),[2]}}))}))},e.prototype.dropColumnCompositeUniques=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i=this;return Oe(this,(function(o){switch(o.label){case 0:return(n=this.queryRunner.loadedTables.find((function(t){return i.getTablePath(t)===e})))?0===(r=n.uniques.filter((function(e){return e.columnNames.length>1&&-1!==e.columnNames.indexOf(t)}))).length?[2]:(this.connection.logger.logSchemaBuild('dropping related unique constraints of "'+e+'"."'+t+'": '+r.map((function(e){return e.name})).join(", ")),[4,this.queryRunner.dropUniqueConstraints(n,r)]):[2];case 1:return o.sent(),[2]}}))}))},e.prototype.metadataColumnsToTableColumnOptions=function(e){var t=this;return e.map((function(e){return cn.createTableColumnOptions(e,t.connection.driver)}))},e.prototype.createTypeormMetadataTable=function(){return Ne(this,void 0,void 0,(function(){var e,t,n;return Oe(this,(function(r){switch(r.label){case 0:return e=this.currentSchema,t=this.currentDatabase,n=this.connection.driver.buildTableName("typeorm_metadata",e,t),[4,this.queryRunner.createTable(new dn({database:t,schema:e,name:n,columns:[{name:"type",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataType}),isNullable:!1},{name:"database",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataDatabase}),isNullable:!0},{name:"schema",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataSchema}),isNullable:!0},{name:"table",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataTable}),isNullable:!0},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataName}),isNullable:!0},{name:"value",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.metadataValue}),isNullable:!0}]}),!0)];case 1:return r.sent(),[2]}}))}))},e}(),yn=function(){function e(e){this.childEntityMetadatas=[],this.inheritanceTree=[],this.tableType="regular",this.withoutRowid=!1,this.synchronize=!0,this.hasNonNullableRelations=!1,this.isJunction=!1,this.isAlwaysUsingConstructor=!0,this.isClosureJunction=!1,this.hasMultiplePrimaryKeys=!1,this.hasUUIDGeneratedColumns=!1,this.ownColumns=[],this.columns=[],this.ancestorColumns=[],this.descendantColumns=[],this.nonVirtualColumns=[],this.ownerColumns=[],this.inverseColumns=[],this.generatedColumns=[],this.primaryColumns=[],this.ownRelations=[],this.relations=[],this.eagerRelations=[],this.lazyRelations=[],this.oneToOneRelations=[],this.ownerOneToOneRelations=[],this.oneToManyRelations=[],this.manyToOneRelations=[],this.manyToManyRelations=[],this.ownerManyToManyRelations=[],this.relationsWithJoinColumns=[],this.relationIds=[],this.relationCounts=[],this.foreignKeys=[],this.embeddeds=[],this.allEmbeddeds=[],this.ownIndices=[],this.indices=[],this.uniques=[],this.ownUniques=[],this.checks=[],this.exclusions=[],this.ownListeners=[],this.listeners=[],this.afterLoadListeners=[],this.beforeInsertListeners=[],this.afterInsertListeners=[],this.beforeUpdateListeners=[],this.afterUpdateListeners=[],this.beforeRemoveListeners=[],this.afterRemoveListeners=[],this.connection=e.connection,this.inheritanceTree=e.inheritanceTree||[],this.inheritancePattern=e.inheritancePattern,this.treeType=e.tableTree?e.tableTree.type:void 0,this.treeOptions=e.tableTree?e.tableTree.options:void 0,this.parentClosureEntityMetadata=e.parentClosureEntityMetadata,this.tableMetadataArgs=e.args,this.target=this.tableMetadataArgs.target,this.tableType=this.tableMetadataArgs.type,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=this.tableMetadataArgs.withoutRowid}return e.prototype.create=function(e,t){var n,r=this;if(this.target instanceof Function)return n=!(null==t?void 0:t.fromDeserializer)||this.isAlwaysUsingConstructor?new this.target:Object.create(this.target.prototype),this.lazyRelations.forEach((function(t){return r.connection.relationLoader.enableLazyLoad(t,n,e)})),n;var i={};return this.lazyRelations.forEach((function(t){return r.connection.relationLoader.enableLazyLoad(t,i,e)})),i},e.prototype.hasId=function(e){return!!e&&this.primaryColumns.every((function(t){var n=t.getEntityValue(e);return null!=n&&""!==n}))},e.prototype.hasAllPrimaryKeys=function(e){return this.primaryColumns.every((function(t){var n=t.getEntityValue(e);return null!=n}))},e.prototype.ensureEntityIdMap=function(e){if(e instanceof Object)return e;if(this.hasMultiplePrimaryKeys)throw new dt(this,e);return this.primaryColumns[0].createValueMap(e)},e.prototype.getEntityIdMap=function(t){if(t)return e.getValueMap(t,this.primaryColumns,{skipNulls:!0})},e.prototype.getEntityIdMixedMap=function(e){if(!e)return e;var t=this.getEntityIdMap(e);return this.hasMultiplePrimaryKeys?t:t?this.primaryColumns[0].getEntityValue(t):t},e.prototype.compareEntities=function(e,t){var n=this.getEntityIdMap(e);if(!n)return!1;var r=this.getEntityIdMap(t);return!!r&&Ze.compareIds(n,r)},e.prototype.findColumnWithPropertyName=function(e){return this.columns.find((function(t){return t.propertyName===e}))},e.prototype.findColumnWithDatabaseName=function(e){return this.columns.find((function(t){return t.databaseName===e}))},e.prototype.hasColumnWithPropertyPath=function(e){return this.columns.some((function(t){return t.propertyPath===e}))||this.hasRelationWithPropertyPath(e)},e.prototype.findColumnWithPropertyPath=function(e){var t=this.columns.find((function(t){return t.propertyPath===e}));if(t)return t;var n=this.relations.find((function(t){return t.propertyPath===e}));return n&&1===n.joinColumns.length?n.joinColumns[0]:void 0},e.prototype.findColumnsWithPropertyPath=function(e){var t=this.columns.find((function(t){return t.propertyPath===e}));if(t)return[t];var n=this.findRelationWithPropertyPath(e);return n&&n.joinColumns?n.joinColumns:[]},e.prototype.hasRelationWithPropertyPath=function(e){return this.relations.some((function(t){return t.propertyPath===e}))},e.prototype.findRelationWithPropertyPath=function(e){return this.relations.find((function(t){return t.propertyPath===e}))},e.prototype.hasEmbeddedWithPropertyPath=function(e){return this.allEmbeddeds.some((function(t){return t.propertyPath===e}))},e.prototype.findEmbeddedWithPropertyPath=function(e){return this.allEmbeddeds.find((function(t){return t.propertyPath===e}))},e.prototype.extractRelationValuesFromEntity=function(e,t){var n=this,r=[];return t.forEach((function(t){var i=t.getEntityValue(e);Array.isArray(i)?i.forEach((function(e){return r.push([t,e,n.getInverseEntityMetadata(e,t)])})):i&&r.push([t,i,n.getInverseEntityMetadata(i,t)])})),r},e.prototype.getInverseEntityMetadata=function(e,t){var n=t.inverseEntityMetadata.childEntityMetadatas.find((function(t){return t.target===e.constructor}));return n||t.inverseEntityMetadata},e.createPropertyPath=function(e,t,n){var r=this;void 0===n&&(n="");var i=[];return Object.keys(t).forEach((function(o){var a=n?n+"."+o:o;if(e.hasEmbeddedWithPropertyPath(a)){var s=r.createPropertyPath(e,t[o],a);i.push.apply(i,Be([],ke(s)))}else{var u=n?n+"."+o:o;i.push(u)}})),i},e.difference=function(e,t){return e.filter((function(e){return!t.find((function(t){return Ze.compareIds(e,t)}))}))},e.getValueMap=function(e,t,n){return t.reduce((function(t,r){var i=r.getEntityValueMap(e,n);if(void 0!==t&&null!=i)return Ze.mergeDeep(t,i)}),{})},e.prototype.build=function(){var e,t=this.connection.namingStrategy,n=this.connection.options.entityPrefix,r=this.connection.options.entitySkipConstructor;this.engine=this.tableMetadataArgs.engine,this.database="entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.parentEntityMetadata.database:this.tableMetadataArgs.database,this.tableMetadataArgs.schema?this.schema=this.tableMetadataArgs.schema:"entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.schema=this.parentEntityMetadata.schema:(null===(e=this.connection.options)||void 0===e?void 0:e.hasOwnProperty("schema"))&&(this.schema=this.connection.options.schema),this.givenTableName="entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.parentEntityMetadata.givenTableName:this.tableMetadataArgs.name,this.synchronize=!1!==this.tableMetadataArgs.synchronize,this.targetName=this.tableMetadataArgs.target instanceof Function?this.tableMetadataArgs.target.name:this.tableMetadataArgs.target,"closure-junction"===this.tableMetadataArgs.type?this.tableNameWithoutPrefix=t.closureJunctionTableName(this.givenTableName):"entity-child"===this.tableMetadataArgs.type&&this.parentEntityMetadata?this.tableNameWithoutPrefix=t.tableName(this.parentEntityMetadata.targetName,this.parentEntityMetadata.givenTableName):(this.tableNameWithoutPrefix=t.tableName(this.targetName,this.givenTableName),this.connection.driver.maxAliasLength&&this.connection.driver.maxAliasLength>0&&this.tableNameWithoutPrefix.length>this.connection.driver.maxAliasLength&&(this.tableNameWithoutPrefix=et(this.tableNameWithoutPrefix,{separator:"_",segmentLength:3}))),this.tableName=n?t.prefixTableName(n,this.tableNameWithoutPrefix):this.tableNameWithoutPrefix,this.target=this.target?this.target:this.tableName,this.name=this.targetName?this.targetName:this.tableName,this.expression=this.tableMetadataArgs.expression,this.withoutRowid=!0===this.tableMetadataArgs.withoutRowid,this.tablePath=this.connection.driver.buildTableName(this.tableName,this.schema,this.database),this.orderBy=this.tableMetadataArgs.orderBy instanceof Function?this.tableMetadataArgs.orderBy(this.propertiesMap):this.tableMetadataArgs.orderBy,void 0!==r&&(this.isAlwaysUsingConstructor=!r),this.isJunction="closure-junction"===this.tableMetadataArgs.type||"junction"===this.tableMetadataArgs.type,this.isClosureJunction="closure-junction"===this.tableMetadataArgs.type},e.prototype.registerColumn=function(e){-1===this.ownColumns.indexOf(e)&&(this.ownColumns.push(e),this.columns=this.embeddeds.reduce((function(e,t){return e.concat(t.columnsFromTree)}),this.ownColumns),this.primaryColumns=this.columns.filter((function(e){return e.isPrimary})),this.hasMultiplePrimaryKeys=this.primaryColumns.length>1,this.hasUUIDGeneratedColumns=this.columns.filter((function(e){return e.isGenerated||"uuid"===e.generationStrategy})).length>0,this.propertiesMap=this.createPropertiesMap(),this.childEntityMetadatas&&this.childEntityMetadatas.forEach((function(t){return t.registerColumn(e)})))},e.prototype.createPropertiesMap=function(){var e={};return this.columns.forEach((function(t){return Ze.mergeDeep(e,t.createValueMap(t.propertyPath))})),this.relations.forEach((function(t){return Ze.mergeDeep(e,t.createValueMap(t.propertyPath))})),e},e}(),gn=function(){function e(){}return e.transformFrom=function(e,t){return Array.isArray(e)?e.slice().reverse().reduce((function(e,t){return t.from(e)}),t):e.from(t)},e.transformTo=function(e,t){return Array.isArray(e)?e.reduce((function(e,t){return t.to(e)}),t):e.to(t)},e}(),bn=function(){function e(e){this.isReplicated=!1,this.treeSupport=!0,this.supportedDataTypes=["int","integer","tinyint","smallint","mediumint","bigint","unsigned big int","int2","int8","integer","character","varchar","varying character","nchar","native character","nvarchar","text","clob","text","blob","real","double","double precision","float","real","numeric","decimal","boolean","date","time","datetime"],this.withLengthColumnTypes=["character","varchar","varying character","nchar","native character","nvarchar","text","blob","clob"],this.spatialTypes=[],this.withPrecisionColumnTypes=["real","double","double precision","float","real","numeric","decimal","date","time","datetime"],this.withScaleColumnTypes=["real","double","double precision","float","real","numeric","decimal"],this.mappedDataTypes={createDate:"datetime",createDateDefault:"datetime('now')",updateDate:"datetime",updateDateDefault:"datetime('now')",deleteDate:"datetime",deleteDateNullable:!0,version:"integer",treeLevel:"integer",migrationId:"integer",migrationName:"varchar",migrationTimestamp:"bigint",cacheId:"int",cacheIdentifier:"varchar",cacheTime:"bigint",cacheDuration:"int",cacheQuery:"text",cacheResult:"text",metadataType:"varchar",metadataDatabase:"varchar",metadataSchema:"varchar",metadataTable:"varchar",metadataName:"varchar",metadataValue:"text"},this.connection=e,this.options=e.options,this.database=nt.buildDriverOptions(this.options).database}return e.prototype.connect=function(){return Ne(this,void 0,void 0,(function(){var e;return Oe(this,(function(t){switch(t.label){case 0:return e=this,[4,this.createDatabaseConnection()];case 1:return e.databaseConnection=t.sent(),[2]}}))}))},e.prototype.afterConnect=function(){return Promise.resolve()},e.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return[2,new Promise((function(t,n){e.queryRunner=void 0,e.databaseConnection.close((function(e){return e?n(e):t()}))}))]}))}))},e.prototype.createSchemaBuilder=function(){return new mn(this.connection)},e.prototype.preparePersistentValue=function(e,t){return t.transformer&&(e=gn.transformTo(t.transformer,e)),null==e?e:t.type===Boolean||"boolean"===t.type?!0===e?1:0:"date"===t.type?on.mixedDateToDateString(e):"time"===t.type?on.mixedDateToTimeString(e):"datetime"===t.type||t.type===Date?on.mixedDateToUtcDatetimeString(e):"simple-array"===t.type?on.simpleArrayToString(e):"simple-json"===t.type?on.simpleJsonToString(e):"simple-enum"===t.type?on.simpleEnumToString(e):e},e.prototype.prepareHydratedValue=function(e,t){return null==e?t.transformer?gn.transformFrom(t.transformer,e):e:(t.type===Boolean||"boolean"===t.type?e=!!e:"datetime"===t.type||t.type===Date?(e&&"string"==typeof e&&(/^\d\d\d\d-\d\d-\d\d \d\d:\d\d/.test(e)&&(e=e.replace(" ","T")),/^\d\d\d\d-\d\d-\d\dT\d\d:\d\d(:\d\d(\.\d\d\d)?)?$/.test(e)&&(e+="Z")),e=on.normalizeHydratedDate(e)):"date"===t.type?e=on.mixedDateToDateString(e):"time"===t.type?e=on.mixedTimeToString(e):"simple-array"===t.type?e=on.stringToSimpleArray(e):"simple-json"===t.type?e=on.stringToSimpleJson(e):"simple-enum"===t.type&&(e=on.stringToSimpleEnum(e,t)),t.transformer&&(e=gn.transformFrom(t.transformer,e)),e)},e.prototype.escapeQueryWithParameters=function(e,t,n){var r=this,i=Object.keys(n).map((function(e){return"boolean"==typeof n[e]?!0===n[e]?1:0:n[e]}));return t&&Object.keys(t).length?[e=e.replace(/:(\.\.\.)?([A-Za-z0-9_.]+)/g,(function(e,n,o){if(!t.hasOwnProperty(o))return e;var a=t[o];return n?a.map((function(e){return i.push(e),r.createParameter(o,i.length-1)})).join(", "):a instanceof Function?a():(i.push(a),r.createParameter(o,i.length-1))})),i]:[e,i]},e.prototype.escape=function(e){return'"'+e+'"'},e.prototype.buildTableName=function(e,t,n){return e},e.prototype.parseTableName=function(e){var t=this.database,n=void 0;if(e instanceof dn||e instanceof pn){var r=this.parseTableName(e.name);return{database:e.database||r.database||t,schema:e.schema||r.schema||n,tableName:r.tableName}}if(e instanceof un){r=this.parseTableName(e.referencedTableName);return{database:e.referencedDatabase||r.database||t,schema:e.referencedSchema||r.schema||n,tableName:r.tableName}}if(e instanceof yn)return{database:e.database||t,schema:e.schema||n,tableName:e.tableName};var i=e.split(".");return 3===i.length?{database:i[0]||t,schema:i[1]||n,tableName:i[2]}:2===i.length?{database:t,schema:i[0],tableName:i[1]}:{database:t,schema:n,tableName:e}},e.prototype.normalizeType=function(e){return e.type===Number||"int"===e.type?"integer":e.type===String?"varchar":e.type===Date?"datetime":e.type===Boolean?"boolean":"uuid"===e.type?"varchar":"simple-array"===e.type||"simple-json"===e.type?"text":"simple-enum"===e.type?"varchar":e.type||""},e.prototype.normalizeDefault=function(e){var t=e.default;return"number"==typeof t?""+t:"boolean"==typeof t?t?"1":"0":"function"==typeof t?t():"string"==typeof t?"'"+t+"'":null!=t?""+t:void 0},e.prototype.normalizeIsUnique=function(e){return e.entityMetadata.uniques.some((function(t){return 1===t.columns.length&&t.columns[0]===e}))},e.prototype.getColumnLength=function(e){return e.length?e.length.toString():""},e.prototype.createFullType=function(e){var t=e.type;return e.enum?"varchar":(e.length?t+="("+e.length+")":null!==e.precision&&void 0!==e.precision&&null!==e.scale&&void 0!==e.scale?t+="("+e.precision+","+e.scale+")":null!==e.precision&&void 0!==e.precision&&(t+="("+e.precision+")"),e.isArray&&(t+=" array"),t)},e.prototype.obtainMasterConnection=function(){return Promise.resolve()},e.prototype.obtainSlaveConnection=function(){return Promise.resolve()},e.prototype.createGeneratedMap=function(e,t,n,r){var i=e.generatedColumns.reduce((function(e,i){var o;return"increment"===i.generationStrategy&&t&&(o=t-r+n+1),o?Ze.mergeDeep(e,i.createValueMap(o)):e}),{});return Object.keys(i).length>0?i:void 0},e.prototype.findChangedColumns=function(e,t){var n=this;return t.filter((function(t){var r=e.find((function(e){return e.name===t.databaseName}));return!!r&&(r.name!==t.databaseName||r.type!==n.normalizeType(t)||r.length!==t.length||r.precision!==t.precision||r.scale!==t.scale||n.normalizeDefault(t)!==r.default||r.isPrimary!==t.isPrimary||r.isNullable!==t.isNullable||r.isUnique!==n.normalizeIsUnique(t)||"uuid"!==t.generationStrategy&&r.isGenerated!==t.isGenerated)}))},e.prototype.isReturningSqlSupported=function(){return!1},e.prototype.isUUIDGenerationSupported=function(){return!1},e.prototype.isFullTextColumnTypeSupported=function(){return!1},e.prototype.createParameter=function(e,t){return"?"},e.prototype.createDatabaseConnection=function(){throw new rt("Do not use AbstractSqlite directly, it has to be used with one of the sqlite drivers")},e.prototype.loadDependencies=function(){},e}(),vn=function(){this.count=0,this.promises=[]};o.register("d3jyk",(function(t,n){e(t.exports,"UpdateQueryBuilder",(()=>u));var r=o("lawob"),i=o("2QnDk"),a=o("e6c9k"),s=o("9oHsE").Buffer,u=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.expressionMap.aliasNamePrefixingEnabled=!1,r}return Ae(t,e),t.prototype.getQuery=function(){var e=this.createComment();return e+=this.createUpdateExpression(),e+=this.createOrderByExpression(),(e+=this.createLimitExpression()).trim()},t.prototype.execute=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,o,s,u,c,l,f,h,d,p,m,y,g,b,v,w;return Oe(this,(function(_){switch(_.label){case 0:e=this.obtainQueryRunner(),t=!1,_.label=1;case 1:return _.trys.push([1,13,18,21]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:_.sent(),t=!0,_.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(g=new vn,e.broadcaster.broadcastBeforeUpdateEvent(g,this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),g.promises.length>0?[4,Promise.all(g.promises)]:[3,5]):[3,5];case 4:_.sent(),_.label=5;case 5:if(n=null,r=null,o=new a.ReturningResultsEntityUpdator(e,this.expressionMap),s=[],Array.isArray(this.expressionMap.returning)&&this.expressionMap.mainAlias.hasMetadata)try{for(u=Ce(this.expressionMap.returning),c=u.next();!c.done;c=u.next())l=c.value,s.push.apply(s,Be([],ke(this.expressionMap.mainAlias.metadata.findColumnsWithPropertyPath(l))))}catch(e){v={error:e}}finally{try{c&&!c.done&&(w=u.return)&&w.call(u)}finally{if(v)throw v.error}}return!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=o.getUpdationReturningColumns(),s.push.apply(s,Be([],ke(this.expressionMap.extraReturningColumns.filter((function(e){return!s.includes(e)})))))),s.length>0&&this.connection.driver instanceof Ve&&(n=this.connection.driver.buildTableVariableDeclaration("@OutputTable",s),r="SELECT * FROM @OutputTable"),f=ke(this.getQueryAndParameters(),2),h=f[0],d=f[1],p=[n,h,r],[4,e.query(p.filter((function(e){return null!=e})).join(";\n\n"),d,!0)];case 6:return m=_.sent(),y=i.UpdateResult.from(m),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0?[4,o.update(y,this.expressionMap.whereEntities)]:[3,8];case 7:_.sent(),_.label=8;case 8:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(g=new vn,e.broadcaster.broadcastAfterUpdateEvent(g,this.expressionMap.mainAlias.metadata,this.expressionMap.valuesSet),g.promises.length>0?[4,Promise.all(g.promises)]:[3,10]):[3,10];case 9:_.sent(),_.label=10;case 10:return t?[4,e.commitTransaction()]:[3,12];case 11:_.sent(),_.label=12;case 12:return[2,y];case 13:if(b=_.sent(),!t)return[3,17];_.label=14;case 14:return _.trys.push([14,16,,17]),[4,e.rollbackTransaction()];case 15:return _.sent(),[3,17];case 16:return _.sent(),[3,17];case 17:throw b;case 18:return e===this.queryRunner?[3,20]:[4,e.release()];case 19:_.sent(),_.label=20;case 20:return[7];case 21:return[2]}}))}))},t.prototype.set=function(e){return this.expressionMap.valuesSet=e,this},t.prototype.where=function(e,t){this.expressionMap.wheres=[];var n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this},t.prototype.andWhere=function(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this},t.prototype.orWhere=function(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this},t.prototype.whereInIds=function(e){return this.where(this.getWhereInIdsCondition(e))},t.prototype.andWhereInIds=function(e){return this.andWhere(this.getWhereInIdsCondition(e))},t.prototype.orWhereInIds=function(e){return this.orWhere(this.getWhereInIdsCondition(e))},t.prototype.output=function(e){return this.returning(e)},t.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new Ot;return this.expressionMap.returning=e,this},t.prototype.orderBy=function(e,t,n){var r,i;return void 0===t&&(t="ASC"),this.expressionMap.orderBys=e?e instanceof Object?e:n?((r={})[e]={order:t,nulls:n},r):((i={})[e]=t,i):{},this},t.prototype.addOrderBy=function(e,t,n){return void 0===t&&(t="ASC"),this.expressionMap.orderBys[e]=n?{order:t,nulls:n}:t,this},t.prototype.limit=function(e){return this.expressionMap.limit=e,this},t.prototype.whereEntity=function(e){var t=this;if(!this.expressionMap.mainAlias.hasMetadata)throw new rt(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];var n=Array.isArray(e)?e:[e];return n.forEach((function(e){var n=t.expressionMap.mainAlias.metadata.getEntityIdMap(e);if(!n)throw new rt("Provided entity does not have ids set, cannot perform operation.");t.orWhereInIds(n)})),this.expressionMap.whereEntities=n,this},t.prototype.updateEntity=function(e){return this.expressionMap.updateEntity=e,this},t.prototype.createUpdateExpression=function(){var e=this,t=this.getValueSet(),n=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0,r=[],i=[];if(n?(this.createPropertyPath(n,t).forEach((function(o){var a=n.findColumnsWithPropertyPath(o);if(a.length<=0)throw new kt(o);a.forEach((function(n){if(n.isUpdate){i.push(n);var o=n.getEntityValue(t);if(n.referencedColumn&&o instanceof Object&&!(o instanceof s)?o=n.referencedColumn.getEntityValue(o):o instanceof Function||(o=e.connection.driver.preparePersistentValue(o,n)),o instanceof Function)r.push(e.escape(n.databaseName)+" = "+o());else if(e.connection.driver instanceof ze&&null===o)r.push(e.escape(n.databaseName)+" = NULL");else{e.connection.driver instanceof Ve&&(o=e.connection.driver.parametrizeValue(n,o));var a=e.createParameter(o),u=null;if((e.connection.driver instanceof We||e.connection.driver instanceof Fe)&&-1!==e.connection.driver.spatialTypes.indexOf(n.type)){var c=e.connection.driver.options.legacySpatialSupport?"GeomFromText":"ST_GeomFromText";u=null!=n.srid?c+"("+a+", "+n.srid+")":c+"("+a+")"}else u=e.connection.driver instanceof Ue&&-1!==e.connection.driver.spatialTypes.indexOf(n.type)?null!=n.srid?"ST_SetSRID(ST_GeomFromGeoJSON("+a+"), "+n.srid+")::"+n.type:"ST_GeomFromGeoJSON("+a+")::"+n.type:e.connection.driver instanceof Ve&&-1!==e.connection.driver.spatialTypes.indexOf(n.type)?n.type+"::STGeomFromText("+a+", "+(n.srid||"0")+")":a;r.push(e.escape(n.databaseName)+" = "+u)}}}))})),n.versionColumn&&-1===i.indexOf(n.versionColumn)&&r.push(this.escape(n.versionColumn.databaseName)+" = "+this.escape(n.versionColumn.databaseName)+" + 1"),n.updateDateColumn&&-1===i.indexOf(n.updateDateColumn)&&r.push(this.escape(n.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP")):Object.keys(t).map((function(n){var i=t[n];if(i instanceof Function)r.push(e.escape(n)+" = "+i());else if(e.connection.driver instanceof ze&&null===i)r.push(e.escape(n)+" = NULL");else{var o=e.createParameter(i);r.push(e.escape(n)+" = "+o)}})),r.length<=0)throw new mt;var o=this.createWhereExpression(),a=this.createReturningExpression();return a&&(this.connection.driver instanceof Ue||this.connection.driver instanceof He||this.connection.driver instanceof Ke)?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+r.join(", ")+o+" RETURNING "+a:a&&this.connection.driver instanceof Ve?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+r.join(", ")+" OUTPUT "+a+o:"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+r.join(", ")+o},t.prototype.createOrderByExpression=function(){var e=this,t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map((function(n){return"string"==typeof t[n]?e.replacePropertyNames(n)+" "+t[n]:e.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls})).join(", "):""},t.prototype.createLimitExpression=function(){var e=this.expressionMap.limit;if(e){if(this.connection.driver instanceof We||this.connection.driver instanceof Fe)return" LIMIT "+e;throw new xt}return""},t.prototype.getValueSet=function(){if(this.expressionMap.valuesSet instanceof Object)return this.expressionMap.valuesSet;throw new mt},t}(r.QueryBuilder)})),o.register("2QnDk",(function(t,n){e(t.exports,"UpdateResult",(()=>r));var r=function(){function e(){this.generatedMaps=[]}return e.from=function(e){var t=new this;return t.raw=e.records,t.affected=e.affected,t},e}()})),o.register("9nUs1",(function(t,n){e(t.exports,"DeleteQueryBuilder",(()=>a));var r=o("lawob"),i=o("14MvS"),a=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.expressionMap.aliasNamePrefixingEnabled=!1,r}return Ae(t,e),t.prototype.getQuery=function(){var e=this.createComment();return(e+=this.createDeleteExpression()).trim()},t.prototype.execute=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,o,a,s,u,c;return Oe(this,(function(l){switch(l.label){case 0:e=ke(this.getQueryAndParameters(),2),t=e[0],n=e[1],r=this.obtainQueryRunner(),o=!1,l.label=1;case 1:return l.trys.push([1,11,16,19]),!0!==this.expressionMap.useTransaction||!1!==r.isTransactionActive?[3,3]:[4,r.startTransaction()];case 2:l.sent(),o=!0,l.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(u=new vn,r.broadcaster.broadcastBeforeRemoveEvent(u,this.expressionMap.mainAlias.metadata),u.promises.length>0?[4,Promise.all(u.promises)]:[3,5]):[3,5];case 4:l.sent(),l.label=5;case 5:return[4,r.query(t,n,!0)];case 6:return a=l.sent(),s=i.DeleteResult.from(a),!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(u=new vn,r.broadcaster.broadcastAfterRemoveEvent(u,this.expressionMap.mainAlias.metadata),u.promises.length>0?[4,Promise.all(u.promises)]:[3,8]):[3,8];case 7:l.sent(),l.label=8;case 8:return o?[4,r.commitTransaction()]:[3,10];case 9:l.sent(),l.label=10;case 10:return[2,s];case 11:if(c=l.sent(),!o)return[3,15];l.label=12;case 12:return l.trys.push([12,14,,15]),[4,r.rollbackTransaction()];case 13:return l.sent(),[3,15];case 14:return l.sent(),[3,15];case 15:throw c;case 16:return r===this.queryRunner?[3,18]:[4,r.release()];case 17:l.sent(),l.label=18;case 18:return[7];case 19:return[2]}}))}))},t.prototype.from=function(e,t){e=e instanceof wt?e.options.name:e;var n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this},t.prototype.where=function(e,t){this.expressionMap.wheres=[];var n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this},t.prototype.andWhere=function(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this},t.prototype.orWhere=function(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this},t.prototype.whereInIds=function(e){return this.where(this.getWhereInIdsCondition(e))},t.prototype.andWhereInIds=function(e){return this.andWhere(this.getWhereInIdsCondition(e))},t.prototype.orWhereInIds=function(e){return this.orWhere(this.getWhereInIdsCondition(e))},t.prototype.output=function(e){return this.returning(e)},t.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new Ot;return this.expressionMap.returning=e,this},t.prototype.createDeleteExpression=function(){var e=this.getTableName(this.getMainTableName()),t=this.createWhereExpression(),n=this.createReturningExpression();return n&&(this.connection.driver instanceof Ue||this.connection.driver instanceof Ke)?"DELETE FROM "+e+t+" RETURNING "+n:""!==n&&this.connection.driver instanceof Ve?"DELETE FROM "+e+" OUTPUT "+n+t:"DELETE FROM "+e+t},t}(r.QueryBuilder)})),o.register("14MvS",(function(t,n){e(t.exports,"DeleteResult",(()=>r));var r=function(){function e(){}return e.from=function(e){var t=new this;return t.raw=e.records,t.affected=e.affected,t},e}()})),o.register("g1b81",(function(t,n){e(t.exports,"SoftDeleteQueryBuilder",(()=>s));var r=o("lawob"),i=o("2QnDk"),a=o("e6c9k"),s=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.expressionMap.aliasNamePrefixingEnabled=!1,r}return Ae(t,e),t.prototype.getQuery=function(){var e=this.createUpdateExpression();return e+=this.createOrderByExpression(),(e+=this.createLimitExpression()).trim()},t.prototype.execute=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,o,s,u,c,l,f;return Oe(this,(function(h){switch(h.label){case 0:e=this.obtainQueryRunner(),t=!1,h.label=1;case 1:return h.trys.push([1,13,18,21]),!0!==this.expressionMap.useTransaction||!1!==e.isTransactionActive?[3,3]:[4,e.startTransaction()];case 2:h.sent(),t=!0,h.label=3;case 3:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(l=new vn,e.broadcaster.broadcastBeforeUpdateEvent(l,this.expressionMap.mainAlias.metadata),l.promises.length>0?[4,Promise.all(l.promises)]:[3,5]):[3,5];case 4:h.sent(),h.label=5;case 5:return n=new a.ReturningResultsEntityUpdator(e,this.expressionMap),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0&&(this.expressionMap.extraReturningColumns=n.getUpdationReturningColumns()),r=ke(this.getQueryAndParameters(),2),o=r[0],s=r[1],[4,e.query(o,s,!0)];case 6:return u=h.sent(),c=i.UpdateResult.from(u),!0===this.expressionMap.updateEntity&&this.expressionMap.mainAlias.hasMetadata&&this.expressionMap.whereEntities.length>0?[4,n.update(c,this.expressionMap.whereEntities)]:[3,8];case 7:h.sent(),h.label=8;case 8:return!0===this.expressionMap.callListeners&&this.expressionMap.mainAlias.hasMetadata?(l=new vn,e.broadcaster.broadcastAfterUpdateEvent(l,this.expressionMap.mainAlias.metadata),l.promises.length>0?[4,Promise.all(l.promises)]:[3,10]):[3,10];case 9:h.sent(),h.label=10;case 10:return t?[4,e.commitTransaction()]:[3,12];case 11:h.sent(),h.label=12;case 12:return[2,c];case 13:if(f=h.sent(),!t)return[3,17];h.label=14;case 14:return h.trys.push([14,16,,17]),[4,e.rollbackTransaction()];case 15:return h.sent(),[3,17];case 16:return h.sent(),[3,17];case 17:throw f;case 18:return e===this.queryRunner?[3,20]:[4,e.release()];case 19:h.sent(),h.label=20;case 20:return[7];case 21:return[2]}}))}))},t.prototype.from=function(e,t){e=e instanceof wt?e.options.name:e;var n=this.createFromAlias(e,t);return this.expressionMap.setMainAlias(n),this},t.prototype.where=function(e,t){this.expressionMap.wheres=[];var n=this.getWhereCondition(e);return n&&(this.expressionMap.wheres=[{type:"simple",condition:n}]),t&&this.setParameters(t),this},t.prototype.andWhere=function(e,t){return this.expressionMap.wheres.push({type:"and",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this},t.prototype.orWhere=function(e,t){return this.expressionMap.wheres.push({type:"or",condition:this.getWhereCondition(e)}),t&&this.setParameters(t),this},t.prototype.whereInIds=function(e){return this.where(this.getWhereInIdsCondition(e))},t.prototype.andWhereInIds=function(e){return this.andWhere(this.getWhereInIdsCondition(e))},t.prototype.orWhereInIds=function(e){return this.orWhere(this.getWhereInIdsCondition(e))},t.prototype.output=function(e){return this.returning(e)},t.prototype.returning=function(e){if(!this.connection.driver.isReturningSqlSupported())throw new Ot;return this.expressionMap.returning=e,this},t.prototype.orderBy=function(e,t,n){var r,i;return void 0===t&&(t="ASC"),this.expressionMap.orderBys=e?e instanceof Object?e:n?((r={})[e]={order:t,nulls:n},r):((i={})[e]=t,i):{},this},t.prototype.addOrderBy=function(e,t,n){return void 0===t&&(t="ASC"),this.expressionMap.orderBys[e]=n?{order:t,nulls:n}:t,this},t.prototype.limit=function(e){return this.expressionMap.limit=e,this},t.prototype.whereEntity=function(e){var t=this;if(!this.expressionMap.mainAlias.hasMetadata)throw new rt(".whereEntity method can only be used on queries which update real entity table.");this.expressionMap.wheres=[];var n=Array.isArray(e)?e:[e];return n.forEach((function(e){var n=t.expressionMap.mainAlias.metadata.getEntityIdMap(e);if(!n)throw new rt("Provided entity does not have ids set, cannot perform operation.");t.orWhereInIds(n)})),this.expressionMap.whereEntities=n,this},t.prototype.updateEntity=function(e){return this.expressionMap.updateEntity=e,this},t.prototype.createUpdateExpression=function(){var e=this.expressionMap.mainAlias.hasMetadata?this.expressionMap.mainAlias.metadata:void 0;if(!e)throw new rt('Cannot get entity metadata for the given alias "'+this.expressionMap.mainAlias+'"');if(!e.deleteDateColumn)throw new Pt(e);var t=[];switch(this.expressionMap.queryType){case"soft-delete":t.push(this.escape(e.deleteDateColumn.databaseName)+" = CURRENT_TIMESTAMP");break;case"restore":t.push(this.escape(e.deleteDateColumn.databaseName)+" = NULL");break;default:throw new rt('The queryType must be "soft-delete" or "restore"')}if(e.versionColumn&&t.push(this.escape(e.versionColumn.databaseName)+" = "+this.escape(e.versionColumn.databaseName)+" + 1"),e.updateDateColumn&&t.push(this.escape(e.updateDateColumn.databaseName)+" = CURRENT_TIMESTAMP"),t.length<=0)throw new mt;var n=this.createWhereExpression(),r=this.createReturningExpression();return r&&(this.connection.driver instanceof Ue||this.connection.driver instanceof He||this.connection.driver instanceof Ke)?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+t.join(", ")+n+" RETURNING "+r:r&&this.connection.driver instanceof Ve?"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+t.join(", ")+" OUTPUT "+r+n:"UPDATE "+this.getTableName(this.getMainTableName())+" SET "+t.join(", ")+n},t.prototype.createOrderByExpression=function(){var e=this,t=this.expressionMap.orderBys;return Object.keys(t).length>0?" ORDER BY "+Object.keys(t).map((function(n){return"string"==typeof t[n]?e.replacePropertyNames(n)+" "+t[n]:e.replacePropertyNames(n)+" "+t[n].order+" "+t[n].nulls})).join(", "):""},t.prototype.createLimitExpression=function(){var e=this.expressionMap.limit;if(e){if(this.connection.driver instanceof We)return" LIMIT "+e;throw new xt}return""},t}(r.QueryBuilder)})),o.register("3RnXi",(function(t,n){e(t.exports,"RelationQueryBuilder",(()=>s));var r=o("lawob"),i=o("7xMPb"),a=o("jQezk"),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),t.prototype.getQuery=function(){return""},t.prototype.of=function(e){return this.expressionMap.of=e,this},t.prototype.set=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){if(t=this.expressionMap.relationMetadata,!this.expressionMap.of)throw new rt("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToMany||t.isOneToMany)throw new rt('Set operation is only supported for many-to-one and one-to-one relations. However given "'+t.propertyPath+'" has '+t.relationType+" relation. Use .add() method instead.");if(t.joinColumns&&t.joinColumns.length>1&&(!(e instanceof Object)||Object.keys(e).length<t.joinColumns.length))throw new rt('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return[2,new i.RelationUpdater(this,this.expressionMap).update(e)]}))}))},t.prototype.add=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){if(Array.isArray(e)&&0===e.length)return[2];if(t=this.expressionMap.relationMetadata,!this.expressionMap.of)throw new rt("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToOne||t.isOneToOne)throw new rt('Add operation is only supported for many-to-many and one-to-many relations. However given "'+t.propertyPath+'" has '+t.relationType+" relation. Use .set() method instead.");if(t.joinColumns&&t.joinColumns.length>1&&(!(e instanceof Object)||Object.keys(e).length<t.joinColumns.length))throw new rt('Value to be set into the relation must be a map of relation ids, for example: .set({ firstName: "...", lastName: "..." })');return[2,new i.RelationUpdater(this,this.expressionMap).update(e)]}))}))},t.prototype.remove=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){if(Array.isArray(e)&&0===e.length)return[2];if(t=this.expressionMap.relationMetadata,!this.expressionMap.of)throw new rt("Entity whose relation needs to be set is not set. Use .of method to define whose relation you want to set.");if(t.isManyToOne||t.isOneToOne)throw new rt('Add operation is only supported for many-to-many and one-to-many relations. However given "'+t.propertyPath+'" has '+t.relationType+" relation. Use .set(null) method instead.");return[2,new a.RelationRemover(this,this.expressionMap).remove(e)]}))}))},t.prototype.addAndRemove=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(n){switch(n.label){case 0:return[4,this.remove(t)];case 1:return n.sent(),[4,this.add(e)];case 2:return n.sent(),[2]}}))}))},t.prototype.loadOne=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,this.loadMany().then((function(e){return e[0]}))]}))}))},t.prototype.loadMany=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){if(!((e=this.expressionMap.of)instanceof Object)){if((t=this.expressionMap.mainAlias.metadata).hasMultiplePrimaryKeys)throw new rt("Cannot load entity because only one primary key was specified, however entity contains multiple primary keys");e=t.primaryColumns[0].createValueMap(e)}return[2,this.connection.relationLoader.load(this.expressionMap.relationMetadata,e,this.queryRunner)]}))}))},t}(r.QueryBuilder)})),o.register("7xMPb",(function(t,n){e(t.exports,"RelationUpdater",(()=>r));var r=function(){function e(e,t){this.queryBuilder=e,this.expressionMap=t}return e.prototype.update=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l,f,h,d,p=this;return Oe(this,(function(m){switch(m.label){case 0:return(t=this.expressionMap.relationMetadata).isManyToOne||t.isOneToOneOwner?(s=t.joinColumns.reduce((function(t,n){var r=e instanceof Object?n.referencedColumn.getEntityValue(e):e;return n.setEntityValue(t,r),t}),{}),!this.expressionMap.of||Array.isArray(this.expressionMap.of)&&!this.expressionMap.of.length?[2]:[4,this.queryBuilder.createQueryBuilder().update(t.entityMetadata.target).set(s).whereInIds(this.expressionMap.of).execute()]):[3,2];case 1:return m.sent(),[3,10];case 2:return!t.isOneToOneNotOwner&&!t.isOneToMany||null!==e?[3,4]:(n={},t.inverseRelation.joinColumns.forEach((function(e){n[e.propertyName]=null})),c=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],r={},i=[],c.forEach((function(e,n){t.inverseRelation.joinColumns.map((function(t,o){var a="joinColumn_"+n+"_"+o;r[a]=e instanceof Object?t.referencedColumn.getEntityValue(e):e,i.push(t.propertyPath+" = :"+a)}))})),(o=i.map((function(e){return"("+e+")"})).join(" OR "))?[4,this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(n).where(o).setParameters(r).execute()]:[2]);case 3:return m.sent(),[3,10];case 4:if(!t.isOneToOneNotOwner&&!t.isOneToMany)return[3,6];if(Array.isArray(this.expressionMap.of))throw new rt("You cannot update relations of multiple entities with the same related object. Provide a single entity into .of method.");return a=this.expressionMap.of,s=t.inverseRelation.joinColumns.reduce((function(e,t){var n=a instanceof Object?t.referencedColumn.getEntityValue(a):a;return t.setEntityValue(e,n),e}),{}),!e||Array.isArray(e)&&!e.length?[2]:[4,this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(s).whereInIds(e).execute()];case 5:return m.sent(),[3,10];case 6:return u=t.junctionEntityMetadata,c=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],l=Array.isArray(e)?e:[e],f=t.isManyToManyOwner?c:l,h=t.isManyToManyOwner?l:c,d=[],f.forEach((function(e){h.forEach((function(t){var n={};u.ownerColumns.forEach((function(t){n[t.databaseName]=e instanceof Object?t.referencedColumn.getEntityValue(e):e})),u.inverseColumns.forEach((function(e){n[e.databaseName]=t instanceof Object?e.referencedColumn.getEntityValue(t):t})),d.push(n)}))})),d.length?this.queryBuilder.connection.driver instanceof He||this.queryBuilder.connection.driver instanceof ze?[4,Promise.all(d.map((function(e){return p.queryBuilder.createQueryBuilder().insert().into(u.tableName).values(e).execute()})))]:[3,8]:[2];case 7:return m.sent(),[3,10];case 8:return[4,this.queryBuilder.createQueryBuilder().insert().into(u.tableName).values(d).execute()];case 9:m.sent(),m.label=10;case 10:return[2]}}))}))},e}()})),o.register("jQezk",(function(t,n){e(t.exports,"RelationRemover",(()=>r));var r=function(){function e(e,t){this.queryBuilder=e,this.expressionMap=t}return e.prototype.remove=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l,f,h,d;return Oe(this,(function(p){switch(p.label){case 0:return(t=this.expressionMap.relationMetadata).isOneToMany?(s=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],n=Array.isArray(e)?e:[e],r={},t.inverseRelation.joinColumns.forEach((function(e){r[e.propertyName]=null})),i={},o=[],s.forEach((function(e,r){o.push.apply(o,Be([],ke(n.map((function(n,o){return Be(Be([],ke(t.inverseRelation.joinColumns.map((function(t,n){var a="joinColumn_"+r+"_"+o+"_"+n;return i[a]=e instanceof Object?t.referencedColumn.getEntityValue(e):e,t.propertyPath+" = :"+a})))),ke(t.inverseRelation.entityMetadata.primaryColumns.map((function(e,t){var r="primaryColumn_"+o+"_"+o+"_"+t;return i[r]=n instanceof Object?e.getEntityValue(n):n,e.propertyPath+" = :"+r})))).join(" AND ")})))))})),(d=o.map((function(e){return"("+e+")"})).join(" OR "))?[4,this.queryBuilder.createQueryBuilder().update(t.inverseEntityMetadata.target).set(r).where(d).setParameters(i).execute()]:[2]):[3,2];case 1:return p.sent(),[3,4];case 2:return a=t.junctionEntityMetadata,s=Array.isArray(this.expressionMap.of)?this.expressionMap.of:[this.expressionMap.of],u=Array.isArray(e)?e:[e],c=t.isManyToManyOwner?s:u,l=t.isManyToManyOwner?u:s,f={},h=[],c.forEach((function(e,t){h.push.apply(h,Be([],ke(l.map((function(n,r){return Be(Be([],ke(a.ownerColumns.map((function(n,i){var o="firstValue_"+t+"_"+r+"_"+i;return f[o]=e instanceof Object?n.referencedColumn.getEntityValue(e):e,n.databaseName+" = :"+o})))),ke(a.inverseColumns.map((function(e,i){var o="secondValue_"+t+"_"+r+"_"+i;return f[o]=n instanceof Object?e.referencedColumn.getEntityValue(n):n,e.databaseName+" = :"+o})))).join(" AND ")})))))})),d=h.map((function(e){return"("+e+")"})).join(" OR "),[4,this.queryBuilder.createQueryBuilder().delete().from(a.tableName).where(d).setParameters(f).execute()];case 3:p.sent(),p.label=4;case 4:return[2]}}))}))},e}()})),o.register("aipRq",(function(e,t){e.exports=function(e){function t(e){let r,i,o,a=null;function s(...e){if(!s.enabled)return;const n=s,i=Number(new Date),o=i-(r||i);n.diff=o,n.prev=r,n.curr=i,r=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,((r,i)=>{if("%%"===r)return"%";a++;const o=t.formatters[i];if("function"==typeof o){const t=e[a];r=o.call(n,t),e.splice(a,1),a--}return r})),t.formatArgs.call(n,e);(n.log||t.log).apply(n,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=n,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==a?a:(i!==t.namespaces&&(i=t.namespaces,o=t.enabled(e)),o),set:e=>{a=e}}),"function"==typeof t.init&&t.init(s),s}function n(e,n){const r=t(this.namespace+(void 0===n?":":n)+e);return r.log=this.log,r}function r(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(r),...t.skips.map(r).map((e=>"-"+e))].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const r=("string"==typeof e?e:"").split(/[\s,]+/),i=r.length;for(n=0;n<i;n++)r[n]&&("-"===(e=r[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=o("796b5"),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach((n=>{t[n]=e[n]})),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}})),o.register("796b5",(function(e,t){var n=1e3,r=6e4,i=36e5,o=864e5,a=6048e5,s=315576e5;function u(e,t,n,r){var i=t>=1.5*n;return Math.round(e/n)+" "+r+(i?"s":"")}e.exports=function(e,t){t=t||{};var c,l,f=typeof e;if("string"===f&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(!t)return;var u=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return u*s;case"weeks":case"week":case"w":return u*a;case"days":case"day":case"d":return u*o;case"hours":case"hour":case"hrs":case"hr":case"h":return u*i;case"minutes":case"minute":case"mins":case"min":case"m":return u*r;case"seconds":case"second":case"secs":case"sec":case"s":return u*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return u;default:return}}(e);if("number"===f&&isFinite(e))return t.long?(c=e,(l=Math.abs(c))>=o?u(c,l,o,"day"):l>=i?u(c,l,i,"hour"):l>=r?u(c,l,r,"minute"):l>=n?u(c,l,n,"second"):c+" ms"):function(e){var t=Math.abs(e);return t>=o?Math.round(e/o)+"d":t>=i?Math.round(e/i)+"h":t>=r?Math.round(e/r)+"m":t>=n?Math.round(e/n)+"s":e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}})),o.register("fO1PS",(function(e,t){var n=o("j1UVA"),r=tn,i=nn,a=o("7H4yS"),s=o("7thg8"),u=o("1EBKZ").Buffer,c=o("lh7Mj"),l={};function f(e){return a.compare(e,this._upperBound)>0}function h(e){return a.compare(e,this._upperBound)>=0}function d(e){return a.compare(e,this._upperBound)<0}function p(e){return a.compare(e,this._upperBound)<=0}function m(e,t){i.call(this,e),this._limit=t.limit,-1===this._limit&&(this._limit=1/0);var n=e._store;this.keyAsBuffer=!1!==t.keyAsBuffer,this.valueAsBuffer=!1!==t.valueAsBuffer,this._reverse=t.reverse,this._options=t,this._done=0,this._reverse?(this._incr="prev",this._lowerBound=a.upperBound(t,l),this._upperBound=a.lowerBound(t,l),this._lowerBound===l?this._tree=n.end:a.upperBoundInclusive(t)?this._tree=n.le(this._lowerBound):this._tree=n.lt(this._lowerBound),this._upperBound!==l&&(a.lowerBoundInclusive(t)?this._test=h:this._test=f)):(this._incr="next",this._lowerBound=a.lowerBound(t,l),this._upperBound=a.upperBound(t,l),this._lowerBound===l?this._tree=n.begin:a.lowerBoundInclusive(t)?this._tree=n.ge(this._lowerBound):this._tree=n.gt(this._lowerBound),this._upperBound!==l&&(a.upperBoundInclusive(t)?this._test=p:this._test=d))}function y(){if(!(this instanceof y))return new y;r.call(this,{bufferKeys:!0,snapshots:!0,permanence:!1,seek:!0,clear:!0}),this._store=s(a.compare)}n(m,i),m.prototype._next=function(e){var t,n;return this._done++>=this._limit?c(e):this._tree.valid?(t=this._tree.key,n=this._tree.value,this._test(t)?(this.keyAsBuffer||(t=t.toString()),this.valueAsBuffer||(n=n.toString()),this._tree[this._incr](),void c((function(){e(null,t,n)}))):c(e)):c(e)},m.prototype._test=function(){return!0},m.prototype._outOfRange=function(e){return!this._test(e)||this._lowerBound!==l&&(this._reverse?a.upperBoundInclusive(this._options)?a.compare(e,this._lowerBound)>0:a.compare(e,this._lowerBound)>=0:a.lowerBoundInclusive(this._options)?a.compare(e,this._lowerBound)<0:a.compare(e,this._lowerBound)<=0)},m.prototype._seek=function(e){if(0===e.length)throw new Error("cannot seek() to an empty target");this._outOfRange(e)?(this._tree=this.db._store.end,this._tree.next()):this._reverse?this._tree=this.db._store.le(e):this._tree=this.db._store.ge(e)},n(y,r),y.prototype._open=function(e,t){var n=this;c((function(){t(null,n)}))},y.prototype._serializeKey=function(e){return u.isBuffer(e)?e:u.from(String(e))},y.prototype._serializeValue=function(e){return u.isBuffer(e)?e:u.from(String(e))},y.prototype._put=function(e,t,n,r){var i=this._store.find(e);i.valid?this._store=i.update(t):this._store=this._store.insert(e,t),c(r)},y.prototype._get=function(e,t,n){var r=this._store.get(e);if(void 0===r)return c((function(){n(new Error("NotFound"))}));t.asBuffer||(r=r.toString()),c((function(){n(null,r)}))},y.prototype._del=function(e,t,n){this._store=this._store.remove(e),c(n)},y.prototype._batch=function(e,t,n){for(var r,i,o,a=-1,s=e.length,u=this._store;++a<s;)r=e[a].key,o=u.find(r),"put"===e[a].type?(i=e[a].value,u=o.valid?o.update(i):u.insert(r,i)):u=o.remove();this._store=u,c(n)},y.prototype._iterator=function(e){return new m(this,e)},e.exports=y.default=y,e.exports.MemIterator=m})),tn=o("5Z2ZN"),nn=o("5sKS0"),rn=o("7hdOB"),o.register("7H4yS",(function(t,n){var r,i,o,a,s,u,c,l,f,h;e(t.exports,"compare",(()=>r),(e=>r=e)),e(t.exports,"lowerBoundKey",(()=>i),(e=>i=e)),e(t.exports,"lowerBound",(()=>o),(e=>o=e)),e(t.exports,"lowerBoundInclusive",(()=>a),(e=>a=e)),e(t.exports,"upperBoundInclusive",(()=>s),(e=>s=e)),e(t.exports,"lowerBoundExclusive",(()=>u),(e=>u=e)),e(t.exports,"upperBoundExclusive",(()=>c),(e=>c=e)),e(t.exports,"upperBoundKey",(()=>l),(e=>l=e)),e(t.exports,"upperBound",(()=>f),(e=>f=e)),e(t.exports,"contains",(()=>h),(e=>h=e));var d=T;function p(e){return void 0!==e&&""!==e}function m(e,t){return Object.hasOwnProperty.call(e,t)}function y(e,t){return Object.hasOwnProperty.call(e,t)&&t}r=function(e,t){if(d.isBuffer(e)){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e[r]-t[r];if(i)return i}return e.length-t.length}return e<t?-1:e>t?1:0};var g=i=function(e){return y(e,"gt")||y(e,"gte")||y(e,"min")||(e.reverse?y(e,"end"):y(e,"start"))||void 0},b=o=function(e,t){var n=g(e);return n?e[n]:t},v=a=function(e){return!m(e,"gt")},w=s=function(e){return!m(e,"lt")},_=u=function(e){return!v(e)},E=c=function(e){return!w(e)},S=l=function(e){return y(e,"lt")||y(e,"lte")||y(e,"max")||(e.reverse?y(e,"start"):y(e,"end"))||void 0},x=f=function(e,t){var n=S(e);return n?e[n]:t};function M(e){return e}h=function(e,t,n){n=n||r;var i=b(e);if(p(i)&&((o=n(t,i))<0||0===o&&_(e)))return!1;var o,a=x(e);if(p(a)&&((o=n(t,a))>0||0===o&&E(e)))return!1;return!0}})),o.register("7thg8",(function(e,t){e.exports=function(e){return new a(e||p,null)};function n(e,t,n,r,i,o){this._color=e,this.key=t,this.value=n,this.left=r,this.right=i,this._count=o}function r(e){return new n(e._color,e.key,e.value,e.left,e.right,e._count)}function i(e,t){return new n(e,t.key,t.value,t.left,t.right,t._count)}function o(e){e._count=1+(e.left?e.left._count:0)+(e.right?e.right._count:0)}function a(e,t){this._compare=e,this.root=t}var s=a.prototype;function u(e,t){var n;if(t.left&&(n=u(e,t.left)))return n;return(n=e(t.key,t.value))||(t.right?u(e,t.right):void 0)}function c(e,t,n,r){if(t(e,r.key)<=0){var i;if(r.left)if(i=c(e,t,n,r.left))return i;if(i=n(r.key,r.value))return i}if(r.right)return c(e,t,n,r.right)}function l(e,t,n,r,i){var o,a=n(e,i.key),s=n(t,i.key);if(a<=0){if(i.left&&(o=l(e,t,n,r,i.left)))return o;if(s>0&&(o=r(i.key,i.value)))return o}if(s>0&&i.right)return l(e,t,n,r,i.right)}function f(e,t){this.tree=e,this._stack=t}Object.defineProperty(s,"keys",{get:function(){var e=[];return this.forEach((function(t,n){e.push(t)})),e}}),Object.defineProperty(s,"values",{get:function(){var e=[];return this.forEach((function(t,n){e.push(n)})),e}}),Object.defineProperty(s,"length",{get:function(){return this.root?this.root._count:0}}),s.insert=function(e,t){for(var r=this._compare,s=this.root,u=[],c=[];s;){var l=r(e,s.key);u.push(s),c.push(l),s=l<=0?s.left:s.right}u.push(new n(0,e,t,null,null,1));for(var f=u.length-2;f>=0;--f){s=u[f];c[f]<=0?u[f]=new n(s._color,s.key,s.value,u[f+1],s.right,s._count+1):u[f]=new n(s._color,s.key,s.value,s.left,u[f+1],s._count+1)}for(f=u.length-1;f>1;--f){var h=u[f-1];s=u[f];if(1===h._color||1===s._color)break;var d=u[f-2];if(d.left===h)if(h.left===s){if(!(p=d.right)||0!==p._color){if(d._color=0,d.left=h.right,h._color=1,h.right=d,u[f-2]=h,u[f-1]=s,o(d),o(h),f>=3)(m=u[f-3]).left===d?m.left=h:m.right=h;break}h._color=1,d.right=i(1,p),d._color=0,f-=1}else{if(!(p=d.right)||0!==p._color){if(h.right=s.left,d._color=0,d.left=s.right,s._color=1,s.left=h,s.right=d,u[f-2]=s,u[f-1]=h,o(d),o(h),o(s),f>=3)(m=u[f-3]).left===d?m.left=s:m.right=s;break}h._color=1,d.right=i(1,p),d._color=0,f-=1}else if(h.right===s){if(!(p=d.left)||0!==p._color){if(d._color=0,d.right=h.left,h._color=1,h.left=d,u[f-2]=h,u[f-1]=s,o(d),o(h),f>=3)(m=u[f-3]).right===d?m.right=h:m.left=h;break}h._color=1,d.left=i(1,p),d._color=0,f-=1}else{var p;if(!(p=d.left)||0!==p._color){var m;if(h.left=s.right,d._color=0,d.right=s.left,s._color=1,s.right=h,s.left=d,u[f-2]=s,u[f-1]=h,o(d),o(h),o(s),f>=3)(m=u[f-3]).right===d?m.right=s:m.left=s;break}h._color=1,d.left=i(1,p),d._color=0,f-=1}}return u[0]._color=1,new a(r,u[0])},s.forEach=function(e,t,n){if(this.root)switch(arguments.length){case 1:return u(e,this.root);case 2:return c(t,this._compare,e,this.root);case 3:if(this._compare(t,n)>=0)return;return l(t,n,this._compare,e,this.root)}},Object.defineProperty(s,"begin",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.left;return new f(this,e)}}),Object.defineProperty(s,"end",{get:function(){for(var e=[],t=this.root;t;)e.push(t),t=t.right;return new f(this,e)}}),s.at=function(e){if(e<0)return new f(this,[]);for(var t=this.root,n=[];;){if(n.push(t),t.left){if(e<t.left._count){t=t.left;continue}e-=t.left._count}if(!e)return new f(this,n);if(e-=1,!t.right)break;if(e>=t.right._count)break;t=t.right}return new f(this,[])},s.ge=function(e){for(var t=this._compare,n=this.root,r=[],i=0;n;){var o=t(e,n.key);r.push(n),o<=0&&(i=r.length),n=o<=0?n.left:n.right}return r.length=i,new f(this,r)},s.gt=function(e){for(var t=this._compare,n=this.root,r=[],i=0;n;){var o=t(e,n.key);r.push(n),o<0&&(i=r.length),n=o<0?n.left:n.right}return r.length=i,new f(this,r)},s.lt=function(e){for(var t=this._compare,n=this.root,r=[],i=0;n;){var o=t(e,n.key);r.push(n),o>0&&(i=r.length),n=o<=0?n.left:n.right}return r.length=i,new f(this,r)},s.le=function(e){for(var t=this._compare,n=this.root,r=[],i=0;n;){var o=t(e,n.key);r.push(n),o>=0&&(i=r.length),n=o<0?n.left:n.right}return r.length=i,new f(this,r)},s.find=function(e){for(var t=this._compare,n=this.root,r=[];n;){var i=t(e,n.key);if(r.push(n),0===i)return new f(this,r);n=i<=0?n.left:n.right}return new f(this,[])},s.remove=function(e){var t=this.find(e);return t?t.remove():this},s.get=function(e){for(var t=this._compare,n=this.root;n;){var r=t(e,n.key);if(0===r)return n.value;n=r<=0?n.left:n.right}};var h=f.prototype;function d(e,t){e.key=t.key,e.value=t.value,e.left=t.left,e.right=t.right,e._color=t._color,e._count=t._count}function p(e,t){return e<t?-1:e>t?1:0}Object.defineProperty(h,"valid",{get:function(){return this._stack.length>0}}),Object.defineProperty(h,"node",{get:function(){return this._stack.length>0?this._stack[this._stack.length-1]:null},enumerable:!0}),h.clone=function(){return new f(this.tree,this._stack.slice())},h.remove=function(){var e=this._stack;if(0===e.length)return this.tree;var t=new Array(e.length),s=e[e.length-1];t[t.length-1]=new n(s._color,s.key,s.value,s.left,s.right,s._count);for(var u=e.length-2;u>=0;--u){(s=e[u]).left===e[u+1]?t[u]=new n(s._color,s.key,s.value,t[u+1],s.right,s._count):t[u]=new n(s._color,s.key,s.value,s.left,t[u+1],s._count)}if((s=t[t.length-1]).left&&s.right){var c=t.length;for(s=s.left;s.right;)t.push(s),s=s.right;var l=t[c-1];t.push(new n(s._color,l.key,l.value,s.left,s.right,s._count)),t[c-1].key=s.key,t[c-1].value=s.value;for(u=t.length-2;u>=c;--u)s=t[u],t[u]=new n(s._color,s.key,s.value,s.left,t[u+1],s._count);t[c-1].left=t[c]}if(0===(s=t[t.length-1])._color){var f=t[t.length-2];f.left===s?f.left=null:f.right===s&&(f.right=null),t.pop();for(u=0;u<t.length;++u)t[u]._count--;return new a(this.tree._compare,t[0])}if(s.left||s.right){s.left?d(s,s.left):s.right&&d(s,s.right),s._color=1;for(u=0;u<t.length-1;++u)t[u]._count--;return new a(this.tree._compare,t[0])}if(1===t.length)return new a(this.tree._compare,null);for(u=0;u<t.length;++u)t[u]._count--;var h=t[t.length-2];return function(e){for(var t,n,a,s,u=e.length-1;u>=0;--u){if(t=e[u],0===u)return void(t._color=1);if((n=e[u-1]).left===t){if((a=n.right).right&&0===a.right._color)return s=(a=n.right=r(a)).right=r(a.right),n.right=a.left,a.left=n,a.right=s,a._color=n._color,t._color=1,n._color=1,s._color=1,o(n),o(a),u>1&&((c=e[u-2]).left===n?c.left=a:c.right=a),void(e[u-1]=a);if(a.left&&0===a.left._color)return s=(a=n.right=r(a)).left=r(a.left),n.right=s.left,a.left=s.right,s.left=n,s.right=a,s._color=n._color,n._color=1,a._color=1,t._color=1,o(n),o(a),o(s),u>1&&((c=e[u-2]).left===n?c.left=s:c.right=s),void(e[u-1]=s);if(1===a._color){if(0===n._color)return n._color=1,void(n.right=i(0,a));n.right=i(0,a);continue}a=r(a),n.right=a.left,a.left=n,a._color=n._color,n._color=0,o(n),o(a),u>1&&((c=e[u-2]).left===n?c.left=a:c.right=a),e[u-1]=a,e[u]=n,u+1<e.length?e[u+1]=t:e.push(t),u+=2}else{if((a=n.left).left&&0===a.left._color)return s=(a=n.left=r(a)).left=r(a.left),n.left=a.right,a.right=n,a.left=s,a._color=n._color,t._color=1,n._color=1,s._color=1,o(n),o(a),u>1&&((c=e[u-2]).right===n?c.right=a:c.left=a),void(e[u-1]=a);if(a.right&&0===a.right._color)return s=(a=n.left=r(a)).right=r(a.right),n.left=s.right,a.right=s.left,s.right=n,s.left=a,s._color=n._color,n._color=1,a._color=1,t._color=1,o(n),o(a),o(s),u>1&&((c=e[u-2]).right===n?c.right=s:c.left=s),void(e[u-1]=s);if(1===a._color){if(0===n._color)return n._color=1,void(n.left=i(0,a));n.left=i(0,a);continue}var c;a=r(a),n.left=a.right,a.right=n,a._color=n._color,n._color=0,o(n),o(a),u>1&&((c=e[u-2]).right===n?c.right=a:c.left=a),e[u-1]=a,e[u]=n,u+1<e.length?e[u+1]=t:e.push(t),u+=2}}}(t),h.left===s?h.left=null:h.right=null,new a(this.tree._compare,t[0])},Object.defineProperty(h,"key",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].key},enumerable:!0}),Object.defineProperty(h,"value",{get:function(){if(this._stack.length>0)return this._stack[this._stack.length-1].value},enumerable:!0}),Object.defineProperty(h,"index",{get:function(){var e=0,t=this._stack;if(0===t.length){var n=this.tree.root;return n?n._count:0}t[t.length-1].left&&(e=t[t.length-1].left._count);for(var r=t.length-2;r>=0;--r)t[r+1]===t[r].right&&(++e,t[r].left&&(e+=t[r].left._count));return e},enumerable:!0}),h.next=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.right)for(t=t.right;t;)e.push(t),t=t.left;else for(e.pop();e.length>0&&e[e.length-1].right===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(h,"hasNext",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].right)return!0;for(var t=e.length-1;t>0;--t)if(e[t-1].left===e[t])return!0;return!1}}),h.update=function(e){var t=this._stack;if(0===t.length)throw new Error("Can't update empty node!");var r=new Array(t.length),i=t[t.length-1];r[r.length-1]=new n(i._color,i.key,e,i.left,i.right,i._count);for(var o=t.length-2;o>=0;--o)(i=t[o]).left===t[o+1]?r[o]=new n(i._color,i.key,i.value,r[o+1],i.right,i._count):r[o]=new n(i._color,i.key,i.value,i.left,r[o+1],i._count);return new a(this.tree._compare,r[0])},h.prev=function(){var e=this._stack;if(0!==e.length){var t=e[e.length-1];if(t.left)for(t=t.left;t;)e.push(t),t=t.right;else for(e.pop();e.length>0&&e[e.length-1].left===t;)t=e[e.length-1],e.pop()}},Object.defineProperty(h,"hasPrev",{get:function(){var e=this._stack;if(0===e.length)return!1;if(e[e.length-1].left)return!0;for(var t=e.length-1;t>0;--t)if(e[t-1].right===e[t])return!0;return!1}})})),o.register("lh7Mj",(function(e,t){e.exports=o("jMdNH")})),o.register("jMdNH",(function(e,t){var n,r,i,a=[o("br7pn"),o("ir7rV"),o("5PURY"),o("hSVaX"),o("jCe3p")],s=-1,u=[],c=!1;function l(){n&&r&&(n=!1,r.length?u=r.concat(u):s=-1,u.length&&f())}function f(){if(!n){c=!1,n=!0;for(var e=u.length,t=setTimeout(l);e;){for(r=u,u=[];r&&++s<e;)r[s].run();s=-1,e=u.length}r=null,s=-1,n=!1,clearTimeout(t)}}for(var h=-1,d=a.length;++h<d;)if(a[h]&&a[h].test&&a[h].test()){i=a[h].install(f);break}function p(e,t){this.fun=e,this.array=t}p.prototype.run=function(){var e=this.fun,t=this.array;switch(t.length){case 0:return e();case 1:return e(t[0]);case 2:return e(t[0],t[1]);case 3:return e(t[0],t[1],t[2]);default:return e.apply(null,t)}},e.exports=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];u.push(new p(e,t)),c||n||(c=!0,i())}})),o.register("br7pn",(function(t,n){var r,i;e(t.exports,"test",(()=>r),(e=>r=e)),e(t.exports,"install",(()=>i),(e=>i=e));var a=o("iThRa");r=function(){return void 0!==a&&!1},i=function(e){return function(){a.nextTick(e)}}})),o.register("ir7rV",(function(n,r){var i,o;e(n.exports,"test",(()=>i),(e=>i=e)),e(n.exports,"install",(()=>o),(e=>o=e));var a=t.MutationObserver||t.WebKitMutationObserver;i=function(){return a},o=function(e){var n=0,r=new a(e),i=t.document.createTextNode("");return r.observe(i,{characterData:!0}),function(){i.data=n=++n%2}}})),o.register("5PURY",(function(n,r){var i,o;e(n.exports,"test",(()=>i),(e=>i=e)),e(n.exports,"install",(()=>o),(e=>o=e)),i=function(){return!t.setImmediate&&void 0!==t.MessageChannel},o=function(e){var n=new t.MessageChannel;return n.port1.onmessage=e,function(){n.port2.postMessage(0)}}})),o.register("hSVaX",(function(n,r){var i,o;e(n.exports,"test",(()=>i),(e=>i=e)),e(n.exports,"install",(()=>o),(e=>o=e)),i=function(){return"document"in t&&"onreadystatechange"in t.document.createElement("script")},o=function(e){return function(){var n=t.document.createElement("script");return n.onreadystatechange=function(){e(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},t.document.documentElement.appendChild(n),e}}})),o.register("jCe3p",(function(t,n){var r,i;e(t.exports,"test",(()=>r),(e=>r=e)),e(t.exports,"install",(()=>i),(e=>i=e)),r=function(){return!0},i=function(e){return function(){setTimeout(e,0)}}})),o.register("gO7hz",(function(e,t){var n=T,r=o("dyk5A"),i=tn,a=o("eb7BX"),s=o("iZ4AW"),u=o("kkfWi");function c(e){if(!(this instanceof c))return new c(e);if("string"!=typeof e)throw new Error("constructor requires a location string argument");i.call(this,{bufferKeys:!0,snapshots:!0,permanence:!0,seek:!0,clear:!0,createIfMissing:!0,errorIfExists:!0,additionalMethods:{approximateSize:!0,compactRange:!0}}),this.location=e,this.context=a.db_init()}r.inherits(c,i),c.prototype._open=function(e,t){a.db_open(this.context,this.location,e,t)},c.prototype._close=function(e){a.db_close(this.context,e)},c.prototype._serializeKey=function(e){return n.isBuffer(e)?e:String(e)},c.prototype._serializeValue=function(e){return n.isBuffer(e)?e:String(e)},c.prototype._put=function(e,t,n,r){a.db_put(this.context,e,t,n,r)},c.prototype._get=function(e,t,n){a.db_get(this.context,e,t,n)},c.prototype._del=function(e,t,n){a.db_del(this.context,e,t,n)},c.prototype._chainedBatch=function(){return new s(this)},c.prototype._batch=function(e,t,n){a.batch_do(this.context,e,t,n)},c.prototype.approximateSize=function(e,t,n){if(null==e||null==t||"function"==typeof e||"function"==typeof t)throw new Error("approximateSize() requires valid `start` and `end` arguments");if("function"!=typeof n)throw new Error("approximateSize() requires a callback argument");e=this._serializeKey(e),t=this._serializeKey(t),a.db_approximate_size(this.context,e,t,n)},c.prototype.compactRange=function(e,t,n){if(null==e||null==t||"function"==typeof e||"function"==typeof t)throw new Error("compactRange() requires valid `start` and `end` arguments");if("function"!=typeof n)throw new Error("compactRange() requires a callback argument");e=this._serializeKey(e),t=this._serializeKey(t),a.db_compact_range(this.context,e,t,n)},c.prototype.getProperty=function(e){if("string"!=typeof e)throw new Error("getProperty() requires a valid `property` argument");return a.db_get_property(this.context,e)},c.prototype._iterator=function(e){if("open"!==this.status)throw new Error("cannot call iterator() before open()");return new u(this,e)},c.destroy=function(e,t){if(arguments.length<2)throw new Error("destroy() requires `location` and `callback` arguments");if("string"!=typeof e)throw new Error("destroy() requires a location string argument");if("function"!=typeof t)throw new Error("destroy() requires a callback function argument");a.destroy_db(e,t)},c.repair=function(e,t){if(arguments.length<2)throw new Error("repair() requires `location` and `callback` arguments");if("string"!=typeof e)throw new Error("repair() requires a location string argument");if("function"!=typeof t)throw new Error("repair() requires a callback function argument");a.repair_db(e,t)},e.exports=c.default=c})),o.register("eb7BX",(function(e,t){e.exports=o("lkdjV")("node_modules/leveldown")})),o.register("lkdjV",(function(e,t){var n=o("iThRa"),r=o("kOtop"),i=o("choVg"),a="function"==typeof __webpack_require__?__non_webpack_require__:void 0,s=n.versions.modules,u=n.versions&&n.versions.electron||"undefined"!=typeof window&&window.process&&"renderer"===window.process.type?"electron":"node",c=Nn(),l=On(),f="linux"===l&&r.existsSync("/etc/alpine-release")?"musl":"glibc",h=("arm64"===c?"8":n.config.variables.arm_version)||"",d=(n.versions.uv||"").split(".")[0];function p(e){return a(p.path(e))}function m(e){try{return r.readdirSync(e)}catch(e){return[]}}function y(e,t){var n=m(e).filter(t);return n[0]&&i.join(e,n[0])}function g(e){return/\.node$/.test(e)}function b(e){var t=e.split("."),n={file:e,specificity:0};if("node"===t.pop()){for(var r=0;r<t.length;r++){var i=t[r];if("node"===i||"electron"===i||"node-webkit"===i)n.runtime=i;else if("napi"===i)n.napi=!0;else if("abi"===i.slice(0,3))n.abi=i.slice(3);else if("uv"===i.slice(0,2))n.uv=i.slice(2);else if("armv"===i.slice(0,4))n.armv=i.slice(4);else{if("glibc"!==i&&"musl"!==i)continue;n.libc=i}n.specificity++}return n}}function v(e,t){return function(n){return null!=n&&(!(n.runtime!==e&&!function(e){return"node"===e.runtime&&e.napi}(n))&&(!(n.abi!==t&&!n.napi)&&((!n.uv||n.uv===d)&&((!n.armv||n.armv===h)&&(!n.libc||n.libc===f)))))}}function w(e){return function(t,n){return t.runtime!==n.runtime?t.runtime===e?-1:1:t.abi!==n.abi?t.abi?-1:1:t.specificity!==n.specificity?t.specificity>n.specificity?-1:1:0}}e.exports=p,p.path=function(e){e=i.resolve(e||".");try{var t=a(i.join(e,"package.json")).name.toUpperCase().replace(/-/g,"_");n.env[t+"_PREBUILD"]&&(e=n.env[t+"_PREBUILD"])}catch(e){}var r=y(i.join(e,"build/Release"),g);if(r)return r;var o=y(i.join(e,"build/Debug"),g);if(o)return o;var p=i.join(e,"prebuilds",l+"-"+c),_=m(p).map(b).filter(v(u,s)).sort(w(u))[0];if(_)return i.join(p,_.file);var E=["platform="+l,"arch="+c,"runtime="+u,"abi="+s,"uv="+d,h?"armv="+h:"","libc="+f].filter(Boolean).join(" ");throw new Error("No native build was found for "+E)},p.parseTags=b,p.matchTags=v,p.compareTags=w})),o.register("choVg",(function(e,t){var n=o("iThRa");function r(e){if("string"!=typeof e)throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}function i(e,t){for(var n,r="",i=0,o=-1,a=0,s=0;s<=e.length;++s){if(s<e.length)n=e.charCodeAt(s);else{if(47===n)break;n=47}if(47===n){if(o===s-1||1===a);else if(o!==s-1&&2===a){if(r.length<2||2!==i||46!==r.charCodeAt(r.length-1)||46!==r.charCodeAt(r.length-2))if(r.length>2){var u=r.lastIndexOf("/");if(u!==r.length-1){-1===u?(r="",i=0):i=(r=r.slice(0,u)).length-1-r.lastIndexOf("/"),o=s,a=0;continue}}else if(2===r.length||1===r.length){r="",i=0,o=s,a=0;continue}t&&(r.length>0?r+="/..":r="..",i=2)}else r.length>0?r+="/"+e.slice(o+1,s):r=e.slice(o+1,s),i=s-o-1;o=s,a=0}else 46===n&&-1!==a?++a:a=-1}return r}var a={resolve:function(){for(var e,t="",o=!1,a=arguments.length-1;a>=-1&&!o;a--){var s;a>=0?s=arguments[a]:(void 0===e&&(e=n.cwd()),s=e),r(s),0!==s.length&&(t=s+"/"+t,o=47===s.charCodeAt(0))}return t=i(t,!o),o?t.length>0?"/"+t:"/":t.length>0?t:"."},normalize:function(e){if(r(e),0===e.length)return".";var t=47===e.charCodeAt(0),n=47===e.charCodeAt(e.length-1);return 0!==(e=i(e,!t)).length||t||(e="."),e.length>0&&n&&(e+="/"),t?"/"+e:e},isAbsolute:function(e){return r(e),e.length>0&&47===e.charCodeAt(0)},join:function(){if(0===arguments.length)return".";for(var e,t=0;t<arguments.length;++t){var n=arguments[t];r(n),n.length>0&&(void 0===e?e=n:e+="/"+n)}return void 0===e?".":a.normalize(e)},relative:function(e,t){if(r(e),r(t),e===t)return"";if((e=a.resolve(e))===(t=a.resolve(t)))return"";for(var n=1;n<e.length&&47===e.charCodeAt(n);++n);for(var i=e.length,o=i-n,s=1;s<t.length&&47===t.charCodeAt(s);++s);for(var u=t.length-s,c=o<u?o:u,l=-1,f=0;f<=c;++f){if(f===c){if(u>c){if(47===t.charCodeAt(s+f))return t.slice(s+f+1);if(0===f)return t.slice(s+f)}else o>c&&(47===e.charCodeAt(n+f)?l=f:0===f&&(l=0));break}var h=e.charCodeAt(n+f);if(h!==t.charCodeAt(s+f))break;47===h&&(l=f)}var d="";for(f=n+l+1;f<=i;++f)f!==i&&47!==e.charCodeAt(f)||(0===d.length?d+="..":d+="/..");return d.length>0?d+t.slice(s+l):(s+=l,47===t.charCodeAt(s)&&++s,t.slice(s))},_makeLong:function(e){return e},dirname:function(e){if(r(e),0===e.length)return".";for(var t=e.charCodeAt(0),n=47===t,i=-1,o=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!o){i=a;break}}else o=!1;return-1===i?n?"/":".":n&&1===i?"//":e.slice(0,i)},basename:function(e,t){if(void 0!==t&&"string"!=typeof t)throw new TypeError('"ext" argument must be a string');r(e);var n,i=0,o=-1,a=!0;if(void 0!==t&&t.length>0&&t.length<=e.length){if(t.length===e.length&&t===e)return"";var s=t.length-1,u=-1;for(n=e.length-1;n>=0;--n){var c=e.charCodeAt(n);if(47===c){if(!a){i=n+1;break}}else-1===u&&(a=!1,u=n+1),s>=0&&(c===t.charCodeAt(s)?-1==--s&&(o=n):(s=-1,o=u))}return i===o?o=u:-1===o&&(o=e.length),e.slice(i,o)}for(n=e.length-1;n>=0;--n)if(47===e.charCodeAt(n)){if(!a){i=n+1;break}}else-1===o&&(a=!1,o=n+1);return-1===o?"":e.slice(i,o)},extname:function(e){r(e);for(var t=-1,n=0,i=-1,o=!0,a=0,s=e.length-1;s>=0;--s){var u=e.charCodeAt(s);if(47!==u)-1===i&&(o=!1,i=s+1),46===u?-1===t?t=s:1!==a&&(a=1):-1!==t&&(a=-1);else if(!o){n=s+1;break}}return-1===t||-1===i||0===a||1===a&&t===i-1&&t===n+1?"":e.slice(t,i)},format:function(e){if(null===e||"object"!=typeof e)throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return function(e,t){var n=t.dir||t.root,r=t.base||(t.name||"")+(t.ext||"");return n?n===t.root?n+r:n+e+r:r}("/",e)},parse:function(e){r(e);var t={root:"",dir:"",base:"",ext:"",name:""};if(0===e.length)return t;var n,i=e.charCodeAt(0),o=47===i;o?(t.root="/",n=1):n=0;for(var a=-1,s=0,u=-1,c=!0,l=e.length-1,f=0;l>=n;--l)if(47!==(i=e.charCodeAt(l)))-1===u&&(c=!1,u=l+1),46===i?-1===a?a=l:1!==f&&(f=1):-1!==a&&(f=-1);else if(!c){s=l+1;break}return-1===a||-1===u||0===f||1===f&&a===u-1&&a===s+1?-1!==u&&(t.base=t.name=0===s&&o?e.slice(1,u):e.slice(s,u)):(0===s&&o?(t.name=e.slice(1,a),t.base=e.slice(1,u)):(t.name=e.slice(s,a),t.base=e.slice(s,u)),t.ext=e.slice(a,u)),s>0?t.dir=e.slice(0,s-1):o&&(t.dir="/"),t},sep:"/",delimiter:":",win32:null,posix:null};a.posix=a,e.exports=a}));var wn,_n,En,Sn,xn,Tn,Mn,An,Rn,In,Pn,Nn,On,Cn,kn,Bn,Dn,jn={};e(jn,"endianness",(()=>wn),(e=>wn=e)),e(jn,"hostname",(()=>_n),(e=>_n=e)),e(jn,"loadavg",(()=>En),(e=>En=e)),e(jn,"uptime",(()=>Sn),(e=>Sn=e)),e(jn,"freemem",(()=>xn),(e=>xn=e)),e(jn,"totalmem",(()=>Tn),(e=>Tn=e)),e(jn,"cpus",(()=>Mn),(e=>Mn=e)),e(jn,"type",(()=>An),(e=>An=e)),e(jn,"release",(()=>Rn),(e=>Rn=e)),e(jn,"networkInterfaces",(()=>In),(e=>In=e)),e(jn,"getNetworkInterfaces",(()=>Pn),(e=>Pn=e)),e(jn,"arch",(()=>Nn),(e=>Nn=e)),e(jn,"platform",(()=>On),(e=>On=e)),e(jn,"tmpdir",(()=>Cn),(e=>Cn=e)),e(jn,"tmpDir",(()=>kn),(e=>kn=e)),e(jn,"EOL",(()=>Bn),(e=>Bn=e)),e(jn,"homedir",(()=>Dn),(e=>Dn=e)),wn=function(){return"LE"},_n=function(){return"undefined"!=typeof location?location.hostname:""},En=function(){return[]},Sn=function(){return 0},xn=function(){return Number.MAX_VALUE},Tn=function(){return Number.MAX_VALUE},Mn=function(){return[]},An=function(){return"Browser"},Rn=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},In=Pn=function(){return{}},Nn=function(){return"javascript"},On=function(){return"browser"},Cn=kn=function(){return"/tmp"},Bn="\n",Dn=function(){return"/"},o.register("iZ4AW",(function(e,t){var n=o("dyk5A"),r=rn,i=o("eb7BX");function a(e){r.call(this,e),this.context=i.batch_init(e.context)}a.prototype._put=function(e,t){i.batch_put(this.context,e,t)},a.prototype._del=function(e){i.batch_del(this.context,e)},a.prototype._clear=function(){i.batch_clear(this.context)},a.prototype._write=function(e,t){i.batch_write(this.context,e,t)},n.inherits(a,r),e.exports=a})),o.register("kkfWi",(function(e,t){var n=o("iThRa"),r=o("dyk5A"),i=nn,a=o("eb7BX");function s(e,t){i.call(this,e),this.context=a.iterator_init(e.context,t),this.cache=null,this.finished=!1}r.inherits(s,i),s.prototype._seek=function(e){if(0===e.length)throw new Error("cannot seek() to an empty target");this.cache=null,a.iterator_seek(this.context,e),this.finished=!1},s.prototype._next=function(e){var t=this;return this.cache&&this.cache.length?n.nextTick(e,null,this.cache.pop(),this.cache.pop()):this.finished?n.nextTick(e):a.iterator_next(this.context,(function(n,r,i){if(n)return e(n);t.cache=r,t.finished=i,t._next(e)})),this},s.prototype._end=function(e){delete this.cache,a.iterator_end(this.context,e)},e.exports=s})),o.register("bYdEu",(function(e,t){e.exports=h;var n=tn,r=o("j1UVA"),i=o("aZinq"),a=o("fCZW0"),s=o("lbbvE"),u=o("gQQgY"),c=o("cpZGV"),l=o("5hLGU"),f="level-js-";function h(e,t){if(!(this instanceof h))return new h(e,t);if(n.call(this,{bufferKeys:u.bufferKeys(indexedDB),snapshots:!0,permanence:!0,clear:!0}),t=t||{},"string"!=typeof e)throw new Error("constructor requires a location string argument");this.location=e,this.prefix=null==t.prefix?f:t.prefix,this.version=parseInt(t.version||1,10)}r(h,n),h.prototype.type="level-js",h.prototype._open=function(e,t){var n=indexedDB.open(this.prefix+this.location,this.version),r=this;n.onerror=function(){t(n.error||new Error("unknown error"))},n.onsuccess=function(){r.db=n.result,t()},n.onupgradeneeded=function(e){var t=e.target.result;t.objectStoreNames.contains(r.location)||t.createObjectStore(r.location)}},h.prototype.store=function(e){return this.db.transaction([this.location],e).objectStore(this.location)},h.prototype.await=function(e,t){var n=e.transaction;n.onabort=function(){t(n.error||new Error("aborted by user"))},n.oncomplete=function(){t(null,e.result)}},h.prototype._get=function(e,t,n){var r=this.store("readonly");try{var i=r.get(e)}catch(e){return this._nextTick(n,e)}this.await(i,(function(e,r){return e?n(e):void 0===r?n(new Error("NotFound")):void n(null,s(r,t.asBuffer))}))},h.prototype._del=function(e,t,n){var r=this.store("readwrite");try{var i=r.delete(e)}catch(e){return this._nextTick(n,e)}this.await(i,n)},h.prototype._put=function(e,t,n,r){var i=this.store("readwrite");try{var o=i.put(t,e)}catch(e){return this._nextTick(r,e)}this.await(o,r)},h.prototype._serializeKey=function(e){return a(e,this.supports.bufferKeys)},h.prototype._serializeValue=function(e){return a(e,!0)},h.prototype._iterator=function(e){return new i(this,this.location,e)},h.prototype._batch=function(e,t,n){if(0===e.length)return this._nextTick(n);var r,i=this.store("readwrite"),o=i.transaction,a=0;o.onabort=function(){n(r||o.error||new Error("aborted by user"))},o.oncomplete=function(){n()},function t(){var n=e[a++],s=n.key;try{var u="del"===n.type?i.delete(s):i.put(n.value,s)}catch(e){return r=e,void o.abort()}a<e.length&&(u.onsuccess=t)}()},h.prototype._clear=function(e,t){try{var n=l(e)}catch(e){return this._nextTick(t)}if(e.limit>=0)return c(this,this.location,n,e,t);try{var r=this.store("readwrite"),i=n?r.delete(n):r.clear()}catch(e){return this._nextTick(t,e)}this.await(i,t)},h.prototype._close=function(e){this.db.close(),this._nextTick(e)},h.prototype.upgrade=function(e){if("open"!==this.status)return this._nextTick(e,new Error("cannot upgrade() before open()"));var t=this.iterator(),n={},r=this;function i(e){if(e)return a(e);t.next(o)}function o(e,t,o){if(e||void 0===t)return a(e);var u=r._serializeKey(s(t,!0)),c=r._serializeValue(s(o,!0));r._batch([{type:"del",key:t},{type:"put",key:u,value:c}],n,i)}function a(n){t.end((function(t){e(n||t)}))}t._deserializeKey=t._deserializeValue=function(e){return e},i()},h.destroy=function(e,t,n){"function"==typeof t&&(n=t,t=f);var r=indexedDB.deleteDatabase(t+e);r.onsuccess=function(){n()},r.onerror=function(e){n(e)}}})),o.register("aZinq",(function(e,t){var n=o("j1UVA"),r=nn,i=o("5hLGU"),a=o("lbbvE"),s=function(){};function u(e,t,n){if(r.call(this,e),this._limit=n.limit,this._count=0,this._callback=null,this._cache=[],this._completed=!1,this._aborted=!1,this._error=null,this._transaction=null,this._keys=n.keys,this._values=n.values,this._keyAsBuffer=n.keyAsBuffer,this._valueAsBuffer=n.valueAsBuffer,0!==this._limit){try{var o=i(n)}catch(e){return void(this._completed=!0)}this.createIterator(t,o,n.reverse)}else this._completed=!0}e.exports=u,n(u,r),u.prototype.createIterator=function(e,t,n){var r=this,i=this.db.db.transaction([e],"readonly");i.objectStore(e).openCursor(t,n?"prev":"next").onsuccess=function(e){var t=e.target.result;t&&r.onItem(t)},this._transaction=i,i.onabort=function(){r.onAbort(r._transaction.error||new Error("aborted by user"))},i.oncomplete=function(){r.onComplete()}},u.prototype.onItem=function(e){this._cache.push(e.key,e.value),(this._limit<=0||++this._count<this._limit)&&e.continue(),this.maybeNext()},u.prototype.onAbort=function(e){this._aborted=!0,this._error=e,this.maybeNext()},u.prototype.onComplete=function(){this._completed=!0,this.maybeNext()},u.prototype.maybeNext=function(){this._callback&&(this._next(this._callback),this._callback=null)},u.prototype._next=function(e){if(this._aborted){var t=this._error;this._error=null,this._nextTick(e,t)}else if(this._cache.length>0){var n=this._cache.shift(),r=this._cache.shift();n=this._keys&&void 0!==n?this._deserializeKey(n,this._keyAsBuffer):void 0,r=this._values&&void 0!==r?this._deserializeValue(r,this._valueAsBuffer):void 0,this._nextTick(e,null,n,r)}else this._completed?this._nextTick(e):this._callback=e},u.prototype._deserializeKey=a,u.prototype._deserializeValue=a,u.prototype._end=function(e){if(this._aborted||this._completed)return this._nextTick(e,this._error);this.onItem=s,this.onAbort=e,this.onComplete=e}})),o.register("5hLGU",(function(e,t){var n=o("7H4yS"),r={};e.exports=function(e){var t=n.lowerBound(e,r),i=n.upperBound(e,r),o=n.lowerBoundExclusive(e,r),a=n.upperBoundExclusive(e,r);return t!==r&&i!==r?IDBKeyRange.bound(t,i,o,a):t!==r?IDBKeyRange.lowerBound(t,o):i!==r?IDBKeyRange.upperBound(i,a):null}})),o.register("lbbvE",(function(e,n){var r=T,i=function(){if(t.TextDecoder){var e=new TextDecoder("utf-8");return e.decode.bind(e)}return function(e){return a(e).toString()}}(),o=function(){if(t.TextDecoder){var e=new TextDecoder("utf-8");return e.decode.bind(e)}return function(e){return r.from(e).toString()}}();function a(e){var t=r.from(e.buffer);return e.byteLength===e.buffer.byteLength?t:t.slice(e.byteOffset,e.byteOffset+e.byteLength)}e.exports=function(e,t){return e instanceof Uint8Array?t?a(e):i(e):e instanceof ArrayBuffer?t?r.from(e):o(e):t?r.from(String(e)):String(e)}})),o.register("fCZW0",(function(e,n){var r=T,i=function(){if(t.TextEncoder){var e=new TextEncoder("utf-8");return e.encode.bind(e)}return r.from}();e.exports=function(e,t){return t?r.isBuffer(e)?e:i(String(e)):String(e)}})),o.register("gQQgY",(function(t,n){var r,i;e(t.exports,"test",(()=>r),(e=>r=e)),e(t.exports,"bufferKeys",(()=>i),(e=>i=e)),i=(r=function(e){return function(t){try{return t.cmp(e,0),!0}catch(e){return!1}}})(T.alloc(0))})),o.register("cpZGV",(function(e,t){e.exports=function(e,t,n,r,i){if(0===r.limit)return e._nextTick(i);var o=e.db.transaction([t],"readwrite"),a=o.objectStore(t),s=0;o.oncomplete=function(){i()},o.onabort=function(){i(o.error||new Error("aborted by user"))};var u=a.openKeyCursor?"openKeyCursor":"openCursor",c=r.reverse?"prev":"next";a[u](n,c).onsuccess=function(e){var t=e.target.result;t&&(a.delete(t.key).onsuccess=function(){(r.limit<=0||++s<r.limit)&&t.continue()})}}}));var Ln=o("3KgUz");const qn=h.createLogger("aztec:transport_client");class Un extends(n(Ln)){constructor(e){super(),this.transportConnect=e,this.msgId=0,this.pendingRequests=[]}async open(){this.socket=await this.transportConnect.createSocket(),this.socket.registerHandler((e=>this.handleSocketMessage(e)))}close(){this.socket?.close(),this.removeAllListeners()}async request(e){if(!this.socket)throw new Error("Socket not open.");const t=this.msgId++,n={msgId:t,payload:e};return qn("->",n),new Promise(((e,r)=>{this.pendingRequests.push({resolve:e,reject:r,msgId:t}),this.socket.send(n)}))}async handleSocketMessage(e){if(qn("<-",e),function(e){return void 0===e.msgId}(e))return void this.emit("event_msg",e.payload);const t=this.pendingRequests.findIndex((t=>t.msgId===e.msgId));if(-1===t)return;const[n]=this.pendingRequests.splice(t,1);e.error?n.reject(new Error(e.error)):n.resolve(e.payload)}}class Fn{constructor(e){this.port=e}async send(e){this.port.postMessage(e)}registerHandler(e){this.port.onmessage=async t=>e(t.data)}close(){this.port.onmessage=null,this.port.close()}}function Kn(e,t,n=console.error){return async({fn:r,args:i})=>{if(n(`dispatching to ${t}: ${r}`,i),e[t][r]&&"function"==typeof e[t][r])return await e[t][r](...i);n(`dispatch error, undefined or not a function on ${t}: ${r}`)}}class Vn extends Un{}class zn extends class{constructor(e,t){this.listener=e,this.msgHandlerFn=t,this.sockets=[]}start(){this.listener.on("new_socket",(e=>this.handleNewSocket(e))),this.listener.open()}stop(){this.listener.close(),this.sockets.forEach((e=>e.close()))}async broadcast(e){await Promise.all(this.sockets.map((t=>t.send({payload:e}))))}handleNewSocket(e){e.registerHandler((t=>this.handleSocketMessage(e,t))),this.sockets.push(e)}async handleSocketMessage(e,{msgId:t,payload:n}){try{const r={msgId:t,payload:await this.msgHandlerFn(n)};await e.send(r)}catch(n){const r={msgId:t,error:n.message};await e.send(r)}}}{}Ln=o("3KgUz");var Wn=o("1T4rt"),Hn=o("lJwtZ"),Gn={};Object.defineProperty(Gn,"__esModule",{value:!0}),Gn.Crs=void 0;Gn.Crs=class{constructor(e){this.numPoints=e}async download(){const e=28+64*this.numPoints-1,t=await(0,_.fetch)("https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/sealed/transcript00.dat",{headers:{Range:`bytes=28-${e}`}});this.data=new Uint8Array(await t.arrayBuffer()),await this.downloadG2Data()}async downloadG2Data(){const e=await(0,_.fetch)("https://aztec-ignition.s3.amazonaws.com/MAIN%20IGNITION/sealed/transcript00.dat",{headers:{Range:"bytes=322560028-322560155"}});this.g2Data=new Uint8Array(await e.arrayBuffer())}getData(){return this.data}getG2Data(){return this.g2Data}};v=o("1vwiL");var Qn={};Object.defineProperty(Qn,"__esModule",{value:!0}),s(o("6HKnN"),Qn);var Jn={};Object.defineProperty(Jn,"__esModule",{value:!0}),s(o("7WRIX"),Jn);var Zn=o("2ZepW"),$n=o("4G3uU"),Yn={};Object.defineProperty(Yn,"__esModule",{value:!0}),Yn.sleep=Yn.InterruptableSleep=void 0;Yn.InterruptableSleep=class{constructor(){this.interruptResolve=()=>{},this.interruptPromise=new Promise((e=>this.interruptResolve=e)),this.timeouts=[]}async sleep(e){let t;const n=new Promise((n=>t=setTimeout(n,e)));this.timeouts.push(t),await Promise.race([n,this.interruptPromise]),clearTimeout(t),this.timeouts.splice(this.timeouts.indexOf(t),1)}interrupt(){this.interruptResolve(),this.interruptPromise=new Promise((e=>this.interruptResolve=e))}},Yn.sleep=function(e){return new Promise((t=>setTimeout(t,e)))};var Xn={};Object.defineProperty(Xn,"__esModule",{value:!0}),Xn.Timer=void 0;Xn.Timer=class{constructor(){this.start=(new Date).getTime()}ms(){return(new Date).getTime()-this.start}s(){return((new Date).getTime()-this.start)/1e3}};var er={};Object.defineProperty(er,"__esModule",{value:!0}),s(o("hRYWQ"),er),s(o("eE6bJ"),er);Ln=o("3KgUz"),Zn=o("2ZepW"),new Error("timeout while waiting for mutex to become available"),new Error("mutex already locked");var tr=new Error("request for lock canceled"),nr=function(){function e(e,t){if(void 0===t&&(t=tr),this._maxConcurrency=e,this._cancelError=t,this._queue=[],this._waiters=[],e<=0)throw new Error("semaphore must be initialized to a positive value");this._value=e}return e.prototype.acquire=function(){var e=this,t=this.isLocked(),n=new Promise((function(t,n){return e._queue.push({resolve:t,reject:n})}));return t||this._dispatch(),n},e.prototype.runExclusive=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r;return Oe(this,(function(i){switch(i.label){case 0:return[4,this.acquire()];case 1:t=i.sent(),n=t[0],r=t[1],i.label=2;case 2:return i.trys.push([2,,4,5]),[4,e(n)];case 3:return[2,i.sent()];case 4:return r(),[7];case 5:return[2]}}))}))},e.prototype.waitForUnlock=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return this.isLocked()?[2,new Promise((function(t){return e._waiters.push({resolve:t})}))]:[2,Promise.resolve()]}))}))},e.prototype.isLocked=function(){return this._value<=0},e.prototype.release=function(){if(this._maxConcurrency>1)throw new Error("this method is unavailable on semaphores with concurrency > 1; use the scoped release returned by acquire instead");if(this._currentReleaser){var e=this._currentReleaser;this._currentReleaser=void 0,e()}},e.prototype.cancel=function(){var e=this;this._queue.forEach((function(t){return t.reject(e._cancelError)})),this._queue=[]},e.prototype._dispatch=function(){var e=this,t=this._queue.shift();if(t){var n=!1;this._currentReleaser=function(){n||(n=!0,e._value++,e._resolveWaiters(),e._dispatch())},t.resolve([this._value--,this._currentReleaser])}},e.prototype._resolveWaiters=function(){this._waiters.forEach((function(e){return e.resolve()})),this._waiters=[]},e}(),rr=function(){function e(e){this._semaphore=new nr(1,e)}return e.prototype.acquire=function(){return Ne(this,void 0,void 0,(function(){var e;return Oe(this,(function(t){switch(t.label){case 0:return[4,this._semaphore.acquire()];case 1:return e=t.sent(),[2,e[1]]}}))}))},e.prototype.runExclusive=function(e){return this._semaphore.runExclusive((function(){return e()}))},e.prototype.isLocked=function(){return this._semaphore.isLocked()},e.prototype.waitForUnlock=function(){return this._semaphore.waitForUnlock()},e.prototype.release=function(){this._semaphore.release()},e.prototype.cancel=function(){return this._semaphore.cancel()},e}();class ir{constructor(e,t){this.block=e,this.pedersen=t,this.mutex=new rr}async getBlockSubtreeHashPath(e){const t=await this.mutex.acquire();try{if(!this.subtree){const t=er.WorldStateConstants.NUM_NEW_DATA_TREE_NOTES_PER_TX*this.block.rollupSize,n=m.RollupProofData.fromBuffer(this.block.rollupProofData);this.startIndex=n.dataStartIndex;const r=this.startIndex+t;if(e<this.startIndex||e>=r)throw new Error("Index out of bounds.");const i=n.innerProofData.flatMap((e=>[e.noteCommitment1,e.noteCommitment2])),o=[...i,...Array(t-i.length).fill(Zn.MemoryMerkleTree.ZERO_ELEMENT)];this.subtree=await Zn.MemoryMerkleTree.new(o,this.pedersen)}return this.subtree.getHashPath(e-this.startIndex)}finally{t()}}}Wn=o("1T4rt");var or=T;class ar{constructor(e,t,n,r,i,o,a,s,u){this.txId=e,this.userId=t,this.aliasHash=n,this.newSpendingPublicKey1=r,this.newSpendingPublicKey2=i,this.migrated=o,this.txRefNo=a,this.created=s,this.settled=u,this.proofId=p.ProofId.ACCOUNT}}Wn=o("1T4rt");var sr=o("jJK4a"),ur=T;class cr{constructor(e,t,n,r,i,o,a,s,u,c,l,f,h,d,m,y,g){this.txId=e,this.userId=t,this.bridgeId=n,this.depositValue=r,this.txFee=i,this.partialStateSecret=o,this.txRefNo=a,this.created=s,this.settled=u,this.interactionNonce=c,this.isAsync=l,this.success=f,this.outputValueA=h,this.outputValueB=d,this.finalised=m,this.claimSettled=y,this.claimTxId=g,this.proofId=p.ProofId.DEFI_DEPOSIT}}Wn=o("1T4rt");class lr{constructor(e,t,n,r,i,o,a,s,u,c,l,f,h,d,p){this.txId=e,this.userId=t,this.proofId=n,this.assetId=r,this.publicValue=i,this.publicOwner=o,this.privateInput=a,this.recipientPrivateOutput=s,this.senderPrivateOutput=u,this.isRecipient=c,this.isSender=l,this.accountRequired=f,this.txRefNo=h,this.created=d,this.settled=p}}const fr=({txId:e,userId:t,proofId:n,assetId:r,publicValue:i,publicOwner:o,privateInput:a,recipientPrivateOutput:s,senderPrivateOutput:u,txRefNo:c,created:l,settled:f},h,d)=>new lr(e,h,n,r,i,o,a,s,u,!0,h.equals(t),d,c,l,f),hr=e=>{switch(e.proofId){case p.ProofId.ACCOUNT:return(e=>({...e,txId:e.txId.toString(),userId:e.userId.toString(),aliasHash:e.aliasHash.toString(),newSpendingPublicKey1:e.newSpendingPublicKey1?e.newSpendingPublicKey1.toString("hex"):void 0,newSpendingPublicKey2:e.newSpendingPublicKey2?e.newSpendingPublicKey2.toString("hex"):void 0}))(e);case p.ProofId.DEFI_DEPOSIT:return(e=>({...e,txId:e.txId.toString(),userId:e.userId.toString(),bridgeId:e.bridgeId.toString(),depositValue:e.depositValue.toString(),txFee:e.txFee.toString(),partialStateSecret:e.partialStateSecret.toString("hex"),outputValueA:e.outputValueA?.toString(),outputValueB:e.outputValueB?.toString(),claimTxId:e.claimTxId?.toString()}))(e);default:return(e=>({...e,txId:e.txId.toString(),userId:e.userId.toString(),publicValue:e.publicValue.toString(),publicOwner:e.publicOwner?e.publicOwner.toString():void 0,privateInput:e.privateInput.toString(),recipientPrivateOutput:e.recipientPrivateOutput.toString(),senderPrivateOutput:e.senderPrivateOutput.toString()}))(e)}},dr=e=>{switch(e.proofId){case p.ProofId.ACCOUNT:return(e=>new ar(g.TxId.fromString(e.txId),Wn.GrumpkinAddress.fromString(e.userId),f.AliasHash.fromString(e.aliasHash),e.newSpendingPublicKey1?or.from(e.newSpendingPublicKey1,"hex"):void 0,e.newSpendingPublicKey2?or.from(e.newSpendingPublicKey2,"hex"):void 0,e.migrated,e.txRefNo,e.created,e.settled))(e);case p.ProofId.DEFI_DEPOSIT:return(e=>new cr(g.TxId.fromString(e.txId),Wn.GrumpkinAddress.fromString(e.userId),sr.BridgeId.fromString(e.bridgeId),BigInt(e.depositValue),BigInt(e.txFee),ur.from(e.partialStateSecret,"hex"),e.txRefNo,e.created,e.settled,e.interactionNonce,e.isAsync,e.success,e.outputValueA?BigInt(e.outputValueA):void 0,e.outputValueB?BigInt(e.outputValueB):void 0,e.finalised,e.claimSettled,e.claimTxId?g.TxId.fromString(e.claimTxId):void 0))(e);default:return(e=>new lr(g.TxId.fromString(e.txId),Wn.GrumpkinAddress.fromString(e.userId),e.proofId,e.assetId,BigInt(e.publicValue),e.publicOwner?Wn.EthAddress.fromString(e.publicOwner):void 0,BigInt(e.privateInput),BigInt(e.recipientPrivateOutput),BigInt(e.senderPrivateOutput),e.isRecipient,e.isSender,e.accountRequired,e.txRefNo,e.created,e.settled))(e)}};Wn=o("1T4rt"),Zn=o("2ZepW");const pr=h.createLogger("bb:account_proof");class mr{constructor(e,t,n){this.prover=e,this.worldState=t,this.db=n}async createProofInput(e,t,n,r,i,o,a,s=!0){const u=e.equals(r),c=this.worldState.getRoot(),{path:l,index:f}=await this.getAccountPathAndIndex(e,s?r:e),h=new p.AccountTx(c,e,i||e,o||Wn.GrumpkinAddress.ZERO,a||Wn.GrumpkinAddress.ZERO,t,u,n,f,l,r);return{tx:h,signingData:await this.prover.computeSigningData(h)}}async createProof({tx:e,signature:t},n){pr("creating proof...");const r=(new Date).getTime(),i=await this.prover.createAccountProof(e,t);pr(`created proof: ${(new Date).getTime()-r}ms`),pr(`proof size: ${i.length}`);const o=new p.ProofData(i),a=new g.TxId(o.txId),{aliasHash:s,newAccountPublicKey:u,newSpendingPublicKey1:c,newSpendingPublicKey2:l,migrate:f}=e;return{tx:new ar(a,u,s,c?.x(),l?.x(),f,n,new Date),proofData:o,offchainTxData:new y.OffchainAccountData(u,s,c?.x(),l?.x(),n),outputNotes:[]}}async getAccountPathAndIndex(e,t){if(t.equals(e))return{path:this.worldState.buildZeroHashPath(er.WorldStateConstants.DATA_TREE_DEPTH),index:0};{const n=await this.db.getSpendingKey(e,t);if(void 0===n)throw new Error("Unknown spending key.");const r=Zn.HashPath.fromBuffer(n.hashPath);return{path:await this.worldState.buildFullHashPath(n.treeIndex,r),index:n.treeIndex}}}}Wn=o("1T4rt"),sr=o("jJK4a"),v=o("1vwiL"),Zn=o("2ZepW"),$n=o("4G3uU"),$n=o("4G3uU");var yr=T;class gr{constructor(e,t,n,r,i,o,a){this.treeNote=e,this.commitment=t,this.nullifier=n,this.allowChain=r,this.nullified=i,this.index=o,this.hashPath=a}get assetId(){return this.treeNote.assetId}get value(){return this.treeNote.value}get owner(){return this.treeNote.ownerPubKey}get ownerAccountRequired(){return this.treeNote.accountRequired}get pending(){return void 0===this.index}}const br=({treeNote:e,commitment:t,nullifier:n,allowChain:r,nullified:i,index:o,hashPath:a})=>({treeNote:new Uint8Array(e.toBuffer()),commitment:t.toString("hex"),nullifier:n.toString("hex"),allowChain:r,nullified:i,index:o,hashPath:a?.toString("hex")}),vr=({treeNote:e,commitment:t,nullifier:n,allowChain:r,nullified:i,index:o,hashPath:a})=>new gr($n.TreeNote.fromBuffer(yr.from(e)),yr.from(t,"hex"),yr.from(n,"hex"),r,i,o,a?yr.from(a,"hex"):void 0);var wr=T;class _r{constructor(e,t,n,r){this.noteAlgos=e,this.worldState=t,this.grumpkin=n,this.db=r}async createTx(e,t,n,r,i,{publicValue:o=BigInt(0),publicOwner:a=Wn.EthAddress.ZERO,outputNoteValue1:s=BigInt(0),outputNoteValue2:u=BigInt(0),newNoteOwner:c=e.id,newNoteOwnerAccountRequired:l=!0,bridgeId:h=sr.BridgeId.ZERO,defiDepositValue:d=BigInt(0),allowChain:m=0}={}){if(r.reduce(((e,t)=>e+(t.allowChain?1:0)),0)>1)throw new Error("Cannot chain from more than one pending note.");const{id:y,accountPrivateKey:g,accountPublicKey:b}=e,w=!i.equals(e.id),_=w?(await this.db.getAlias(b))?.aliasHash:f.AliasHash.random();if(!_)throw new Error("User not registered or not fully synced.");const{path:E,index:S}=await this.getAccountPathAndIndex(b,i),x=r.length,T=[...r],M=T.map((e=>e.treeNote));for(let e=T.length;e<2;++e){const e=$n.TreeNote.createFromEphPriv(b,BigInt(0),n,w,v.randomBytes(32),this.createEphemeralPrivKey(),this.grumpkin);M.push(e),T.push(this.generateNewNote(e,g,{gibberish:!0}))}const A=T.map((e=>e.index||0)),R=await Promise.all(T.map((async(e,t)=>{if(e.hashPath){const n=Zn.HashPath.fromBuffer(e.hashPath);return await this.worldState.buildFullHashPath(A[t],n)}return this.worldState.buildZeroHashPath(er.WorldStateConstants.DATA_TREE_DEPTH)}))),I=T.map((e=>e.nullifier)),P=[this.createNote(n,s,c,l,I[0]),this.createNote(n,u,y,w,I[1])],N=P.map((e=>e.note)),O=t===p.ProofId.DEFI_DEPOSIT?this.createClaimNote(h,d,y,I[0]):{note:$n.ClaimNoteTxData.EMPTY,ephPubKey:void 0},C=1+r.findIndex((e=>e.allowChain)),k=C?r[C-1].commitment:wr.alloc(32),B=this.worldState.getRoot();return{tx:new p.JoinSplitTx(t,o,a,n,x,A,B,R,M,N,O.note,g,_,w,S,E,i,k,m),viewingKeys:t===p.ProofId.DEFI_DEPOSIT?[P[1].viewingKey]:[P[0].viewingKey,P[1].viewingKey],partialStateSecretEphPubKey:O.ephPubKey}}async getAccountPathAndIndex(e,t){if(t.equals(e))return{path:this.worldState.buildZeroHashPath(er.WorldStateConstants.DATA_TREE_DEPTH),index:0};{const n=await this.db.getSpendingKey(e,t);if(void 0===n)throw new Error("Unknown spending key.");const r=Zn.HashPath.fromBuffer(n.hashPath);return{path:await this.worldState.buildFullHashPath(n.treeIndex,r),index:n.treeIndex}}}generateNewNote(e,t,{allowChain:n=!1,gibberish:r=!1}={}){const i=this.noteAlgos.valueNoteCommitment(e),o=this.noteAlgos.valueNoteNullifier(i,t,!r);return new gr(e,i,o,n,!1)}createNote(e,t,n,r,i,o){const{ephPrivKey:a}=this.createEphemeralKeyPair(),s=o?o.x():wr.alloc(32),u=$n.TreeNote.createFromEphPriv(n,t,e,r,i,a,this.grumpkin,s),c=u.createViewingKey(a,this.grumpkin);return{note:u,viewingKey:c}}createClaimNote(e,t,n,r){const{ephPrivKey:i,ephPubKey:o}=this.createEphemeralKeyPair(),a=$n.deriveNoteSecret(n,i,this.grumpkin);return{note:new $n.ClaimNoteTxData(t,e,a,r),ephPubKey:o}}createEphemeralPrivKey(){return this.grumpkin.getRandomFr()}createEphemeralKeyPair(){const e=this.grumpkin.getRandomFr();return{ephPrivKey:e,ephPubKey:new Wn.GrumpkinAddress(this.grumpkin.mul(Qn.Grumpkin.one,e))}}}const Er=h.createLogger("bb:defi_deposit_proof_creator");class Sr{constructor(e,t,n,r,i){this.prover=e,this.noteAlgos=t,this.txFactory=new _r(t,n,r,i)}async createProofInput(e,t,n,r,i){if(i.equals(e.id))throw new Error("Cannot spend notes for defi deposit using account key.");const o=t.inputAssetIdA,a=await this.txFactory.createTx(e,p.ProofId.DEFI_DEPOSIT,o,r,i,{bridgeId:t,defiDepositValue:n,newNoteOwner:e.id,newNoteOwnerAccountRequired:!0}),s=await this.prover.computeSigningData(a.tx);return{...a,signingData:s}}async createProof(e,{tx:t,signature:n,partialStateSecretEphPubKey:r,viewingKeys:i},o){Er("creating proof...");const a=(new Date).getTime(),s=await this.prover.createProof(t,n);Er(`created proof: ${(new Date).getTime()-a}ms`),Er(`proof size: ${s.length}`);const u=new p.ProofData(s),c=new g.TxId(u.txId),{outputNotes:l,claimNote:{value:f,bridgeId:h,partialStateSecret:d},inputNotes:m}=t,b=(h.numInputAssets>1?m[0].value:m.reduce(((e,t)=>e+t.value),BigInt(0)))-f,v=new cr(c,e.id,h,f,b,d,o,new Date),w=this.noteAlgos.valueNotePartialCommitment(d,e.id,!0);return{tx:v,proofData:u,offchainTxData:new y.OffchainDefiDepositData(h,w,r,f,b,i[0],o),outputNotes:[this.txFactory.generateNewNote(l[0],e.accountPrivateKey,{allowChain:u.allowChainFromNote1}),this.txFactory.generateNewNote(l[1],e.accountPrivateKey,{allowChain:u.allowChainFromNote2})]}}}const xr=h.createLogger("bb:payment_proof_creator");class Tr{constructor(e,t,n,r,i){this.prover=e,this.txFactory=new _r(t,n,r,i)}async createProofInput(e,t,n,r,i,o,a,s,u,c,l,f,h){if(o&&a)throw new Error("Public values cannot be both greater than zero.");if(a+r+i>o+n)throw new Error("Total output cannot be larger than total input.");if(o+a&&!l)throw new Error("Public owner undefined.");if(r&&!u)throw new Error("Note recipient undefined.");const d=!f.equals(e.accountPublicKey);if(t.some((e=>e.treeNote.accountRequired!==d)))throw new Error(`Cannot spend notes with ${d?"account":"spending"} key.`);const m=o>0?p.ProofId.DEPOSIT:a>0?p.ProofId.WITHDRAW:p.ProofId.SEND,y=t.reduce(((e,t)=>e+t.value),BigInt(0)),g=y>n?y-n:BigInt(0),b=await this.txFactory.createTx(e,m,s,t,f,{publicValue:o+a,publicOwner:l,outputNoteValue1:r,outputNoteValue2:g+i,newNoteOwner:u,newNoteOwnerAccountRequired:c,allowChain:h}),v=await this.prover.computeSigningData(b.tx);return{...b,signingData:v}}async createProof(e,{tx:t,signature:n,viewingKeys:r},i){xr("creating proof...");const o=(new Date).getTime(),a=await this.prover.createProof(t,n);xr(`created proof: ${(new Date).getTime()-o}ms`),xr(`proof size: ${a.length}`);const s=new p.ProofData(a),u=new g.TxId(s.txId),{inputNotes:c,outputNotes:[l,f],proofId:h,publicValue:d,publicOwner:m}=t,b=c.reduce(((e,t)=>e+t.value),BigInt(0)),{value:v}=l,{assetId:w,value:_}=f,E=l.ownerPubKey,S=f.ownerPubKey;let x=E.equals(S),T=!0,M=f.accountRequired;l.ownerPubKey.equals(f.ownerPubKey)&&l.accountRequired!==f.accountRequired&&(x=l.accountRequired,T=f.accountRequired,M=!0);return{tx:new lr(u,S,h,w,d,m,b,v,_,x,T,M,i,new Date),proofData:s,offchainTxData:new y.OffchainJoinSplitData(r,i),outputNotes:[this.txFactory.generateNewNote(l,e.accountPrivateKey,{allowChain:s.allowChainFromNote1}),this.txFactory.generateNewNote(f,e.accountPrivateKey,{allowChain:s.allowChainFromNote2})]}}}Wn=o("1T4rt"),v=o("1vwiL");var Mr=o("aebg6"),Ar=T;const Rr=({tx:e,signingData:t,signature:n})=>({tx:new Uint8Array(e.toBuffer()),signingData:new Uint8Array(t),signature:n?n.toString():void 0}),Ir=({tx:e,signingData:t,signature:n})=>({tx:p.AccountTx.fromBuffer(Ar.from(e)),signingData:Ar.from(t),signature:n?v.SchnorrSignature.fromString(n):void 0}),Pr=({tx:e,viewingKeys:t,partialStateSecretEphPubKey:n,signingData:r,signature:i})=>({tx:new Uint8Array(e.toBuffer()),viewingKeys:t.map((e=>e.toString())),partialStateSecretEphPubKey:n?n.toString():void 0,signingData:new Uint8Array(r),signature:i?i.toString():void 0}),Nr=({tx:e,viewingKeys:t,partialStateSecretEphPubKey:n,signingData:r,signature:i})=>({tx:p.JoinSplitTx.fromBuffer(Ar.from(e)),viewingKeys:t.map((e=>Mr.ViewingKey.fromString(e))),partialStateSecretEphPubKey:n?Wn.GrumpkinAddress.fromString(n):void 0,signingData:Ar.from(r),signature:i?v.SchnorrSignature.fromString(i):void 0});var Or=T;const Cr=({tx:e,proofData:t,offchainTxData:n,outputNotes:r,signature:i})=>({tx:hr(e),proofData:new Uint8Array(t.rawProofData),offchainTxData:new Uint8Array(n.toBuffer()),outputNotes:r.map((e=>br(e))),signature:i?new Uint8Array(i):void 0}),kr=(e,t)=>{switch(e){case p.ProofId.DEPOSIT:case p.ProofId.WITHDRAW:case p.ProofId.SEND:return y.OffchainJoinSplitData.fromBuffer(t);case p.ProofId.ACCOUNT:return y.OffchainAccountData.fromBuffer(t);case p.ProofId.DEFI_DEPOSIT:return y.OffchainDefiDepositData.fromBuffer(t);default:throw new Error(`Unsupported ProofOutput proofId: ${e}`)}},Br=({tx:e,proofData:t,offchainTxData:n,outputNotes:r,signature:i})=>({tx:dr(e),proofData:new p.ProofData(Or.from(t)),offchainTxData:kr(e.proofId,Or.from(n)),outputNotes:r.map((e=>vr(e))),signature:i?Or.from(i):void 0});class Dr{constructor(){this.queue=new Te.MemoryFifo,this.queue.process((e=>e()))}length(){return this.queue.length()}cancel(){this.queue.cancel()}async push(e){return new Promise(((t,n)=>{this.queue.put((async()=>{try{const n=await e();t(n)}catch(e){n(e)}}))}))}}var jr={};Object.defineProperty(jr,"__esModule",{value:!0}),jr.Mutex=void 0,s(o("3CZp2"),jr);jr.Mutex=class{constructor(e,t,n=5e3,r=2e3,i=2e3){this.db=e,this.name=t,this.timeout=n,this.tryLockInterval=r,this.pingInterval=i,this.id=0}async lock(){for(;;){if(await this.db.acquireLock(this.name,this.timeout)){const e=this.id;return void(this.pingTimeout=setTimeout((()=>this.ping(e)),this.pingInterval))}await new Promise((e=>setTimeout(e,this.tryLockInterval)))}}async unlock(){clearTimeout(this.pingTimeout),this.id++,await this.db.releaseLock(this.name)}async ping(e){e===this.id&&(await this.db.extendLock(this.name,this.timeout),this.pingTimeout=setTimeout((()=>this.ping(e)),this.pingInterval))}};class Lr{constructor(e,t,n=5e3,r=2e3,i=2e3){this.queue=new Te.MemoryFifo,this.queue.process((e=>e())),this.mutex=new jr.Mutex(e,t,n,r,i)}length(){return this.queue.length()}cancel(){this.queue.cancel()}async push(e){return new Promise(((t,n)=>{this.queue.put((async()=>{await this.mutex.lock();try{const n=await e();t(n)}catch(e){n(e)}finally{await this.mutex.unlock()}}))}))}}class qr{constructor(e,t,n){this.schnorr=e,this.publicKey=t,this.privateKey=n}getPublicKey(){return this.publicKey}async signMessage(e){return this.schnorr.constructSignature(e,this.privateKey)}}Wn=o("1T4rt"),Hn=o("lJwtZ"),sr=o("jJK4a"),$n=o("4G3uU"),Ln=o("3KgUz");class Ur{constructor(e=[]){this.sortedNotes=[],this.bulkAdd(e)}get length(){return this.sortedNotes.length}get notes(){return[...this.sortedNotes]}add(e){let t=this.sortedNotes.length;for(;t>0&&!(this.sortedNotes[t-1].value<e.value||this.sortedNotes[t-1].value===e.value&&!e.pending);t--);return this.sortedNotes.splice(t,0,e),this}bulkAdd(e){return this.sortedNotes.length?e.forEach((e=>this.add(e))):this.sortedNotes=[...e].sort(((e,t)=>e.value<t.value?-1:e.value>t.value||t.pending?1:-1)),this}forEach(e){this.sortedNotes.forEach(((t,n)=>e(t,n)))}find(e){return this.sortedNotes.find((t=>e(t)))}findLast(e){for(let t=this.sortedNotes.length-1;t>=0;--t)if(e(this.sortedNotes[t]))return this.sortedNotes[t]}nth(e){return this.sortedNotes[e]}first(e){return this.sortedNotes.slice(0,e)}last(e){return this.sortedNotes.slice(-e)}filter(e){const t=this.sortedNotes.filter(e);return new Ur(t)}clone(){return new Ur(this.notes)}}const Fr=(e,t)=>{let n=0;const r=e.nth(n);if(!r)return null;let i=r.value,o=e.length-1;if(n===o)return i>=t?[r]:null;const a=e.nth(o);i+=a.value;let s=i,u=[r,a];for(;n<o-1;){if(s>t)o--;else if(s<t)n++;else{if(!(n<o-2))break;n++,o--}const r=[e.nth(n),e.nth(o)];s=r[0].value+r[1].value,(s===t||i!==t&&s>t)&&(i=s,u=r)}return i>=t?u:null},Kr=e=>e.reduce(((e,{value:t})=>e+t),BigInt(0));class Vr{constructor(e=[]){this.notes=e;const t=e.filter((e=>e.ownerAccountRequired));this.spendableNotes=new Ur(t.filter((e=>!e.pending||e.allowChain))),this.settledNotes=new Ur(t.filter((e=>!e.pending)));const n=e.filter((e=>!e.ownerAccountRequired));this.unsafeSpendableNotes=new Ur(n.filter((e=>!e.pending||e.allowChain))),this.unsafeSettledNotes=new Ur(n.filter((e=>!e.pending)))}pick(e,t,n=!1,r=!1){const i=this.getSortedNotes(t,n,r),o=((e,t)=>{const n=e.filter((e=>!e.allowChain)),r=e.filter((e=>e.allowChain)),i=[Fr(n,t)];return r.forEach((e=>{const r=n.clone().add(e);i.push(Fr(r,t))})),i.reduce(((e,t)=>{if(!e||!t)return e||t;if(e.length!==t.length)return e.length>t.length?e:t;const n=e.reduce(((e,t)=>e+t.value),BigInt(0)),r=t.reduce(((e,t)=>e+t.value),BigInt(0));return r<n||r===n&&t[0].value>e[0].value?t:e}),i[0])||null})(i,e)||[];if(Kr(o)===e)return o;const a=i.findLast((t=>t.value===e));return a?[a]:o}pickOne(e,t,n=!1,r=!1){const i=this.getSortedNotes(t,!0,r).find((t=>t.value>=e));if(n)return i;const o=this.getSortedNotes(t,!1,r).find((t=>t.value>=e));return i&&o?i.value<=o.value?i:o:i||o}getSum(e=!1){return Kr(e?this.unsafeSettledNotes.notes:this.settledNotes.notes)}getSpendableSum(e,t=!1,n=!1){const r=this.getSortedNotes(e,t,n);return Kr(r.notes)}getMaxSpendableValue(e,t=2,n=!1,r=!1){if(t<=0||t>2)throw new Error("`numNotes` can only be 1 or 2.");const i=this.getSortedNotes(e,n,r),o=[];let a=!1;return i.findLast((e=>(e.pending&&a||o.push(e),a=a||e.pending,o.length===t))),Kr(o)}getSortedNotes(e=[],t,n){const[r,i]=n?[this.unsafeSettledNotes,this.unsafeSpendableNotes]:[this.settledNotes,this.spendableNotes];return(t?r:i).filter((({nullifier:t})=>!e.some((e=>e.equals(t)))))}}var zr=T;const Wr=h.createLogger("bb:user_state");var Hr;!function(e){e.UPDATED_USER_STATE="UPDATED_USER_STATE"}(Hr||(Hr={}));class Gr extends Ln.EventEmitter{constructor(e,t,n,r,i){super(),this.userData=e,this.grumpkin=t,this.noteAlgos=n,this.db=r,this.rollupProvider=i,this.notePickers=[],this.blockQueue=new Te.MemoryFifo}debug(...e){Wr(`${this.userData.id.toShortString()}:`,...e)}async init(){await this.resetData(),await this.refreshNotePicker()}async start(){this.debug(`starting from rollup block ${this.userData.syncedToRollup+1}...`),this.runningPromise=this.blockQueue.process((async e=>this.handleBlocks(e)))}async stop(e=!1){this.debug("stopping..."),e?this.blockQueue.end():this.blockQueue.cancel(),await this.runningPromise,this.debug("stopped.")}isSyncing(){return this.blockQueue.length()>1}async awaitSynchronised(){for(;this.isSyncing();)await new Promise((e=>setTimeout(e,1e3)))}getUserData(){return this.userData}processBlock(e){this.blockQueue.put([e])}processBlocks(e){this.blockQueue.put(e)}async handleBlocks(e){if(0==(e=e.filter((e=>e.block.rollupId>this.userData.syncedToRollup))).length)return;const t=e.map((e=>m.RollupProofData.fromBuffer(e.block.rollupProofData))),n=t.map((e=>e.innerProofData.filter((e=>!e.isPadding())))).flat(),r=e.map((e=>e.block.offchainTxData)).flat(),i=[],o=[],a=[],s=[],u=[],c=[];n.forEach(((e,t)=>{switch(e.proofId){case p.ProofId.DEPOSIT:case p.ProofId.WITHDRAW:case p.ProofId.SEND:{const e=y.OffchainJoinSplitData.fromBuffer(r[t]);i.push(...e.viewingKeys);const{noteCommitment1:u,noteCommitment2:c,nullifier1:l,nullifier2:f}=n[t];o.push(u),o.push(c),a.push(l),a.push(f),s.push(e);break}case p.ProofId.ACCOUNT:u.push(y.OffchainAccountData.fromBuffer(r[t]));break;case p.ProofId.DEFI_DEPOSIT:{const e=y.OffchainDefiDepositData.fromBuffer(r[t]);i.push(e.viewingKey);const{noteCommitment2:s,nullifier2:u}=n[t];o.push(s),a.push(u),c.push(e);break}}}));const l=zr.concat(i.flat().map((e=>e.toBuffer()))),f=await $n.batchDecryptNotes(l,this.userData.accountPrivateKey,this.noteAlgos,this.grumpkin),h=$n.recoverTreeNotes(f,a,o,this.userData.accountPrivateKey,this.grumpkin,this.noteAlgos);let d=0;for(let n=0;n<e.length;++n){const r=e[n],i=t[n];for(let e=0;e<i.innerProofData.length;++e){const t=i.innerProofData[e];if(t.isPadding())continue;const n=i.dataStartIndex+2*e;switch(t.proofId){case p.ProofId.DEPOSIT:case p.ProofId.WITHDRAW:case p.ProofId.SEND:{const[e]=s.splice(0,1),[i,o]=h.slice(d,d+2);if(d+=2,!i&&!o)continue;await this.handlePaymentTx(r,t,e,n,i,o);break}case p.ProofId.ACCOUNT:{const[e]=u.splice(0,1);await this.handleAccountTx(r,t,e,n);break}case p.ProofId.DEFI_DEPOSIT:{const e=h[d];d++;const[o]=c.splice(0,1);if(!e)continue;await this.handleDefiDepositTx(r,i,t,o,n,e);break}case p.ProofId.DEFI_CLAIM:await this.handleDefiClaimTx(r,t,n)}}this.userData={...this.userData,syncedToRollup:i.rollupId},await this.processDefiInteractionResults(r)}await this.db.updateUser(this.userData),this.emit(Hr.UPDATED_USER_STATE,this.userData.id)}async resetData(){const e=await this.rollupProvider.getPendingTxs(),t=await this.db.getPendingUserTxs(this.userData.id);for(const n of t)e.some((e=>e.txId.equals(n)))||await this.db.removeUserTx(this.userData.id,n);const n=await this.db.getPendingNotes(this.userData.id);for(const t of n)e.some((e=>e.noteCommitment1.equals(t.commitment)||e.noteCommitment2.equals(t.commitment)))||await this.db.removeNote(t.nullifier)}async handleAccountTx(e,t,n,r){const{created:i}=e.block,o=this.recoverAccountTx(t,n,i);if(!o.userId.equals(this.userData.id))return;const{txId:a,userId:s,newSpendingPublicKey1:u,newSpendingPublicKey2:c}=o;if(u){this.debug(`added spending key ${u.toString("hex")}.`);const t=await e.getBlockSubtreeHashPath(r);await this.db.addSpendingKey({userId:s,key:u,treeIndex:r,hashPath:t.toBuffer()})}if(c){this.debug(`added spending key ${c.toString("hex")}.`);const t=await e.getBlockSubtreeHashPath(r+1);await this.db.addSpendingKey({userId:s,key:c,treeIndex:r+1,hashPath:t.toBuffer()})}await this.db.getAccountTx(a)?(this.debug(`settling account tx: ${a.toString()}`),await this.db.settleAccountTx(a,e.block.created)):(this.debug(`recovered account tx: ${a.toString()}`),await this.db.addAccountTx(o))}async handlePaymentTx(e,t,n,r,i,o){const{created:a}=e.block,{noteCommitment1:s,noteCommitment2:u,nullifier1:c,nullifier2:l}=t,f=i?await this.processSettledNote(r,i,s,e):void 0,h=o?await this.processSettledNote(r+1,o,u,e):void 0;if(!f&&!h)return;const d=await this.nullifyNote(c),p=await this.nullifyNote(l);await this.refreshNotePicker();const m=new g.TxId(t.txId);if(await this.db.getPaymentTx(this.userData.id,m))this.debug(`settling payment tx: ${m}`),await this.db.settlePaymentTx(this.userData.id,m,a);else{const e=this.recoverPaymentTx(t,n,a,f,h,d,p);this.debug(`received or recovered payment tx: ${m}`),await this.db.addPaymentTx(e)}}async handleDefiDepositTx(e,t,n,r,i,o){const{interactionResult:a,created:s}=e.block,{noteCommitment1:u,noteCommitment2:c}=n;if(!await this.processSettledNote(i+1,o,c,e))return;const{bridgeId:l,partialStateSecretEphPubKey:f}=r,h=$n.deriveNoteSecret(f,this.userData.accountPrivateKey,this.grumpkin),d=new g.TxId(n.txId),{rollupId:p,bridgeIds:y}=t,b=m.RollupProofData.NUM_BRIDGE_CALLS_PER_BLOCK*p+y.findIndex((e=>e.equals(l.toBuffer()))),v=a.every((e=>e.nonce!==b));await this.addClaim(d,u,h,b);const{nullifier1:w,nullifier2:_}=n;await this.nullifyNote(w),await this.nullifyNote(_),await this.refreshNotePicker();if(await this.db.getDefiTx(d))this.debug(`found defi tx, awaiting claim for settlement: ${d}`),await this.db.settleDefiDeposit(d,b,v,s);else{const e=this.recoverDefiTx(n,r,s,b,v);this.debug(`recovered defi tx: ${d}`),await this.db.addDefiTx(e)}}async processDefiInteractionResults(e){const{interactionResult:t,created:n}=e.block;for(const e of t){const t=await this.db.getDefiTxsByNonce(this.userData.id,e.nonce);for(const r of t){const t=e.result?e.totalOutputValueA*r.depositValue/e.totalInputValue:BigInt(0),i=e.result?e.totalOutputValueB*r.depositValue/e.totalInputValue:BigInt(0);await this.db.updateDefiTxFinalisationResult(r.txId,e.result,t,i,n)}}}async handleDefiClaimTx(e,t,n){const{nullifier1:r}=t,i=new g.TxId(t.txId);this.debug(`found claim tx: ${i}`);const o=await this.db.getClaimTx(r);if(!o?.userId.equals(this.userData.id))return;const{created:a}=e.block,{defiTxId:s,userId:u,secret:c,interactionNonce:l}=o,{noteCommitment1:f,noteCommitment2:h,nullifier2:d}=t,{bridgeId:p,depositValue:m,outputValueA:y,outputValueB:b,success:v}=await this.db.getDefiTx(s),w=!0;if(!v){{const t=new $n.TreeNote(u,m,p.inputAssetIdA,w,c,zr.alloc(32),r);await this.processSettledNote(n,t,f,e)}if(2===p.numInputAssets){const t=new $n.TreeNote(u,m,p.inputAssetIdB,w,c,zr.alloc(32),d);await this.processSettledNote(n+1,t,h,e)}}if(y){const t=new $n.TreeNote(u,y,p.firstOutputVirtual?sr.virtualAssetIdFlag+l:p.outputAssetIdA,w,c,zr.alloc(32),r);await this.processSettledNote(n,t,f,e)}if(b){const t=new $n.TreeNote(u,b,p.secondOutputVirtual?sr.virtualAssetIdFlag+l:p.outputAssetIdB,w,c,zr.alloc(32),d);await this.processSettledNote(n+1,t,h,e)}await this.refreshNotePicker(),await this.db.settleDefiTx(s,a,i),this.debug(`settled defi tx: ${s}`)}async processSettledNote(e,t,n,r){const{value:i}=t,o=await r.getBlockSubtreeHashPath(e),a=this.noteAlgos.valueNoteNullifier(n,this.userData.accountPrivateKey),s=new gr(t,n,a,!1,!1,e,o.toBuffer());return i&&(await this.db.addNote(s),this.debug(`successfully decrypted note at index ${e} with value ${i} of asset ${t.assetId}.`)),s}async nullifyNote(e){const t=await this.db.getNoteByNullifier(e);if(t&&t.owner.equals(this.userData.id))return await this.db.nullifyNote(e),this.debug(`nullified note at index ${t.index} with value ${t.value}.`),t}async addClaim(e,t,n,r){const i=this.noteAlgos.claimNoteNullifier(t);await this.db.addClaimTx({defiTxId:e,userId:this.userData.id,secret:n,nullifier:i,interactionNonce:r})}recoverPaymentTx(e,t,n,r,i,o,a){const s=e.proofId,u=e.assetId.readUInt32BE(28),c=Hn.toBigIntBE(e.publicValue),l=c?new Wn.EthAddress(e.publicOwner):void 0,f=e=>e?e.value:BigInt(0),h=f(o)+f(a),d=f(r),p=f(i);let m=!!r,y=!!i,b=(r||i).ownerAccountRequired;r&&i&&r.owner.equals(i.owner)&&r.ownerAccountRequired!==i.ownerAccountRequired&&(m=r.ownerAccountRequired,y=i.ownerAccountRequired,b=!0);const{txRefNo:v}=t;return new lr(new g.TxId(e.txId),this.userData.id,s,u,c,l,h,d,p,m,y,b,v,new Date,n)}recoverAccountTx(e,t,n){const{accountPublicKey:r,aliasHash:i,spendingPublicKey1:o,spendingPublicKey2:a,txRefNo:s}=t,u=new g.TxId(e.txId),{nullifier1:c,nullifier2:l}=e,f=!Hn.toBigIntBE(c)&&!!Hn.toBigIntBE(l);return new ar(u,r,i,Hn.toBigIntBE(o)?o:void 0,Hn.toBigIntBE(a)?a:void 0,f,s,new Date,n)}recoverDefiTx(e,t,n,r,i){const{bridgeId:o,depositValue:a,txFee:s,partialStateSecretEphPubKey:u,txRefNo:c}=t,l=new g.TxId(e.txId),f=$n.deriveNoteSecret(u,this.userData.accountPrivateKey,this.grumpkin);return new cr(l,this.userData.id,o,a,s,f,c,new Date,n,r,i)}async refreshNotePicker(){const e=new Map;(await this.db.getNotes(this.userData.id)).forEach((t=>{const n=e.get(t.assetId)||[];e.set(t.assetId,[...n,t])}));const t=[...e.keys()].sort(((e,t)=>e>t?1:-1));this.notePickers=t.map((t=>({assetId:t,notePicker:new Vr(e.get(t))})))}async pickNotes(e,t,n=!1,r=!1){const{notePicker:i}=this.notePickers.find((t=>t.assetId===e))||{};if(!i)return[];const o=await this.rollupProvider.getPendingNoteNullifiers();return i.pick(t,o,n,r)}async pickNote(e,t,n=!1,r=!1){const{notePicker:i}=this.notePickers.find((t=>t.assetId===e))||{};if(!i)return;const o=await this.rollupProvider.getPendingNoteNullifiers();return i.pickOne(t,o,n,r)}async getSpendableSum(e,t=!1,n=!1){const{notePicker:r}=this.notePickers.find((t=>t.assetId===e))||{};if(!r)return BigInt(0);const i=await this.rollupProvider.getPendingNoteNullifiers();return r.getSpendableSum(i,t,n)}async getSpendableSums(e=!1,t=!1){const n=await this.rollupProvider.getPendingNoteNullifiers();return this.notePickers.map((({assetId:r,notePicker:i})=>({assetId:r,value:i.getSpendableSum(n,e,t)}))).filter((e=>e.value>BigInt(0)))}async getMaxSpendableValue(e,t,n=!1,r=!1){const{notePicker:i}=this.notePickers.find((t=>t.assetId===e))||{};if(!i)return BigInt(0);const o=await this.rollupProvider.getPendingNoteNullifiers();return i.getMaxSpendableValue(o,t,n,r)}getBalance(e,t=!1){const{notePicker:n}=this.notePickers.find((t=>t.assetId===e))||{};return n?n.getSum(t):BigInt(0)}getBalances(e=!1){return this.notePickers.map((({assetId:t,notePicker:n})=>({assetId:t,value:n.getSum(e)}))).filter((e=>e.value>BigInt(0)))}async addProof({tx:e,outputNotes:t}){switch(e.proofId){case p.ProofId.DEPOSIT:case p.ProofId.WITHDRAW:case p.ProofId.SEND:this.debug(`adding pending payment tx: ${e.txId}`),await this.db.addPaymentTx(e);break;case p.ProofId.ACCOUNT:this.debug(`adding pending account tx: ${e.txId}`),await this.db.addAccountTx(e);break;case p.ProofId.DEFI_DEPOSIT:this.debug(`adding pending defi tx: ${e.txId}`),await this.db.addDefiTx(e)}const n=t[0]&&await this.processPendingNote(t[0]),r=t[1]&&await this.processPendingNote(t[1]);(n?.value||r?.value)&&await this.refreshNotePicker(),this.emit(Hr.UPDATED_USER_STATE,this.userData.id)}async processPendingNote(e){const{ownerPubKey:t,value:n}=e.treeNote;if(t.equals(this.userData.id))return n&&(await this.db.addNote(e),Wr(`user ${this.userData.id} adding pending note with value ${n}, allowChain = ${e.allowChain}.`)),e}}class Qr{constructor(e,t,n,r){this.grumpkin=e,this.noteAlgos=t,this.db=n,this.rollupProvider=r}async createUserState(e){const t=new Gr(e,this.grumpkin,this.noteAlgos,this.db,this.rollupProvider);return await t.init(),t}}Wn=o("1T4rt");var Jr,Zr=T;!function(e){e.UPDATED_USERS="SDKEVENT_UPDATED_USERS",e.UPDATED_USER_STATE="SDKEVENT_UPDATED_USER_STATE",e.UPDATED_WORLD_STATE="SDKEVENT_UPDATED_WORLD_STATE",e.DESTROYED="SDKEVENT_DESTROYED"}(Jr||(Jr={}));var $r=T;const Yr=h.createLogger("bb:core_sdk");var Xr,ei;(ei=Xr||(Xr={})).UNINITIALIZED="UNINITIALIZED",ei.INITIALIZED="INITIALIZED",ei.RUNNING="RUNNING",ei.STOPPING="STOPPING",ei.DESTROYED="DESTROYED";class ti extends Ln.EventEmitter{constructor(e,t,n,r,i,o,a,s){super(),this.leveldb=e,this.db=t,this.rollupProvider=n,this.barretenberg=r,this.pedersen=i,this.pippenger=o,this.fftFactory=a,this.workerPool=s,this.userStates=[],this.sdkStatus={serverUrl:"",chainId:-1,rollupContractAddress:Wn.EthAddress.ZERO,feePayingAssetIds:[0],syncedToRollup:-1,latestRollupId:-1,dataRoot:$r.alloc(0),dataSize:0},this.initState=Xr.UNINITIALIZED,this.interruptableSleep=new Yn.InterruptableSleep}async init(e){if(this.initState!==Xr.UNINITIALIZED)throw new Error("Already initialized.");try{this.options=e,this.serialQueue=new Lr(this.db,"aztec_core_sdk"),this.noteAlgos=new $n.NoteAlgorithms(this.barretenberg),this.blake2s=new v.Blake2s(this.barretenberg),this.grumpkin=new Qn.Grumpkin(this.barretenberg),this.schnorr=new v.Schnorr(this.barretenberg),this.userStateFactory=new Qr(this.grumpkin,this.noteAlgos,this.db,this.rollupProvider),this.worldState=new er.WorldState(this.leveldb,this.pedersen);const{blockchainStatus:{chainId:t,rollupContractAddress:n},runtimeConfig:{feePayingAssetIds:r},rollupSize:i}=await this.getRemoteStatus(),o=await this.getLocalRollupContractAddress();o&&!o.equals(n)&&(Yr("Erasing database..."),await this.leveldb.clear(),await this.db.clear()),await this.leveldb.put("rollupContractAddress",n.toBuffer()),await this.initUserStates();const a=Math.ceil(Math.log2(i*er.WorldStateConstants.NUM_NEW_DATA_TREE_NOTES_PER_TX));await this.worldState.init(a),this.sdkStatus={...this.sdkStatus,serverUrl:e.serverUrl,chainId:t,rollupContractAddress:n,feePayingAssetIds:r,dataSize:this.worldState.getSize(),dataRoot:this.worldState.getRoot(),syncedToRollup:await this.getSyncedToRollup(),latestRollupId:+await this.leveldb.get("latestRollupId").catch((()=>-1))},this.initState=Xr.INITIALIZED}catch(e){throw await this.leveldb.close(),await this.db.close(),await(this.workerPool?.destroy()),this.serialQueue?.cancel(),e}}async destroy(){Yr("destroying..."),this.initState=Xr.STOPPING,this.interruptableSleep.interrupt(),await this.synchingPromise,await this.serialQueue.push((async()=>this.serialQueue.cancel())),await Promise.all(this.userStates.map((e=>(e.removeAllListeners(),e.stop())))),await this.fftFactory.destroy(),await this.leveldb.close(),await this.db.close(),await(this.workerPool?.destroy()),this.initState=Xr.DESTROYED,this.emit(Jr.DESTROYED),this.removeAllListeners(),Yr("destroyed.")}async getLocalStatus(){return{...this.sdkStatus}}async getRemoteStatus(){return await this.rollupProvider.getStatus()}async isAccountRegistered(e){return!!await this.db.getAlias(e)}async isRemoteAccountRegistered(e){return this.rollupProvider.isAccountRegistered(e)}async isAliasRegistered(e){const t=await this.computeAliasHash(e);return(await this.db.getAliases(t)).length>0}async isRemoteAliasRegistered(e){return this.rollupProvider.isAliasRegistered(e)}async accountExists(e,t){const n=await this.computeAliasHash(t),r=await this.db.getAlias(e);return!!r&&r.aliasHash.equals(n)}async remoteAccountExists(e,t){return this.rollupProvider.accountExists(e,t)}async getAccountPublicKey(e){const t=await this.computeAliasHash(e);return(await this.db.getAliases(t))[0]?.accountPublicKey}async getRemoteUnsettledAccountPublicKey(e){const t=await this.computeAliasHash(e);return(await this.rollupProvider.getUnsettledAccounts()).find((e=>e.aliasHash.equals(t)))?.accountPublicKey}async getTxFees(e){return this.rollupProvider.getTxFees(e)}async getDefiFees(e){return this.rollupProvider.getDefiFees(e)}async getDefiInteractionNonce(e){const t=await this.db.getDefiTx(e);if(!t)throw new Error("Unknown txId");return t.interactionNonce}async userExists(e){return!!await this.db.getUser(e)}async getUserData(e){return this.getUserState(e).getUserData()}async getUsersData(){return this.userStates.map((e=>e.getUserData()))}async derivePublicKey(e){return new Wn.GrumpkinAddress(this.grumpkin.mul(Qn.Grumpkin.one,e))}async constructSignature(e,t){return this.schnorr.constructSignature(e,t)}async addUser(e,t=!1){return this.serialQueue.push((async()=>{const n=await this.derivePublicKey(e);if(await this.db.getUser(n))throw new Error(`User already exists: ${n}`);let r=-1;if(t){const{blockchainStatus:{nextRollupId:e}}=await this.getRemoteStatus();r=e-1}const i={id:n,accountPrivateKey:e,accountPublicKey:n,syncedToRollup:r};await this.db.addUser(i);const o=await this.userStateFactory.createUserState(i);return this.userStates.push(o),o.start(),this.emit(Jr.UPDATED_USERS),o.getUserData()}))}async removeUser(e){return this.serialQueue.push((async()=>{const t=this.getUserState(e);this.userStates=this.userStates.filter((e=>e!==t)),t.removeAllListeners(),await t.stop(),await this.db.removeUser(e),this.emit(Jr.UPDATED_USERS)}))}async getSpendingKeys(e){return(await this.db.getSpendingKeys(e)).map((e=>e.key))}async getBalances(e,t){return this.getUserState(e).getBalances(t)}async getBalance(e,t,n){return this.getUserState(e).getBalance(t,n)}async getSpendableSum(e,t,n,r){return this.getUserState(e).getSpendableSum(t,n,r)}async getSpendableSums(e,t,n){return this.getUserState(e).getSpendableSums(t,n)}async getMaxSpendableValue(e,t,n,r,i){return this.getUserState(e).getMaxSpendableValue(t,n,r,i)}async pickNotes(e,t,n,r,i){return this.getUserState(e).pickNotes(t,n,r,i)}async pickNote(e,t,n,r,i){return this.getUserState(e).pickNote(t,n,r,i)}async getUserTxs(e){return this.db.getUserTxs(e)}async getRemoteUnsettledPaymentTxs(){return this.rollupProvider.getUnsettledPaymentTxs()}async run(){this.initState!==Xr.RUNNING&&(this.initState=Xr.RUNNING,this.serialQueue.push((async()=>{const{useKeyCache:e}=this.options,{proverless:t,blockchainStatus:{verifierContractAddress:n},runtimeConfig:{useKeyCache:r}}=await this.getRemoteStatus(),i=await this.getLocalVerifierContractAddress(),o=i&&!i.equals(n)||!r||!e,a=Math.max(p.JoinSplitProver.getCircuitSize(),p.AccountProver.getCircuitSize()),s=await this.getCrsData(a);await this.pippenger.init(s),await this.genesisSync(),await this.startReceivingBlocks(),await this.createJoinSplitProofCreator(o,t),await this.createAccountProofCreator(o,t),await this.leveldb.put("verifierContractAddress",n.toBuffer())})).catch(Yr))}async createDepositProof(e,t,n,r,i,o,a){return this.serialQueue.push((async()=>{this.assertInitState(Xr.RUNNING);const s=v.randomBytes(32),u=await this.derivePublicKey(s),c={id:u,accountPrivateKey:s,accountPublicKey:u,syncedToRollup:-1},l=new qr(this,u,s),f=u,h=await this.paymentProofCreator.createProofInput(c,[],BigInt(0),n,BigInt(0),t,BigInt(0),e,i,o,r,f,0),d=await l.signMessage(h.signingData);return this.paymentProofCreator.createProof(c,{...h,signature:d},a)}))}async createPaymentProofInput(e,t,n,r,i,o,a,s,u,c,l,f){return this.serialQueue.push((async()=>{this.assertInitState(Xr.RUNNING);const h=this.getUserState(e),d=h.getUserData(),p=l.equals(e),m=i?await h.pickNotes(t,i,!1,p):[];if(i&&!m.length)throw new Error(`Failed to find no more than 2 notes that sum to ${i}.`);return this.paymentProofCreator.createProofInput(d,m,i,o,a,n,r,t,s,u,c,l,f)}))}async createPaymentProof(e,t){return this.serialQueue.push((async()=>{this.assertInitState(Xr.RUNNING);const{outputNotes:n}=e.tx,r=n[1].ownerPubKey,i=this.getUserState(r).getUserData();return this.paymentProofCreator.createProof(i,e,t)}))}async createAccountProofSigningData(e,t,n,r,i,o,a){return this.serialQueue.push((async()=>{this.assertInitState(Xr.RUNNING);const s=this.computeAliasHash(t),{signingData:u}=await this.accountProofCreator.createProofInput(e,s,n,r,i,o,a,!1);return u}))}async createAccountProofInput(e,t,n,r,i,o,a){return this.serialQueue.push((async()=>{this.assertInitState(Xr.RUNNING);const s=await this.computeAliasHash(t),u=a?await this.derivePublicKey(a):void 0;return this.accountProofCreator.createProofInput(e,s,n,r,u,i,o)}))}async createAccountProof(e,t){return this.serialQueue.push((async()=>(this.assertInitState(Xr.RUNNING),this.accountProofCreator.createProof(e,t))))}async createDefiProofInput(e,t,n,r,i){return this.serialQueue.push((async()=>{this.assertInitState(Xr.RUNNING);const o=this.getUserState(e).getUserData();return this.defiDepositProofCreator.createProofInput(o,t,n,r,i)}))}async createDefiProof(e,t){return this.serialQueue.push((async()=>{this.assertInitState(Xr.RUNNING);const{outputNotes:n}=e.tx,r=n[1].ownerPubKey,i=this.getUserState(r).getUserData();return this.defiDepositProofCreator.createProof(i,e,t)}))}async sendProofs(e){return this.serialQueue.push((async()=>{this.assertInitState(Xr.RUNNING);const t=e.map((({proofData:e,offchainTxData:t,signature:n})=>({proofData:e.rawProofData,offchainTxData:t.toBuffer(),depositSignature:n}))),n=await this.rollupProvider.sendTxs(t);for(const t of e){const{userId:e}=t.tx;try{await this.getUserState(e).addProof(t)}catch(e){}if([p.ProofId.DEPOSIT,p.ProofId.SEND].includes(t.tx.proofId)){const n=t.outputNotes[0].owner;if(!n.equals(e)){const e=t.outputNotes[0].ownerAccountRequired,r=fr(t.tx,n,e);try{await this.getUserState(n).addProof({...t,tx:r})}catch(e){}}}}return n}))}async awaitSynchronised(){for(this.assertInitState(Xr.RUNNING);;)try{if(await this.isSynchronised())return;await new Promise((e=>setTimeout(e,1e3)))}catch(e){Yr(e),await new Promise((e=>setTimeout(e,1e3)))}}async isUserSynching(e){return this.assertInitState(Xr.RUNNING),this.getUserState(e).isSyncing()}async awaitUserSynchronised(e){this.assertInitState(Xr.RUNNING),await this.getUserState(e).awaitSynchronised()}async awaitSettlement(e,t){this.assertInitState(Xr.RUNNING);const n=(new Date).getTime();for(;;){if(t&&(new Date).getTime()-n>1e3*t)throw new Error(`Timeout awaiting tx settlement: ${e}`);if(await this.db.isUserTxSettled(e))break;await new Promise((e=>setTimeout(e,1e3)))}}async awaitDefiDepositCompletion(e,t){this.assertInitState(Xr.RUNNING);const n=(new Date).getTime();for(;;){if(t&&(new Date).getTime()-n>1e3*t)throw new Error(`Timeout awaiting defi interaction: ${e}`);const r=await this.db.getDefiTx(e);if(!r)throw new Error("Unknown txId.");if(r.settled)break;await new Promise((e=>setTimeout(e,1e3)))}}async awaitDefiFinalisation(e,t){this.assertInitState(Xr.RUNNING);const n=(new Date).getTime();for(;;){if(t&&(new Date).getTime()-n>1e3*t)throw new Error(`Timeout awaiting defi interaction: ${e}`);const r=await this.db.getDefiTx(e);if(!r)throw new Error("Unknown txId.");if(r.finalised)break;await new Promise((e=>setTimeout(e,1e3)))}}async awaitDefiSettlement(e,t){this.assertInitState(Xr.RUNNING);const n=(new Date).getTime();for(;;){if(t&&(new Date).getTime()-n>1e3*t)throw new Error(`Timeout awaiting defi interaction: ${e}`);const r=await this.db.getDefiTx(e);if(!r)throw new Error("Unknown txId.");if(r.claimSettled)break;await new Promise((e=>setTimeout(e,1e3)))}}getUserState(e){const t=this.userStates.find((t=>t.getUserData().id.equals(e)));if(!t)throw new Error(`User not found: ${e}`);return t}async isSynchronised(){const e=await this.rollupProvider.getStatus();return this.worldState.getRoot().equals(e.blockchainStatus.dataRoot)}assertInitState(e){if(this.initState!==e)throw new Error(`Init state ${this.initState} !== ${e}`)}async getLocalRollupContractAddress(){const e=await this.leveldb.get("rollupContractAddress").catch((()=>{}));return e?new Wn.EthAddress(e):void 0}async getLocalVerifierContractAddress(){const e=await this.leveldb.get("verifierContractAddress").catch((()=>{}));return e?new Wn.EthAddress(e):void 0}async getSyncedToRollup(){return+await this.leveldb.get("syncedToRollup").catch((()=>-1))}async getCrsData(e){Yr("downloading crs data...");const t=new Gn.Crs(e);return await t.download(),Yr("done."),$r.from(t.getData())}async initUserStates(){Yr("initializing user states...");const e=await this.db.getUsers();this.userStates=await Promise.all(e.map((e=>this.userStateFactory.createUserState(e)))),this.userStates.forEach((e=>e.on(Hr.UPDATED_USER_STATE,(e=>this.emit(Jr.UPDATED_USER_STATE,e)))))}computeAliasHash(e){return f.AliasHash.fromAlias(e,this.blake2s)}async createJoinSplitProofCreator(e,t){const n=await this.fftFactory.createFft(p.JoinSplitProver.getCircuitSize(t)),r=new p.UnrolledProver(this.barretenberg,this.pippenger,n),i=new p.JoinSplitProver(r,t);this.paymentProofCreator=new Tr(i,this.noteAlgos,this.worldState,this.grumpkin,this.db),this.defiDepositProofCreator=new Sr(i,this.noteAlgos,this.worldState,this.grumpkin,this.db),await this.createJoinSplitProvingKey(i,e)}async createAccountProofCreator(e,t){const n=await this.fftFactory.createFft(p.AccountProver.getCircuitSize(t)),r=new p.UnrolledProver(this.barretenberg,this.pippenger,n),i=new p.AccountProver(r,t);this.accountProofCreator=new mr(i,this.worldState,this.db),await this.createAccountProvingKey(i,e)}async createJoinSplitProvingKey(e,t){if(!t){const t=await this.db.getKey("join-split-proving-key");if(t)return Yr("loading join-split proving key..."),void await e.loadKey(t)}if(Yr("computing join-split proving key..."),await e.computeKey(),this.options.useKeyCache){Yr("saving join-split proving key...");const t=await e.getKey();await this.db.addKey("join-split-proving-key",t)}else await this.db.deleteKey("join-split-proving-key");Yr("done.")}async createAccountProvingKey(e,t){if(!t){const t=await this.db.getKey("account-proving-key");if(t)return Yr("loading account proving key..."),void await e.loadKey(t)}if(Yr("computing account proving key..."),await e.computeKey(),this.options.useKeyCache){Yr("saving account proving key...");const t=await e.getKey();await this.db.addKey("account-proving-key",t)}else await this.db.deleteKey("account-proving-key");Yr("done.")}async syncGenesisAliasesAndKeys(e,t){const n=[],r=[];let i=0;for(const o of e){const{alias:{aliasHash:e,address:a},signingKeys:{signingKey1:s,signingKey2:u}}=o,c=new Wn.GrumpkinAddress(a);n.push({accountPublicKey:c,aliasHash:new f.AliasHash(e),index:i}),[s,u].forEach((e=>{r.push({userId:c,treeIndex:i,key:e,hashPath:t[i].toBuffer()}),i++}))}Yr(`saving ${n.length} aliases...`),await this.db.addAliases(n),Yr(`saving ${r.length} spending keys...`),await this.db.addSpendingKeys(r)}async syncGenesisCommitments(e){const{rollupSize:t}=await this.getRemoteStatus(),n=e.flatMap((e=>[e.notes.note1,e.notes.note2])),r=(1<<Math.ceil(Math.log2(t)))*er.WorldStateConstants.NUM_NEW_DATA_TREE_NOTES_PER_TX;let i=0;const o={},a=[];for(Yr("building immutable sub-trees from commitments...");n.length>0;){const e=n.splice(0,r),t=Array(r-e.length).fill(Zn.MemoryMerkleTree.ZERO_ELEMENT),s=[...e,...t],u=await Zn.MemoryMerkleTree.new(s,this.pedersen);for(let e=0;e<r;e++)o[i++]=u.getHashPath(e);a.push(u.getRoot())}return Yr(`adding ${a.length} subtree roots to data tree...`),await this.worldState.insertElements(0,a),o}async genesisSync(e=!1){if(this.worldState.getSize()>0)return;Yr("initialising genesis state from server...");const t=new Xn.Timer,n=await this.rollupProvider.getInitialWorldState(),r=Jn.InitHelpers.parseAccountTreeData(n.initialAccounts),i=await this.syncGenesisCommitments(r);e||await this.syncGenesisAliasesAndKeys(r,i),Yr(`genesis sync complete in ${t.s()}s`)}async startReceivingBlocks(){this.synchingPromise=(async()=>{for(Yr("starting sync task...");this.initState!==Xr.STOPPING;)this.serialQueue.push((()=>this.sync())),await this.interruptableSleep.sleep(1e4);Yr("stopped sync task.")})()}async reinitDataTree(){Yr("re-initialising data tree...");const e=await this.getLocalRollupContractAddress(),t=await this.getLocalVerifierContractAddress();await this.leveldb.clear(),await this.leveldb.put("rollupContractAddress",e.toBuffer()),t&&await this.leveldb.put("verifierContractAddress",t.toBuffer());const{rollupSize:n}=await this.getRemoteStatus(),r=Math.ceil(Math.log2(n*er.WorldStateConstants.NUM_NEW_DATA_TREE_NOTES_PER_TX));await this.worldState.init(r),await this.genesisSync(!0)}async sync(){const e=await this.getSyncedToRollup();let t=Math.min(e,...this.userStates.map((e=>e.getUserData().syncedToRollup)))+1;for(;;){const e=await this.rollupProvider.getBlocks(t);if(!e.length)break;const n=await this.getSyncedToRollup(),r=e.filter((e=>e.rollupId>n));if(r.length){const e=this.worldState.getRoot(),t=r.map((e=>m.RollupProofData.fromBuffer(e.rollupProofData))),i=r.map((e=>e.offchainTxData)),o=r.map((e=>e.subtreeRoot));await this.worldState.insertElements(t[0].dataStartIndex,o),await this.processAliases(t,i),await this.updateStatusRollupInfo(t[t.length-1]);const a=t[t.length-1].newDataRoot;if(!this.worldState.getRoot().equals(a)){await this.reinitDataTree(),this.rollupProvider.clientLog({message:"Invalid dataRoot.",synchingFromRollup:n,blocksReceived:r.length,oldRoot:e.toString("hex"),newRoot:this.worldState.getRoot().toString("hex"),newSize:this.worldState.getSize(),expectedDataRoot:a.toString("hex")});continue}}const i=e.map((e=>new ir(e,this.pedersen)));this.userStates.forEach((e=>e.processBlocks(i.filter((t=>t.block.rollupId>e.getUserData().syncedToRollup))))),t=e[e.length-1].rollupId+1}}async updateStatusRollupInfo(e){const t=e.rollupId,n=this.rollupProvider.getLatestRollupId();await this.leveldb.put("syncedToRollup",t.toString()),await this.leveldb.put("latestRollupId",n.toString()),this.sdkStatus.syncedToRollup=t,this.sdkStatus.latestRollupId=n,this.sdkStatus.dataRoot=this.worldState.getRoot(),this.sdkStatus.dataSize=this.worldState.getSize(),this.emit(Jr.UPDATED_WORLD_STATE,t,n)}async processAliases(e,t){const n=(e,t)=>{const n=[];let r=-1;for(let i=0;i<e.innerProofData.length;++i){const o=e.innerProofData[i];if(o.isPadding())continue;if(r++,o.proofId!==p.ProofId.ACCOUNT)continue;if(!!Hn.toBigIntBE(o.nullifier2)){const{accountPublicKey:a,aliasHash:s,spendingPublicKey1:u}=y.OffchainAccountData.fromBuffer(t[r]);this.noteAlgos.accountNoteCommitment(s,a,u).equals(o.noteCommitment1)&&n.push({accountPublicKey:a,aliasHash:s,index:e.dataStartIndex+2*i})}}return n},r=e.map(((e,r)=>n(e,t[r]))).flat();await this.db.addAliases(r)}}Wn=o("1T4rt");var ni=o("4ZiGb"),ri=(v=o("1vwiL"),{});Object.defineProperty(ri,"__esModule",{value:!0}),s(o("diP7t"),ri),s(o("5s4nN"),ri),s(o("7Kr0G"),ri);Ln=o("3KgUz"),Wn=o("1T4rt"),Wn=o("1T4rt"),v=o("1vwiL");var ii=T;const oi=({id:e,accountPublicKey:t,accountPrivateKey:n,...r})=>({...r,id:e.toString(),accountPublicKey:t.toString(),accountPrivateKey:n.toString("hex")}),ai=({id:e,accountPublicKey:t,accountPrivateKey:n,...r})=>({...r,id:Wn.GrumpkinAddress.fromString(e),accountPublicKey:Wn.GrumpkinAddress.fromString(t),accountPrivateKey:ii.from(n,"hex")});var si=T;class ui extends(n(Ln)){constructor(e){super(),this.backend=e;for(const e in Jr){const t=Jr[e];this.backend.on(t,((...e)=>{switch(t){case Jr.UPDATED_USER_STATE:{const[n]=e;this.emit(t,Wn.GrumpkinAddress.fromString(n));break}default:this.emit(t,...e)}}))}}async init(e){await this.backend.init(e)}async run(){await this.backend.run()}async destroy(){await this.backend.destroy()}async getLocalStatus(){return(e=>({...e,rollupContractAddress:Wn.EthAddress.fromString(e.rollupContractAddress),dataRoot:Zr.from(e.dataRoot,"hex")}))(await this.backend.getLocalStatus())}async getRemoteStatus(){const e=await this.backend.getRemoteStatus();return ri.rollupProviderStatusFromJson(e)}async isAccountRegistered(e){return this.backend.isAccountRegistered(e.toString())}async isRemoteAccountRegistered(e){return this.backend.isRemoteAccountRegistered(e.toString())}async isAliasRegistered(e){return this.backend.isAliasRegistered(e)}async isRemoteAliasRegistered(e){return this.backend.isRemoteAliasRegistered(e)}async accountExists(e,t){return this.backend.accountExists(e.toString(),t)}async remoteAccountExists(e,t){return this.backend.remoteAccountExists(e.toString(),t)}async getAccountPublicKey(e){const t=await this.backend.getAccountPublicKey(e);return t?Wn.GrumpkinAddress.fromString(t):void 0}async getRemoteUnsettledAccountPublicKey(e){const t=await this.backend.getRemoteUnsettledAccountPublicKey(e);return t?Wn.GrumpkinAddress.fromString(t):void 0}async getTxFees(e){return(await this.backend.getTxFees(e)).map((e=>e.map(ni.assetValueFromJson)))}async getDefiFees(e){return(await this.backend.getDefiFees(e.toString())).map(ni.assetValueFromJson)}async createDepositProof(e,t,n,r,i,o,a){const s=await this.backend.createDepositProof(e,t.toString(),n.toString(),r.toString(),i.toString(),o,a);return Br(s)}async createPaymentProofInput(e,t,n,r,i,o,a,s,u,c,l,f){const h=await this.backend.createPaymentProofInput(e.toString(),t,n.toString(),r.toString(),i.toString(),o.toString(),a.toString(),s?s.toString():void 0,u,c?c.toString():void 0,l.toString(),f);return Nr(h)}async createPaymentProof(e,t){const n=await this.backend.createPaymentProof(Pr(e),t);return Br(n)}async createAccountProofSigningData(e,t,n,r,i,o,a){const s=await this.backend.createAccountProofSigningData(e.toString(),t,n,r.toString(),i?i.toString():void 0,o?o.toString():void 0,a?a.toString():void 0);return si.from(s)}async createAccountProofInput(e,t,n,r,i,o,a){const s=await this.backend.createAccountProofInput(e.toString(),t,n,r.toString(),i?i.toString():void 0,o?o.toString():void 0,a?new Uint8Array(a):void 0);return Ir(s)}async createAccountProof(e,t){const n=await this.backend.createAccountProof(Rr(e),t);return Br(n)}async createDefiProofInput(e,t,n,r,i){const o=await this.backend.createDefiProofInput(e.toString(),t.toString(),n.toString(),r.map((e=>br(e))),i.toString());return Nr(o)}async createDefiProof(e,t){const n=await this.backend.createDefiProof(Pr(e),t);return Br(n)}async sendProofs(e){return(await this.backend.sendProofs(e.map(Cr))).map(g.TxId.fromString)}async awaitSynchronised(){await this.backend.awaitSynchronised()}async isUserSynching(e){return this.backend.isUserSynching(e.toString())}async awaitUserSynchronised(e){await this.backend.awaitUserSynchronised(e.toString())}async awaitSettlement(e,t){await this.backend.awaitSettlement(e.toString(),t)}async awaitDefiDepositCompletion(e,t){await this.backend.awaitDefiDepositCompletion(e.toString(),t)}async awaitDefiFinalisation(e,t){await this.backend.awaitDefiFinalisation(e.toString(),t)}async awaitDefiSettlement(e,t){await this.backend.awaitDefiSettlement(e.toString(),t)}async getDefiInteractionNonce(e){return this.backend.getDefiInteractionNonce(e.toString())}async userExists(e){return this.backend.userExists(e.toString())}async getUserData(e){const t=await this.backend.getUserData(e.toString());return ai(t)}async getUsersData(){return(await this.backend.getUsersData()).map(ai)}async derivePublicKey(e){const t=await this.backend.derivePublicKey(new Uint8Array(e));return Wn.GrumpkinAddress.fromString(t)}async constructSignature(e,t){const n=await this.backend.constructSignature(new Uint8Array(e),new Uint8Array(t));return v.SchnorrSignature.fromString(n)}async addUser(e,t){const n=await this.backend.addUser(new Uint8Array(e),t);return ai(n)}async removeUser(e){await this.backend.removeUser(e.toString())}async getSpendingKeys(e){return(await this.backend.getSpendingKeys(e.toString())).map((e=>si.from(e)))}async getBalances(e,t){return(await this.backend.getBalances(e.toString(),t)).map(ni.assetValueFromJson)}async getBalance(e,t,n){const r=await this.backend.getBalance(e.toString(),t,n);return BigInt(r)}async getSpendableSum(e,t,n,r){const i=await this.backend.getSpendableSum(e.toString(),t,n,r);return BigInt(i)}async getSpendableSums(e,t,n){return(await this.backend.getSpendableSums(e.toString(),t,n)).map(ni.assetValueFromJson)}async getMaxSpendableValue(e,t,n,r,i){const o=await this.backend.getMaxSpendableValue(e.toString(),t,n,r,i);return BigInt(o)}async pickNotes(e,t,n,r,i){return(await this.backend.pickNotes(e.toString(),t,n.toString(),r,i)).map(vr)}async pickNote(e,t,n,r,i){const o=await this.backend.pickNote(e.toString(),t,n.toString(),r,i);return o?vr(o):void 0}async getUserTxs(e){return(await this.backend.getUserTxs(e.toString())).map(dr)}async getRemoteUnsettledPaymentTxs(){return(await this.backend.getRemoteUnsettledPaymentTxs()).map(ri.joinSplitTxFromJson)}}Ln=o("3KgUz");class ci extends Ln.EventEmitter{constructor(e){super(),this.handler=e}async request(e,t=[]){return await this.handler({fn:e,args:t})}async init(e){await this.request("init",[e])}async run(){await this.request("run")}async destroy(){await this.request("destroy")}async getLocalStatus(){return this.request("getLocalStatus")}async getRemoteStatus(){return this.request("getRemoteStatus")}async isAccountRegistered(e){return this.request("isAccountRegistered",[e])}async isRemoteAccountRegistered(e){return this.request("isRemoteAccountRegistered",[e])}async isAliasRegistered(e){return this.request("isAliasRegistered",[e])}async isRemoteAliasRegistered(e){return this.request("isRemoteAliasRegistered",[e])}async accountExists(e,t){return this.request("accountExists",[e,t])}async remoteAccountExists(e,t){return this.request("remoteAccountExists",[e,t])}async getAccountPublicKey(e){return this.request("getAccountPublicKey",[e])}async getRemoteUnsettledAccountPublicKey(e){return this.request("getRemoteUnsettledAccountPublicKey",[e])}async getTxFees(e){return this.request("getTxFees",[e])}async getDefiFees(e){return this.request("getDefiFees",[e])}async createDepositProof(e,t,n,r,i,o,a){return this.request("createDepositProof",[e,t,n,r,i,o,a])}async createPaymentProofInput(e,t,n,r,i,o,a,s,u,c,l,f){return this.request("createPaymentProofInput",[e,t,n,r,i,o,a,s,u,c,l,f])}async createPaymentProof(e,t){return this.request("createPaymentProof",[e,t])}async createAccountProofSigningData(e,t,n,r,i,o,a){return this.request("createAccountProofSigningData",[e,t,n,r,i,o,a])}async createAccountProofInput(e,t,n,r,i,o,a){return this.request("createAccountProofInput",[e,t,n,r,i,o,a])}async createAccountProof(e,t){return this.request("createAccountProof",[e,t])}async createDefiProofInput(e,t,n,r,i){return this.request("createDefiProofInput",[e,t,n,r,i])}async createDefiProof(e,t){return this.request("createDefiProof",[e,t])}async sendProofs(e){return this.request("sendProofs",[e])}async awaitSynchronised(){return this.request("awaitSynchronised")}async isUserSynching(e){return this.request("isUserSynching",[e])}async awaitUserSynchronised(e){return this.request("awaitUserSynchronised",[e])}async awaitSettlement(e,t){return this.request("awaitSettlement",[e,t])}async awaitDefiDepositCompletion(e,t){return this.request("awaitDefiDepositCompletion",[e,t])}async awaitDefiFinalisation(e,t){return this.request("awaitDefiFinalisation",[e,t])}async awaitDefiSettlement(e,t){return this.request("awaitDefiSettlement",[e,t])}async getDefiInteractionNonce(e){return this.request("getDefiInteractionNonce",[e])}async userExists(e){return this.request("userExists",[e])}getUserData(e){return this.request("getUserData",[e])}getUsersData(){return this.request("getUsersData")}derivePublicKey(e){return this.request("derivePublicKey",[e])}async constructSignature(e,t){return this.request("constructSignature",[e,t])}async addUser(e,t){return this.request("addUser",[e,t])}async removeUser(e){return this.request("removeUser",[e])}async getSpendingKeys(e){return this.request("getSpendingKeys",[e])}getBalances(e,t){return this.request("getBalances",[e,t])}getBalance(e,t,n){return this.request("getBalance",[e,t,n])}async getSpendableSum(e,t,n,r){return this.request("getSpendableSum",[e,t,n,r])}async getSpendableSums(e,t,n){return this.request("getSpendableSums",[e,t,n])}async getMaxSpendableValue(e,t,n,r,i){return this.request("getMaxSpendableValue",[e,t,n,r,i])}async pickNotes(e,t,n,r,i){return this.request("pickNotes",[e,t,n,r,i])}async pickNote(e,t,n,r,i){return this.request("pickNote",[e,t,n,r,i])}async getUserTxs(e){return this.request("getUserTxs",[e])}async getRemoteUnsettledPaymentTxs(){return this.request("getRemoteUnsettledPaymentTxs")}}Wn=o("1T4rt"),ni=o("4ZiGb"),sr=o("jJK4a"),Ln=o("3KgUz");var li=T;class fi{constructor(e){this.core=e,this.eventDelegator=new Ln.EventEmitter;for(const e in Jr){const t=Jr[e];this.core.on(t,((...e)=>{switch(t){case Jr.UPDATED_USER_STATE:{const[n]=e;this.eventDelegator.emit(t,n.toString());break}default:this.eventDelegator.emit(t,...e)}}))}}async init(e){await this.core.init(e)}on(e,t){this.eventDelegator.on(e,t)}async run(){await this.core.run()}async destroy(){await this.core.destroy()}async getLocalStatus(){return(e=>({...e,rollupContractAddress:e.rollupContractAddress.toString(),dataRoot:e.dataRoot.toString("hex")}))(await this.core.getLocalStatus())}async getRemoteStatus(){const e=await this.core.getRemoteStatus();return ri.rollupProviderStatusToJson(e)}async isAccountRegistered(e){return this.core.isAccountRegistered(Wn.GrumpkinAddress.fromString(e))}async isRemoteAccountRegistered(e){return this.core.isRemoteAccountRegistered(Wn.GrumpkinAddress.fromString(e))}async isAliasRegistered(e){return this.core.isAliasRegistered(e)}async isRemoteAliasRegistered(e){return this.core.isRemoteAliasRegistered(e)}async accountExists(e,t){return this.core.accountExists(Wn.GrumpkinAddress.fromString(e),t)}async remoteAccountExists(e,t){return this.core.remoteAccountExists(Wn.GrumpkinAddress.fromString(e),t)}async getAccountPublicKey(e){return(await this.core.getAccountPublicKey(e))?.toString()}async getRemoteUnsettledAccountPublicKey(e){return(await this.core.getRemoteUnsettledAccountPublicKey(e))?.toString()}async getTxFees(e){return(await this.core.getTxFees(e)).map((e=>e.map(ni.assetValueToJson)))}async getDefiFees(e){return(await this.core.getDefiFees(sr.BridgeId.fromString(e))).map(ni.assetValueToJson)}async createDepositProof(e,t,n,r,i,o,a){const s=await this.core.createDepositProof(e,BigInt(t),BigInt(n),Wn.EthAddress.fromString(r),Wn.GrumpkinAddress.fromString(i),o,a);return Cr(s)}async createPaymentProofInput(e,t,n,r,i,o,a,s,u,c,l,f){const h=await this.core.createPaymentProofInput(Wn.GrumpkinAddress.fromString(e),t,BigInt(n),BigInt(r),BigInt(i),BigInt(o),BigInt(a),s?Wn.GrumpkinAddress.fromString(s):void 0,u,c?Wn.EthAddress.fromString(c):void 0,Wn.GrumpkinAddress.fromString(l),f);return Pr(h)}async createPaymentProof(e,t){const n=await this.core.createPaymentProof(Nr(e),t);return Cr(n)}async createAccountProofSigningData(e,t,n,r,i,o,a){const s=await this.core.createAccountProofSigningData(Wn.GrumpkinAddress.fromString(e),t,n,Wn.GrumpkinAddress.fromString(r),i?Wn.GrumpkinAddress.fromString(i):void 0,o?Wn.GrumpkinAddress.fromString(o):void 0,a?Wn.GrumpkinAddress.fromString(a):void 0);return new Uint8Array(s)}async createAccountProofInput(e,t,n,r,i,o,a){const s=await this.core.createAccountProofInput(Wn.GrumpkinAddress.fromString(e),t,n,Wn.GrumpkinAddress.fromString(r),i?Wn.GrumpkinAddress.fromString(i):void 0,o?Wn.GrumpkinAddress.fromString(o):void 0,a?li.from(a):void 0);return Rr(s)}async createAccountProof(e,t){const n=await this.core.createAccountProof(Ir(e),t);return Cr(n)}async createDefiProofInput(e,t,n,r,i){const o=await this.core.createDefiProofInput(Wn.GrumpkinAddress.fromString(e),sr.BridgeId.fromString(t),BigInt(n),r.map((e=>vr(e))),Wn.GrumpkinAddress.fromString(i));return Pr(o)}async createDefiProof(e,t){const n=await this.core.createDefiProof(Nr(e),t);return Cr(n)}async sendProofs(e){return(await this.core.sendProofs(e.map(Br))).map((e=>e.toString()))}async awaitSynchronised(){await this.core.awaitSynchronised()}async isUserSynching(e){return this.core.isUserSynching(Wn.GrumpkinAddress.fromString(e))}async awaitUserSynchronised(e){await this.core.awaitUserSynchronised(Wn.GrumpkinAddress.fromString(e))}async awaitSettlement(e,t){await this.core.awaitSettlement(g.TxId.fromString(e),t)}async awaitDefiDepositCompletion(e,t){await this.core.awaitDefiDepositCompletion(g.TxId.fromString(e),t)}async awaitDefiFinalisation(e,t){await this.core.awaitDefiFinalisation(g.TxId.fromString(e),t)}async awaitDefiSettlement(e,t){await this.core.awaitDefiSettlement(g.TxId.fromString(e),t)}async getDefiInteractionNonce(e){return this.core.getDefiInteractionNonce(g.TxId.fromString(e))}async userExists(e){return this.core.userExists(Wn.GrumpkinAddress.fromString(e))}async getUserData(e){const t=await this.core.getUserData(Wn.GrumpkinAddress.fromString(e));return oi(t)}async getUsersData(){return(await this.core.getUsersData()).map(oi)}async derivePublicKey(e){return(await this.core.derivePublicKey(li.from(e))).toString()}async constructSignature(e,t){return(await this.core.constructSignature(li.from(e),li.from(t))).toString()}async addUser(e,t){const n=await this.core.addUser(li.from(e),t);return oi(n)}async removeUser(e){await this.core.removeUser(Wn.GrumpkinAddress.fromString(e))}async getSpendingKeys(e){return(await this.core.getSpendingKeys(Wn.GrumpkinAddress.fromString(e))).map((e=>new Uint8Array(e)))}async getBalances(e,t){return(await this.core.getBalances(Wn.GrumpkinAddress.fromString(e),t)).map(ni.assetValueToJson)}async getBalance(e,t,n){return(await this.core.getBalance(Wn.GrumpkinAddress.fromString(e),t,n)).toString()}async getSpendableSum(e,t,n,r){return(await this.core.getSpendableSum(Wn.GrumpkinAddress.fromString(e),t,n,r)).toString()}async getSpendableSums(e,t,n){return(await this.core.getSpendableSums(Wn.GrumpkinAddress.fromString(e),t,n)).map(ni.assetValueToJson)}async getMaxSpendableValue(e,t,n,r,i){return(await this.core.getMaxSpendableValue(Wn.GrumpkinAddress.fromString(e),t,n,r,i)).toString()}async pickNotes(e,t,n,r,i){return(await this.core.pickNotes(Wn.GrumpkinAddress.fromString(e),t,BigInt(n),r,i)).map(br)}async pickNote(e,t,n,r,i){const o=await this.core.pickNote(Wn.GrumpkinAddress.fromString(e),t,BigInt(n),r,i);return o?br(o):void 0}async getUserTxs(e){return(await this.core.getUserTxs(Wn.GrumpkinAddress.fromString(e))).map(hr)}async getRemoteUnsettledPaymentTxs(){return(await this.core.getRemoteUnsettledPaymentTxs()).map(ri.joinSplitTxToJson)}}var hi,di=o("iThRa"),pi=(Ln=o("3KgUz")).EventEmitter,mi=o("dyk5A").inherits,yi={},gi=tn,bi=o("j1UVA"),vi={},wi=nn;function _i(e,t){wi.call(this,e),this._options=t,this._iterator=null,this._operations=[]}(bi=o("j1UVA"))(_i,wi),_i.prototype.setDb=function(e){var t=this._iterator=e.iterator(this._options);this._operations.forEach((function(e){t[e.method].apply(t,e.args)}))},_i.prototype._operation=function(e,t){if(this._iterator)return this._iterator[e].apply(this._iterator,t);this._operations.push({method:e,args:t})},"next end".split(" ").forEach((function(e){_i.prototype["_"+e]=function(){this._operation(e,arguments)}})),_i.prototype.seek=function(){this._operation("seek",arguments)},vi=_i;var Ei="put get del batch clear".split(" "),Si="approximateSize compactRange".split(" ");function xi(e){gi.call(this,e.supports||{}),Si.forEach((function(t){"function"!=typeof e[t]||this.supports.additionalMethods[t]||(this.supports.additionalMethods[t]=!0)}),this),this._db=e,this._operations=[],Ti(this)}function Ti(e){Ei.forEach((function(t){e["_"+t]=function(){this._operations.push({method:t,args:arguments})}})),Object.keys(e.supports.additionalMethods).forEach((function(t){e[t]=function(){this._operations.push({method:t,args:arguments})}})),e._iterator=function(t){var n=new vi(e,t);return this._operations.push({iterator:n}),n}}bi(xi,gi),xi.prototype.type="deferred-leveldown",xi.prototype._open=function(e,t){var n=this;this._db.open(e,(function(e){if(e)return t(e);n._operations.forEach((function(e){e.iterator?e.iterator.setDb(n._db):n._db[e.method].apply(n._db,e.args)})),n._operations=[],function(e){Ei.concat("iterator").forEach((function(t){e["_"+t]=function(){return this._db[t].apply(this._db,arguments)}})),Object.keys(e.supports.additionalMethods).forEach((function(t){e[t]=function(){return this._db[t].apply(this._db,arguments)}}))}(n),t()}))},xi.prototype._close=function(e){var t=this;this._db.close((function(n){if(n)return e(n);Ti(t),e()}))},xi.prototype._serializeKey=function(e){return e},xi.prototype._serializeValue=function(e){return e},(yi=xi).DeferredIterator=vi;var Mi={},Ai=(bi=o("j1UVA"),o("kU4py").Readable);function Ri(e,t){if(!(this instanceof Ri))return new Ri(e,t);t=t||{},Ai.call(this,S(t,{objectMode:!0})),this._iterator=e,this._options=t,this.on("end",this.destroy.bind(this,null,null))}Mi=Ri,bi(Ri,Ai),Ri.prototype._read=function(){var e=this,t=this._options;this.destroyed||this._iterator.next((function(n,r,i){if(!e.destroyed)return n?e.destroy(n):void(void 0===r&&void 0===i?e.push(null):!1!==t.keys&&!1===t.values?e.push(r):!1===t.keys&&!1!==t.values?e.push(i):e.push({key:r,value:i}))}))},Ri.prototype._destroy=function(e,t){this._iterator.end((function(n){t(e||n)}))};var Ii,Pi={},Ni={},Oi=Ni.all=[{errno:-2,code:"ENOENT",description:"no such file or directory"},{errno:-1,code:"UNKNOWN",description:"unknown error"},{errno:0,code:"OK",description:"success"},{errno:1,code:"EOF",description:"end of file"},{errno:2,code:"EADDRINFO",description:"getaddrinfo error"},{errno:3,code:"EACCES",description:"permission denied"},{errno:4,code:"EAGAIN",description:"resource temporarily unavailable"},{errno:5,code:"EADDRINUSE",description:"address already in use"},{errno:6,code:"EADDRNOTAVAIL",description:"address not available"},{errno:7,code:"EAFNOSUPPORT",description:"address family not supported"},{errno:8,code:"EALREADY",description:"connection already in progress"},{errno:9,code:"EBADF",description:"bad file descriptor"},{errno:10,code:"EBUSY",description:"resource busy or locked"},{errno:11,code:"ECONNABORTED",description:"software caused connection abort"},{errno:12,code:"ECONNREFUSED",description:"connection refused"},{errno:13,code:"ECONNRESET",description:"connection reset by peer"},{errno:14,code:"EDESTADDRREQ",description:"destination address required"},{errno:15,code:"EFAULT",description:"bad address in system call argument"},{errno:16,code:"EHOSTUNREACH",description:"host is unreachable"},{errno:17,code:"EINTR",description:"interrupted system call"},{errno:18,code:"EINVAL",description:"invalid argument"},{errno:19,code:"EISCONN",description:"socket is already connected"},{errno:20,code:"EMFILE",description:"too many open files"},{errno:21,code:"EMSGSIZE",description:"message too long"},{errno:22,code:"ENETDOWN",description:"network is down"},{errno:23,code:"ENETUNREACH",description:"network is unreachable"},{errno:24,code:"ENFILE",description:"file table overflow"},{errno:25,code:"ENOBUFS",description:"no buffer space available"},{errno:26,code:"ENOMEM",description:"not enough memory"},{errno:27,code:"ENOTDIR",description:"not a directory"},{errno:28,code:"EISDIR",description:"illegal operation on a directory"},{errno:29,code:"ENONET",description:"machine is not on the network"},{errno:31,code:"ENOTCONN",description:"socket is not connected"},{errno:32,code:"ENOTSOCK",description:"socket operation on non-socket"},{errno:33,code:"ENOTSUP",description:"operation not supported on socket"},{errno:34,code:"ENOENT",description:"no such file or directory"},{errno:35,code:"ENOSYS",description:"function not implemented"},{errno:36,code:"EPIPE",description:"broken pipe"},{errno:37,code:"EPROTO",description:"protocol error"},{errno:38,code:"EPROTONOSUPPORT",description:"protocol not supported"},{errno:39,code:"EPROTOTYPE",description:"protocol wrong type for socket"},{errno:40,code:"ETIMEDOUT",description:"connection timed out"},{errno:41,code:"ECHARSET",description:"invalid Unicode character"},{errno:42,code:"EAIFAMNOSUPPORT",description:"address family for hostname not supported"},{errno:44,code:"EAISERVICE",description:"servname not supported for ai_socktype"},{errno:45,code:"EAISOCKTYPE",description:"ai_socktype not supported"},{errno:46,code:"ESHUTDOWN",description:"cannot send after transport endpoint shutdown"},{errno:47,code:"EEXIST",description:"file already exists"},{errno:48,code:"ESRCH",description:"no such process"},{errno:49,code:"ENAMETOOLONG",description:"name too long"},{errno:50,code:"EPERM",description:"operation not permitted"},{errno:51,code:"ELOOP",description:"too many symbolic links encountered"},{errno:52,code:"EXDEV",description:"cross-device link not permitted"},{errno:53,code:"ENOTEMPTY",description:"directory not empty"},{errno:54,code:"ENOSPC",description:"no space left on device"},{errno:55,code:"EIO",description:"i/o error"},{errno:56,code:"EROFS",description:"read-only file system"},{errno:57,code:"ENODEV",description:"no such device"},{errno:58,code:"ESPIPE",description:"invalid seek"},{errno:59,code:"ECANCELED",description:"operation canceled"}];Ni.errno={},Ni.code={},Oi.forEach((function(e){Ni.errno[e.errno]=e,Ni.code[e.code]=e})),Ni.custom=o("1v3TW")(Ni),Ni.create=Ni.custom.createError;var Ci=Ni.create,ki=Ci("LevelUPError"),Bi=Ci("NotFoundError",ki);Bi.prototype.notFound=!0,Bi.prototype.status=404;var Di,ji,Li=(Ii={LevelUPError:ki,InitializationError:Ci("InitializationError",ki),OpenError:Ci("OpenError",ki),ReadError:Ci("ReadError",ki),WriteError:Ci("WriteError",ki),NotFoundError:Bi,EncodingError:Ci("EncodingError",ki)}).WriteError,qi={};qi=function(){var e,t=new Promise((function(t,n){e=function(e,r){e?n(e):t(r)}}));return e.promise=t,e};var Ui=Di=function(e,t){return"function"==typeof e?e:t},Fi=ji=function(e){return"object"==typeof e&&null!==e?e:{}};function Ki(e){this.db=this._levelup=e,this.batch=e.db.batch(),this.ops=[],this.length=0}Ki.prototype.put=function(e,t){try{this.batch.put(e,t)}catch(e){throw new Li(e)}return this.ops.push({type:"put",key:e,value:t}),this.length++,this},Ki.prototype.del=function(e){try{this.batch.del(e)}catch(e){throw new Li(e)}return this.ops.push({type:"del",key:e}),this.length++,this},Ki.prototype.clear=function(){try{this.batch.clear()}catch(e){throw new Li(e)}return this.ops=[],this.length=0,this},Ki.prototype.write=function(e,t){var n,r=this._levelup,i=this.ops;(t=Ui(e,t))||(n=(t=qi()).promise),e=Fi(e);try{this.batch.write(e,(function(e){if(e)return t(new Li(e));r.emit("batch",i),t()}))}catch(e){throw new Li(e)}return n},Pi=Ki;var Vi=o("gZ5lU"),zi=o("2pKBN"),Wi=Di,Hi=ji,Gi=Ii.WriteError,Qi=Ii.ReadError,Ji=Ii.NotFoundError,Zi=Ii.OpenError,$i=Ii.InitializationError;function Yi(e,t,n){if(!(this instanceof Yi))return new Yi(e,t,n);var r,i=this;if(pi.call(this),this.setMaxListeners(1/0),"function"==typeof t&&(n=t,t={}),t=t||{},!e||"object"!=typeof e){if(r=new $i("First argument must be an abstract-leveldown compliant store"),"function"==typeof n)return di.nextTick(n,r);throw r}zi.strictEqual(typeof e.status,"string",".status required, old abstract-leveldown"),this.options=Hi(t),this._db=e,this.db=new yi(e),this.open(n||function(e){e&&i.emit("error",e)}),this.supports=Vi(this.db.supports,{status:!1,deferredOpen:!0,openCallback:!0,promises:!0,streams:!0}),Object.keys(this.supports.additionalMethods).forEach((function(e){null==this[e]&&(this[e]=function(){return this.db[e].apply(this.db,arguments)})}),this)}function Xi(e,t){if(!e._isOpening()&&!e.isOpen())return di.nextTick(t,new Qi("Database is not open")),!0}Yi.prototype.emit=pi.prototype.emit,Yi.prototype.once=pi.prototype.once,mi(Yi,pi),Yi.prototype.open=function(e,t){var n,r=this;return"function"==typeof e&&(t=e,e=null),t||(n=(t=qi()).promise),e||(e=this.options),this.isOpen()?(di.nextTick(t,null,r),n):this._isOpening()?(this.once("open",(function(){t(null,r)})),n):(this.emit("opening"),this.db.open(e,(function(e){if(e)return t(new Zi(e));r.db=r._db,t(null,r),r.emit("open"),r.emit("ready")})),n)},Yi.prototype.close=function(e){var t,n=this;return e||(t=(e=qi()).promise),this.isOpen()?(this.db.close((function(){n.emit("closed"),e.apply(null,arguments)})),this.emit("closing"),this.db=new yi(this._db)):this.isClosed()?di.nextTick(e):"closing"===this.db.status?this.once("closed",e):this._isOpening()&&this.once("open",(function(){n.close(e)})),t},Yi.prototype.isOpen=function(){return"open"===this.db.status},Yi.prototype._isOpening=function(){return"opening"===this.db.status},Yi.prototype.isClosed=function(){return/^clos|new/.test(this.db.status)},Yi.prototype.get=function(e,t,n){var r;return(n=Wi(t,n))||(r=(n=qi()).promise),Xi(this,n)||(t=Hi(t),this.db.get(e,t,(function(t,r){if(t)return t=/notfound/i.test(t)||t.notFound?new Ji("Key not found in database ["+e+"]",t):new Qi(t),n(t);n(null,r)}))),r},Yi.prototype.put=function(e,t,n,r){var i,o=this;return(r=Wi(n,r))||(i=(r=qi()).promise),Xi(this,r)||(n=Hi(n),this.db.put(e,t,n,(function(n){if(n)return r(new Gi(n));o.emit("put",e,t),r()}))),i},Yi.prototype.del=function(e,t,n){var r,i=this;return(n=Wi(t,n))||(r=(n=qi()).promise),Xi(this,n)||(t=Hi(t),this.db.del(e,t,(function(t){if(t)return n(new Gi(t));i.emit("del",e),n()}))),r},Yi.prototype.batch=function(e,t,n){if(!arguments.length)return new Pi(this);var r,i=this;return(n="function"==typeof e?e:Wi(t,n))||(r=(n=qi()).promise),Xi(this,n)||(t=Hi(t),this.db.batch(e,t,(function(t){if(t)return n(new Gi(t));i.emit("batch",e),n()}))),r},Yi.prototype.iterator=function(e){return this.db.iterator(e)},Yi.prototype.clear=function(e,t){var n,r=this;return t=Wi(e,t),e=Hi(e),t||(n=(t=qi()).promise),Xi(this,t)||this.db.clear(e,(function(n){if(n)return t(new Gi(n));r.emit("clear",e),t()})),n},Yi.prototype.readStream=Yi.prototype.createReadStream=function(e){return"number"!=typeof(e=S({keys:!0,values:!0},e)).limit&&(e.limit=-1),new Mi(this.db.iterator(e),e)},Yi.prototype.keyStream=Yi.prototype.createKeyStream=function(e){return this.createReadStream(S(e,{keys:!0,values:!1}))},Yi.prototype.valueStream=Yi.prototype.createValueStream=function(e){return this.createReadStream(S(e,{keys:!1,values:!0}))},Yi.prototype.toString=function(){return"LevelUP"},Yi.prototype.type="levelup",Yi.errors=Ii,hi=Yi.default=Yi;v=o("1vwiL");var eo={};Object.defineProperty(eo,"__esModule",{value:!0}),s(o("iiY8F"),eo),s(o("gSoBg"),eo),s(o("k2qnY"),eo);var to={};Object.defineProperty(to,"__esModule",{value:!0}),s(o("jsQJq"),to),s(o("4aqig"),to),s(o("e5vRy"),to);var no={},ro=o("150uq").Buffer;Object.defineProperty(no,"__esModule",{value:!0}),no.fetchCode=void 0;var io=o("kOtop");const oo=l(o("2vGx5"));var ao=o("7IjzK"),so=o("cC4OV");s(o("1U2aA"),no),s(o("eaYik"),no),s(o("g389p"),no),so.EventEmitter.defaultMaxListeners=30,no.fetchCode=async function(){if(oo.default)return await(0,ao.promisify)(io.readFile)("../barretenberg.js/dest/wasm/barretenberg.wasm");{const e=await fetch("/barretenberg.wasm");return ro.from(await e.arrayBuffer())}};function uo(){const e=n(false)?n(jn).cpus().length:navigator.hardwareConcurrency||2;return t=Math.min(e,8),Math.pow(2,Math.floor(Math.log(t)/Math.log(2)));var t}Ln=o("3KgUz");var co;!function(e){e.PEDERSEN="PEDERSEN",e.PIPPENGER="PIPPENGER",e.FFT="FFT"}(co||(co={}));class lo{constructor(e){this.fftInstance=e}async fft(e,t){return this.fftInstance.fft(e,t)}async ifft(e){return this.fftInstance.ifft(e)}}class fo{constructor(e){this.fftFactory=e,this.ffts={}}async createFft(e){if(!this.ffts[e]){const t=await this.fftFactory.createFft(e);this.ffts[e]=new lo(t)}return this.ffts[e]}async getFft(e){return this.createFft(e)}}v=o("1vwiL");var ho=T;v.SinglePedersen;class po{constructor(e){this.pedersen=e}async hashToTree(e){return(await this.pedersen.hashToTree(e.map((e=>ho.from(e))))).map((e=>new Uint8Array(e)))}}class mo{constructor(e){this.pippenger=e}async init(e){await this.pippenger.init(e)}async pippengerUnsafe(e,t,n){const r=await this.pippenger.pippengerUnsafe(e,t,n);return new Uint8Array(r)}}const yo=h.createLogger("aztec:sdk:job_queue_worker");class go{constructor(e,t,n,r){this.jobQueue=e,this.notifyNewJob=async()=>{this.newJobPromise||(this.newJobPromise=this.fetchAndProcess(),await this.newJobPromise,this.newJobPromise=void 0)},this.pedersen=new po(t),this.pippenger=new mo(n),this.fftFactory=new fo(r)}async init(e){await this.pippenger.init(e)}start(){this.jobQueue.on("new_job",this.notifyNewJob)}async stop(){this.jobQueue.off("new_job",this.notifyNewJob),await this.newJobPromise}async fetchAndProcess(){document.hidden&&await new Promise((e=>setTimeout(e,500)));try{const e=await this.jobQueue.getJob();e&&(this.pingTimeout=setTimeout((()=>this.ping(e.id)),1e3),await this.processJob(e))}catch(e){yo(e)}finally{clearTimeout(this.pingTimeout)}}async ping(e){try{await this.jobQueue.ping(e)===e&&(this.pingTimeout=setTimeout((()=>this.ping(e)),1e3))}catch(e){yo(e)}}async processJob(e){let t,n="";try{t=await this.process(e)}catch(e){yo(e),n=e.message}try{await this.jobQueue.completeJob(e.id,t,n)}catch(e){yo(e)}}async process({target:e,query:t,args:n}){switch(e){case co.PEDERSEN:return this.pedersen[t](...n);case co.PIPPENGER:return this.pippenger[t](...n);case co.FFT:{const[e,...r]=n;return(await this.fftFactory.getFft(e))[t](...r)}}}}Ln=o("3KgUz");class bo extends Ln.EventEmitter{constructor(e){super(),this.handler=e}async getJob(){return await this.handler({fn:"getJob",args:[]})}async ping(e){return await this.handler({fn:"ping",args:[e]})}async completeJob(e,t,n){return await this.handler({fn:"completeJob",args:[e,t,n]})}}const vo=h.createLogger("bb:banana_core_sdk");class wo extends ci{constructor(e,t,n){super(e),this.jobQueueWorker=t,this.workerPool=n}async destroy(){vo("Destroying banana core sdk..."),await(this.jobQueueWorker?.stop()),await this.workerPool.destroy(),this.emit(Jr.DESTROYED),vo("Banana core sdk destroyed.")}}var _o=T;const Eo=h.createLogger("aztec:sdk:shared_worker_frontend");class So{constructor(e){this.transportClient=e,this.jobQueueDispatch=Kn(this,"jobQueue",Eo),this.coreSdkDispatch=Kn(this,"coreSdk",Eo)}async initComponents(e){this.jobQueue=new bo((e=>(Eo(`job queue dispatch request: ${e.fn}(${e.args})`),this.transportClient.request({fn:"jobQueueDispatch",args:[e]}))));const{numWorkers:t=uo()}=e,n=await no.BarretenbergWasm.new(),r=await no.WorkerPool.new(n,t),i=new v.PooledPedersen(n,r),o=new to.PooledPippenger(r),a=new eo.PooledFftFactory(r),s=new go(this.jobQueue,i,o,a),u=await this.getCrsData();return await s.init(u),Eo("starting job queue worker..."),s.start(),this.transportClient.on("event_msg",(({fn:e,args:t})=>this[e](...t))),await this.transportClient.request({fn:"initComponents",args:[e]}),this.coreSdk=new wo((e=>(Eo(`core sdk dispatch request: ${e.fn}(${e.args})`),this.transportClient.request({fn:"coreSdkDispatch",args:[e]}))),s,r),this.coreSdk.on(Jr.DESTROYED,(()=>this.transportClient.close())),{coreSdk:new ui(this.coreSdk)}}async getCrsData(){Eo("downloading crs data (circuit size: 65536)...");const e=new Gn.Crs(65536);return await e.download(),Eo("done."),_o.from(e.getData())}}class xo{constructor(e){this.sharedWorker=e}async createSocket(){return new Fn(this.sharedWorker.port)}}const To=h.createLogger("bb:create_banana_core_sdk");async function Mo(e){To("creating shared worker frontend...");const t=await async function(){if(void 0===window.SharedWorker)throw new Error("SharedWorker is not supported.");return new SharedWorker("./shared_worker.js",{name:"Aztec core sdk",credentials:"same-origin"})}(),n=new xo(t),r=new Vn(n);await r.open();const i=new So(r),{coreSdk:o}=await i.initComponents(e);return o}var Ao;v=o("1vwiL"),io=o("kOtop"),di=o("iThRa");!function(e){!function(n){var r="object"==typeof t?t:"object"==typeof self?self:"object"==typeof this?this:Function("return this;")(),i=o(e);function o(e,t){return function(n,r){"function"!=typeof e[n]&&Object.defineProperty(e,n,{configurable:!0,writable:!0,value:r}),t&&t(n,r)}}void 0===r.Reflect?r.Reflect=e:i=o(r.Reflect,i),function(e){var t=Object.prototype.hasOwnProperty,n="function"==typeof Symbol,r=n&&void 0!==Symbol.toPrimitive?Symbol.toPrimitive:"@@toPrimitive",i=n&&void 0!==Symbol.iterator?Symbol.iterator:"@@iterator",o="function"==typeof Object.create,a={__proto__:[]}instanceof Array,s=!o&&!a,u={create:o?function(){return re(Object.create(null))}:a?function(){return re({__proto__:null})}:function(){return re({})},has:s?function(e,n){return t.call(e,n)}:function(e,t){return t in e},get:s?function(e,n){return t.call(e,n)?e[n]:void 0}:function(e,t){return e[t]}},c=Object.getPrototypeOf(Function),l="object"==typeof di&&di.env&&!1,f=l||"function"!=typeof Map||"function"!=typeof Map.prototype.entries?ee():Map,h=l||"function"!=typeof Set||"function"!=typeof Set.prototype.entries?te():Set,d=new(l||"function"!=typeof WeakMap?ne():WeakMap);function p(e,t,n,r){if(B(n)){if(!z(e))throw new TypeError;if(!H(t))throw new TypeError;return x(e,t)}if(!z(e))throw new TypeError;if(!L(t))throw new TypeError;if(!L(r)&&!B(r)&&!D(r))throw new TypeError;return D(r)&&(r=void 0),T(e,t,n=V(n),r)}function m(e,t){function n(n,r){if(!L(n))throw new TypeError;if(!B(r)&&!G(r))throw new TypeError;N(e,t,n,r)}return n}function y(e,t,n,r){if(!L(n))throw new TypeError;return B(r)||(r=V(r)),N(e,t,n,r)}function g(e,t,n){if(!L(t))throw new TypeError;return B(n)||(n=V(n)),A(e,t,n)}function b(e,t,n){if(!L(t))throw new TypeError;return B(n)||(n=V(n)),R(e,t,n)}function v(e,t,n){if(!L(t))throw new TypeError;return B(n)||(n=V(n)),I(e,t,n)}function w(e,t,n){if(!L(t))throw new TypeError;return B(n)||(n=V(n)),P(e,t,n)}function _(e,t){if(!L(e))throw new TypeError;return B(t)||(t=V(t)),O(e,t)}function E(e,t){if(!L(e))throw new TypeError;return B(t)||(t=V(t)),C(e,t)}function S(e,t,n){if(!L(t))throw new TypeError;B(n)||(n=V(n));var r=M(t,n,!1);if(B(r))return!1;if(!r.delete(e))return!1;if(r.size>0)return!0;var i=d.get(t);return i.delete(n),i.size>0||d.delete(t),!0}function x(e,t){for(var n=e.length-1;n>=0;--n){var r=(0,e[n])(t);if(!B(r)&&!D(r)){if(!H(r))throw new TypeError;t=r}}return t}function T(e,t,n,r){for(var i=e.length-1;i>=0;--i){var o=(0,e[i])(t,n,r);if(!B(o)&&!D(o)){if(!L(o))throw new TypeError;r=o}}return r}function M(e,t,n){var r=d.get(e);if(B(r)){if(!n)return;r=new f,d.set(e,r)}var i=r.get(t);if(B(i)){if(!n)return;i=new f,r.set(t,i)}return i}function A(e,t,n){if(R(e,t,n))return!0;var r=X(t);return!D(r)&&A(e,r,n)}function R(e,t,n){var r=M(t,n,!1);return!B(r)&&F(r.has(e))}function I(e,t,n){if(R(e,t,n))return P(e,t,n);var r=X(t);return D(r)?void 0:I(e,r,n)}function P(e,t,n){var r=M(t,n,!1);if(!B(r))return r.get(e)}function N(e,t,n,r){M(n,r,!0).set(e,t)}function O(e,t){var n=C(e,t),r=X(e);if(null===r)return n;var i=O(r,t);if(i.length<=0)return n;if(n.length<=0)return i;for(var o=new h,a=[],s=0,u=n;s<u.length;s++){var c=u[s];o.has(c)||(o.add(c),a.push(c))}for(var l=0,f=i;l<f.length;l++){c=f[l];o.has(c)||(o.add(c),a.push(c))}return a}function C(e,t){var n=[],r=M(e,t,!1);if(B(r))return n;for(var i=J(r.keys()),o=0;;){var a=$(i);if(!a)return n.length=o,n;var s=Z(a);try{n[o]=s}catch(e){try{Y(i)}finally{throw e}}o++}}function k(e){if(null===e)return 1;switch(typeof e){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return null===e?1:6;default:return 6}}function B(e){return void 0===e}function D(e){return null===e}function j(e){return"symbol"==typeof e}function L(e){return"object"==typeof e?null!==e:"function"==typeof e}function q(e,t){switch(k(e)){case 0:case 1:case 2:case 3:case 4:case 5:return e}var n=3===t?"string":5===t?"number":"default",i=Q(e,r);if(void 0!==i){var o=i.call(e,n);if(L(o))throw new TypeError;return o}return U(e,"default"===n?"number":n)}function U(e,t){if("string"===t){var n=e.toString;if(W(n))if(!L(i=n.call(e)))return i;if(W(r=e.valueOf))if(!L(i=r.call(e)))return i}else{var r;if(W(r=e.valueOf))if(!L(i=r.call(e)))return i;var i,o=e.toString;if(W(o))if(!L(i=o.call(e)))return i}throw new TypeError}function F(e){return!!e}function K(e){return""+e}function V(e){var t=q(e,3);return j(t)?t:K(t)}function z(e){return Array.isArray?Array.isArray(e):e instanceof Object?e instanceof Array:"[object Array]"===Object.prototype.toString.call(e)}function W(e){return"function"==typeof e}function H(e){return"function"==typeof e}function G(e){switch(k(e)){case 3:case 4:return!0;default:return!1}}function Q(e,t){var n=e[t];if(null!=n){if(!W(n))throw new TypeError;return n}}function J(e){var t=Q(e,i);if(!W(t))throw new TypeError;var n=t.call(e);if(!L(n))throw new TypeError;return n}function Z(e){return e.value}function $(e){var t=e.next();return!t.done&&t}function Y(e){var t=e.return;t&&t.call(e)}function X(e){var t=Object.getPrototypeOf(e);if("function"!=typeof e||e===c)return t;if(t!==c)return t;var n=e.prototype,r=n&&Object.getPrototypeOf(n);if(null==r||r===Object.prototype)return t;var i=r.constructor;return"function"!=typeof i||i===e?t:i}function ee(){var e={},t=[],n=function(){function e(e,t,n){this._index=0,this._keys=e,this._values=t,this._selector=n}return e.prototype["@@iterator"]=function(){return this},e.prototype[i]=function(){return this},e.prototype.next=function(){var e=this._index;if(e>=0&&e<this._keys.length){var n=this._selector(this._keys[e],this._values[e]);return e+1>=this._keys.length?(this._index=-1,this._keys=t,this._values=t):this._index++,{value:n,done:!1}}return{value:void 0,done:!0}},e.prototype.throw=function(e){throw this._index>=0&&(this._index=-1,this._keys=t,this._values=t),e},e.prototype.return=function(e){return this._index>=0&&(this._index=-1,this._keys=t,this._values=t),{value:e,done:!0}},e}();function r(e,t){return e}function o(e,t){return t}function a(e,t){return[e,t]}return function(){function t(){this._keys=[],this._values=[],this._cacheKey=e,this._cacheIndex=-2}return Object.defineProperty(t.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),t.prototype.has=function(e){return this._find(e,!1)>=0},t.prototype.get=function(e){var t=this._find(e,!1);return t>=0?this._values[t]:void 0},t.prototype.set=function(e,t){var n=this._find(e,!0);return this._values[n]=t,this},t.prototype.delete=function(t){var n=this._find(t,!1);if(n>=0){for(var r=this._keys.length,i=n+1;i<r;i++)this._keys[i-1]=this._keys[i],this._values[i-1]=this._values[i];return this._keys.length--,this._values.length--,t===this._cacheKey&&(this._cacheKey=e,this._cacheIndex=-2),!0}return!1},t.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=e,this._cacheIndex=-2},t.prototype.keys=function(){return new n(this._keys,this._values,r)},t.prototype.values=function(){return new n(this._keys,this._values,o)},t.prototype.entries=function(){return new n(this._keys,this._values,a)},t.prototype["@@iterator"]=function(){return this.entries()},t.prototype[i]=function(){return this.entries()},t.prototype._find=function(e,t){return this._cacheKey!==e&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=e)),this._cacheIndex<0&&t&&(this._cacheIndex=this._keys.length,this._keys.push(e),this._values.push(void 0)),this._cacheIndex},t}()}function te(){return function(){function e(){this._map=new f}return Object.defineProperty(e.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),e.prototype.has=function(e){return this._map.has(e)},e.prototype.add=function(e){return this._map.set(e,e),this},e.prototype.delete=function(e){return this._map.delete(e)},e.prototype.clear=function(){this._map.clear()},e.prototype.keys=function(){return this._map.keys()},e.prototype.values=function(){return this._map.values()},e.prototype.entries=function(){return this._map.entries()},e.prototype["@@iterator"]=function(){return this.keys()},e.prototype[i]=function(){return this.keys()},e}()}function ne(){var e=16,n=u.create(),r=i();function i(){var e;do{e="@@WeakMap@@"+c()}while(u.has(n,e));return n[e]=!0,e}function o(e,n){if(!t.call(e,r)){if(!n)return;Object.defineProperty(e,r,{value:u.create()})}return e[r]}function a(e,t){for(var n=0;n<t;++n)e[n]=255*Math.random()|0;return e}function s(e){return"function"==typeof Uint8Array?"undefined"!=typeof crypto?crypto.getRandomValues(new Uint8Array(e)):"undefined"!=typeof msCrypto?msCrypto.getRandomValues(new Uint8Array(e)):a(new Uint8Array(e),e):a(new Array(e),e)}function c(){var t=s(e);t[6]=79&t[6]|64,t[8]=191&t[8]|128;for(var n="",r=0;r<e;++r){var i=t[r];4!==r&&6!==r&&8!==r||(n+="-"),i<16&&(n+="0"),n+=i.toString(16).toLowerCase()}return n}return function(){function e(){this._key=i()}return e.prototype.has=function(e){var t=o(e,!1);return void 0!==t&&u.has(t,this._key)},e.prototype.get=function(e){var t=o(e,!1);return void 0!==t?u.get(t,this._key):void 0},e.prototype.set=function(e,t){return o(e,!0)[this._key]=t,this},e.prototype.delete=function(e){var t=o(e,!1);return void 0!==t&&delete t[this._key]},e.prototype.clear=function(){this._key=i()},e}()}function re(e){return e.__=void 0,delete e.__,e}e("decorate",p),e("metadata",m),e("defineMetadata",y),e("hasMetadata",g),e("hasOwnMetadata",b),e("getMetadata",v),e("getOwnMetadata",w),e("getMetadataKeys",_),e("getOwnMetadataKeys",E),e("deleteMetadata",S)}(i)}()}(Ao||(Ao={}));var Ro=function(){function e(){}return e.getInheritanceTree=function(e){var t=[e],n=function(e){var r=Object.getPrototypeOf(e);r&&r.name&&(t.push(r),n(r))};return n(e),t},e.isInherited=function(e,t){return e.prototype instanceof t},e.filterByTarget=function(e,t){return t?e.filter((function(e){return e.target&&-1!==t.indexOf(e.target)})):e},e}(),Io=function(){function e(){this.tables=[],this.trees=[],this.entityRepositories=[],this.transactionEntityManagers=[],this.transactionRepositories=[],this.namingStrategies=[],this.entitySubscribers=[],this.indices=[],this.uniques=[],this.checks=[],this.exclusions=[],this.columns=[],this.generations=[],this.relations=[],this.joinColumns=[],this.joinTables=[],this.entityListeners=[],this.relationCounts=[],this.relationIds=[],this.embeddeds=[],this.inheritances=[],this.discriminatorValues=[]}return e.prototype.filterTables=function(e){return this.filterByTarget(this.tables,e)},e.prototype.filterColumns=function(e){return this.filterByTargetAndWithoutDuplicateProperties(this.columns,e)},e.prototype.findGenerated=function(e,t){return this.generations.find((function(n){return(Array.isArray(e)?-1!==e.indexOf(n.target):n.target===e)&&n.propertyName===t}))},e.prototype.findTree=function(e){return this.trees.find((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterRelations=function(e){return this.filterByTargetAndWithoutDuplicateRelationProperties(this.relations,e)},e.prototype.filterRelationIds=function(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationIds,e)},e.prototype.filterRelationCounts=function(e){return this.filterByTargetAndWithoutDuplicateProperties(this.relationCounts,e)},e.prototype.filterIndices=function(e){return this.indices.filter((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterUniques=function(e){return this.uniques.filter((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterChecks=function(e){return this.checks.filter((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterExclusions=function(e){return this.exclusions.filter((function(t){return Array.isArray(e)?-1!==e.indexOf(t.target):t.target===e}))},e.prototype.filterListeners=function(e){return this.filterByTarget(this.entityListeners,e)},e.prototype.filterEmbeddeds=function(e){return this.filterByTargetAndWithoutDuplicateEmbeddedProperties(this.embeddeds,e)},e.prototype.findJoinTable=function(e,t){return this.joinTables.find((function(n){return n.target===e&&n.propertyName===t}))},e.prototype.filterJoinColumns=function(e,t){return this.joinColumns.filter((function(n){return n.target===e&&n.propertyName===t}))},e.prototype.filterSubscribers=function(e){return this.filterByTarget(this.entitySubscribers,e)},e.prototype.filterNamingStrategies=function(e){return this.filterByTarget(this.namingStrategies,e)},e.prototype.filterTransactionEntityManagers=function(e,t){return this.transactionEntityManagers.filter((function(n){return(Array.isArray(e)?-1!==e.indexOf(n.target):n.target===e)&&n.methodName===t}))},e.prototype.filterTransactionRepository=function(e,t){return this.transactionRepositories.filter((function(n){return(Array.isArray(e)?-1!==e.indexOf(n.target):n.target===e)&&n.methodName===t}))},e.prototype.filterSingleTableChildren=function(e){return this.tables.filter((function(t){return t.target instanceof Function&&e instanceof Function&&Ro.isInherited(t.target,e)&&"entity-child"===t.type}))},e.prototype.findInheritanceType=function(e){return this.inheritances.find((function(t){return t.target===e}))},e.prototype.findDiscriminatorValue=function(e){return this.discriminatorValues.find((function(t){return t.target===e}))},e.prototype.filterByTarget=function(e,t){return e.filter((function(e){return Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t}))},e.prototype.filterByTargetAndWithoutDuplicateProperties=function(e,t){var n=[];return e.forEach((function(e){(Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t)&&(n.find((function(t){return t.propertyName===e.propertyName}))||n.push(e))})),n},e.prototype.filterByTargetAndWithoutDuplicateRelationProperties=function(e,t){var n=[];return e.forEach((function(e){if(t instanceof Array?-1!==t.indexOf(e.target):e.target===t){var r=n.findIndex((function(t){return t.propertyName===e.propertyName}));if(t instanceof Array&&-1!==r&&t.indexOf(e.target)<t.indexOf(n[r].target)){var i=Object.create(n[r]);i.type=e.type,n[r]=i}else-1===r&&n.push(e)}})),n},e.prototype.filterByTargetAndWithoutDuplicateEmbeddedProperties=function(e,t){var n=[];return e.forEach((function(e){(Array.isArray(t)?-1!==t.indexOf(e.target):e.target===t)&&(n.find((function(t){return t.prefix===e.prefix&&t.propertyName===e.propertyName}))||n.push(e))})),n},e}(),Po=function(){function e(){}return e.getGlobalVariable=function(){return"undefined"!=typeof window?window:t},e.load=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: require("'+e+'").');return""},e.pathNormalize=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: path.normalize("'+e+'").');return""},e.pathExtname=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: path.extname("'+e+'").');return""},e.pathResolve=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: path.resolve("'+e+'").');return""},e.fileExist=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.existsSync("'+e+'").');return!1},e.dotenv=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: dotenv.config({ path: "'+e+'" }).')},e.getEnvVariable=function(e){},e.readFileSync=function(e){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.readFileSync("'+e+'").');return null},e.appendFileSync=function(e,t){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.appendFileSync("'+e+'").')},e.writeFile=function(e,t){if("browser"===this.type)throw new Error('This option/function is not supported in the browser environment. Failed operation: fs.writeFile("'+e+'").');return Promise.reject(null)},e.highlightSql=function(e){return e},e.highlightJson=function(e){return e},e.logInfo=function(e,t){console.info(e+" ",t)},e.logError=function(e,t){console.error(e+" ",t)},e.logWarn=function(e,t){console.warn(e+" ",t)},e.log=function(e){console.log(e)},e.warn=function(e){return e},e.type="browser",e}();"undefined"!=typeof window&&(window.Buffer=o("9oHsE").Buffer),void 0!==t&&(t.Buffer=o("9oHsE").Buffer);(function(){function e(){}e.prototype.read=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))}})(),function(){function e(){}e.prototype.read=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))}}(),function(){function e(){}e.prototype.read=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))}}();var No=function(){function e(){}return e.prototype.all=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))},e.prototype.get=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))},e.prototype.has=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new Error("Cannot read connection options in a browser context.")}))}))},e}(),Oo=function(){function e(){this.nestedSetColumnNames={left:"nsleft",right:"nsright"},this.materializedPathColumnName="mpath"}return e.prototype.getTableName=function(e){return e instanceof dn&&(e=e.name),e.split(".").pop()},e.prototype.tableName=function(e,t){return t||Xe(e)},e.prototype.closureJunctionTableName=function(e){return e+"_closure"},e.prototype.columnName=function(e,t,n){var r=t||e;return n.length?Ye(n.join("_"))+r.replace(/\w\S*/g,(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()})):r},e.prototype.relationName=function(e){return e},e.prototype.primaryKeyName=function(e,t){var n=Be([],ke(t));n.sort();var r=this.getTableName(e).replace(".","_")+"_"+n.join("_");return"PK_"+en.sha1(r).substr(0,27)},e.prototype.uniqueConstraintName=function(e,t){var n=Be([],ke(t));n.sort();var r=this.getTableName(e).replace(".","_")+"_"+n.join("_");return"UQ_"+en.sha1(r).substr(0,27)},e.prototype.relationConstraintName=function(e,t,n){var r=Be([],ke(t));r.sort();var i=this.getTableName(e).replace(".","_")+"_"+r.join("_");return n&&(i+="_"+n),"REL_"+en.sha1(i).substr(0,26)},e.prototype.defaultConstraintName=function(e,t){var n=this.getTableName(e).replace(".","_")+"_"+t;return"DF_"+en.sha1(n).substr(0,27)},e.prototype.foreignKeyName=function(e,t,n,r){var i=Be([],ke(t));i.sort();var o=this.getTableName(e).replace(".","_")+"_"+i.join("_");return"FK_"+en.sha1(o).substr(0,27)},e.prototype.indexName=function(e,t,n){var r=Be([],ke(t));r.sort();var i=this.getTableName(e).replace(".","_")+"_"+r.join("_");return n&&(i+="_"+n),"IDX_"+en.sha1(i).substr(0,26)},e.prototype.checkConstraintName=function(e,t,n){var r=this.getTableName(e).replace(".","_")+"_"+t,i="CHK_"+en.sha1(r).substr(0,26);return n?i+"_ENUM":i},e.prototype.exclusionConstraintName=function(e,t){var n=this.getTableName(e).replace(".","_")+"_"+t;return"XCL_"+en.sha1(n).substr(0,26)},e.prototype.joinColumnName=function(e,t){return Ye(e+"_"+t)},e.prototype.joinTableName=function(e,t,n,r){return Xe(e+"_"+n.replace(/\./gi,"_")+"_"+t)},e.prototype.joinTableColumnDuplicationPrefix=function(e,t){return e+"_"+t},e.prototype.joinTableColumnName=function(e,t,n){return Ye(e+"_"+(n||t))},e.prototype.joinTableInverseColumnName=function(e,t,n){return this.joinTableColumnName(e,t,n)},e.prototype.prefixTableName=function(e,t){return e+t},e.prototype.eagerJoinRelationAlias=function(e,t){return e+"_"+t.replace(".","_")},e}(),Co=function(e,t,n,r){this.id=e,this.timestamp=t,this.name=n,this.instance=r},ko=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];this.value=e,this.type=t,this.params=[],this.params=n||[]},Bo=function(){function e(e,t){this.connection=e,this.queryRunner=t,this.transaction="all";var n=this.connection.driver.options.schema,r=this.connection.driver.database;this.migrationsDatabase=r,this.migrationsSchema=n,this.migrationsTableName=e.options.migrationsTableName||"migrations",this.migrationsTable=this.connection.driver.buildTableName(this.migrationsTableName,n,r)}return e.prototype.executeMigration=function(e){return Ne(this,void 0,void 0,(function(){var t=this;return Oe(this,(function(n){return[2,this.withQueryRunner((function(n){return Ne(t,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return[4,this.createMigrationsTableIfNotExist(n)];case 1:return t.sent(),[4,e.instance.up(n)];case 2:return t.sent(),[4,this.insertExecutedMigration(n,e)];case 3:return t.sent(),[2,e]}}))}))}))]}))}))},e.prototype.getAllMigrations=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve(this.getMigrations())]}))}))},e.prototype.getExecutedMigrations=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return[2,this.withQueryRunner((function(t){return Ne(e,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return[4,this.createMigrationsTableIfNotExist(t)];case 1:return e.sent(),[4,this.loadExecutedMigrations(t)];case 2:return[2,e.sent()]}}))}))}))]}))}))},e.prototype.getPendingMigrations=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:return[4,this.getAllMigrations()];case 1:return e=n.sent(),[4,this.getExecutedMigrations()];case 2:return t=n.sent(),[2,e.filter((function(e){return!t.find((function(t){return t.name===e.name}))}))]}}))}))},e.prototype.insertMigration=function(e){var t=this;return new Promise((function(n,r){t.withQueryRunner((function(i){t.insertExecutedMigration(i,e).then(n).catch(r)}))}))},e.prototype.deleteMigration=function(e){var t=this;return new Promise((function(n,r){t.withQueryRunner((function(i){t.deleteExecutedMigration(i,e).then(n).catch(r)}))}))},e.prototype.showMigrations=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u,c,l;return Oe(this,(function(f){switch(f.label){case 0:return e=!1,t=this.queryRunner||this.connection.createQueryRunner(),[4,this.createMigrationsTableIfNotExist(t)];case 1:return f.sent(),[4,this.loadExecutedMigrations(t)];case 2:n=f.sent(),r=this.getMigrations(),i=function(t){n.find((function(e){return e.name===t.name}))?o.connection.logger.logSchemaBuild(" [X] "+t.name):(e=!0,o.connection.logger.logSchemaBuild(" [ ] "+t.name))},o=this;try{for(a=Ce(r),s=a.next();!s.done;s=a.next())u=s.value,i(u)}catch(e){c={error:e}}finally{try{s&&!s.done&&(l=a.return)&&l.call(a)}finally{if(c)throw c.error}}return this.queryRunner?[3,4]:[4,t.release()];case 3:f.sent(),f.label=4;case 4:return[2,e]}}))}))},e.prototype.executePendingMigrations=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u,c,l,f,h,d,p,m,y=this;return Oe(this,(function(g){switch(g.label){case 0:return e=this.queryRunner||this.connection.createQueryRunner(),[4,this.createMigrationsTableIfNotExist(e)];case 1:return g.sent(),[4,this.loadExecutedMigrations(e)];case 2:return t=g.sent(),n=this.getLatestTimestampMigration(t),r=this.getMigrations(),i=[],(o=r.filter((function(e){return!t.find((function(t){return t.name===e.name}))}))).length?[3,5]:(this.connection.logger.logSchemaBuild("No migrations are pending"),this.queryRunner?[3,4]:[4,e.release()]);case 3:g.sent(),g.label=4;case 4:return[2,[]];case 5:return this.connection.logger.logSchemaBuild(t.length+" migrations are already loaded in the database."),this.connection.logger.logSchemaBuild(r.length+" migrations were found in the source code."),n&&this.connection.logger.logSchemaBuild(n.name+" is the last executed migration. It was executed on "+new Date(n.timestamp).toString()+"."),this.connection.logger.logSchemaBuild(o.length+" migrations are new migrations that needs to be executed."),a=!1,"all"!==this.transaction||e.isTransactionActive?[3,7]:[4,e.startTransaction()];case 6:g.sent(),a=!0,g.label=7;case 7:g.trys.push([7,18,23,26]),s=function(t){return Oe(this,(function(n){switch(n.label){case 0:return"each"!==u.transaction||e.isTransactionActive?[3,2]:[4,e.startTransaction()];case 1:n.sent(),a=!0,n.label=2;case 2:return[4,t.instance.up(e).then((function(){return Ne(y,void 0,void 0,(function(){return Oe(this,(function(n){switch(n.label){case 0:return[4,this.insertExecutedMigration(e,t)];case 1:return n.sent(),"each"===this.transaction&&a?[4,e.commitTransaction()]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))})).then((function(){i.push(t),y.connection.logger.logSchemaBuild("Migration "+t.name+" has been executed successfully.")}))];case 3:return n.sent(),[2]}}))},u=this,g.label=8;case 8:g.trys.push([8,13,14,15]),c=Ce(o),l=c.next(),g.label=9;case 9:return l.done?[3,12]:(f=l.value,[5,s(f)]);case 10:g.sent(),g.label=11;case 11:return l=c.next(),[3,9];case 12:return[3,15];case 13:return h=g.sent(),p={error:h},[3,15];case 14:try{l&&!l.done&&(m=c.return)&&m.call(c)}finally{if(p)throw p.error}return[7];case 15:return"all"===this.transaction&&a?[4,e.commitTransaction()]:[3,17];case 16:g.sent(),g.label=17;case 17:return[3,26];case 18:if(d=g.sent(),!a)return[3,22];g.label=19;case 19:return g.trys.push([19,21,,22]),[4,e.rollbackTransaction()];case 20:return g.sent(),[3,22];case 21:return g.sent(),[3,22];case 22:throw d;case 23:return this.queryRunner?[3,25]:[4,e.release()];case 24:g.sent(),g.label=25;case 25:return[7];case 26:return[2,i]}}))}))},e.prototype.undoLastMigration=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e=this.queryRunner||this.connection.createQueryRunner(),[4,this.createMigrationsTableIfNotExist(e)];case 1:return s.sent(),[4,this.loadExecutedMigrations(e)];case 2:if(t=s.sent(),!(n=this.getLatestExecutedMigration(t)))return this.connection.logger.logSchemaBuild("No migrations was found in the database. Nothing to revert!"),[2];if(r=this.getMigrations(),!(i=r.find((function(e){return e.name===n.name}))))throw new rt("No migration "+n.name+" was found in the source code. Make sure you have this migration in your codebase and its included in the connection options.");return this.connection.logger.logSchemaBuild(t.length+" migrations are already loaded in the database."),this.connection.logger.logSchemaBuild(n.name+" is the last executed migration. It was executed on "+new Date(n.timestamp).toString()+"."),this.connection.logger.logSchemaBuild("Now reverting it..."),o=!1,"none"===this.transaction||e.isTransactionActive?[3,4]:[4,e.startTransaction()];case 3:s.sent(),o=!0,s.label=4;case 4:return s.trys.push([4,9,14,17]),[4,i.instance.down(e)];case 5:return s.sent(),[4,this.deleteExecutedMigration(e,i)];case 6:return s.sent(),this.connection.logger.logSchemaBuild("Migration "+i.name+" has been reverted successfully."),o?[4,e.commitTransaction()]:[3,8];case 7:s.sent(),s.label=8;case 8:return[3,17];case 9:if(a=s.sent(),!o)return[3,13];s.label=10;case 10:return s.trys.push([10,12,,13]),[4,e.rollbackTransaction()];case 11:return s.sent(),[3,13];case 12:return s.sent(),[3,13];case 13:throw a;case 14:return this.queryRunner?[3,16]:[4,e.release()];case 15:s.sent(),s.label=16;case 16:return[7];case 17:return[2]}}))}))},e.prototype.createMigrationsTableIfNotExist=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return this.connection.driver instanceof De?[2]:[4,e.hasTable(this.migrationsTable)];case 1:return t.sent()?[3,3]:[4,e.createTable(new dn({database:this.migrationsDatabase,schema:this.migrationsSchema,name:this.migrationsTable,columns:[{name:"id",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationId}),isGenerated:!0,generationStrategy:"increment",isPrimary:!0,isNullable:!1},{name:"timestamp",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp}),isPrimary:!1,isNullable:!1},{name:"name",type:this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}),isNullable:!1}]}))];case 2:t.sent(),t.label=3;case 3:return[2]}}))}))},e.prototype.loadExecutedMigrations=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return this.connection.driver instanceof De?[4,e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).find().sort({_id:-1}).toArray()]:[3,2];case 1:return[2,t.sent()];case 2:return[4,this.connection.manager.createQueryBuilder(e).select().orderBy(this.connection.driver.escape("id"),"DESC").from(this.migrationsTable,this.migrationsTableName).getRawMany()];case 3:return[2,t.sent().map((function(e){return new Co(parseInt(e.id),parseInt(e.timestamp),e.name)}))]}}))}))},e.prototype.getMigrations=function(){var e=this.connection.migrations.map((function(e){var t=e.name||e.constructor.name,n=parseInt(t.substr(-13),10);if(!n||isNaN(n))throw new rt(t+" migration name is wrong. Migration class name should have a JavaScript timestamp appended.");return new Co(void 0,n,t,e)}));return this.checkForDuplicateMigrations(e),e.sort((function(e,t){return e.timestamp-t.timestamp}))},e.prototype.checkForDuplicateMigrations=function(e){var t=e.map((function(e){return e.name})),n=Array.from(new Set(t.filter((function(e,n){return t.indexOf(e)<n}))));if(n.length>0)throw Error("Duplicate migrations: "+n.join(", "))},e.prototype.getLatestTimestampMigration=function(e){var t=e.map((function(e){return e})).sort((function(e,t){return-1*(e.timestamp-t.timestamp)}));return t.length>0?t[0]:void 0},e.prototype.getLatestExecutedMigration=function(e){return e.length>0?e[0]:void 0},e.prototype.insertExecutedMigration=function(e,t){return Ne(this,void 0,void 0,(function(){var n;return Oe(this,(function(r){switch(r.label){case 0:return n={},this.connection.driver instanceof Ve?(n.timestamp=new ko(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),n.name=new ko(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(n.timestamp=t.timestamp,n.name=t.name),this.connection.driver instanceof De?[4,e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).insertOne(n)]:[3,2];case 1:return r.sent(),[3,4];case 2:return[4,e.manager.createQueryBuilder().insert().into(this.migrationsTable).values(n).execute()];case 3:r.sent(),r.label=4;case 4:return[2]}}))}))},e.prototype.deleteExecutedMigration=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return n={},this.connection.driver instanceof Ve?(n.timestamp=new ko(t.timestamp,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationTimestamp})),n.name=new ko(t.name,this.connection.driver.normalizeType({type:this.connection.driver.mappedDataTypes.migrationName}))):(n.timestamp=t.timestamp,n.name=t.name),this.connection.driver instanceof De?[4,e.databaseConnection.db(this.connection.driver.database).collection(this.migrationsTableName).deleteOne(n)]:[3,2];case 1:return i.sent(),[3,4];case 2:return[4,(r=e.manager.createQueryBuilder()).delete().from(this.migrationsTable).where(r.escape("timestamp")+" = :timestamp").andWhere(r.escape("name")+" = :name").setParameters(n).execute()];case 3:i.sent(),i.label=4;case 4:return[2]}}))}))},e.prototype.withQueryRunner=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){switch(n.label){case 0:t=this.queryRunner||this.connection.createQueryRunner(),n.label=1;case 1:return n.trys.push([1,,2,5]),[2,e(t)];case 2:return this.queryRunner?[3,4]:[4,t.release()];case 3:n.sent(),n.label=4;case 4:return[7];case 5:return[2]}}))}))},e}();function Do(e,t,n){var r=[],i={};return function o(a){i[a]=!0,r.push(a),e[a].forEach((function(e){if(i[e]){if(r.indexOf(e)>=0)throw r.push(e),new rt("Dependency Cycle Found: "+r.join(" -> "))}else o(e)})),r.pop(),t&&0!==e[a].length||-1!==n.indexOf(a)||n.push(a)}}var jo=function(){function e(){this.nodes={},this.outgoingEdges={},this.incomingEdges={}}return e.prototype.addNode=function(e,t){this.hasNode(e)||(this.nodes[e]=2===arguments.length?t:e,this.outgoingEdges[e]=[],this.incomingEdges[e]=[])},e.prototype.removeNode=function(e){this.hasNode(e)&&(delete this.nodes[e],delete this.outgoingEdges[e],delete this.incomingEdges[e],[this.incomingEdges,this.outgoingEdges].forEach((function(t){Object.keys(t).forEach((function(n){var r=t[n].indexOf(e);r>=0&&t[n].splice(r,1)}),this)})))},e.prototype.hasNode=function(e){return this.nodes.hasOwnProperty(e)},e.prototype.getNodeData=function(e){if(this.hasNode(e))return this.nodes[e];throw new rt("Node does not exist: "+e)},e.prototype.setNodeData=function(e,t){if(!this.hasNode(e))throw new rt("Node does not exist: "+e);this.nodes[e]=t},e.prototype.addDependency=function(e,t){if(!this.hasNode(e))throw new rt("Node does not exist: "+e);if(!this.hasNode(t))throw new rt("Node does not exist: "+t);return-1===this.outgoingEdges[e].indexOf(t)&&this.outgoingEdges[e].push(t),-1===this.incomingEdges[t].indexOf(e)&&this.incomingEdges[t].push(e),!0},e.prototype.removeDependency=function(e,t){var n;this.hasNode(e)&&(n=this.outgoingEdges[e].indexOf(t))>=0&&this.outgoingEdges[e].splice(n,1),this.hasNode(t)&&(n=this.incomingEdges[t].indexOf(e))>=0&&this.incomingEdges[t].splice(n,1)},e.prototype.dependenciesOf=function(e,t){if(this.hasNode(e)){var n=[];Do(this.outgoingEdges,t,n)(e);var r=n.indexOf(e);return r>=0&&n.splice(r,1),n}throw new rt("Node does not exist: "+e)},e.prototype.dependantsOf=function(e,t){if(this.hasNode(e)){var n=[];Do(this.incomingEdges,t,n)(e);var r=n.indexOf(e);return r>=0&&n.splice(r,1),n}throw new rt("Node does not exist: "+e)},e.prototype.overallOrder=function(e){var t=this,n=[],r=Object.keys(this.nodes);if(0===r.length)return n;var i=Do(this.outgoingEdges,!1,[]);r.forEach((function(e){i(e)}));var o=Do(this.outgoingEdges,e,n);return r.filter((function(e){return 0===t.incomingEdges[e].length})).forEach((function(e){o(e)})),n},e}(),Lo=function(){function e(){}return e.prototype.validateMany=function(e,t){var n=this;e.forEach((function(r){return n.validate(r,e,t)})),this.validateDependencies(e),this.validateEagerRelations(e)},e.prototype.validate=function(e,t,n){if(!e.primaryColumns.length&&!e.isJunction)throw new Ct(e);if("STI"===e.inheritancePattern||"entity-child"===e.tableType){if(!e.discriminatorColumn)throw new rt("Entity "+e.name+" using single-table inheritance, it should also have a discriminator column. Did you forget to put discriminator column options?");if(void 0===e.discriminatorValue)throw new rt("Entity "+e.name+" has an undefined discriminator value. Discriminator value should be defined.");var r=t.find((function(t){return t!==e&&("STI"===t.inheritancePattern||"entity-child"===t.tableType)&&t.discriminatorValue===e.discriminatorValue&&t.inheritanceTree.some((function(t){return-1!==e.inheritanceTree.indexOf(t)}))}));if(r)throw new rt("Entities "+e.name+" and "+r.name+" have the same discriminator values. Make sure they are different while using the @ChildEntity decorator.")}if((e.relationCounts.forEach((function(e){if(e.relation.isManyToOne||e.relation.isOneToOne)throw new rt("Relation count can not be implemented on ManyToOne or OneToOne relations.")})),n instanceof De||e.columns.forEach((function(t){var r=n.normalizeType(t);if(-1===n.supportedDataTypes.indexOf(r))throw new Vt(t,r,n.options.type);if(t.length&&-1===n.withLengthColumnTypes.indexOf(r))throw new rt("Column "+t.propertyName+" of Entity "+e.name+" does not support length property.");if("enum"===t.type&&!t.enum&&!t.enumName)throw new rt('Column "'+t.propertyName+'" of Entity "'+e.name+'" is defined as enum, but missing "enum" or "enumName" properties.')})),n instanceof We||n instanceof Fe)&&e.columns.filter((function(e){return e.isGenerated&&"uuid"!==e.generationStrategy})).length>1)throw new rt("Error in "+e.name+" entity. There can be only one auto-increment column in MySql table.");if(n instanceof We&&(0===t.filter((function(e){return e.database})).length&&!n.database))throw new Yt("database");if(n instanceof Ve&&e.columns.filter((function(e){return e.charset})).length>1)throw new rt("Character set specifying is not supported in Sql Server");var i=e.create();e.relations.forEach((function(e){if(e.isManyToMany||e.isOneToMany){if(!1===e.persistenceEnabled)return;var t=e.getEntityValue(i);if(Array.isArray(t))throw new zt(e)}})),e.relations.forEach((function(e){})),e.relations.forEach((function(t){if(t.isCascadeRemove&&t.inverseRelation&&t.inverseRelation.isCascadeRemove)throw new rt("Relation "+e.name+"#"+t.propertyName+" and "+t.inverseRelation.entityMetadata.name+"#"+t.inverseRelation.propertyName+" both has cascade remove set. This may lead to unexpected circular removals. Please set cascade remove only from one side of relationship.")})),e.eagerRelations.forEach((function(e){}))},e.prototype.validateDependencies=function(e){var t=new jo;e.forEach((function(e){t.addNode(e.name)})),e.forEach((function(e){e.relationsWithJoinColumns.filter((function(e){return!e.isNullable})).forEach((function(n){t.addDependency(e.name,n.inverseEntityMetadata.name)}))}));try{t.overallOrder()}catch(e){throw new Nt(e.toString().replace("Error: Dependency Cycle Found: ",""))}},e.prototype.validateEagerRelations=function(e){e.forEach((function(e){e.eagerRelations.forEach((function(t){if(t.inverseRelation&&t.inverseRelation.isEager)throw new rt("Circular eager relations are disallowed. "+e.targetName+"#"+t.propertyPath+' contains "eager: true", and its inverse side '+t.inverseEntityMetadata.targetName+"#"+t.inverseRelation.propertyPath+' contains "eager: true" as well. Remove "eager: true" from one side of the relation.')}))}))},e}(),qo=function(){function e(){}return e.prototype.createQueryBuilder=function(e,t){return this.manager.createQueryBuilder(this.metadata.target,e||this.metadata.targetName,t||this.queryRunner)},Object.defineProperty(e.prototype,"target",{get:function(){return this.metadata.target},enumerable:!1,configurable:!0}),e.prototype.hasId=function(e){return this.manager.hasId(this.metadata.target,e)},e.prototype.getId=function(e){return this.manager.getId(this.metadata.target,e)},e.prototype.create=function(e){return this.manager.create(this.metadata.target,e)},e.prototype.merge=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return(t=this.manager).merge.apply(t,Be([this.metadata.target,e],ke(n)))},e.prototype.preload=function(e){return this.manager.preload(this.metadata.target,e)},e.prototype.save=function(e,t){return this.manager.save(this.metadata.target,e,t)},e.prototype.remove=function(e,t){return this.manager.remove(this.metadata.target,e,t)},e.prototype.softRemove=function(e,t){return this.manager.softRemove(this.metadata.target,e,t)},e.prototype.recover=function(e,t){return this.manager.recover(this.metadata.target,e,t)},e.prototype.insert=function(e){return this.manager.insert(this.metadata.target,e)},e.prototype.update=function(e,t){return this.manager.update(this.metadata.target,e,t)},e.prototype.delete=function(e){return this.manager.delete(this.metadata.target,e)},e.prototype.softDelete=function(e){return this.manager.softDelete(this.metadata.target,e)},e.prototype.restore=function(e){return this.manager.restore(this.metadata.target,e)},e.prototype.count=function(e){return this.manager.count(this.metadata.target,e)},e.prototype.find=function(e){return this.manager.find(this.metadata.target,e)},e.prototype.findAndCount=function(e){return this.manager.findAndCount(this.metadata.target,e)},e.prototype.findByIds=function(e,t){return this.manager.findByIds(this.metadata.target,e,t)},e.prototype.findOne=function(e,t){return this.manager.findOne(this.metadata.target,e,t)},e.prototype.findOneOrFail=function(e,t){return this.manager.findOneOrFail(this.metadata.target,e,t)},e.prototype.query=function(e,t){return this.manager.query(e,t)},e.prototype.clear=function(){return this.manager.clear(this.metadata.target)},e.prototype.increment=function(e,t,n){return this.manager.increment(this.metadata.target,e,t,n)},e.prototype.decrement=function(e,t,n){return this.manager.decrement(this.metadata.target,e,t,n)},e}(),Uo=function(){function e(){}return e.isFindOneOptions=function(e){var t=e;return t&&(Array.isArray(t.select)||t.where instanceof Object||"string"==typeof t.where||Array.isArray(t.relations)||t.join instanceof Object||t.order instanceof Object||t.cache instanceof Object||"boolean"==typeof t.cache||"number"==typeof t.cache||t.lock instanceof Object||t.loadRelationIds instanceof Object||"boolean"==typeof t.loadRelationIds||"boolean"==typeof t.loadEagerRelations||"boolean"==typeof t.withDeleted||"boolean"==typeof t.transaction)},e.isFindManyOptions=function(e){var t=e;return t&&(this.isFindOneOptions(t)||"number"==typeof t.skip||"number"==typeof t.take||"string"==typeof t.skip||"string"==typeof t.take)},e.extractFindManyOptionsAlias=function(e){if(this.isFindManyOptions(e)&&e.join)return e.join.alias},e.applyFindManyOptionsOrConditionsToQueryBuilder=function(e,t){return this.isFindManyOptions(t)?this.applyOptionsToQueryBuilder(e,t):t?e.where(t):e},e.applyOptionsToQueryBuilder=function(e,t){if(!t||!this.isFindOneOptions(t)&&!this.isFindManyOptions(t))return e;if(!0===t.transaction&&(e.expressionMap.useTransaction=!0),!e.expressionMap.mainAlias||!e.expressionMap.mainAlias.hasMetadata)return e;var n=e.expressionMap.mainAlias.metadata;if(t.withDeleted&&e.withDeleted(),t.select&&(e.select([]),t.select.forEach((function(t){var r,i;if(!n.hasColumnWithPropertyPath(""+t))throw new rt(t+" column was not found in the "+n.name+" entity.");var o=n.findColumnsWithPropertyPath(""+t);try{for(var a=Ce(o),s=a.next();!s.done;s=a.next()){var u=s.value;e.addSelect(e.alias+"."+u.propertyPath)}}catch(e){r={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(r)throw r.error}}}))),t.relations){var r=Be([],ke(t.relations));if(this.applyRelationsRecursively(e,r,e.expressionMap.mainAlias.name,e.expressionMap.mainAlias.metadata,""),r.length>0)throw new Ut(r)}if(t.join&&(t.join.leftJoin&&Object.keys(t.join.leftJoin).forEach((function(n){e.leftJoin(t.join.leftJoin[n],n)})),t.join.innerJoin&&Object.keys(t.join.innerJoin).forEach((function(n){e.innerJoin(t.join.innerJoin[n],n)})),t.join.leftJoinAndSelect&&Object.keys(t.join.leftJoinAndSelect).forEach((function(n){e.leftJoinAndSelect(t.join.leftJoinAndSelect[n],n)})),t.join.innerJoinAndSelect&&Object.keys(t.join.innerJoinAndSelect).forEach((function(n){e.innerJoinAndSelect(t.join.innerJoinAndSelect[n],n)}))),t.cache)if(t.cache instanceof Object){var i=t.cache;e.cache(i.id,i.milliseconds)}else e.cache(t.cache);if(t.lock)if("optimistic"===t.lock.mode)e.setLock(t.lock.mode,t.lock.version);else if("pessimistic_read"===t.lock.mode||"pessimistic_write"===t.lock.mode||"dirty_read"===t.lock.mode||"pessimistic_partial_write"===t.lock.mode||"pessimistic_write_or_fail"===t.lock.mode){var o=t.lock.tables?t.lock.tables.map((function(t){var n=e.expressionMap.aliases.find((function(e){return e.metadata.tableNameWithoutPrefix===t}));if(!n)throw new rt('"'+t+'" is not part of this query');return e.escape(n.name)})):void 0;e.setLock(t.lock.mode,void 0,o)}return!0===t.loadRelationIds?e.loadAllRelationIds():t.loadRelationIds instanceof Object&&e.loadAllRelationIds(t.loadRelationIds),t.where&&e.where(t.where),t.skip&&e.skip(t.skip),t.take&&e.take(t.take),t.order&&Object.keys(t.order).forEach((function(r){var i=t.order[r];if(!n.findColumnWithPropertyPath(r))throw new Error(r+" column was not found in the "+n.name+" entity.");switch(i){case 1:e.addOrderBy(e.alias+"."+r,"ASC");break;case-1:e.addOrderBy(e.alias+"."+r,"DESC");break;case"ASC":e.addOrderBy(e.alias+"."+r,"ASC");break;case"DESC":e.addOrderBy(e.alias+"."+r,"DESC")}})),e},e.applyRelationsRecursively=function(e,t,n,r,i){var o=this,a=[];if(i){var s=new RegExp("^"+i.replace(".","\\.")+"\\.");a=t.filter((function(e){return e.match(s)})).map((function(e){return e.replace(s,"")})).filter((function(e){return r.findRelationWithPropertyPath(e)}))}else a=t.filter((function(e){return r.findRelationWithPropertyPath(e)}));a.forEach((function(a){var s=nt.buildAlias(e.connection.driver,{shorten:!0,joiner:"__"},n,a),u=n+"."+a;e.leftJoinAndSelect(u,s),t.splice(t.indexOf(i?i+"."+a:a),1);var c=e.expressionMap.joinAttributes.find((function(e){return e.entityOrProperty===u}));o.applyRelationsRecursively(e,t,c.alias.name,c.metadata,i?i+"."+a:a);var l=r.relations.find((function(e){return e.propertyName===a}));l&&o.joinEagerRelations(e,s,l.inverseEntityMetadata)}))},e.joinEagerRelations=function(e,t,n){var r=this;n.eagerRelations.forEach((function(n){var i,o,a,s,u=nt.buildAlias(e.connection.driver,{shorten:!0},e.connection.namingStrategy.eagerJoinRelationAlias(t,n.propertyPath)),c=!0;try{for(var l=Ce(e.expressionMap.joinAttributes),f=l.next();!f.done;f=l.next()){var h=f.value;if(void 0===h.condition&&void 0===h.mapToProperty&&void 0===h.isMappingMany&&"LEFT"===h.direction&&h.entityOrProperty===t+"."+n.propertyPath){c=!1,u=h.alias.name;break}}}catch(e){i={error:e}}finally{try{f&&!f.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}c&&e.leftJoin(t+"."+n.propertyPath,u);var d=!0;try{for(var p=Ce(e.expressionMap.selects),m=p.next();!m.done;m=p.next()){var y=m.value;if(void 0===y.aliasName&&void 0===y.virtual&&y.selection===u){d=!1;break}}}catch(e){a={error:e}}finally{try{m&&!m.done&&(s=p.return)&&s.call(p)}finally{if(a)throw a.error}}d&&e.addSelect(u),r.joinEagerRelations(e,u,n.inverseEntityMetadata)}))},e}(),Fo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),t.prototype.findTrees=function(e){return Ne(this,void 0,void 0,(function(){var t,n=this;return Oe(this,(function(r){switch(r.label){case 0:return[4,this.findRoots(e)];case 1:return t=r.sent(),[4,Promise.all(t.map((function(t){return n.findDescendantsTree(t,e)})))];case 2:return r.sent(),[2,t]}}))}))},t.prototype.findRoots=function(e){var t,n,r=this,i=this.manager.connection.namingStrategy.joinColumnName(this.metadata.treeParentRelation.propertyName,this.metadata.primaryColumns[0].propertyName),o=this.createQueryBuilder("treeEntity");if(null==e?void 0:e.relations){var a=Be([],ke(e.relations));if(Uo.applyRelationsRecursively(o,a,o.expressionMap.mainAlias.name,o.expressionMap.mainAlias.metadata,""),a.length>0)throw new Ut(a)}return o.where((n="treeEntity",r.manager.connection.driver.escape(n)+"."+(t=i,r.manager.connection.driver.escape(t)+" IS NULL"))).getMany()},t.prototype.findDescendants=function(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getMany()},t.prototype.findDescendantsTree=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:if(n=this.createDescendantsQueryBuilder("treeEntity","treeClosure",e),(null==t?void 0:t.relations)&&(r=Be([],ke(t.relations)),Uo.applyRelationsRecursively(n,r,n.expressionMap.mainAlias.name,n.expressionMap.mainAlias.metadata,""),r.length>0))throw new Ut(r);return[4,n.getRawAndEntities()];case 1:return i=a.sent(),o=this.createRelationMaps("treeEntity",i.raw),this.buildChildrenEntityTree(e,i.entities,o),[2,e]}}))}))},t.prototype.countDescendants=function(e){return this.createDescendantsQueryBuilder("treeEntity","treeClosure",e).getCount()},t.prototype.createDescendantsQueryBuilder=function(e,t,n){var r=this,i=function(e){return r.manager.connection.driver.escape(e)};if("closure-table"===this.metadata.treeType){var o=this.metadata.closureJunctionTable.descendantColumns.map((function(n){return i(t)+"."+i(n.propertyPath)+" = "+i(e)+"."+i(n.referencedColumn.propertyPath)})).join(" AND "),a={},s=this.metadata.closureJunctionTable.ancestorColumns.map((function(e){return a[e.referencedColumn.propertyName]=e.referencedColumn.getEntityValue(n),i(t)+"."+i(e.propertyPath)+" = :"+e.referencedColumn.propertyName})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,o).where(s).setParameters(a)}if("nested-set"===this.metadata.treeType){s=e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN joined."+this.metadata.nestedSetLeftColumn.propertyPath+" AND joined."+this.metadata.nestedSetRightColumn.propertyPath;var u={};o=this.metadata.treeParentRelation.joinColumns.map((function(e){var t=e.referencedColumn.propertyPath.replace(".","_");return u[t]=e.referencedColumn.getEntityValue(n),"joined."+e.referencedColumn.propertyPath+" = :"+t})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",s).where(o,u)}if("materialized-path"===this.metadata.treeType)return this.createQueryBuilder(e).where((function(t){var i=t.subQuery().select(r.metadata.targetName+"."+r.metadata.materializedPathColumn.propertyPath,"path").from(r.metadata.target,r.metadata.targetName).whereInIds(r.metadata.getEntityIdMap(n));return r.manager.connection.driver instanceof bn?e+"."+r.metadata.materializedPathColumn.propertyPath+" LIKE "+i.getQuery()+" || '%'":e+"."+r.metadata.materializedPathColumn.propertyPath+" LIKE CONCAT("+i.getQuery()+", '%')"}));throw new rt("Supported only in tree entities")},t.prototype.findAncestors=function(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getMany()},t.prototype.findAncestorsTree=function(e){var t=this;return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getRawAndEntities().then((function(n){var r=t.createRelationMaps("treeEntity",n.raw);return t.buildParentEntityTree(e,n.entities,r),e}))},t.prototype.countAncestors=function(e){return this.createAncestorsQueryBuilder("treeEntity","treeClosure",e).getCount()},t.prototype.createAncestorsQueryBuilder=function(e,t,n){var r=this;if("closure-table"===this.metadata.treeType){var i=this.metadata.closureJunctionTable.ancestorColumns.map((function(n){return t+"."+n.propertyPath+" = "+e+"."+n.referencedColumn.propertyPath})).join(" AND "),o={},a=this.metadata.closureJunctionTable.descendantColumns.map((function(e){return o[e.referencedColumn.propertyName]=e.referencedColumn.getEntityValue(n),t+"."+e.propertyPath+" = :"+e.referencedColumn.propertyName})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.closureJunctionTable.tableName,t,i).where(a).setParameters(o)}if("nested-set"===this.metadata.treeType){i="joined."+this.metadata.nestedSetLeftColumn.propertyPath+" BETWEEN "+e+"."+this.metadata.nestedSetLeftColumn.propertyPath+" AND "+e+"."+this.metadata.nestedSetRightColumn.propertyPath;var s={};a=this.metadata.treeParentRelation.joinColumns.map((function(e){var t=e.referencedColumn.propertyPath.replace(".","_");return s[t]=e.referencedColumn.getEntityValue(n),"joined."+e.referencedColumn.propertyPath+" = :"+t})).join(" AND ");return this.createQueryBuilder(e).innerJoin(this.metadata.targetName,"joined",i).where(a,s)}if("materialized-path"===this.metadata.treeType)return this.createQueryBuilder(e).where((function(t){var i=t.subQuery().select(r.metadata.targetName+"."+r.metadata.materializedPathColumn.propertyPath,"path").from(r.metadata.target,r.metadata.targetName).whereInIds(r.metadata.getEntityIdMap(n));return r.manager.connection.driver instanceof bn?i.getQuery()+" LIKE "+e+"."+r.metadata.materializedPathColumn.propertyPath+" || '%'":i.getQuery()+" LIKE CONCAT("+e+"."+r.metadata.materializedPathColumn.propertyPath+", '%')"}));throw new rt("Supported only in tree entities")},t.prototype.createRelationMaps=function(e,t){var n=this;return t.map((function(t){var r=n.metadata.treeParentRelation.joinColumns[0],i=r.givenDatabaseName||r.databaseName,o=t[e+"_"+n.metadata.primaryColumns[0].databaseName],a=t[e+"_"+i];return{id:n.manager.connection.driver.prepareHydratedValue(o,n.metadata.primaryColumns[0]),parentId:n.manager.connection.driver.prepareHydratedValue(a,r)}}))},t.prototype.buildChildrenEntityTree=function(e,t,n){var r=this,i=this.metadata.treeChildrenRelation.propertyName,o=this.metadata.primaryColumns[0].getEntityValue(e),a=n.filter((function(e){return e.parentId===o})),s=new Set(a.map((function(e){return e.id})));e[i]=t.filter((function(e){return s.has(r.metadata.primaryColumns[0].getEntityValue(e))})),e[i].forEach((function(e){r.buildChildrenEntityTree(e,t,n)}))},t.prototype.buildParentEntityTree=function(e,t,n){var r=this,i=this.metadata.treeParentRelation.propertyName,o=this.metadata.primaryColumns[0].getEntityValue(e),a=n.find((function(e){return e.id===o})),s=t.find((function(e){return!!a&&r.metadata.primaryColumns[0].getEntityValue(e)===a.parentId}));s&&(e[i]=s,this.buildParentEntityTree(e[i],t,n))},t}(qo),Ko=function(){function e(){}return e.prototype.transform=function(e,t,n,r){return void 0===r&&(r=!1),this.groupAndTransform(e,t,n,r),e},e.prototype.groupAndTransform=function(e,t,n,r){var i=this;void 0===r&&(r=!1),n.nonVirtualColumns.forEach((function(n){var r=n.getEntityValue(t);void 0!==r&&n.setEntityValue(e,r)})),n.relations.length&&n.relations.forEach((function(n){var o=n.getEntityValue(e),a=n.getEntityValue(t,r);if(void 0!==a)if(n.isOneToMany||n.isManyToMany){if(!Array.isArray(a))return;o||(o=[],n.setEntityValue(e,o)),a.forEach((function(e){var t=o.find((function(t){return n.inverseEntityMetadata.compareEntities(e,t)}));t||(t=n.inverseEntityMetadata.create(void 0,{fromDeserializer:!0}),o.push(t)),i.groupAndTransform(t,e,n.inverseEntityMetadata,r)}))}else{if(!(a instanceof Object))return void(o instanceof Object||n.setEntityValue(e,a));o||(o=n.inverseEntityMetadata.create(void 0,{fromDeserializer:!0}),n.setEntityValue(e,o)),i.groupAndTransform(o,a,n.inverseEntityMetadata,r)}}))},e}(),Vo=function(){function e(e,t,n,r){this.plainEntity=e,this.metadata=t,this.parentLoadMapItem=n,this.relation=r}return Object.defineProperty(e.prototype,"target",{get:function(){return this.metadata.target},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.metadata.getEntityIdMixedMap(this.plainEntity)},enumerable:!1,configurable:!0}),e}(),zo=function(){function e(){this.loadMapItems=[]}return Object.defineProperty(e.prototype,"mainLoadMapItem",{get:function(){return this.loadMapItems.find((function(e){return!e.relation&&!e.parentLoadMapItem}))},enumerable:!1,configurable:!0}),e.prototype.addLoadMap=function(e){this.loadMapItems.find((function(t){return t.target===e.target&&t.id===e.id}))||this.loadMapItems.push(e)},e.prototype.fillEntities=function(e,t){var n=this;t.forEach((function(t){var r=n.loadMapItems.find((function(n){return n.target===e&&n.metadata.compareEntities(t,n.plainEntity)}));r&&(r.entity=t)}))},e.prototype.groupByTargetIds=function(){var e=[];return this.loadMapItems.forEach((function(t){var n=e.find((function(e){return e.target===t.target}));n||(n={target:t.target,ids:[]},e.push(n)),n.ids.push(t.id)})),e},e}(),Wo=function(){function e(e){this.manager=e}return e.prototype.transform=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i=this;return Oe(this,(function(o){switch(o.label){case 0:return t.hasAllPrimaryKeys(e)?(n=new zo,(r=function(e,i,o,a){var s=new Vo(e,i,o,a);n.addLoadMap(s),i.extractRelationValuesFromEntity(e,t.relations).filter((function(e){return null!=e})).forEach((function(e){var t=ke(e,3),n=t[0],i=t[1],o=t[2];return r(i,o,s,n)}))})(e,t),[4,Promise.all(n.groupByTargetIds().map((function(e){return i.manager.findByIds(e.target,e.ids).then((function(t){return n.fillEntities(e.target,t)}))})))]):[2,Promise.reject("Given object does not have a primary column, cannot transform it to database entity.")];case 1:return o.sent(),n.loadMapItems.forEach((function(e){e.relation&&e.entity&&e.parentLoadMapItem&&e.parentLoadMapItem.entity&&(e.relation.isManyToMany||e.relation.isOneToMany?(e.parentLoadMapItem.entity[e.relation.propertyName]||(e.parentLoadMapItem.entity[e.relation.propertyName]=[]),e.parentLoadMapItem.entity[e.relation.propertyName].push(e.entity)):e.parentLoadMapItem.entity[e.relation.propertyName]=e.entity)})),[2,n.mainLoadMapItem?n.mainLoadMapItem.entity:void 0]}}))}))},e}(),Ho=function(){function e(){}return Object.defineProperty(e.prototype,"repository",{get:function(){var e=this.getCustomRepositoryTarget(this);if(!e)throw new It(this.constructor);return this.manager.getRepository(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"treeRepository",{get:function(){var e=this.getCustomRepositoryTarget(this);if(!e)throw new It(this.constructor);return this.manager.getTreeRepository(e)},enumerable:!1,configurable:!0}),e.prototype.createQueryBuilder=function(e){var t=this.getCustomRepositoryTarget(this.constructor);if(!t)throw new It(this.constructor);return this.manager.getRepository(t).createQueryBuilder(e)},e.prototype.createQueryBuilderFor=function(e,t){return this.getRepositoryFor(e).createQueryBuilder(t)},e.prototype.getRepositoryFor=function(e){return this.manager.getRepository(e)},e.prototype.getTreeRepositoryFor=function(e){return this.manager.getTreeRepository(e)},e.prototype.getCustomRepositoryTarget=function(e){var t=Es().entityRepositories.find((function(t){return t.target===(e instanceof Function?e:e.constructor)}));if(!t)throw new gt(e);return t.entity},e}(),Go=function(){function e(){}return e.prototype.create=function(e,t,n){if(t.treeType){var r=new Fo;return Object.assign(r,{manager:e,metadata:t,queryRunner:n}),r}r=void 0;return r=e.connection.driver instanceof De?new qe:new qo,Object.assign(r,{manager:e,metadata:t,queryRunner:n}),r},e}(),Qo=function(){function e(e){this.subjects=Be([],ke(e)),this.metadatas=this.getUniqueMetadatas(this.subjects)}return e.prototype.sort=function(e){var t=this;if(!this.metadatas.length)return this.subjects;var n=[];if("delete"===e){var r=this.subjects.filter((function(e){return!e.entity&&!e.databaseEntity}));n.push.apply(n,Be([],ke(r))),this.removeAlreadySorted(r)}var i=this.getNonNullableDependencies(),o=this.toposort(i);"insert"===e&&(o=o.reverse()),o.forEach((function(e){var r=t.subjects.filter((function(t){return t.metadata.targetName===e}));n.push.apply(n,Be([],ke(r))),t.removeAlreadySorted(r)}));var a=this.getDependencies(),s=this.toposort(a);return"insert"===e&&(s=s.reverse()),s.forEach((function(e){var r=t.subjects.filter((function(t){return t.metadata.targetName===e}));n.push.apply(n,Be([],ke(r))),t.removeAlreadySorted(r)})),n.push.apply(n,Be([],ke(this.subjects))),n},e.prototype.removeAlreadySorted=function(e){var t=this;e.forEach((function(e){t.subjects.splice(t.subjects.indexOf(e),1)}))},e.prototype.getUniqueMetadatas=function(e){var t=[];return e.forEach((function(e){-1===t.indexOf(e.metadata)&&t.push(e.metadata)})),t},e.prototype.getNonNullableDependencies=function(){return this.metadatas.reduce((function(e,t){return t.relationsWithJoinColumns.forEach((function(n){n.isNullable||e.push([t.targetName,n.inverseEntityMetadata.targetName])})),e}),[])},e.prototype.getDependencies=function(){return this.metadatas.reduce((function(e,t){return t.relationsWithJoinColumns.forEach((function(n){n.inverseEntityMetadata!==t&&e.push([t.targetName,n.inverseEntityMetadata.targetName])})),e}),[])},e.prototype.toposort=function(e){for(var t=function(e){for(var t=[],n=0,r=e.length;n<r;n++){var i=e[n];t.indexOf(i[0])<0&&t.push(i[0]),t.indexOf(i[1])<0&&t.push(i[1])}return t}(e),n=t.length,r=new Array(n),i={},o=n;o--;)i[o]||a(t[o],o,[]);function a(o,s,u){if(u.indexOf(o)>=0)throw new rt("Cyclic dependency: "+JSON.stringify(o));if(!~t.indexOf(o))throw new rt("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(o));if(!i[s]){i[s]=!0;var c=e.filter((function(e){return e[0]===o}));if(s=c.length){var l=u.concat(o);do{var f=c[--s][1];a(f,t.indexOf(f),l)}while(s)}r[--n]=o}}return r},e}(),Jo=o("9oHsE").Buffer,Zo=function(){function e(){}return e.prototype.compute=function(e){var t=this;e.forEach((function(n){t.computeDiffColumns(n),t.computeDiffRelationalColumns(e,n)}))},e.prototype.computeDiffColumns=function(e){e.entity&&e.metadata.columns.forEach((function(t){if(!t.isVirtual&&!t.isDiscriminator){var n=e.changeMaps.find((function(e){return e.column===t}));n&&e.changeMaps.splice(e.changeMaps.indexOf(n),1);var r=t.getEntityValue(e.entity);if(void 0!==r){if(e.databaseEntity){var i="json"!==t.type&&"jsonb"!==t.type,o=t.getEntityValue(e.databaseEntity,i);if(t.relationMetadata){var a=t.relationMetadata.getEntityValue(e.entity);if(null!=a)return}var s=r;if(null!==r){switch(t.type){case"date":s=on.mixedDateToDateString(r);break;case"time":case"time with time zone":case"time without time zone":case"timetz":s=on.mixedDateToTimeString(r);break;case"datetime":case"datetime2":case Date:case"timestamp":case"timestamp without time zone":case"timestamp with time zone":case"timestamp with local time zone":case"timestamptz":s=on.mixedDateToUtcDatetimeString(r),o=on.mixedDateToUtcDatetimeString(o);break;case"json":case"jsonb":if(Ze.deepCompare(r,o))return;break;case"simple-array":s=on.simpleArrayToString(r),o=on.simpleArrayToString(o);break;case"simple-enum":s=on.simpleEnumToString(r),o=on.simpleEnumToString(o);break;case"simple-json":s=on.simpleJsonToString(r),o=on.simpleJsonToString(o)}t.transformer&&(s=gn.transformTo(t.transformer,r))}if(s instanceof Jo&&o instanceof Jo){if(s.equals(o))return}else if(s===o)return}e.diffColumns.push(t),e.changeMaps.push({column:t,value:r})}}}))},e.prototype.computeDiffRelationalColumns=function(e,t){t.entity&&t.metadata.relationsWithJoinColumns.forEach((function(n){var r=n.getEntityValue(t.entity);if(void 0!==r){if(t.databaseEntity){var i=r;null!==i&&i instanceof Object&&(i=n.getRelationIdMap(i));var o=n.getEntityValue(t.databaseEntity);if(Ze.compareIds(i,o))return;t.diffRelations.push(n)}var a=e.find((function(e){return e.mustBeInserted&&e.entity===r}));a&&(r=a);var s=t.changeMaps.find((function(e){return e.relation===n}));s?s.value=r:t.changeMaps.push({relation:n,value:r})}}))},e}(),$o=function(e){function t(){return e.call(this,"Nested sets do not support multiple root entities.")||this}return Ae(t,e),t}(rt),Yo=function(){function e(e){this.queryRunner=e}return e.prototype.insert=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:return t=function(e){return u.queryRunner.connection.driver.escape(e)},n=this.getTableName(e.metadata.tablePath),r=t(e.metadata.nestedSetLeftColumn.databaseName),i=t(e.metadata.nestedSetRightColumn.databaseName),!(o=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(o=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),a=e.metadata.getEntityIdMap(o),s=void 0,a?[4,this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.nestedSetRightColumn.propertyPath,"right").from(e.metadata.target,e.metadata.targetName).whereInIds(a).getRawOne().then((function(e){var t=e?e.right:void 0;return"string"==typeof t?parseInt(t):t}))]:[3,2];case 1:s=c.sent(),c.label=2;case 2:return void 0===s?[3,4]:[4,this.queryRunner.query("UPDATE "+n+" SET "+r+" = CASE WHEN "+r+" > "+s+" THEN "+r+" + 2 ELSE "+r+" END,"+i+" = "+i+" + 2 WHERE "+i+" >= "+s)];case 3:return c.sent(),Ze.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(s),e.metadata.nestedSetRightColumn.createValueMap(s+1)),[3,6];case 4:return[4,this.isUniqueRootEntity(e,o)];case 5:if(!c.sent())throw new $o;Ze.mergeDeep(e.insertedValueSet,e.metadata.nestedSetLeftColumn.createValueMap(1),e.metadata.nestedSetRightColumn.createValueMap(2)),c.label=6;case 6:return[2]}}))}))},e.prototype.update=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b=this;return Oe(this,(function(v){switch(v.label){case 0:return!(t=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity),!(n=e.databaseEntity)&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find((function(t){return Object.entries(e.identifier).every((function(e){var n=ke(e,2),r=n[0],i=n[1];return t[r]===i}))}))),void 0===n||void 0===t?[2]:(r=e.metadata.treeParentRelation.getEntityValue(n),i=e.metadata.getEntityIdMap(r),o=e.metadata.getEntityIdMap(t),Ze.compareIds(i,o)?[2]:t?(a=function(e){return b.queryRunner.connection.driver.escape(e)},s=this.getTableName(e.metadata.tablePath),u=a(e.metadata.nestedSetLeftColumn.databaseName),c=a(e.metadata.nestedSetRightColumn.databaseName),l=e.metadata.getEntityIdMap(n),f=void 0,l?[4,this.getNestedSetIds(e.metadata,l)]:[3,2]):[3,9]);case 1:f=v.sent()[0],v.label=2;case 2:return h=void 0,o?[4,this.getNestedSetIds(e.metadata,o)]:[3,4];case 3:h=v.sent()[0],v.label=4;case 4:return void 0===f||void 0===h?[3,8]:(d=h.left>f.left,p=f.right-f.left+1,m=void 0,m=d?h.left-f.right:h.right-f.left,y="WHEN "+u+" >= "+f.left+" AND "+u+" < "+f.right+" THEN "+u+" + "+m+" ",g="WHEN "+c+" > "+f.left+" AND "+c+" <= "+f.right+" THEN "+c+" + "+m+" ",d?[4,this.queryRunner.query("UPDATE "+s+" SET "+u+" = CASE WHEN "+u+" > "+f.right+" AND "+u+" <= "+h.left+" THEN "+u+" - "+p+" "+y+"ELSE "+u+" END, "+c+" = CASE WHEN "+c+" > "+f.right+" AND "+c+" < "+h.left+" THEN "+c+" - "+p+" "+g+"ELSE "+c+" END")]:[3,6]);case 5:return v.sent(),[3,8];case 6:return[4,this.queryRunner.query("UPDATE "+s+" SET "+u+" = CASE WHEN "+u+" < "+f.left+" AND "+u+" > "+h.right+" THEN "+u+" + "+p+" "+y+"ELSE "+u+" END, "+c+" = CASE WHEN "+c+" < "+f.left+" AND "+c+" >= "+h.right+" THEN "+c+" + "+p+" "+g+"ELSE "+c+" END")];case 7:v.sent(),v.label=8;case 8:return[3,11];case 9:return[4,this.isUniqueRootEntity(e,t)];case 10:if(!v.sent())throw new $o;v.label=11;case 11:return[2]}}))}))},e.prototype.remove=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b,v,w,_=this;return Oe(this,(function(E){switch(E.label){case 0:Array.isArray(e)||(e=[e]),t=e[0].metadata,n=function(e){return _.queryRunner.connection.driver.escape(e)},r=this.getTableName(t.tablePath),i=n(t.nestedSetLeftColumn.databaseName),o=n(t.nestedSetRightColumn.databaseName),a=[];try{for(s=Ce(e),u=s.next();!u.done;u=s.next())c=u.value,(l=t.getEntityIdMap(c.entity))&&a.push(l)}catch(e){g={error:e}}finally{try{u&&!u.done&&(b=s.return)&&b.call(s)}finally{if(g)throw g.error}}return[4,this.getNestedSetIds(t,a)];case 1:f=E.sent(),E.label=2;case 2:E.trys.push([2,7,8,9]),h=Ce(f),d=h.next(),E.label=3;case 3:return d.done?[3,6]:(p=d.value,m=p.right-p.left+1,[4,this.queryRunner.query("UPDATE "+r+" SET "+i+" = CASE WHEN "+i+" > "+p.left+" THEN "+i+" - "+m+" ELSE "+i+" END, "+o+" = CASE WHEN "+o+" > "+p.right+" THEN "+o+" - "+m+" ELSE "+o+" END")]);case 4:E.sent(),E.label=5;case 5:return d=h.next(),[3,3];case 6:return[3,9];case 7:return y=E.sent(),v={error:y},[3,9];case 8:try{d&&!d.done&&(w=h.return)&&w.call(h)}finally{if(v)throw v.error}return[7];case 9:return[2]}}))}))},e.prototype.getNestedSetIds=function(e,t){var n={left:e.targetName+"."+e.nestedSetLeftColumn.propertyPath,right:e.targetName+"."+e.nestedSetRightColumn.propertyPath},r=this.queryRunner.manager.createQueryBuilder();return Object.entries(n).forEach((function(e){var t=ke(e,2),n=t[0],i=t[1];r.addSelect(i,n)})),r.from(e.target,e.targetName).whereInIds(t).orderBy(n.right,"DESC").getRawMany().then((function(e){var t,r,i,o,a=[];try{for(var s=Ce(e),u=s.next();!u.done;u=s.next()){var c=u.value,l={};try{for(var f=(i=void 0,Ce(Object.keys(n))),h=f.next();!h.done;h=f.next()){var d=h.value,p=c?c[d]:void 0;l[d]="string"==typeof p?parseInt(p):p}}catch(e){i={error:e}}finally{try{h&&!h.done&&(o=f.return)&&o.call(f)}finally{if(i)throw i.error}}a.push(l)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}return a}))},e.prototype.isUniqueRootEntity=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s,u=this;return Oe(this,(function(c){switch(c.label){case 0:return n=function(e){return u.queryRunner.connection.driver.escape(e)},r=this.getTableName(e.metadata.tablePath),i=[],o=e.metadata.treeParentRelation.joinColumns.map((function(e){var r=n(e.databaseName),o=e.getEntityValue(t);return null==o?r+" IS NULL":(i.push(o),r+" = "+u.queryRunner.connection.driver.createParameter("entity_"+e.databaseName,i.length-1))})).join(" AND "),a="count",[4,this.queryRunner.query("SELECT COUNT(1) AS "+n(a)+" FROM "+r+" WHERE "+o,i,!0)];case 1:return s=c.sent(),[2,0===parseInt(s.records[0][a])]}}))}))},e.prototype.getTableName=function(e){var t=this;return e.split(".").map((function(e){return""===e?e:t.queryRunner.connection.driver.escape(e)})).join(".")},e}(),Xo=function(){function e(e){this.queryRunner=e}return e.prototype.insert=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l=this;return Oe(this,(function(f){switch(f.label){case 0:return t={},e.metadata.closureJunctionTable.ancestorColumns.forEach((function(n){t[n.databaseName]=e.identifier})),e.metadata.closureJunctionTable.descendantColumns.forEach((function(n){t[n.databaseName]=e.identifier})),[4,this.queryRunner.manager.createQueryBuilder().insert().into(e.metadata.closureJunctionTable.tablePath).values(t).updateEntity(!1).callListeners(!1).execute()];case 1:return f.sent(),!(n=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(n=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),n?(r=function(e){return l.queryRunner.connection.driver.escape(e)},i=this.getTableName(e.metadata.closureJunctionTable.tablePath),o=[],a=e.metadata.closureJunctionTable.ancestorColumns.map((function(e){return r(e.databaseName)})),s=e.metadata.closureJunctionTable.descendantColumns.map((function(e){return r(e.databaseName)})),u=e.metadata.primaryColumns.map((function(t){return o.push(t.getEntityValue(e.insertedValueSet?e.insertedValueSet:e.entity)),l.queryRunner.connection.driver.createParameter("child_entity_"+t.databaseName,o.length-1)})),c=e.metadata.closureJunctionTable.descendantColumns.map((function(t){var i=r(t.databaseName),a=t.referencedColumn.getEntityValue(n);if(!a)throw new Rt(e.metadata.name);return o.push(a),i+" = "+l.queryRunner.connection.driver.createParameter("parent_entity_"+t.referencedColumn.databaseName,o.length-1)})),[4,this.queryRunner.query("INSERT INTO "+i+" ("+Be(Be([],ke(a)),ke(s)).join(", ")+") SELECT "+a.join(", ")+", "+u.join(", ")+" FROM "+i+" WHERE "+c.join(" AND "),o)]):[3,3];case 2:f.sent(),f.label=3;case 3:return[2]}}))}))},e.prototype.update=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b,v,w,_,E,S,x=this;return Oe(this,(function(T){switch(T.label){case 0:if(!(t=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity),!(n=e.databaseEntity)&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find((function(t){return Object.entries(e.identifier).every((function(e){var n=ke(e,2),r=n[0],i=n[1];return t[r]===i}))}))),void 0===n||void 0===t)return[2];if(r=e.metadata.treeParentRelation.getEntityValue(n),i=e.metadata.getEntityIdMap(r),o=e.metadata.getEntityIdMap(t),Ze.compareIds(i,o))return[2];a=function(e){return x.queryRunner.connection.driver.escape(e)},s=e.metadata.closureJunctionTable,u=s.ancestorColumns.map((function(e){return a(e.databaseName)})),c=s.descendantColumns.map((function(e){return a(e.databaseName)})),l=function(e,t){var n,r,i="sub"+t,o=e.createQueryBuilder().select(c.join(", ")).from(s.tablePath,i);try{for(var u=Ce(s.ancestorColumns),l=u.next();!l.done;l=u.next()){var f=l.value;o.andWhere(a(i)+"."+a(f.databaseName)+" = :value_"+f.referencedColumn.databaseName)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return e.createQueryBuilder().select(c.join(", ")).from("("+o.getQuery()+")",t).setParameters(o.getParameters()).getQuery()},f={};try{for(h=Ce(e.metadata.primaryColumns),d=h.next();!d.done;d=h.next())p=d.value,f["value_"+p.databaseName]=n[p.databaseName]}catch(e){E={error:e}}finally{try{d&&!d.done&&(S=h.return)&&S.call(h)}finally{if(E)throw E.error}}return[4,this.queryRunner.manager.createQueryBuilder().delete().from(s.tablePath).where((function(e){return"("+c.join(", ")+") IN ("+l(e,"descendant")+")"})).andWhere((function(e){return"("+u.join(", ")+") NOT IN ("+l(e,"ancestor")+")"})).setParameters(f).execute()];case 1:return T.sent(),t?(m=[],y=this.getTableName(s.tablePath),g=a("supertree"),b=a("subtree"),v=Be(Be([],ke(u.map((function(e){return g+"."+e})))),ke(c.map((function(e){return b+"."+e})))),w=e.metadata.closureJunctionTable.ancestorColumns.map((function(e){var t=a(e.databaseName),r=e.referencedColumn.getEntityValue(n);m.push(r);var i=x.queryRunner.connection.driver.createParameter("entity_"+e.referencedColumn.databaseName,m.length-1);return b+"."+t+" = "+i})),_=e.metadata.closureJunctionTable.descendantColumns.map((function(n){var r=a(n.databaseName),i=n.referencedColumn.getEntityValue(t);if(!i)throw new Rt(e.metadata.name);m.push(i);var o=x.queryRunner.connection.driver.createParameter("parent_entity_"+n.referencedColumn.databaseName,m.length-1);return g+"."+r+" = "+o})),[4,this.queryRunner.query("INSERT INTO "+y+" ("+Be(Be([],ke(u)),ke(c)).join(", ")+") SELECT "+v.join(", ")+" FROM "+y+" AS "+g+", "+y+" AS "+b+" WHERE "+Be(Be([],ke(w)),ke(_)).join(" AND "),m)]):[3,3];case 2:T.sent(),T.label=3;case 3:return[2]}}))}))},e.prototype.remove=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s=this;return Oe(this,(function(u){switch(u.label){case 0:return this.queryRunner.connection.driver instanceof Ve?(Array.isArray(e)||(e=[e]),t=function(e){return s.queryRunner.connection.driver.escape(e)},n=e.map((function(e){return e.identifier})),r=e[0].metadata.closureJunctionTable,o=(i=function(e){return e.map((function(e){var r=n.map((function(t){return t[e.referencedColumn.databaseName]}));return t(e.databaseName)+" IN ("+r.join(", ")+")"})).join(" AND ")})(r.ancestorColumns),a=i(r.descendantColumns),[4,this.queryRunner.manager.createQueryBuilder().delete().from(r.tablePath).where(o).orWhere(a).execute()]):[2];case 1:return u.sent(),[2]}}))}))},e.prototype.getTableName=function(e){var t=this;return e.split(".").map((function(e){return""===e?e:t.queryRunner.connection.driver.escape(e)})).join(".")},e}(),ea=function(){function e(e){this.queryRunner=e}return e.prototype.insert=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return!(t=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.insertedValueSet?e.parentSubject.insertedValueSet:e.parentSubject.entity),n=e.metadata.getEntityIdMap(t),r="",n?[4,this.getEntityPath(e,n)]:[3,2];case 1:r=a.sent(),a.label=2;case 2:return i=e.metadata.treeParentRelation.joinColumns.map((function(t){return t.referencedColumn.getEntityValue(e.insertedValueSet)})).join("_"),[4,this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set((o={},o[e.metadata.materializedPathColumn.propertyPath]=r+i+".",o)).where(e.identifier).execute()];case 3:return a.sent(),[2]}}))}))},e.prototype.update=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l;return Oe(this,(function(f){switch(f.label){case 0:return!(t=e.metadata.treeParentRelation.getEntityValue(e.entity))&&e.parentSubject&&e.parentSubject.entity&&(t=e.parentSubject.entity),!(n=e.databaseEntity)&&t&&(n=e.metadata.treeChildrenRelation.getEntityValue(t).find((function(t){return Object.entries(e.identifier).every((function(e){var n=ke(e,2),r=n[0],i=n[1];return t[r]===i}))}))),r=e.metadata.treeParentRelation.getEntityValue(n),i=e.metadata.getEntityIdMap(r),o=e.metadata.getEntityIdMap(t),Ze.compareIds(i,o)?[2]:(a="",o?[4,this.getEntityPath(e,o)]:[3,2]);case 1:a=f.sent(),f.label=2;case 2:return s="",i?[4,this.getEntityPath(e,i)]:[3,4];case 3:s=f.sent()||"",f.label=4;case 4:return u=e.metadata.treeParentRelation.joinColumns.map((function(e){return e.referencedColumn.getEntityValue(n)})).join("_"),c=e.metadata.materializedPathColumn.propertyPath,[4,this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set((l={},l[c]=function(){return"REPLACE("+c+", '"+s+u+".', '"+a+u+".')"},l)).where(c+" LIKE :path",{path:""+s+u+".%"}).execute()];case 5:return f.sent(),[2]}}))}))},e.prototype.getEntityPath=function(e,t){return this.queryRunner.manager.createQueryBuilder().select(e.metadata.targetName+"."+e.metadata.materializedPathColumn.propertyPath,"path").from(e.metadata.target,e.metadata.targetName).whereInIds(t).getRawOne().then((function(e){return e?e.path:void 0}))},e}(),ta=function(){function e(e,t,n){this.hasExecutableOperations=!1,this.insertSubjects=[],this.updateSubjects=[],this.removeSubjects=[],this.softRemoveSubjects=[],this.recoverSubjects=[],this.queryRunner=e,this.allSubjects=t,this.options=n,this.validate(),this.recompute()}return e.prototype.execute=function(){return Ne(this,void 0,void 0,(function(){var e;return Oe(this,(function(t){switch(t.label){case 0:return e=void 0,this.options&&!1===this.options.listeners?[3,2]:(e=this.broadcastBeforeEventsForAll()).promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:t.sent(),t.label=2;case 2:return e&&e.count>0&&(this.insertSubjects.forEach((function(e){return e.recompute()})),this.updateSubjects.forEach((function(e){return e.recompute()})),this.removeSubjects.forEach((function(e){return e.recompute()})),this.softRemoveSubjects.forEach((function(e){return e.recompute()})),this.recoverSubjects.forEach((function(e){return e.recompute()})),this.recompute()),this.insertSubjects=new Qo(this.insertSubjects).sort("insert"),[4,this.executeInsertOperations()];case 3:return t.sent(),this.updateSubjects=this.allSubjects.filter((function(e){return e.mustBeUpdated})),[4,this.executeUpdateOperations()];case 4:return t.sent(),this.removeSubjects=new Qo(this.removeSubjects).sort("delete"),[4,this.executeRemoveOperations()];case 5:return t.sent(),this.softRemoveSubjects=this.allSubjects.filter((function(e){return e.mustBeSoftRemoved})),[4,this.executeSoftRemoveOperations()];case 6:return t.sent(),this.recoverSubjects=this.allSubjects.filter((function(e){return e.mustBeRecovered})),[4,this.executeRecoverOperations()];case 7:return t.sent(),[4,this.updateSpecialColumnsInPersistedEntities()];case 8:return t.sent(),this.options&&!1===this.options.listeners?[3,10]:(e=this.broadcastAfterEventsForAll()).promises.length>0?[4,Promise.all(e.promises)]:[3,10];case 9:t.sent(),t.label=10;case 10:return[2]}}))}))},e.prototype.validate=function(){this.allSubjects.forEach((function(e){if(e.mustBeUpdated&&e.mustBeRemoved)throw new Gt(e)}))},e.prototype.recompute=function(){(new Zo).compute(this.allSubjects),this.insertSubjects=this.allSubjects.filter((function(e){return e.mustBeInserted})),this.updateSubjects=this.allSubjects.filter((function(e){return e.mustBeUpdated})),this.removeSubjects=this.allSubjects.filter((function(e){return e.mustBeRemoved})),this.softRemoveSubjects=this.allSubjects.filter((function(e){return e.mustBeSoftRemoved})),this.recoverSubjects=this.allSubjects.filter((function(e){return e.mustBeRecovered})),this.hasExecutableOperations=this.insertSubjects.length>0||this.updateSubjects.length>0||this.removeSubjects.length>0||this.softRemoveSubjects.length>0||this.recoverSubjects.length>0},e.prototype.broadcastBeforeEventsForAll=function(){var e=this,t=new vn;return this.insertSubjects.length&&this.insertSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeInsertEvent(t,n.metadata,n.entity)})),this.updateSubjects.length&&this.updateSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),this.removeSubjects.length&&this.removeSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeRemoveEvent(t,n.metadata,n.entity,n.databaseEntity)})),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),this.recoverSubjects.length&&this.recoverSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastBeforeUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),t},e.prototype.broadcastAfterEventsForAll=function(){var e=this,t=new vn;return this.insertSubjects.length&&this.insertSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterInsertEvent(t,n.metadata,n.entity)})),this.updateSubjects.length&&this.updateSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),this.removeSubjects.length&&this.removeSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterRemoveEvent(t,n.metadata,n.entity,n.databaseEntity)})),this.softRemoveSubjects.length&&this.softRemoveSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),this.recoverSubjects.length&&this.recoverSubjects.forEach((function(n){return e.queryRunner.broadcaster.broadcastAfterUpdateEvent(t,n.metadata,n.entity,n.databaseEntity,n.diffColumns,n.diffRelations)})),t},e.prototype.executeInsertOperations=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u,c,l,f=this;return Oe(this,(function(h){switch(h.label){case 0:e=ke(this.groupBulkSubjects(this.insertSubjects,"insert"),2),t=e[0],n=e[1],r=function(e){var n,r,o,a,s,u,c,l,h,d,p,m,y;return Oe(this,(function(g){switch(g.label){case 0:return n=t[e],r=[],o=[],a=[],i.queryRunner.connection.driver instanceof De?n.forEach((function(e){e.metadata.createDateColumn&&e.entity&&(e.entity[e.metadata.createDateColumn.databaseName]=new Date),e.metadata.updateDateColumn&&e.entity&&(e.entity[e.metadata.updateDateColumn.databaseName]=new Date),e.createValueSetAndPopChangeMap(),o.push(e),r.push(e.entity)})):i.queryRunner.connection.driver instanceof He?n.forEach((function(e){a.push(e)})):n.forEach((function(e){0===e.changeMaps.length||e.metadata.treeType||f.queryRunner.connection.driver instanceof He||f.queryRunner.connection.driver instanceof ze?a.push(e):(o.push(e),r.push(e.createValueSetAndPopChangeMap()))})),i.queryRunner instanceof je?[4,i.queryRunner.manager.insert(n[0].metadata.target,r)]:[3,2];case 1:return s=g.sent(),n.forEach((function(e,t){e.identifier=s.identifiers[t],e.generatedMap=s.generatedMaps[t],e.insertedValueSet=r[t]})),[3,12];case 2:return r.length>0?[4,i.queryRunner.manager.createQueryBuilder().insert().into(n[0].metadata.target).values(r).updateEntity(!i.options||!1!==i.options.reload).callListeners(!1).execute()]:[3,4];case 3:u=g.sent(),o.forEach((function(e,t){e.identifier=u.identifiers[t],e.generatedMap=u.generatedMaps[t],e.insertedValueSet=r[t]})),g.label=4;case 4:if(!(a.length>0))return[3,12];c=function(e){return Oe(this,(function(t){switch(t.label){case 0:return e.insertedValueSet=e.createValueSetAndPopChangeMap(),"nested-set"!==e.metadata.treeType?[3,2]:[4,new Yo(i.queryRunner).insert(e)];case 1:t.sent(),t.label=2;case 2:return[4,i.queryRunner.manager.createQueryBuilder().insert().into(e.metadata.target).values(e.insertedValueSet).updateEntity(!i.options||!1!==i.options.reload).callListeners(!1).execute().then((function(t){e.identifier=t.identifiers[0],e.generatedMap=t.generatedMaps[0]}))];case 3:return t.sent(),"closure-table"!==e.metadata.treeType?[3,5]:[4,new Xo(i.queryRunner).insert(e)];case 4:return t.sent(),[3,7];case 5:return"materialized-path"!==e.metadata.treeType?[3,7]:[4,new ea(i.queryRunner).insert(e)];case 6:t.sent(),t.label=7;case 7:return[2]}}))},g.label=5;case 5:g.trys.push([5,10,11,12]),m=void 0,l=Ce(a),h=l.next(),g.label=6;case 6:return h.done?[3,9]:(d=h.value,[5,c(d)]);case 7:g.sent(),g.label=8;case 8:return h=l.next(),[3,6];case 9:return[3,12];case 10:return p=g.sent(),m={error:p},[3,12];case 11:try{h&&!h.done&&(y=l.return)&&y.call(l)}finally{if(m)throw m.error}return[7];case 12:return n.forEach((function(e){e.generatedMap&&e.metadata.columns.forEach((function(t){var n=t.getEntityValue(e.generatedMap);if(null!=n){var r=f.queryRunner.connection.driver.prepareHydratedValue(n,t);t.setEntityValue(e.generatedMap,r)}}))})),[2]}}))},i=this,h.label=1;case 1:h.trys.push([1,6,7,8]),o=Ce(n),a=o.next(),h.label=2;case 2:return a.done?[3,5]:(s=a.value,[5,r(s)]);case 3:h.sent(),h.label=4;case 4:return a=o.next(),[3,2];case 5:return[3,8];case 6:return u=h.sent(),c={error:u},[3,8];case 7:try{a&&!a.done&&(l=o.return)&&l.call(o)}finally{if(c)throw c.error}return[7];case 8:return[2]}}))}))},e.prototype.executeUpdateOperations=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u,c=this;return Oe(this,(function(l){switch(l.label){case 0:e=function(e){return Ne(c,void 0,void 0,(function(){var t,n,r,i,o,a=this;return Oe(this,(function(s){switch(s.label){case 0:if(!e.identifier)throw new lt(e);return this.queryRunner instanceof je?(t=this.cloneMongoSubjectEntity(e),e.metadata.objectIdColumn&&e.metadata.objectIdColumn.propertyName&&delete t[e.metadata.objectIdColumn.propertyName],e.metadata.createDateColumn&&e.metadata.createDateColumn.propertyName&&delete t[e.metadata.createDateColumn.propertyName],e.metadata.updateDateColumn&&e.metadata.updateDateColumn.propertyName&&(t[e.metadata.updateDateColumn.propertyName]=new Date),[4,this.queryRunner.manager.update(e.metadata.target,e.identifier,t)]):[3,2];case 1:return s.sent(),[3,11];case 2:switch(n=e.createValueSetAndPopChangeMap(),e.metadata.treeType){case"nested-set":return[3,3];case"closure-table":return[3,5];case"materialized-path":return[3,7]}return[3,9];case 3:return[4,new Yo(this.queryRunner).update(e)];case 4:return s.sent(),[3,9];case 5:return[4,new Xo(this.queryRunner).update(e)];case 6:return s.sent(),[3,9];case 7:return[4,new ea(this.queryRunner).update(e)];case 8:return s.sent(),[3,9];case 9:return r=this.queryRunner.manager.createQueryBuilder().update(e.metadata.target).set(n).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1),e.entity?r.whereEntity(e.identifier):r.where(e.identifier),[4,r.execute()];case 10:i=s.sent(),(o=i.generatedMaps[0])&&(e.metadata.columns.forEach((function(e){var t=e.getEntityValue(o);if(null!=t){var n=a.queryRunner.connection.driver.prepareHydratedValue(t,e);e.setEntityValue(o,n)}})),e.generatedMap||(e.generatedMap={}),Object.assign(e.generatedMap,o)),s.label=11;case 11:return[2]}}))}))},t=[],n=[];try{for(r=Ce(this.updateSubjects),i=r.next();!i.done;i=r.next())"nested-set"===(o=i.value).metadata.treeType?t.push(o):n.push(o)}catch(e){s={error:e}}finally{try{i&&!i.done&&(u=r.return)&&u.call(r)}finally{if(s)throw s.error}}return a=new Promise((function(n,r){return Ne(c,void 0,void 0,(function(){var i,o,a,s,u,c,l;return Oe(this,(function(f){switch(f.label){case 0:f.trys.push([0,7,8,9]),i=Ce(t),o=i.next(),f.label=1;case 1:if(o.done)return[3,6];a=o.value,f.label=2;case 2:return f.trys.push([2,4,,5]),[4,e(a)];case 3:return f.sent(),[3,5];case 4:return s=f.sent(),r(s),[3,5];case 5:return o=i.next(),[3,1];case 6:return[3,9];case 7:return u=f.sent(),c={error:u},[3,9];case 8:try{o&&!o.done&&(l=i.return)&&l.call(i)}finally{if(c)throw c.error}return[7];case 9:return n(),[2]}}))}))})),[4,Promise.all(Be(Be([],ke(n.map(e))),[a]))];case 1:return l.sent(),[2]}}))}))},e.prototype.executeRemoveOperations=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u,c,l;return Oe(this,(function(f){switch(f.label){case 0:e=ke(this.groupBulkSubjects(this.removeSubjects,"delete"),2),t=e[0],n=e[1],f.label=1;case 1:f.trys.push([1,13,14,15]),r=Ce(n),i=r.next(),f.label=2;case 2:return i.done?[3,12]:(o=i.value,a=t[o],s=a.map((function(e){if(!e.identifier)throw new lt(e);return e.identifier})),this.queryRunner instanceof je?[4,this.queryRunner.manager.delete(a[0].metadata.target,s)]:[3,4]);case 3:return f.sent(),[3,11];case 4:switch(a[0].metadata.treeType){case"nested-set":return[3,5];case"closure-table":return[3,7]}return[3,9];case 5:return[4,new Yo(this.queryRunner).remove(a)];case 6:return f.sent(),[3,9];case 7:return[4,new Xo(this.queryRunner).remove(a)];case 8:return f.sent(),[3,9];case 9:return[4,this.queryRunner.manager.createQueryBuilder().delete().from(a[0].metadata.target).where(s).callListeners(!1).execute()];case 10:f.sent(),f.label=11;case 11:return i=r.next(),[3,2];case 12:return[3,15];case 13:return u=f.sent(),c={error:u},[3,15];case 14:try{i&&!i.done&&(l=r.return)&&l.call(r)}finally{if(c)throw c.error}return[7];case 15:return[2]}}))}))},e.prototype.cloneMongoSubjectEntity=function(e){var t,n,r={};if(e.entity)try{for(var i=Ce(e.metadata.columns),o=i.next();!o.done;o=i.next()){var a=o.value;Ze.mergeDeep(r,a.getEntityValueMap(e.entity))}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r},e.prototype.executeSoftRemoveOperations=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){switch(t.label){case 0:return[4,Promise.all(this.softRemoveSubjects.map((function(t){return Ne(e,void 0,void 0,(function(){var e,n,r,i=this;return Oe(this,(function(o){switch(o.label){case 0:if(!t.identifier)throw new lt(t);return this.queryRunner instanceof je?(n=this.cloneMongoSubjectEntity(t),t.metadata.objectIdColumn&&t.metadata.objectIdColumn.propertyName&&delete n[t.metadata.objectIdColumn.propertyName],t.metadata.createDateColumn&&t.metadata.createDateColumn.propertyName&&delete n[t.metadata.createDateColumn.propertyName],t.metadata.updateDateColumn&&t.metadata.updateDateColumn.propertyName&&(n[t.metadata.updateDateColumn.propertyName]=new Date),t.metadata.deleteDateColumn&&t.metadata.deleteDateColumn.propertyName&&(n[t.metadata.deleteDateColumn.propertyName]=new Date),[4,this.queryRunner.manager.update(t.metadata.target,t.identifier,n)]):[3,2];case 1:return e=o.sent(),[3,4];case 2:return r=this.queryRunner.manager.createQueryBuilder().softDelete().from(t.metadata.target).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1),t.entity?r.whereEntity(t.identifier):r.where(t.identifier),[4,r.execute()];case 3:e=o.sent(),o.label=4;case 4:return t.generatedMap=e.generatedMaps[0],t.generatedMap&&t.metadata.columns.forEach((function(e){var n=e.getEntityValue(t.generatedMap);if(null!=n){var r=i.queryRunner.connection.driver.prepareHydratedValue(n,e);e.setEntityValue(t.generatedMap,r)}})),[2]}}))}))})))];case 1:return t.sent(),[2]}}))}))},e.prototype.executeRecoverOperations=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){switch(t.label){case 0:return[4,Promise.all(this.recoverSubjects.map((function(t){return Ne(e,void 0,void 0,(function(){var e,n,r,i=this;return Oe(this,(function(o){switch(o.label){case 0:if(!t.identifier)throw new lt(t);return this.queryRunner instanceof je?(n=this.cloneMongoSubjectEntity(t),t.metadata.objectIdColumn&&t.metadata.objectIdColumn.propertyName&&delete n[t.metadata.objectIdColumn.propertyName],t.metadata.createDateColumn&&t.metadata.createDateColumn.propertyName&&delete n[t.metadata.createDateColumn.propertyName],t.metadata.updateDateColumn&&t.metadata.updateDateColumn.propertyName&&(n[t.metadata.updateDateColumn.propertyName]=new Date),t.metadata.deleteDateColumn&&t.metadata.deleteDateColumn.propertyName&&(n[t.metadata.deleteDateColumn.propertyName]=null),[4,this.queryRunner.manager.update(t.metadata.target,t.identifier,n)]):[3,2];case 1:return e=o.sent(),[3,4];case 2:return r=this.queryRunner.manager.createQueryBuilder().restore().from(t.metadata.target).updateEntity(!this.options||!1!==this.options.reload).callListeners(!1),t.entity?r.whereEntity(t.identifier):r.where(t.identifier),[4,r.execute()];case 3:e=o.sent(),o.label=4;case 4:return t.generatedMap=e.generatedMaps[0],t.generatedMap&&t.metadata.columns.forEach((function(e){var n=e.getEntityValue(t.generatedMap);if(null!=n){var r=i.queryRunner.connection.driver.prepareHydratedValue(n,e);e.setEntityValue(t.generatedMap,r)}})),[2]}}))}))})))];case 1:return t.sent(),[2]}}))}))},e.prototype.updateSpecialColumnsInPersistedEntities=function(){var e=this;this.insertSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.insertSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.updateSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.softRemoveSubjects),this.updateSubjects.length&&this.updateSpecialColumnsInInsertedAndUpdatedEntities(this.recoverSubjects),this.removeSubjects.length&&this.removeSubjects.forEach((function(e){e.entity&&e.metadata.primaryColumns.forEach((function(t){t.setEntityValue(e.entity,void 0)}))})),this.allSubjects.forEach((function(t){t.entity&&(t.metadata.relationIds.forEach((function(e){e.setValue(t.entity)})),e.queryRunner instanceof je&&t.metadata.objectIdColumn&&t.metadata.objectIdColumn.databaseName&&t.metadata.objectIdColumn.databaseName!==t.metadata.objectIdColumn.propertyName&&delete t.entity[t.metadata.objectIdColumn.databaseName])}))},e.prototype.updateSpecialColumnsInInsertedAndUpdatedEntities=function(e){var t=this;e.forEach((function(e){e.entity&&(e.metadata.columns.forEach((function(t){if(!(e.metadata.childEntityMetadatas.length>0&&-1!==e.metadata.childEntityMetadatas.map((function(e){return e.target})).indexOf(t.target)||t.isVirtual)){if(t.isNullable)void 0===t.getEntityValue(e.entity)&&t.setEntityValue(e.entity,null);e.updatedRelationMaps.length>0&&e.updatedRelationMaps.forEach((function(t){t.relation.joinColumns.forEach((function(n){!0!==n.isVirtual&&n.setEntityValue(e.entity,t.value instanceof Object?n.referencedColumn.getEntityValue(t.value):t.value)}))}))}})),e.generatedMap&&t.queryRunner.manager.merge(e.metadata.target,e.entity,e.generatedMap))}))},e.prototype.groupBulkSubjects=function(e,t){var n={},r=[],i="delete"===t||this.queryRunner.connection.driver.isReturningSqlSupported();return e.forEach((function(e,t){var o=i||e.metadata.isJunction?e.metadata.name:e.metadata.name+"_"+t;n[o]?n[o].push(e):(n[o]=[e],r.push(o))})),[n,r]},e}(),na=o("9oHsE").Buffer,ra=function(){function e(e){var t;this.identifier=void 0,this.entityWithFulfilledIds=void 0,this.databaseEntityLoaded=!1,this.changeMaps=[],this.canBeInserted=!1,this.canBeUpdated=!1,this.mustBeRemoved=!1,this.canBeSoftRemoved=!1,this.canBeRecovered=!1,this.updatedRelationMaps=[],this.diffColumns=[],this.diffRelations=[],this.metadata=e.metadata,this.entity=e.entity,this.parentSubject=e.parentSubject,void 0!==e.canBeInserted&&(this.canBeInserted=e.canBeInserted),void 0!==e.canBeUpdated&&(this.canBeUpdated=e.canBeUpdated),void 0!==e.mustBeRemoved&&(this.mustBeRemoved=e.mustBeRemoved),void 0!==e.canBeSoftRemoved&&(this.canBeSoftRemoved=e.canBeSoftRemoved),void 0!==e.canBeRecovered&&(this.canBeRecovered=e.canBeRecovered),void 0!==e.identifier&&(this.identifier=e.identifier),void 0!==e.changeMaps&&(t=this.changeMaps).push.apply(t,Be([],ke(e.changeMaps))),this.recompute()}return Object.defineProperty(e.prototype,"mustBeInserted",{get:function(){return this.canBeInserted&&!this.databaseEntity},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mustBeUpdated",{get:function(){return this.canBeUpdated&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)&&this.changeMaps.length>0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mustBeSoftRemoved",{get:function(){return this.canBeSoftRemoved&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mustBeRecovered",{get:function(){return this.canBeRecovered&&this.identifier&&(!1===this.databaseEntityLoaded||this.databaseEntityLoaded&&this.databaseEntity)},enumerable:!1,configurable:!0}),e.prototype.createValueSetAndPopChangeMap=function(){var t=this,n=[],r=this.changeMaps.reduce((function(r,i){var o,a=i.value;if(a instanceof e&&(a=a.insertedValueSet?a.insertedValueSet:a.entity),t.metadata.isJunction&&i.column)o=i.column.createValueMap(i.column.referencedColumn.getEntityValue(a));else if(i.column)o=i.column.createValueMap(a);else if(i.relation)if(a instanceof Object&&!(a instanceof na)){var s=i.relation.getRelationIdMap(a);if(void 0===s)return n.push(i),t.canBeUpdated=!0,r;o=i.relation.createValueMap(s),t.updatedRelationMaps.push({relation:i.relation,value:s})}else o=i.relation.createValueMap(a),t.updatedRelationMaps.push({relation:i.relation,value:a});return Ze.mergeDeep(r,o),r}),{});return this.changeMaps=n,r},e.prototype.recompute=function(){var e=this;this.entity?(this.entityWithFulfilledIds=Object.assign({},this.entity),this.parentSubject&&this.metadata.primaryColumns.forEach((function(t){if(t.relationMetadata&&t.relationMetadata.inverseEntityMetadata===e.parentSubject.metadata){var n=t.referencedColumn.getEntityValue(e.parentSubject.entity);t.setEntityValue(e.entityWithFulfilledIds,n)}})),this.identifier=this.metadata.getEntityIdMap(this.entityWithFulfilledIds)):this.databaseEntity&&(this.identifier=this.metadata.getEntityIdMap(this.databaseEntity))},e}(),ia=function(){function e(e){this.subjects=e}return e.prototype.build=function(){var e=this;this.subjects.forEach((function(t){t.metadata.oneToManyRelations.forEach((function(n){!1!==n.persistenceEnabled&&e.buildForSubjectRelation(t,n)}))}))},e.prototype.buildForSubjectRelation=function(e,t){var n=this,r=[];e.databaseEntity&&(r=t.getEntityValue(e.databaseEntity));var i=t.getEntityValue(e.entity);if(null===i&&(i=[]),void 0!==i){var o=[];i.forEach((function(i){var a=t.inverseEntityMetadata.getEntityIdMap(i),s=n.subjects.find((function(e){return e.entity===i}));if(s&&(a=s.identifier),a){r.find((function(e){return Ze.compareIds(a,e)}))||(s||(s=new ra({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:a}),n.subjects.push(s)),s.changeMaps.push({relation:t.inverseRelation,value:e})),o.push(a)}else{if(!s)return;s.changeMaps.push({relation:t.inverseRelation,value:e})}})),yn.difference(r,o).forEach((function(r){var i=new ra({metadata:t.inverseEntityMetadata,parentSubject:e,identifier:r});t.inverseRelation&&"nullify"!==t.inverseRelation.orphanedRowAction?"delete"===t.inverseRelation.orphanedRowAction&&(i.mustBeRemoved=!0):(i.canBeUpdated=!0,i.changeMaps=[{relation:t.inverseRelation,value:null}]),n.subjects.push(i)}))}},e}(),oa=function(){function e(e){this.subjects=e}return e.prototype.build=function(){var e=this;this.subjects.forEach((function(t){t.metadata.oneToOneRelations.forEach((function(n){n.isOwning||!1===n.persistenceEnabled||e.buildForSubjectRelation(t,n)}))}))},e.prototype.buildForSubjectRelation=function(e,t){var n=void 0;e.databaseEntity&&(n=t.getEntityValue(e.databaseEntity));var r=t.getEntityValue(e.entity);if(void 0!==r)if(null!==r){var i=t.inverseEntityMetadata.getEntityIdMap(r),o=this.subjects.find((function(e){return!!e.entity&&e.entity===r}));if(o&&(i=o.identifier),!i){if(!o)return;o.changeMaps.push({relation:t.inverseRelation,value:e})}n&&Ze.compareIds(i,n)||(o||(o=new ra({metadata:t.inverseEntityMetadata,canBeUpdated:!0,identifier:i}),this.subjects.push(o)),o.changeMaps.push({relation:t.inverseRelation,value:e}))}else if(n){var a=new ra({metadata:t.inverseEntityMetadata,parentSubject:e,canBeUpdated:!0,identifier:n,changeMaps:[{relation:t.inverseRelation,value:null}]});this.subjects.push(a)}},e}(),aa=function(){function e(e){this.subjects=e}return e.prototype.build=function(){var e=this;this.subjects.forEach((function(t){t.entity&&t.metadata.manyToManyRelations.forEach((function(n){!1!==n.persistenceEnabled&&e.buildForSubjectRelation(t,n)}))}))},e.prototype.buildForAllRemoval=function(e){var t=this;e.databaseEntity&&e.metadata.manyToManyRelations.forEach((function(n){!1!==n.persistenceEnabled&&n.getEntityValue(e.databaseEntity).forEach((function(r){var i=new ra({metadata:n.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:t.buildJunctionIdentifier(e,n,r)});t.subjects.push(i)}))}))},e.prototype.buildForSubjectRelation=function(e,t){var n=this,r=[];e.databaseEntity&&(r=t.getEntityValue(e.databaseEntity));var i=t.getEntityValue(e.entity);if(null===i&&(i=[]),Array.isArray(i)){i.forEach((function(i){var o=t.inverseEntityMetadata.getEntityIdMap(i),a=n.subjects.find((function(e){return e.entity===i}));if((a&&(o=a.identifier),o||a)&&!r.find((function(e){return Ze.compareIds(e,o)}))){var s=t.isOwning?e:a||i,u=t.isOwning?a||i:e,c=new ra({metadata:t.junctionEntityMetadata,parentSubject:e,canBeInserted:!0});n.subjects.push(c),t.junctionEntityMetadata.ownerColumns.forEach((function(e){c.changeMaps.push({column:e,value:s})})),t.junctionEntityMetadata.inverseColumns.forEach((function(e){c.changeMaps.push({column:e,value:u})}))}}));var o=[];i.forEach((function(e){var r=t.inverseEntityMetadata.getEntityIdMap(e),i=n.subjects.find((function(t){return t.entity===e}));i&&(r=i.identifier),null!=r&&o.push(r)})),r.filter((function(e){return!o.find((function(t){return Ze.compareIds(t,e)}))})).forEach((function(r){var i=new ra({metadata:t.junctionEntityMetadata,parentSubject:e,mustBeRemoved:!0,identifier:n.buildJunctionIdentifier(e,t,r)});n.subjects.push(i)}))}},e.prototype.buildJunctionIdentifier=function(e,t,n){var r=t.isOwning?e.entity:n,i=t.isOwning?n:e.entity,o={};return t.junctionEntityMetadata.ownerColumns.forEach((function(e){Ze.mergeDeep(o,e.createValueMap(e.referencedColumn.getEntityValue(r)))})),t.junctionEntityMetadata.inverseColumns.forEach((function(e){Ze.mergeDeep(o,e.createValueMap(e.referencedColumn.getEntityValue(i)))})),o},e}(),sa=function(){function e(e,t){this.queryRunner=e,this.subjects=t}return e.prototype.load=function(e){return Ne(this,void 0,void 0,(function(){var t,n=this;return Oe(this,(function(r){switch(r.label){case 0:return t=this.groupByEntityTargets().map((function(t){return Ne(n,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l=this;return Oe(this,(function(f){switch(f.label){case 0:return n=[],r=[],t.subjects.forEach((function(e){!e.databaseEntity&&e.identifier&&(n.push(e.identifier),r.push(e))})),n.length?(i=[],"save"===e||"soft-remove"===e||"recover"===e?t.subjects.forEach((function(e){e.metadata.relations.forEach((function(t){void 0!==t.getEntityValue(e.entityWithFulfilledIds)&&-1===i.indexOf(t.propertyPath)&&i.push(t.propertyPath)}))})):i.push.apply(i,Be([],ke(t.subjects[0].metadata.manyToManyRelations.map((function(e){return e.propertyPath}))))),o={loadEagerRelations:!1,loadRelationIds:{relations:i,disableMixedMap:!0},withDeleted:!0},[4,this.queryRunner.manager.getRepository(t.target).findByIds(n,o)]):[2];case 1:f.sent().forEach((function(e){l.findByPersistEntityLike(t.target,e).forEach((function(t){t.databaseEntity=e,t.identifier||(t.identifier=t.metadata.hasAllPrimaryKeys(e)?t.metadata.getEntityIdMap(e):void 0)}))}));try{for(a=Ce(r),s=a.next();!s.done;s=a.next())s.value.databaseEntityLoaded=!0}catch(e){u={error:e}}finally{try{s&&!s.done&&(c=a.return)&&c.call(a)}finally{if(u)throw u.error}}return[2]}}))}))})),[4,Promise.all(t)];case 1:return r.sent(),[2]}}))}))},e.prototype.findByPersistEntityLike=function(e,t){return this.subjects.filter((function(n){return!!n.entity&&(n.entity===t||n.metadata.target===e&&n.metadata.compareEntities(n.entityWithFulfilledIds,t))}))},e.prototype.groupByEntityTargets=function(){return this.subjects.reduce((function(e,t){var n=e.find((function(e){return e.target===t.metadata.target}));return n||(n={target:t.metadata.target,subjects:[]},e.push(n)),n.subjects.push(t),e}),[])},e}(),ua=function(){function e(e){this.allSubjects=e}return e.prototype.build=function(e,t){var n=this;e.metadata.extractRelationValuesFromEntity(e.entity,e.metadata.relations).forEach((function(r){var i=ke(r,3),o=i[0],a=i[1],s=i[2];if(null!=a&&(o.isCascadeInsert||o.isCascadeUpdate||o.isCascadeSoftRemove||o.isCascadeRecover)&&a instanceof Object){var u=n.findByPersistEntityLike(s.target,a);if(u)return!1===u.canBeInserted&&(u.canBeInserted=!0===o.isCascadeInsert&&"save"===t),!1===u.canBeUpdated&&(u.canBeUpdated=!0===o.isCascadeUpdate&&"save"===t),!1===u.canBeSoftRemoved&&(u.canBeSoftRemoved=!0===o.isCascadeSoftRemove&&"soft-remove"===t),void(!1===u.canBeRecovered&&(u.canBeRecovered=!0===o.isCascadeRecover&&"recover"===t));var c=new ra({metadata:s,parentSubject:e,entity:a,canBeInserted:!0===o.isCascadeInsert&&"save"===t,canBeUpdated:!0===o.isCascadeUpdate&&"save"===t,canBeSoftRemoved:!0===o.isCascadeSoftRemove&&"soft-remove"===t,canBeRecovered:!0===o.isCascadeRecover&&"recover"===t});n.allSubjects.push(c),n.build(c,t)}}))},e.prototype.findByPersistEntityLike=function(e,t){return this.allSubjects.find((function(n){return!!n.entity&&(n.entity===t||n.metadata.target===e&&n.metadata.compareEntities(n.entityWithFulfilledIds,t))}))},e}(),ca=function(){function e(e,t,n,r,i,o){this.connection=e,this.queryRunner=t,this.mode=n,this.target=r,this.entity=i,this.options=o}return e.prototype.execute=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u,c,l,f,h,d=this;return Oe(this,(function(p){switch(p.label){case 0:return this.entity&&"object"==typeof this.entity?[4,Promise.resolve()]:[2,Promise.reject(new St(this.mode,this.entity))];case 1:p.sent(),e=this.queryRunner||this.connection.createQueryRunner(),t=e.data,this.options&&this.options.data&&(e.data=this.options.data),p.label=2;case 2:return p.trys.push([2,,22,25]),n=Array.isArray(this.entity)?this.entity:[this.entity],r=this.options&&this.options.chunk&&this.options.chunk>0?Ze.chunk(n,this.options.chunk):[n],[4,Promise.all(r.map((function(t){return Ne(d,void 0,void 0,(function(){var n,r,i=this;return Oe(this,(function(o){switch(o.label){case 0:return n=[],t.forEach((function(e){var t=i.target?i.target:e.constructor;if(t===Object)throw new pt(i.mode);n.push(new ra({metadata:i.connection.getMetadata(t),entity:e,canBeInserted:"save"===i.mode,canBeUpdated:"save"===i.mode,mustBeRemoved:"remove"===i.mode,canBeSoftRemoved:"soft-remove"===i.mode,canBeRecovered:"recover"===i.mode}))})),r=new ua(n),n.forEach((function(e){r.build(e,i.mode)})),[4,new sa(e,n).load(this.mode)];case 1:return o.sent(),"save"===this.mode||"soft-remove"===this.mode||"recover"===this.mode?(new ia(n).build(),new oa(n).build(),new aa(n).build()):n.forEach((function(e){e.mustBeRemoved&&new aa(n).buildForAllRemoval(e)})),[2,new ta(e,n,this.options)]}}))}))})))];case 3:if(i=p.sent(),0===(o=i.filter((function(e){return e.hasExecutableOperations}))).length)return[2];a=!1,p.label=4;case 4:return p.trys.push([4,16,,21]),e.isTransactionActive?[3,6]:this.options&&!1===this.options.transaction?[3,6]:(a=!0,[4,e.startTransaction()]);case 5:p.sent(),p.label=6;case 6:p.trys.push([6,11,12,13]),s=Ce(o),u=s.next(),p.label=7;case 7:return u.done?[3,10]:[4,u.value.execute()];case 8:p.sent(),p.label=9;case 9:return u=s.next(),[3,7];case 10:return[3,13];case 11:return c=p.sent(),f={error:c},[3,13];case 12:try{u&&!u.done&&(h=s.return)&&h.call(s)}finally{if(f)throw f.error}return[7];case 13:return!0!==a?[3,15]:[4,e.commitTransaction()];case 14:p.sent(),p.label=15;case 15:return[3,21];case 16:if(l=p.sent(),!a)return[3,20];p.label=17;case 17:return p.trys.push([17,19,,20]),[4,e.rollbackTransaction()];case 18:return p.sent(),[3,20];case 19:return p.sent(),[3,20];case 20:throw l;case 21:return[3,25];case 22:return e.data=t,this.queryRunner?[3,24]:[4,e.release()];case 23:p.sent(),p.label=24;case 24:return[7];case 25:return[2]}}))}))},e}(),la=function(){function e(e,t){this.repositories=[],this.plainObjectToEntityTransformer=new Ko,this.connection=e,t&&(this.queryRunner=t,ut.assign(this.queryRunner,{manager:this}))}return e.prototype.transaction=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:if(n="string"==typeof e?e:void 0,!(r="function"==typeof e?e:t))throw new rt("Transaction method requires callback in second paramter if isolation level is supplied.");if(this.connection.driver instanceof De)throw new rt("Transactions aren't supported by MongoDB.");if(this.queryRunner&&this.queryRunner.isReleased)throw new At;if(this.queryRunner&&this.queryRunner.isTransactionActive)throw new rt("Cannot start transaction because its already started");i=this.queryRunner||this.connection.createQueryRunner(),s.label=1;case 1:return s.trys.push([1,8,13,16]),n?[4,i.startTransaction(n)]:[3,3];case 2:return s.sent(),[3,5];case 3:return[4,i.startTransaction()];case 4:s.sent(),s.label=5;case 5:return[4,r(i.manager)];case 6:return o=s.sent(),[4,i.commitTransaction()];case 7:return s.sent(),[2,o];case 8:a=s.sent(),s.label=9;case 9:return s.trys.push([9,11,,12]),[4,i.rollbackTransaction()];case 10:return s.sent(),[3,12];case 11:return s.sent(),[3,12];case 12:throw a;case 13:return this.queryRunner?[3,15]:[4,i.release()];case 14:s.sent(),s.label=15;case 15:return[7];case 16:return[2]}}))}))},e.prototype.query=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(n){return[2,this.connection.query(e,t,this.queryRunner)]}))}))},e.prototype.createQueryBuilder=function(e,t,n){return t?this.connection.createQueryBuilder(e,t,n||this.queryRunner):this.connection.createQueryBuilder(e||n||this.queryRunner)},e.prototype.hasId=function(e,t){var n=2===arguments.length?e:e.constructor,r=2===arguments.length?t:e,i=this.connection.getMetadata(n);return i.hasId(r)},e.prototype.getId=function(e,t){var n=2===arguments.length?e:e.constructor,r=2===arguments.length?t:e,i=this.connection.getMetadata(n);return i.getEntityIdMixedMap(r)},e.prototype.create=function(e,t){var n=this,r=this.connection.getMetadata(e);if(!t)return r.create(this.queryRunner);if(Array.isArray(t))return t.map((function(t){return n.create(e,t)}));var i=r.create(this.queryRunner);return this.plainObjectToEntityTransformer.transform(i,t,r,!0),i},e.prototype.merge=function(e,t){for(var n=this,r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=this.connection.getMetadata(e);return r.forEach((function(e){return n.plainObjectToEntityTransformer.transform(t,e,o)})),t},e.prototype.preload=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return n=this.connection.getMetadata(e),[4,new Wo(this.connection.manager).transform(t,n)];case 1:return(r=i.sent())?[2,this.merge(e,r,t)]:[2,void 0]}}))}))},e.prototype.save=function(e,t,n){var r=arguments.length>1&&(e instanceof Function||e instanceof wt||"string"==typeof e)?e:void 0,i=r?t:e,o=r?n:t;return r instanceof wt&&(r=r.options.name),Array.isArray(i)&&0===i.length?Promise.resolve(i):new ca(this.connection,this.queryRunner,"save",r,i,o).execute().then((function(){return i}))},e.prototype.remove=function(e,t,n){var r=arguments.length>1&&(e instanceof Function||"string"==typeof e)?e:void 0,i=r?t:e,o=r?n:t;return Array.isArray(i)&&0===i.length?Promise.resolve(i):new ca(this.connection,this.queryRunner,"remove",r,i,o).execute().then((function(){return i}))},e.prototype.softRemove=function(e,t,n){var r=arguments.length>1&&(e instanceof Function||e instanceof wt||"string"==typeof e)?e:void 0,i=r?t:e,o=r?n:t;return r instanceof wt&&(r=r.options.name),Array.isArray(i)&&0===i.length?Promise.resolve(i):new ca(this.connection,this.queryRunner,"soft-remove",r,i,o).execute().then((function(){return i}))},e.prototype.recover=function(e,t,n){var r=arguments.length>1&&(e instanceof Function||e instanceof wt||"string"==typeof e)?e:void 0,i=r?t:e,o=r?n:t;return r instanceof wt&&(r=r.options.name),Array.isArray(i)&&0===i.length?Promise.resolve(i):new ca(this.connection,this.queryRunner,"recover",r,i,o).execute().then((function(){return i}))},e.prototype.insert=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(n){return[2,this.createQueryBuilder().insert().into(e).values(t).execute()]}))}))},e.prototype.update=function(e,t,n){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new rt("Empty criteria(s) are not allowed for the update method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().update(e).set(n).whereInIds(t).execute():this.createQueryBuilder().update(e).set(n).where(t).execute()},e.prototype.delete=function(e,t){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new rt("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().delete().from(e).whereInIds(t).execute():this.createQueryBuilder().delete().from(e).where(t).execute()},e.prototype.softDelete=function(e,t){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new rt("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().softDelete().from(e).whereInIds(t).execute():this.createQueryBuilder().softDelete().from(e).where(t).execute()},e.prototype.restore=function(e,t){return null==t||""===t||Array.isArray(t)&&0===t.length?Promise.reject(new rt("Empty criteria(s) are not allowed for the delete method.")):"string"==typeof t||"number"==typeof t||t instanceof Date||Array.isArray(t)?this.createQueryBuilder().restore().from(e).whereInIds(t).execute():this.createQueryBuilder().restore().from(e).where(t).execute()},e.prototype.count=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){return n=this.connection.getMetadata(e),r=this.createQueryBuilder(e,Uo.extractFindManyOptionsAlias(t)||n.name),[2,Uo.applyFindManyOptionsOrConditionsToQueryBuilder(r,t).getCount()]}))}))},e.prototype.find=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){return n=this.connection.getMetadata(e),r=this.createQueryBuilder(e,Uo.extractFindManyOptionsAlias(t)||n.name),Uo.applyFindManyOptionsOrConditionsToQueryBuilder(r,t),Uo.isFindManyOptions(t)&&!1===t.loadEagerRelations||Uo.joinEagerRelations(r,r.alias,n),[2,r.getMany()]}))}))},e.prototype.findAndCount=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){return n=this.connection.getMetadata(e),r=this.createQueryBuilder(e,Uo.extractFindManyOptionsAlias(t)||n.name),Uo.applyFindManyOptionsOrConditionsToQueryBuilder(r,t),Uo.isFindManyOptions(t)&&!1===t.loadEagerRelations||Uo.joinEagerRelations(r,r.alias,n),[2,r.getManyAndCount()]}))}))},e.prototype.findByIds=function(e,t,n){return Ne(this,void 0,void 0,(function(){var r,i;return Oe(this,(function(o){return t.length?(r=this.connection.getMetadata(e),i=this.createQueryBuilder(e,Uo.extractFindManyOptionsAlias(n)||r.name),Uo.applyFindManyOptionsOrConditionsToQueryBuilder(i,n),Uo.isFindManyOptions(n)&&!1===n.loadEagerRelations||Uo.joinEagerRelations(i,i.alias,r),[2,i.andWhereInIds(t).getMany()]):[2,Promise.resolve([])]}))}))},e.prototype.findOne=function(e,t,n){return Ne(this,void 0,void 0,(function(){var r,i,o,a,s,u;return Oe(this,(function(c){return r=void 0,Uo.isFindOneOptions(t)?r=t:n&&Uo.isFindOneOptions(n)&&(r=n),i=void 0,t instanceof Object&&!Uo.isFindOneOptions(t)&&(i=t),o=this.connection.getMetadata(e),a=o.name,r&&r.join?a=r.join.alias:n&&Uo.isFindOneOptions(n)&&n.join&&(a=n.join.alias),s=this.createQueryBuilder(e,a),(u="string"==typeof t||"number"==typeof t||t instanceof Date)||(r=Re(Re({},r||{}),{take:1})),Uo.applyOptionsToQueryBuilder(s,r),r&&!1===r.loadEagerRelations||Uo.joinEagerRelations(s,s.alias,s.expressionMap.mainAlias.metadata),i?s.where(i):u&&s.andWhereInIds(o.ensureEntityIdMap(t)),[2,s.getOne()]}))}))},e.prototype.findOneOrFail=function(e,t,n){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(r){return[2,this.findOne(e,t,n).then((function(n){return void 0===n?Promise.reject(new _t(e,t)):Promise.resolve(n)}))]}))}))},e.prototype.clear=function(e){return Ne(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:t=this.connection.getMetadata(e),n=this.queryRunner||this.connection.createQueryRunner(),r.label=1;case 1:return r.trys.push([1,,3,6]),[4,n.clearTable(t.tablePath)];case 2:return[2,r.sent()];case 3:return this.queryRunner?[3,5]:[4,n.release()];case 4:r.sent(),r.label=5;case 5:return[7];case 6:return[2]}}))}))},e.prototype.increment=function(e,t,n,r){return Ne(this,void 0,void 0,(function(){var i,o,a,s=this;return Oe(this,(function(u){if(i=this.connection.getMetadata(e),!(o=i.findColumnWithPropertyPath(n)))throw new rt("Column "+n+" was not found in "+i.targetName+" entity.");if(isNaN(Number(r)))throw new rt('Value "'+r+'" is not a number.');return a=n.split(".").reduceRight((function(e,t){var n;return(n={})[t]=e,n}),(function(){return s.connection.driver.escape(o.databaseName)+" + "+r})),[2,this.createQueryBuilder(e,"entity").update(e).set(a).where(t).execute()]}))}))},e.prototype.decrement=function(e,t,n,r){return Ne(this,void 0,void 0,(function(){var i,o,a,s=this;return Oe(this,(function(u){if(i=this.connection.getMetadata(e),!(o=i.findColumnWithPropertyPath(n)))throw new rt("Column "+n+" was not found in "+i.targetName+" entity.");if(isNaN(Number(r)))throw new rt('Value "'+r+'" is not a number.');return a=n.split(".").reduceRight((function(e,t){var n;return(n={})[t]=e,n}),(function(){return s.connection.driver.escape(o.databaseName)+" - "+r})),[2,this.createQueryBuilder(e,"entity").update(e).set(a).where(t).execute()]}))}))},e.prototype.getRepository=function(e){if(!this.connection.hasMetadata(e))throw new Ft(this.connection.name,e);var t=this.connection.getMetadata(e),n=this.repositories.find((function(e){return e.metadata===t}));if(n)return n;var r=(new Go).create(this,t,this.queryRunner);return this.repositories.push(r),r},e.prototype.getTreeRepository=function(e){if(!1===this.connection.driver.treeSupport)throw new yt(this.connection.driver);var t=this.getRepository(e);if(!(t instanceof Fo))throw new Kt(e);return t},e.prototype.getMongoRepository=function(e){return this.connection.getMongoRepository(e)},e.prototype.getCustomRepository=function(e){var t=Es().entityRepositories.find((function(t){return t.target===(e instanceof Function?e:e.constructor)}));if(!t)throw new gt(e);var n=t.entity?this.connection.getMetadata(t.entity):void 0,r=new t.target(this,n);if(r instanceof Ho&&(r.manager||(r.manager=this)),r instanceof qo){if(!n)throw new Mt(e);r.manager=this,r.metadata=n}return r},e.prototype.release=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){if(!this.queryRunner)throw new Ht;return[2,this.queryRunner.release()]}))}))},e}(),fa=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.driver=t.driver,r}return Ae(t,e),t.prototype.loadDatabase=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return[4,this.driver.load(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.saveDatabase=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return[4,this.driver.save(e)];case 1:return t.sent(),[2]}}))}))},t.prototype.exportDatabase=function(){return this.driver.export()},t}(la),ha=o("9oHsE").Buffer,da=function(){function e(e){this.length="",this.isPrimary=!1,this.isGenerated=!1,this.isNullable=!1,this.isSelect=!0,this.isInsert=!0,this.isUpdate=!0,this.zerofill=!1,this.unsigned=!1,this.isArray=!1,this.isVirtual=!1,this.isDiscriminator=!1,this.isTreeLevel=!1,this.isCreateDate=!1,this.isUpdateDate=!1,this.isDeleteDate=!1,this.isVersion=!1,this.isObjectId=!1,this.isNestedSetLeft=!1,this.isNestedSetRight=!1,this.isMaterializedPath=!1,this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.referencedColumn=e.referencedColumn,e.args.target&&(this.target=e.args.target),e.args.propertyName&&(this.propertyName=e.args.propertyName),e.args.options.name&&(this.givenDatabaseName=e.args.options.name),e.args.options.type&&(this.type=e.args.options.type),e.args.options.length&&(this.length=e.args.options.length?e.args.options.length.toString():""),e.args.options.width&&(this.width=e.args.options.width),e.args.options.charset&&(this.charset=e.args.options.charset),e.args.options.collation&&(this.collation=e.args.options.collation),e.args.options.primary&&(this.isPrimary=e.args.options.primary),null===e.args.options.default&&(this.isNullable=!0),void 0!==e.args.options.nullable&&(this.isNullable=e.args.options.nullable),void 0!==e.args.options.select&&(this.isSelect=e.args.options.select),void 0!==e.args.options.insert&&(this.isInsert=e.args.options.insert),void 0!==e.args.options.update&&(this.isUpdate=e.args.options.update),void 0!==e.args.options.readonly&&(this.isUpdate=!e.args.options.readonly),e.args.options.comment&&(this.comment=e.args.options.comment),void 0!==e.args.options.default&&(this.default=e.args.options.default),e.args.options.onUpdate&&(this.onUpdate=e.args.options.onUpdate),null!==e.args.options.scale&&void 0!==e.args.options.scale&&(this.scale=e.args.options.scale),e.args.options.zerofill&&(this.zerofill=e.args.options.zerofill,this.unsigned=!0),e.args.options.unsigned&&(this.unsigned=e.args.options.unsigned),null!==e.args.options.precision&&(this.precision=e.args.options.precision),e.args.options.enum&&(e.args.options.enum instanceof Object&&!Array.isArray(e.args.options.enum)?this.enum=Object.keys(e.args.options.enum).filter((function(t){return isNaN(+t)&&"function"!=typeof e.args.options.enum[t]})).map((function(t){return e.args.options.enum[t]})):this.enum=e.args.options.enum),e.args.options.enumName&&(this.enumName=e.args.options.enumName),e.args.options.asExpression&&(this.asExpression=e.args.options.asExpression,this.generatedType=e.args.options.generatedType?e.args.options.generatedType:"VIRTUAL"),e.args.options.hstoreType&&(this.hstoreType=e.args.options.hstoreType),e.args.options.array&&(this.isArray=e.args.options.array),e.args.mode&&(this.isVirtual="virtual"===e.args.mode,this.isTreeLevel="treeLevel"===e.args.mode,this.isCreateDate="createDate"===e.args.mode,this.isUpdateDate="updateDate"===e.args.mode,this.isDeleteDate="deleteDate"===e.args.mode,this.isVersion="version"===e.args.mode,this.isObjectId="objectId"===e.args.mode),e.args.options.transformer&&(this.transformer=e.args.options.transformer),e.args.options.spatialFeatureType&&(this.spatialFeatureType=e.args.options.spatialFeatureType),void 0!==e.args.options.srid&&(this.srid=e.args.options.srid),this.isTreeLevel&&(this.type=e.connection.driver.mappedDataTypes.treeLevel),this.isCreateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.createDate),this.default||(this.default=function(){return e.connection.driver.mappedDataTypes.createDateDefault}),void 0===this.precision&&void 0===e.args.options.precision&&e.connection.driver.mappedDataTypes.createDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.createDatePrecision)),this.isUpdateDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.updateDate),this.default||(this.default=function(){return e.connection.driver.mappedDataTypes.updateDateDefault}),this.onUpdate||(this.onUpdate=e.connection.driver.mappedDataTypes.updateDateDefault),void 0===this.precision&&void 0===e.args.options.precision&&e.connection.driver.mappedDataTypes.updateDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.updateDatePrecision)),this.isDeleteDate&&(this.type||(this.type=e.connection.driver.mappedDataTypes.deleteDate),this.isNullable||(this.isNullable=e.connection.driver.mappedDataTypes.deleteDateNullable),void 0===this.precision&&void 0===e.args.options.precision&&e.connection.driver.mappedDataTypes.deleteDatePrecision&&(this.precision=e.connection.driver.mappedDataTypes.deleteDatePrecision)),this.isVersion&&(this.type=e.connection.driver.mappedDataTypes.version),e.closureType&&(this.closureType=e.closureType),e.nestedSetLeft&&(this.isNestedSetLeft=e.nestedSetLeft),e.nestedSetRight&&(this.isNestedSetRight=e.nestedSetRight),e.materializedPath&&(this.isMaterializedPath=e.materializedPath)}return e.prototype.createValueMap=function(e,t){var n,r=this;if(void 0===t&&(t=!1),this.embeddedMetadata){var i=Be([],ke(this.embeddedMetadata.parentPropertyNames)),o=function(n,i){var a=n.shift();return a?(i[a]={},o(n,i[a]),i):("increment"!==r.generationStrategy&&"rowid"!==r.generationStrategy||"bigint"!==r.type||null===e||(e=String(e)),i[t?r.databaseName:r.propertyName]=e,i)};return o(i,{})}return"increment"!==this.generationStrategy&&"rowid"!==this.generationStrategy||"bigint"!==this.type||null===e||(e=String(e)),(n={})[t?this.databaseName:this.propertyName]=e,n},e.prototype.getEntityValueMap=function(e,t){var n,r,i=this;if(this.embeddedMetadata){var o=Be([],ke(this.embeddedMetadata.parentPropertyNames)),a=this.embeddedMetadata.isArray,s=function(e,t){var n,r;if(void 0===t)return{};var o=e.shift();if(o){var u=s(e,t[o]);return Object.keys(u).length>0?((n={})[o]=u,n):{}}return a&&Array.isArray(t)?t.map((function(e){var t;return(t={})[i.propertyName]=e[i.propertyName],t})):void 0!==t[i.propertyName]?((r={})[i.propertyName]=t[i.propertyName],r):{}},u=s(o,e);return Object.keys(u).length>0?u:void 0}if(this.relationMetadata&&e[this.relationMetadata.propertyName]&&e[this.relationMetadata.propertyName]instanceof Object){u=this.relationMetadata.joinColumns.reduce((function(t,n){var r=n.referencedColumn.getEntityValueMap(e[i.relationMetadata.propertyName]);return void 0===r?t:Ze.mergeDeep(t,r)}),{});return Object.keys(u).length>0?((n={})[this.propertyName]=u,n):void 0}return void 0!==e[this.propertyName]?((r={})[this.propertyName]=e[this.propertyName],r):void 0},e.prototype.getEntityValue=function(e,t){var n=this;if(void 0===t&&(t=!1),null!=e){var r=void 0;if(this.embeddedMetadata){var i=Be([],ke(this.embeddedMetadata.parentPropertyNames)),o=this.embeddedMetadata.isArray,a=function(e,t){var n=e.shift();return n&&t?a(e,t[n]):t},s=a(i,e);if(s)if(this.relationMetadata&&this.referencedColumn)r=!((u=this.relationMetadata.getEntityValue(s))&&u instanceof Object)||u instanceof Xt||u instanceof ha?!(s[this.propertyName]&&s[this.propertyName]instanceof Object)||s[this.propertyName]instanceof Xt||s[this.propertyName]instanceof ha||s[this.propertyName]instanceof Date?s[this.propertyName]:this.referencedColumn.getEntityValue(s[this.propertyName]):this.referencedColumn.getEntityValue(u);else r=this.referencedColumn?this.referencedColumn.getEntityValue(s[this.propertyName]):o&&Array.isArray(s)?s.map((function(e){return e[n.propertyName]})):s[this.propertyName]}else{var u;if(this.relationMetadata&&this.referencedColumn)r=!((u=this.relationMetadata.getEntityValue(e))&&u instanceof Object)||u instanceof Xt||u instanceof Function||u instanceof ha?!(e[this.propertyName]&&e[this.propertyName]instanceof Object)||e[this.propertyName]instanceof Xt||e[this.propertyName]instanceof Function||e[this.propertyName]instanceof ha||e[this.propertyName]instanceof Date?e[this.propertyName]:this.referencedColumn.getEntityValue(e[this.propertyName]):this.referencedColumn.getEntityValue(u);else r=this.referencedColumn?this.referencedColumn.getEntityValue(e[this.propertyName]):e[this.propertyName]}return t&&this.transformer&&(r=gn.transformTo(this.transformer,r)),r}},e.prototype.setEntityValue=function(e,t){var n=this;if(this.embeddedMetadata){var r=function(e,i){var o=e.shift();return o?(i[o.propertyName]||(i[o.propertyName]=o.create()),r(e,i[o.propertyName]),i):(i[n.propertyName]=t,i)};return r(Be([],ke(this.embeddedMetadata.embeddedMetadataTree)),e)}!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName?(this.propertyName in e||(e[this.propertyName]={}),e[this.propertyName][this.referencedColumn.propertyName]=t):e[this.propertyName]=t},e.prototype.build=function(e){return this.propertyPath=this.buildPropertyPath(),this.propertyAliasName=this.propertyPath.replace(".","_"),this.databaseName=this.buildDatabaseName(e),this.databasePath=this.buildDatabasePath(),this.databaseNameWithoutPrefixes=e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,[]),this},e.prototype.buildPropertyPath=function(){var e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.propertyName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.propertyName!==this.propertyName&&(e+="."+this.referencedColumn.propertyName),e},e.prototype.buildDatabasePath=function(){var e="";return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length&&(e=this.embeddedMetadata.parentPropertyNames.join(".")+"."),e+=this.databaseName,!this.entityMetadata.isJunction&&this.isVirtual&&this.referencedColumn&&this.referencedColumn.databaseName!==this.databaseName&&(e+="."+this.referencedColumn.databaseName),e},e.prototype.buildDatabaseName=function(e){var t=this.embeddedMetadata?this.embeddedMetadata.parentPrefixes:[];return e.driver instanceof De&&(t=[]),e.namingStrategy.columnName(this.propertyName,this.givenDatabaseName,t)},e}(),pa=function(e,t){this.query=e,this.parameters=t},ma=function(){this.upQueries=[],this.downQueries=[]},ya=function(){function e(){this.isReleased=!1,this.isTransactionActive=!1,this.data={},this.loadedTables=[],this.loadedViews=[],this.sqlMemoryMode=!1,this.sqlInMemory=new ma,this.cachedTablePaths={}}return e.prototype.getTable=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){switch(n.label){case 0:return t=this,[4,this.loadTables([e])];case 1:return t.loadedTables=n.sent(),[2,this.loadedTables.length>0?this.loadedTables[0]:void 0]}}))}))},e.prototype.getTables=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){switch(n.label){case 0:return e?[3,2]:[4,this.loadTables(e)];case 1:return[2,n.sent()];case 2:return t=this,[4,this.loadTables(e)];case 3:return t.loadedTables=n.sent(),[2,this.loadedTables]}}))}))},e.prototype.getView=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){switch(n.label){case 0:return t=this,[4,this.loadViews([e])];case 1:return t.loadedViews=n.sent(),[2,this.loadedViews.length>0?this.loadedViews[0]:void 0]}}))}))},e.prototype.getViews=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){switch(n.label){case 0:return t=this,[4,this.loadViews(e)];case 1:return t.loadedViews=n.sent(),[2,this.loadedViews]}}))}))},e.prototype.enableSqlMemory=function(){this.sqlInMemory=new ma,this.sqlMemoryMode=!0},e.prototype.disableSqlMemory=function(){this.sqlInMemory=new ma,this.sqlMemoryMode=!1},e.prototype.clearSqlMemory=function(){this.sqlInMemory=new ma},e.prototype.getMemorySql=function(){return this.sqlInMemory},e.prototype.executeMemoryUpSql=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),e=Ce(this.sqlInMemory.upQueries),t=e.next(),u.label=1;case 1:return t.done?[3,4]:(n=t.value,r=n.query,i=n.parameters,[4,this.query(r,i)]);case 2:u.sent(),u.label=3;case 3:return t=e.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},e.prototype.executeMemoryDownSql=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),e=Ce(this.sqlInMemory.downQueries.reverse()),t=e.next(),u.label=1;case 1:return t.done?[3,4]:(n=t.value,r=n.query,i=n.parameters,[4,this.query(r,i)]);case 2:u.sent(),u.label=3;case 3:return t=e.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{t&&!t.done&&(s=e.return)&&s.call(e)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},e.prototype.getCachedView=function(e){return Ne(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:return(t=this.loadedViews.find((function(t){return t.name===e})))?[2,t]:[4,this.loadViews([e])];case 1:if((n=r.sent()).length>0)return this.loadedViews.push(n[0]),[2,n[0]];throw new rt('View "'+e+'" does not exist.')}}))}))},e.prototype.getCachedTable=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a=this;return Oe(this,(function(s){switch(s.label){case 0:return e in this.cachedTablePaths&&(t=this.cachedTablePaths[e],n=this.loadedTables.find((function(e){return a.getTablePath(e)===t})))?[2,n]:[4,this.loadTables([e])];case 1:if((r=s.sent()).length>0)return i=this.getTablePath(r[0]),(o=this.loadedTables.find((function(e){return a.getTablePath(e)===i})))?[2,o]:(this.cachedTablePaths[e]=this.getTablePath(r[0]),this.loadedTables.push(r[0]),[2,r[0]]);throw new rt('Table "'+e+'" does not exist.')}}))}))},e.prototype.replaceCachedTable=function(e,t){var n,r,i=this,o=this.getTablePath(e),a=this.loadedTables.find((function(e){return i.getTablePath(e)===o}));try{for(var s=Ce(Object.entries(this.cachedTablePaths)),u=s.next();!u.done;u=s.next()){var c=ke(u.value,2),l=c[0];c[1]===o&&(this.cachedTablePaths[l]=this.getTablePath(t))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}a&&(a.database=t.database,a.schema=t.schema,a.name=t.name,a.columns=t.columns,a.indices=t.indices,a.foreignKeys=t.foreignKeys,a.uniques=t.uniques,a.checks=t.checks,a.justCreated=t.justCreated,a.engine=t.engine)},e.prototype.getTablePath=function(e){var t=this.connection.driver.parseTableName(e);return this.connection.driver.buildTableName(t.tableName,t.schema,t.database)},e.prototype.getTypeormMetadataTableName=function(){var e=this.connection.driver.options;return this.connection.driver.buildTableName("typeorm_metadata",e.schema,e.database)},e.prototype.isColumnChanged=function(e,t,n,r){return e.charset!==t.charset||e.collation!==t.collation||e.precision!==t.precision||e.scale!==t.scale||e.width!==t.width||e.zerofill!==t.zerofill||e.unsigned!==t.unsigned||e.asExpression!==t.asExpression||n&&e.default!==t.default||e.onUpdate!==t.onUpdate||e.isNullable!==t.isNullable||r&&e.comment!==t.comment||e.enum!==t.enum},e.prototype.isDefaultColumnLength=function(e,t,n){if(this.connection.hasMetadata(e.name)){var r=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(r)if(this.connection.driver.getColumnLength(r))return!1}return!!(this.connection.driver.dataTypeDefaults&&this.connection.driver.dataTypeDefaults[t.type]&&this.connection.driver.dataTypeDefaults[t.type].length)&&this.connection.driver.dataTypeDefaults[t.type].length.toString()===n.toString()},e.prototype.isDefaultColumnPrecision=function(e,t,n){if(this.connection.hasMetadata(e.name)){var r=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(r&&null!==r.precision&&void 0!==r.precision)return!1}return!(!this.connection.driver.dataTypeDefaults||!this.connection.driver.dataTypeDefaults[t.type]||null===this.connection.driver.dataTypeDefaults[t.type].precision||void 0===this.connection.driver.dataTypeDefaults[t.type].precision)&&this.connection.driver.dataTypeDefaults[t.type].precision===n},e.prototype.isDefaultColumnScale=function(e,t,n){if(this.connection.hasMetadata(e.name)){var r=this.connection.getMetadata(e.name).findColumnWithDatabaseName(t.name);if(r&&null!==r.scale&&void 0!==r.scale)return!1}return!(!this.connection.driver.dataTypeDefaults||!this.connection.driver.dataTypeDefaults[t.type]||null===this.connection.driver.dataTypeDefaults[t.type].scale||void 0===this.connection.driver.dataTypeDefaults[t.type].scale)&&this.connection.driver.dataTypeDefaults[t.type].scale===n},e.prototype.executeQueries=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,f;return Oe(this,(function(h){switch(h.label){case 0:if(e instanceof pa&&(e=[e]),t instanceof pa&&(t=[t]),(u=this.sqlInMemory.upQueries).push.apply(u,Be([],ke(e))),(c=this.sqlInMemory.downQueries).push.apply(c,Be([],ke(t))),!0===this.sqlMemoryMode)return[2,Promise.resolve()];h.label=1;case 1:h.trys.push([1,6,7,8]),n=Ce(e),r=n.next(),h.label=2;case 2:return r.done?[3,5]:(i=r.value,o=i.query,a=i.parameters,[4,this.query(o,a)]);case 3:h.sent(),h.label=4;case 4:return r=n.next(),[3,2];case 5:return[3,8];case 6:return s=h.sent(),l={error:s},[3,8];case 7:try{r&&!r.done&&(f=n.return)&&f.call(n)}finally{if(l)throw l.error}return[7];case 8:return[2]}}))}))},e}(),ga=function(e){function t(){return e.call(this)||this}return Ae(t,e),t.prototype.connect=function(){return Promise.resolve(this.driver.databaseConnection)},t.prototype.release=function(){return this.loadedTables=[],this.clearSqlMemory(),Promise.resolve()},t.prototype.startTransaction=function(e){return Ne(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:if(this.isTransactionActive)throw new vt;if(!e)return[3,4];if("READ UNCOMMITTED"!==e&&"SERIALIZABLE"!==e)throw new rt("SQLite only supports SERIALIZABLE and READ UNCOMMITTED isolation");return"READ UNCOMMITTED"!==e?[3,2]:[4,this.query("PRAGMA read_uncommitted = true")];case 1:return r.sent(),[3,4];case 2:return[4,this.query("PRAGMA read_uncommitted = false")];case 3:r.sent(),r.label=4;case 4:return t=new vn,this.broadcaster.broadcastBeforeTransactionStartEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,6];case 5:r.sent(),r.label=6;case 6:return this.isTransactionActive=!0,[4,this.query("BEGIN TRANSACTION")];case 7:return r.sent(),n=new vn,this.broadcaster.broadcastAfterTransactionStartEvent(n),n.promises.length>0?[4,Promise.all(n.promises)]:[3,9];case 8:r.sent(),r.label=9;case 9:return[2]}}))}))},t.prototype.commitTransaction=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new bt;return e=new vn,this.broadcaster.broadcastBeforeTransactionCommitEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.query("COMMIT")];case 3:return n.sent(),this.isTransactionActive=!1,t=new vn,this.broadcaster.broadcastAfterTransactionCommitEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.rollbackTransaction=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new bt;return e=new vn,this.broadcaster.broadcastBeforeTransactionRollbackEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.query("ROLLBACK")];case 3:return n.sent(),this.isTransactionActive=!1,t=new vn,this.broadcaster.broadcastAfterTransactionRollbackEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.stream=function(e,t,n,r){throw new rt("Stream is not supported by sqlite driver.")},t.prototype.getDatabases=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve([])]}))}))},t.prototype.getSchemas=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve([])]}))}))},t.prototype.hasDatabase=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve(!1)]}))}))},t.prototype.getCurrentDatabase=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve(void 0)]}))}))},t.prototype.hasSchema=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new rt("This driver does not support table schemas")}))}))},t.prototype.getCurrentSchema=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve(void 0)]}))}))},t.prototype.hasTable=function(e){return Ne(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:return t=e instanceof dn?e.name:e,n='SELECT * FROM "sqlite_master" WHERE "type" = \'table\' AND "name" = \''+t+"'",[4,this.query(n)];case 1:return[2,!!r.sent().length]}}))}))},t.prototype.hasColumn=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return n=e instanceof dn?e.name:e,r='PRAGMA table_info("'+n+'")',[4,this.query(r)];case 1:return[2,!!i.sent().find((function(e){return e.name===t}))]}}))}))},t.prototype.createDatabase=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve()]}))}))},t.prototype.dropDatabase=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve()]}))}))},t.prototype.createSchema=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve()]}))}))},t.prototype.dropSchema=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve()]}))}))},t.prototype.createTable=function(e,t,n,r){return void 0===t&&(t=!1),void 0===n&&(n=!0),void 0===r&&(r=!0),Ne(this,void 0,void 0,(function(){var i,o,a=this;return Oe(this,(function(s){switch(s.label){case 0:return i=[],o=[],t?[4,this.hasTable(e)]:[3,2];case 1:if(s.sent())return[2,Promise.resolve()];s.label=2;case 2:return i.push(this.createTableSql(e,n)),o.push(this.dropTableSql(e)),r&&e.indices.forEach((function(t){t.name||(t.name=a.connection.namingStrategy.indexName(e,t.columnNames,t.where)),i.push(a.createIndexSql(e,t)),o.push(a.dropIndexSql(t))})),[4,this.executeQueries(i,o)];case 3:return s.sent(),[2]}}))}))},t.prototype.dropTable=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=!0),Ne(this,void 0,void 0,(function(){var i,o,a,s,u,c=this;return Oe(this,(function(l){switch(l.label){case 0:return t?[4,this.hasTable(e)]:[3,2];case 1:if(!l.sent())return[2,Promise.resolve()];l.label=2;case 2:return i=n,e instanceof dn?(a=e,[3,5]):[3,3];case 3:return[4,this.getCachedTable(e)];case 4:a=l.sent(),l.label=5;case 5:return o=a,s=[],u=[],r&&o.indices.forEach((function(e){s.push(c.dropIndexSql(e)),u.push(c.createIndexSql(o,e))})),s.push(this.dropTableSql(o,t)),u.push(this.createTableSql(o,i)),[4,this.executeQueries(s,u)];case 6:return l.sent(),[2]}}))}))},t.prototype.createView=function(e){return Ne(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:return n=[],(t=[]).push(this.createViewSql(e)),t.push(this.insertViewDefinitionSql(e)),n.push(this.dropViewSql(e)),n.push(this.deleteViewDefinitionSql(e)),[4,this.executeQueries(t,n)];case 1:return r.sent(),[2]}}))}))},t.prototype.dropView=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return t=e instanceof pn?e.name:e,[4,this.getCachedView(t)];case 1:return n=o.sent(),i=[],(r=[]).push(this.deleteViewDefinitionSql(n)),r.push(this.dropViewSql(n)),i.push(this.insertViewDefinitionSql(n)),i.push(this.createViewSql(n)),[4,this.executeQueries(r,i)];case 2:return o.sent(),[2]}}))}))},t.prototype.renameTable=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s=this;return Oe(this,(function(u){switch(u.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=u.sent(),u.label=3;case 3:return(i=(n=r).clone()).name=t,o=new pa('ALTER TABLE "'+n.name+'" RENAME TO "'+t+'"'),a=new pa('ALTER TABLE "'+t+'" RENAME TO "'+n.name+'"'),[4,this.executeQueries(o,a)];case 4:return u.sent(),n.name=i.name,i.uniques.forEach((function(e){e.name=s.connection.namingStrategy.uniqueConstraintName(i,e.columnNames)})),i.foreignKeys.forEach((function(e){e.name=s.connection.namingStrategy.foreignKeyName(i,e.columnNames,s.getTablePath(e),e.referencedColumnNames)})),i.indices.forEach((function(e){e.name=s.connection.namingStrategy.indexName(i,e.columnNames,e.where)})),[4,this.recreateTable(i,n)];case 5:return u.sent(),[2]}}))}))},t.prototype.addColumn=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=i.sent(),i.label=3;case 3:return n=r,[2,this.addColumns(n,[t])]}}))}))},t.prototype.addColumns=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:return i=(n=r).clone(),t.forEach((function(e){return i.addColumn(e)})),[4,this.recreateTable(i,n)];case 4:return o.sent(),[2]}}))}))},t.prototype.renameColumn=function(e,t,n){return Ne(this,void 0,void 0,(function(){var r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e instanceof dn?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=s.sent(),s.label=3;case 3:if(r=i,!(o=t instanceof an?t:r.columns.find((function(e){return e.name===t}))))throw new rt('Column "'+t+'" was not found in the "'+r.name+'" table.');return a=void 0,n instanceof an?a=n:(a=o.clone()).name=n,[2,this.changeColumn(r,o,a)]}}))}))},t.prototype.changeColumn=function(e,t,n){return Ne(this,void 0,void 0,(function(){var r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return e instanceof dn?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=a.sent(),a.label=3;case 3:if(r=i,!(o=t instanceof an?t:r.columns.find((function(e){return e.name===t}))))throw new rt('Column "'+t+'" was not found in the "'+r.name+'" table.');return[4,this.changeColumns(r,[{oldColumn:o,newColumn:n}])];case 4:return a.sent(),[2]}}))}))},t.prototype.changeColumns=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o=this;return Oe(this,(function(a){switch(a.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=a.sent(),a.label=3;case 3:return i=(n=r).clone(),t.forEach((function(e){e.newColumn.name!==e.oldColumn.name&&(i.findColumnUniques(e.oldColumn).forEach((function(t){t.columnNames.splice(t.columnNames.indexOf(e.oldColumn.name),1),t.columnNames.push(e.newColumn.name),t.name=o.connection.namingStrategy.uniqueConstraintName(i,t.columnNames)})),i.findColumnForeignKeys(e.oldColumn).forEach((function(t){t.columnNames.splice(t.columnNames.indexOf(e.oldColumn.name),1),t.columnNames.push(e.newColumn.name),t.name=o.connection.namingStrategy.foreignKeyName(i,t.columnNames,o.getTablePath(t),t.referencedColumnNames)})),i.findColumnIndices(e.oldColumn).forEach((function(t){t.columnNames.splice(t.columnNames.indexOf(e.oldColumn.name),1),t.columnNames.push(e.newColumn.name),t.name=o.connection.namingStrategy.indexName(i,t.columnNames,t.where)})));var t=i.columns.find((function(t){return t.name===e.oldColumn.name}));t&&(i.columns[i.columns.indexOf(t)]=e.newColumn)})),[4,this.recreateTable(i,n)];case 4:return a.sent(),[2]}}))}))},t.prototype.dropColumn=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:if(n=r,!(i=t instanceof an?t:n.findColumnByName(t)))throw new rt('Column "'+t+'" was not found in table "'+n.name+'"');return[4,this.dropColumns(n,[i])];case 4:return o.sent(),[2]}}))}))},t.prototype.dropColumns=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:return i=(n=r).clone(),t.forEach((function(e){var t=e instanceof an?e:n.findColumnByName(e);if(!t)throw new Error('Column "'+e+'" was not found in table "'+n.name+'"');i.removeColumn(t),i.findColumnUniques(t).forEach((function(e){return i.removeUniqueConstraint(e)})),i.findColumnIndices(t).forEach((function(e){return i.removeIndex(e)})),i.findColumnForeignKeys(t).forEach((function(e){return i.removeForeignKey(e)}))})),[4,this.recreateTable(i,n)];case 4:return o.sent(),[2]}}))}))},t.prototype.createPrimaryKey=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:return(i=(n=r).clone()).columns.forEach((function(e){t.find((function(t){return t===e.name}))&&(e.isPrimary=!0)})),[4,this.recreateTable(i,n)];case 4:return o.sent(),n.columns.forEach((function(e){t.find((function(t){return t===e.name}))&&(e.isPrimary=!0)})),[2]}}))}))},t.prototype.updatePrimaryKeys=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return[4,Promise.resolve()];case 1:return e.sent(),[2]}}))}))},t.prototype.dropPrimaryKey=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r;return Oe(this,(function(i){switch(i.label){case 0:return e instanceof dn?(n=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:n=i.sent(),i.label=3;case 3:return(r=(t=n).clone()).primaryColumns.forEach((function(e){e.isPrimary=!1})),[4,this.recreateTable(r,t)];case 4:return i.sent(),t.primaryColumns.forEach((function(e){e.isPrimary=!1})),[2]}}))}))},t.prototype.createUniqueConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(n){switch(n.label){case 0:return[4,this.createUniqueConstraints(e,[t])];case 1:return n.sent(),[2]}}))}))},t.prototype.createUniqueConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:return i=(n=r).clone(),t.forEach((function(e){return i.addUniqueConstraint(e)})),[4,this.recreateTable(i,n)];case 4:return o.sent(),[2]}}))}))},t.prototype.dropUniqueConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:if(n=r,!(i=t instanceof ln?t:n.uniques.find((function(e){return e.name===t}))))throw new rt("Supplied unique constraint was not found in table "+n.name);return[4,this.dropUniqueConstraints(n,[i])];case 4:return o.sent(),[2]}}))}))},t.prototype.dropUniqueConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:return i=(n=r).clone(),t.forEach((function(e){return i.removeUniqueConstraint(e)})),[4,this.recreateTable(i,n)];case 4:return o.sent(),[2]}}))}))},t.prototype.createCheckConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(n){switch(n.label){case 0:return[4,this.createCheckConstraints(e,[t])];case 1:return n.sent(),[2]}}))}))},t.prototype.createCheckConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:return i=(n=r).clone(),t.forEach((function(e){return i.addCheckConstraint(e)})),[4,this.recreateTable(i,n)];case 4:return o.sent(),[2]}}))}))},t.prototype.dropCheckConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:if(n=r,!(i=t instanceof fn?t:n.checks.find((function(e){return e.name===t}))))throw new rt("Supplied check constraint was not found in table "+n.name);return[4,this.dropCheckConstraints(n,[i])];case 4:return o.sent(),[2]}}))}))},t.prototype.dropCheckConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:return i=(n=r).clone(),t.forEach((function(e){return i.removeCheckConstraint(e)})),[4,this.recreateTable(i,n)];case 4:return o.sent(),[2]}}))}))},t.prototype.createExclusionConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new rt("Sqlite does not support exclusion constraints.")}))}))},t.prototype.createExclusionConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new rt("Sqlite does not support exclusion constraints.")}))}))},t.prototype.dropExclusionConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new rt("Sqlite does not support exclusion constraints.")}))}))},t.prototype.dropExclusionConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new rt("Sqlite does not support exclusion constraints.")}))}))},t.prototype.createForeignKey=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(n){switch(n.label){case 0:return[4,this.createForeignKeys(e,[t])];case 1:return n.sent(),[2]}}))}))},t.prototype.createForeignKeys=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:return i=(n=r).clone(),t.forEach((function(e){return i.addForeignKey(e)})),[4,this.recreateTable(i,n)];case 4:return o.sent(),[2]}}))}))},t.prototype.dropForeignKey=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:if(n=r,!(i=t instanceof un?t:n.foreignKeys.find((function(e){return e.name===t}))))throw new rt("Supplied foreign key was not found in table "+n.name);return[4,this.dropForeignKeys(e,[i])];case 4:return o.sent(),[2]}}))}))},t.prototype.dropForeignKeys=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=o.sent(),o.label=3;case 3:return i=(n=r).clone(),t.forEach((function(e){return i.removeForeignKey(e)})),[4,this.recreateTable(i,n)];case 4:return o.sent(),[2]}}))}))},t.prototype.createIndex=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=a.sent(),a.label=3;case 3:return n=r,t.name||(t.name=this.connection.namingStrategy.indexName(n,t.columnNames,t.where)),i=this.createIndexSql(n,t),o=this.dropIndexSql(t),[4,this.executeQueries(i,o)];case 4:return a.sent(),n.addIndex(t),[2]}}))}))},t.prototype.createIndices=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return n=t.map((function(t){return r.createIndex(e,t)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},t.prototype.dropIndex=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=s.sent(),s.label=3;case 3:if(n=r,!(i=t instanceof sn?t:n.indices.find((function(e){return e.name===t}))))throw new rt("Supplied index was not found in table "+n.name);return o=this.dropIndexSql(i),a=this.createIndexSql(n,i),[4,this.executeQueries(o,a)];case 4:return s.sent(),n.removeIndex(i),[2]}}))}))},t.prototype.dropIndices=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return n=t.map((function(t){return r.dropIndex(e,t)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},t.prototype.clearTable=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return[4,this.query('DELETE FROM "'+e+'"')];case 1:return t.sent(),[2]}}))}))},t.prototype.clearDatabase=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return[4,this.query("PRAGMA foreign_keys = OFF;")];case 1:return i.sent(),[4,this.startTransaction()];case 2:i.sent(),i.label=3;case 3:return i.trys.push([3,9,14,16]),"SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'",[4,this.query("SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'")];case 4:return e=i.sent(),[4,Promise.all(e.map((function(e){return r.query(e.query)})))];case 5:return i.sent(),"SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'",[4,this.query("SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'")];case 6:return t=i.sent(),[4,Promise.all(t.map((function(e){return r.query(e.query)})))];case 7:return i.sent(),[4,this.commitTransaction()];case 8:return i.sent(),[3,16];case 9:n=i.sent(),i.label=10;case 10:return i.trys.push([10,12,,13]),[4,this.rollbackTransaction()];case 11:return i.sent(),[3,13];case 12:return i.sent(),[3,13];case 13:throw n;case 14:return[4,this.query("PRAGMA foreign_keys = ON;")];case 15:return i.sent(),[7];case 16:return[2]}}))}))},t.prototype.loadViews=function(e){return Ne(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:return[4,this.hasTable(this.getTypeormMetadataTableName())];case 1:return r.sent()?(e||(e=[]),t=e.map((function(e){return"'"+e+"'"})).join(", "),n='SELECT "t".* FROM "'+this.getTypeormMetadataTableName()+'" "t" INNER JOIN "sqlite_master" s ON "s"."name" = "t"."name" AND "s"."type" = \'view\' WHERE "t"."type" = \'VIEW\'',t.length>0&&(n+=' AND "t"."name" IN ('+t+")"),[4,this.query(n)]):[2,[]];case 2:return[2,r.sent().map((function(e){var t=new pn;return t.name=e.name,t.expression=e.value,t}))]}}))}))},t.prototype.loadTables=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l,f,h,d,p=this;return Oe(this,(function(m){switch(m.label){case 0:return e&&0===e.length?[2,[]]:(t=[],e?[3,2]:(s='SELECT * FROM "sqlite_master" WHERE "type" = \'table\'',r=(n=t.push).apply,i=[t],o=[[]],[4,this.query(s)]));case 1:return r.apply(n,i.concat([Be.apply(void 0,o.concat([ke.apply(void 0,[m.sent()])]))])),[3,4];case 2:return a=e.map((function(e){return"'"+e+"'"})).join(", "),s='SELECT * FROM "sqlite_master" WHERE "type" = \'table\' AND "name" IN ('+a+")",c=(u=t.push).apply,l=[t],f=[[]],[4,this.query(s)];case 3:c.apply(u,l.concat([Be.apply(void 0,f.concat([ke.apply(void 0,[m.sent()])]))])),m.label=4;case 4:return 0===t.length?[2,[]]:(h=t.map((function(e){return"'"+e.name+"'"})).join(", "),[4,this.query('SELECT * FROM "sqlite_master" WHERE "type" = \'index\' AND "tbl_name" IN ('+h+")")]);case 5:return d=m.sent(),[2,Promise.all(t.map((function(e){return Ne(p,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l,f,h,p,m,y,g,b,v,w,_,E,S=this;return Oe(this,(function(x){switch(x.label){case 0:return(t=new dn).name=e.name,n=e.sql,[4,Promise.all([this.query('PRAGMA table_info("'+e.name+'")'),this.query('PRAGMA index_list("'+e.name+'")'),this.query('PRAGMA foreign_key_list("'+e.name+'")')])];case 1:for(r=ke.apply(void 0,[x.sent(),3]),i=r[0],o=r[1],a=r[2],s=void 0,u=e.sql,-1!==(c=u.toUpperCase().indexOf("AUTOINCREMENT"))&&(s=u.substr(0,c),l=s.lastIndexOf(","),f=s.lastIndexOf("("),-1!==l?s=(s=(s=s.substr(l)).substr(0,s.lastIndexOf('"'))).substr(s.indexOf('"')+1):-1!==f&&(s=(s=(s=s.substr(f)).substr(0,s.lastIndexOf('"'))).substr(s.indexOf('"')+1))),t.columns=i.map((function(e){var t=new an;if(t.name=e.name,t.type=e.type.toLowerCase(),t.default=null!==e.dflt_value&&void 0!==e.dflt_value?e.dflt_value:void 0,t.isNullable=0===e.notnull,t.isPrimary=e.pk>0,t.comment="",t.isGenerated=s===e.name,t.isGenerated&&(t.generationStrategy="increment"),"varchar"===t.type){var r=n.match(new RegExp('"('+t.name+")\" varchar CHECK\\s*\\(\\s*\\1\\s+IN\\s*\\(('[^']+'(?:\\s*,\\s*'[^']+')+)\\s*\\)\\s*\\)"));r&&(t.enum=r[2].substr(1,r[2].length-2).split("','"))}var i=t.type.indexOf("(");if(-1!==i){var o=t.type,a=o.substr(0,i);if(S.driver.withLengthColumnTypes.find((function(e){return e===a}))){var u=parseInt(o.substring(i+1,o.length-1));u&&(t.length=u.toString(),t.type=a)}if(S.driver.withPrecisionColumnTypes.find((function(e){return e===a}))){var c=new RegExp("^"+a+"\\((\\d+),?\\s?(\\d+)?\\)"),l=o.match(c);l&&l[1]&&(t.precision=+l[1]),S.driver.withScaleColumnTypes.find((function(e){return e===a}))&&l&&l[2]&&(t.scale=+l[2]),t.type=a}}return t})),h=Ze.uniq(a,(function(e){return e.id})),t.foreignKeys=h.map((function(e){var n=a.filter((function(t){return t.id===e.id&&t.table===e.table})),r=n.map((function(e){return e.from})),i=n.map((function(e){return e.to})),o=S.connection.namingStrategy.foreignKeyName(t,r,e.referencedTableName,e.referencedColumnNames);return new un({name:o,columnNames:r,referencedTableName:e.table,referencedColumnNames:i,onDelete:e.on_delete,onUpdate:e.on_update})})),m=[],y=/CONSTRAINT "([^"]*)" UNIQUE \((.*?)\)/g;null!==(p=y.exec(n));)m.push({name:p[1],columns:p[2].substr(1,p[2].length-2).split('", "')});return g=o.filter((function(e){return"u"===e.origin})).map((function(e){return e.name})).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return Ne(S,void 0,void 0,(function(){var n,r,i,a,s;return Oe(this,(function(u){switch(u.label){case 0:return n=o.find((function(t){return t.name===e})),[4,this.query('PRAGMA index_info("'+n.name+'")')];case 1:return r=u.sent(),1===(i=r.sort((function(e,t){return parseInt(e.seqno)-parseInt(t.seqno)})).map((function(e){return e.name}))).length&&(a=t.columns.find((function(e){return!!i.find((function(t){return t===e.name}))})))&&(a.isUnique=!0),s=m.find((function(e){return e.columns.every((function(e){return-1!==i.indexOf(e)}))})),[2,new ln({name:s?s.name:this.connection.namingStrategy.uniqueConstraintName(t,i),columnNames:i})]}}))}))})),b=t,[4,Promise.all(g)];case 2:for(b.uniques=x.sent(),w=/CONSTRAINT "([^"]*)" CHECK (\(.*?\))([,]|[)]$)/g;null!==(v=w.exec(n));)t.checks.push(new fn({name:v[1],expression:v[2]}));return _=o.filter((function(e){return"c"===e.origin})).map((function(e){return e.name})).filter((function(e,t,n){return n.indexOf(e)===t})).map((function(e){return Ne(S,void 0,void 0,(function(){var n,r,i,a,s,u;return Oe(this,(function(c){switch(c.label){case 0:return n=d.find((function(t){return t.name===e})),r=/WHERE (.*)/.exec(n.sql),i=o.find((function(t){return t.name===e})),[4,this.query('PRAGMA index_info("'+i.name+'")')];case 1:return a=c.sent(),s=a.sort((function(e,t){return parseInt(e.seqno)-parseInt(t.seqno)})).map((function(e){return e.name})),u="1"===i.unique||1===i.unique,[2,new sn({table:t,name:i.name,columnNames:s,isUnique:u,where:r?r[1]:void 0})]}}))}))})),[4,Promise.all(_)];case 3:return E=x.sent(),t.indices=E.filter((function(e){return!!e})),[2,t]}}))}))})))]}}))}))},t.prototype.createTableSql=function(e,t){var n=this,r=e.columns.filter((function(e){return e.isPrimary})),i=r.find((function(e){return e.isGenerated&&"increment"===e.generationStrategy})),o=r.length>1;if(o&&i)throw new rt("Sqlite does not support AUTOINCREMENT on composite primary key");var a=e.columns.map((function(e){return n.buildCreateColumnSql(e,o)})).join(", "),s='CREATE TABLE "'+e.name+'" ('+a;(e.columns.filter((function(e){return e.isUnique})).forEach((function(t){e.uniques.some((function(e){return 1===e.columnNames.length&&e.columnNames[0]===t.name}))||e.uniques.push(new ln({name:n.connection.namingStrategy.uniqueConstraintName(e,[t.name]),columnNames:[t.name]}))})),e.uniques.length>0)&&(s+=", "+e.uniques.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.uniqueConstraintName(e,t.columnNames))+'" UNIQUE ('+t.columnNames.map((function(e){return'"'+e+'"'})).join(", ")+")"})).join(", "));e.checks.length>0&&(s+=", "+e.checks.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.checkConstraintName(e,t.expression))+'" CHECK ('+t.expression+")"})).join(", "));e.foreignKeys.length>0&&t&&(s+=", "+e.foreignKeys.map((function(t){var r=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");t.name||(t.name=n.connection.namingStrategy.foreignKeyName(e,t.columnNames,n.getTablePath(t),t.referencedColumnNames));var i=t.referencedColumnNames.map((function(e){return'"'+e+'"'})).join(", "),o='CONSTRAINT "'+t.name+'" FOREIGN KEY ('+r+') REFERENCES "'+t.referencedTableName+'" ('+i+")";return t.onDelete&&(o+=" ON DELETE "+t.onDelete),t.onUpdate&&(o+=" ON UPDATE "+t.onUpdate),o})).join(", "));r.length>1&&(s+=", PRIMARY KEY ("+r.map((function(e){return'"'+e.name+'"'})).join(", ")+")");s+=")";var u=this.connection.entityMetadatas.find((function(t){return n.getTablePath(e)===n.getTablePath(t)}));return u&&u.withoutRowid&&(s+=" WITHOUT ROWID"),new pa(s)},t.prototype.dropTableSql=function(e,t){var n=e instanceof dn?e.name:e;return new pa(t?'DROP TABLE IF EXISTS "'+n+'"':'DROP TABLE "'+n+'"')},t.prototype.createViewSql=function(e){return"string"==typeof e.expression?new pa('CREATE VIEW "'+e.name+'" AS '+e.expression):new pa('CREATE VIEW "'+e.name+'" AS '+e.expression(this.connection).getQuery())},t.prototype.insertViewDefinitionSql=function(e){var t="string"==typeof e.expression?e.expression.trim():e.expression(this.connection).getQuery(),n=ke(this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({type:"VIEW",name:e.name,value:t}).getQueryAndParameters(),2),r=n[0],i=n[1];return new pa(r,i)},t.prototype.dropViewSql=function(e){var t=e instanceof pn?e.name:e;return new pa('DROP VIEW "'+t+'"')},t.prototype.deleteViewDefinitionSql=function(e){var t=e instanceof pn?e.name:e,n=this.connection.createQueryBuilder(),r=ke(n.delete().from(this.getTypeormMetadataTableName()).where(n.escape("type")+" = 'VIEW'").andWhere(n.escape("name")+" = :name",{name:t}).getQueryAndParameters(),2),i=r[0],o=r[1];return new pa(i,o)},t.prototype.createIndexSql=function(e,t){var n=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");return new pa("CREATE "+(t.isUnique?"UNIQUE ":"")+'INDEX "'+t.name+'" ON "'+e.name+'" ('+n+") "+(t.where?"WHERE "+t.where:""))},t.prototype.dropIndexSql=function(e){var t=e instanceof sn?e.name:e;return new pa('DROP INDEX "'+t+'"')},t.prototype.buildCreateColumnSql=function(e,t){var n='"'+e.name+'"';return n+=e instanceof da?" "+this.driver.normalizeType(e):" "+this.connection.driver.createFullType(e),e.enum&&(n+=" CHECK( "+e.name+" IN ("+e.enum.map((function(e){return"'"+e+"'"})).join(",")+") )"),e.isPrimary&&!t&&(n+=" PRIMARY KEY"),!0===e.isGenerated&&"increment"===e.generationStrategy&&(n+=" AUTOINCREMENT"),e.collation&&(n+=" COLLATE "+e.collation),!0!==e.isNullable&&(n+=" NOT NULL"),void 0!==e.default&&null!==e.default&&(n+=" DEFAULT ("+e.default+")"),n},t.prototype.recreateTable=function(e,t,n){return void 0===n&&(n=!0),Ne(this,void 0,void 0,(function(){var r,i,o,a,s=this;return Oe(this,(function(u){switch(u.label){case 0:return r=[],i=[],t.indices.forEach((function(e){r.push(s.dropIndexSql(e)),i.push(s.createIndexSql(t,e))})),e.name="temporary_"+e.name,r.push(this.createTableSql(e,!0)),i.push(this.dropTableSql(e)),n&&(o=e.columns.map((function(e){return'"'+e.name+'"'})).join(", "),a=t.columns.map((function(e){return'"'+e.name+'"'})).join(", "),t.columns.length<e.columns.length?o=e.columns.filter((function(e){return t.columns.find((function(t){return t.name===e.name}))})).map((function(e){return'"'+e.name+'"'})).join(", "):t.columns.length>e.columns.length&&(a=t.columns.filter((function(t){return e.columns.find((function(e){return e.name===t.name}))})).map((function(e){return'"'+e.name+'"'})).join(", ")),r.push(new pa('INSERT INTO "'+e.name+'"('+o+") SELECT "+a+' FROM "'+t.name+'"')),i.push(new pa('INSERT INTO "'+t.name+'"('+a+") SELECT "+o+' FROM "'+e.name+'"'))),r.push(this.dropTableSql(t)),i.push(this.createTableSql(t,!0)),r.push(new pa('ALTER TABLE "'+e.name+'" RENAME TO "'+t.name+'"')),i.push(new pa('ALTER TABLE "'+t.name+'" RENAME TO "'+e.name+'"')),e.name=t.name,e.indices.forEach((function(t){t.name||(t.name=s.connection.namingStrategy.indexName(e,t.columnNames,t.where)),r.push(s.createIndexSql(e,t)),i.push(s.dropIndexSql(t))})),[4,this.executeQueries(r,i)];case 1:return u.sent(),this.replaceCachedTable(t,e),[2]}}))}))},t}(ya),ba=function(){function e(e){this.queryRunner=e}return e.prototype.broadcastBeforeInsertEvent=function(e,t,n){var r=this;n&&t.beforeInsertListeners.length&&t.beforeInsertListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(i){if(r.isAllowedSubscriber(i,t.target)&&i.beforeInsert){var o=i.beforeInsert({connection:r.queryRunner.connection,queryRunner:r.queryRunner,manager:r.queryRunner.manager,entity:n,metadata:t});o instanceof Promise&&e.promises.push(o),e.count++}}))},e.prototype.broadcastBeforeUpdateEvent=function(e,t,n,r,i,o){var a=this;n&&t.beforeUpdateListeners.length&&t.beforeUpdateListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(s){if(a.isAllowedSubscriber(s,t.target)&&s.beforeUpdate){var u=s.beforeUpdate({connection:a.queryRunner.connection,queryRunner:a.queryRunner,manager:a.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,updatedColumns:i||[],updatedRelations:o||[]});u instanceof Promise&&e.promises.push(u),e.count++}}))},e.prototype.broadcastBeforeRemoveEvent=function(e,t,n,r){var i=this;n&&t.beforeRemoveListeners.length&&t.beforeRemoveListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(o){if(i.isAllowedSubscriber(o,t.target)&&o.beforeRemove){var a=o.beforeRemove({connection:i.queryRunner.connection,queryRunner:i.queryRunner,manager:i.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))},e.prototype.broadcastAfterInsertEvent=function(e,t,n){var r=this;n&&t.afterInsertListeners.length&&t.afterInsertListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(i){if(r.isAllowedSubscriber(i,t.target)&&i.afterInsert){var o=i.afterInsert({connection:r.queryRunner.connection,queryRunner:r.queryRunner,manager:r.queryRunner.manager,entity:n,metadata:t});o instanceof Promise&&e.promises.push(o),e.count++}}))},e.prototype.broadcastBeforeTransactionStartEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.beforeTransactionStart){var r=n.beforeTransactionStart({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastAfterTransactionStartEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.afterTransactionStart){var r=n.afterTransactionStart({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastBeforeTransactionCommitEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.beforeTransactionCommit){var r=n.beforeTransactionCommit({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastAfterTransactionCommitEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.afterTransactionCommit){var r=n.afterTransactionCommit({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastBeforeTransactionRollbackEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.beforeTransactionRollback){var r=n.beforeTransactionRollback({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastAfterTransactionRollbackEvent=function(e){var t=this;this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(n){if(n.afterTransactionRollback){var r=n.afterTransactionRollback({connection:t.queryRunner.connection,queryRunner:t.queryRunner,manager:t.queryRunner.manager});r instanceof Promise&&e.promises.push(r),e.count++}}))},e.prototype.broadcastAfterUpdateEvent=function(e,t,n,r,i,o){var a=this;n&&t.afterUpdateListeners.length&&t.afterUpdateListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(s){if(a.isAllowedSubscriber(s,t.target)&&s.afterUpdate){var u=s.afterUpdate({connection:a.queryRunner.connection,queryRunner:a.queryRunner,manager:a.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,updatedColumns:i||[],updatedRelations:o||[]});u instanceof Promise&&e.promises.push(u),e.count++}}))},e.prototype.broadcastAfterRemoveEvent=function(e,t,n,r){var i=this;n&&t.afterRemoveListeners.length&&t.afterRemoveListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),this.queryRunner.connection.subscribers.length&&this.queryRunner.connection.subscribers.forEach((function(o){if(i.isAllowedSubscriber(o,t.target)&&o.afterRemove){var a=o.afterRemove({connection:i.queryRunner.connection,queryRunner:i.queryRunner,manager:i.queryRunner.manager,entity:n,metadata:t,databaseEntity:r,entityId:t.getEntityIdMixedMap(r)});a instanceof Promise&&e.promises.push(a),e.count++}}))},e.prototype.broadcastLoadEventsForAll=function(e,t,n){var r=this;n.forEach((function(n){n instanceof Promise||(t.relations.length&&t.relations.forEach((function(t){if(!t.isLazy||n.hasOwnProperty(t.propertyName)){var i=t.getEntityValue(n);i instanceof Object&&r.broadcastLoadEventsForAll(e,t.inverseEntityMetadata,Array.isArray(i)?i:[i])}})),t.afterLoadListeners.length&&t.afterLoadListeners.forEach((function(t){if(t.isAllowed(n)){var r=t.execute(n);r instanceof Promise&&e.promises.push(r),e.count++}})),r.queryRunner.connection.subscribers.length&&r.queryRunner.connection.subscribers.forEach((function(i){if(r.isAllowedSubscriber(i,t.target)&&i.afterLoad){var o=i.afterLoad(n,{connection:r.queryRunner.connection,queryRunner:r.queryRunner,manager:r.queryRunner.manager,entity:n,metadata:t});o instanceof Promise&&e.promises.push(o),e.count++}})))}))},e.prototype.isAllowedSubscriber=function(e,t){return!e.listenTo||!e.listenTo()||e.listenTo()===Object||e.listenTo()===t||e.listenTo().isPrototypeOf(t)},e}(),va=function(){this.records=[]},wa=function(e){function t(t){var n=e.call(this)||this;return n.isDirty=!1,n.driver=t,n.connection=t.connection,n.broadcaster=new ba(n),n}return Ae(t,e),t.prototype.flush=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return this.isDirty?[4,this.driver.autoSave()]:[3,2];case 1:e.sent(),this.isDirty=!1,e.label=2;case 2:return[2]}}))}))},t.prototype.release=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return[4,this.flush()];case 1:return t.sent(),[2,e.prototype.release.call(this)]}}))}))},t.prototype.commitTransaction=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return[4,e.prototype.commitTransaction.call(this)];case 1:return t.sent(),[4,this.flush()];case 2:return t.sent(),[2]}}))}))},t.prototype.query=function(e,t,n){var r=this;if(void 0===t&&(t=[]),void 0===n&&(n=!1),this.isReleased)throw new Jt;var i=e.trim().split(" ",1)[0];return new Promise((function(o,a){return Ne(r,void 0,void 0,(function(){var r,s,u,c,l,f,h,d;return Oe(this,(function(p){r=this.driver.databaseConnection,this.driver.connection.logger.logQuery(e,t,this),s=+new Date;try{for(u=r.prepare(e),t&&(t=t.map((function(e){return void 0!==e?e:null})),u.bind(t)),c=this.driver.options.maxQueryExecutionTime,l=+new Date,f=l-s,c&&f>c&&this.driver.connection.logger.logQuerySlow(f,e,t,this),h=[];u.step();)h.push(u.getAsObject());(d=new va).affected=r.getRowsModified(),d.records=h,d.raw=h,u.free(),"SELECT"!==i&&(this.isDirty=!0),o(n?d:d.raw)}catch(n){u&&u.free(),this.driver.connection.logger.logQueryError(n,e,t,this),a(new Wt(e,t,n))}return[2]}))}))}))},t}(ga),_a=o("9oHsE").Buffer,Ea=function(e){function t(t){var n=e.call(this,t)||this;if(n.options.autoSave&&!n.options.location&&!n.options.autoSaveCallback)throw new qt("location or autoSaveCallback");return n.loadDependencies(),n}return Ae(t,e),t.prototype.connect=function(){return Ne(this,void 0,void 0,(function(){var e;return Oe(this,(function(t){switch(t.label){case 0:return e=this,[4,this.createDatabaseConnection()];case 1:return e.databaseConnection=t.sent(),[2]}}))}))},t.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return[2,new Promise((function(t,n){try{e.queryRunner=void 0,e.databaseConnection.close(),t()}catch(e){n(e)}}))]}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new wa(this)),this.queryRunner},t.prototype.load=function(e,t){return void 0===t&&(t=!0),Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){switch(i.label){case 0:if("string"!=typeof e)return[3,8];if("node"!==Po.type)return[3,1];if(Po.fileExist(e))return n=Po.readFileSync(e),[2,this.createDatabaseConnectionWithImport(n)];if(t)throw new rt("File "+e+" does not exist");return[2,this.createDatabaseConnectionWithImport()];case 1:return r=null,this.options.useLocalForage?window.localforage?[4,window.localforage.getItem(e)]:[3,3]:[3,5];case 2:return r=i.sent(),[3,4];case 3:throw new rt("localforage is not defined - please import localforage.js into your site");case 4:return[3,6];case 5:r=Po.getGlobalVariable().localStorage.getItem(e),i.label=6;case 6:if(null!=r)return[2,this.createDatabaseConnectionWithImport(JSON.parse(r))];if(t)throw new rt("File "+e+" does not exist");return[2,this.createDatabaseConnectionWithImport()];case 7:return[3,9];case 8:return[2,this.createDatabaseConnectionWithImport(e)];case 9:return[2]}}))}))},t.prototype.save=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:if(!e&&!this.options.location)throw new rt("No location is set, specify a location parameter or add the location option to your configuration");if(t="",e?t=e:this.options.location&&(t=this.options.location),"node"!==Po.type)return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),n=_a.from(this.databaseConnection.export()),[4,Po.writeFile(t,n)];case 2:return a.sent(),[3,4];case 3:throw r=a.sent(),new rt("Could not save database, error: "+r);case 4:return[3,10];case 5:return i=this.databaseConnection.export(),o=[].slice.call(i),this.options.useLocalForage?window.localforage?[4,window.localforage.setItem(t,JSON.stringify(o))]:[3,7]:[3,9];case 6:return a.sent(),[3,8];case 7:throw new rt("localforage is not defined - please import localforage.js into your site");case 8:return[3,10];case 9:Po.getGlobalVariable().localStorage.setItem(t,JSON.stringify(o)),a.label=10;case 10:return[2]}}))}))},t.prototype.autoSave=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return this.options.autoSave?this.options.autoSaveCallback?[4,this.options.autoSaveCallback(this.export())]:[3,2]:[3,4];case 1:return e.sent(),[3,4];case 2:return[4,this.save()];case 3:e.sent(),e.label=4;case 4:return[2]}}))}))},t.prototype.export=function(){return this.databaseConnection.export()},t.prototype.createGeneratedMap=function(e,t){var n=this,r=e.generatedColumns.reduce((function(e,t){if(t.isPrimary&&"increment"===t.generationStrategy){var r="SELECT last_insert_rowid()";try{var i=n.databaseConnection.exec(r);return n.connection.logger.logQuery(r),Ze.mergeDeep(e,t.createValueMap(i[0].values[0][0]))}catch(e){n.connection.logger.logQueryError(e,r,[])}}return e}),{});return Object.keys(r).length>0?r:void 0},t.prototype.createDatabaseConnection=function(){return this.options.location?this.load(this.options.location,!1):this.createDatabaseConnectionWithImport(this.options.database)},t.prototype.createDatabaseConnectionWithImport=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return"function"==typeof this.sqlite.Database?(n=this.sqlite,[3,3]):[3,1];case 1:return[4,this.sqlite(this.options.sqlJsConfig)];case 2:n=i.sent(),i.label=3;case 3:return t=n,e&&e.length>0?this.databaseConnection=new t.Database(e):this.databaseConnection=new t.Database,[2,new Promise((function(e,t){try{r.databaseConnection.exec("PRAGMA foreign_keys = ON;"),e(r.databaseConnection)}catch(e){t(e)}}))]}}))}))},t.prototype.loadDependencies=function(){if("browser"===Po.type)this.sqlite=window.SQL;else try{this.sqlite=Po.load("sql.js")}catch(e){throw new Dt("sql.js","sql.js")}},t}(bn),Sa=function(){function e(){}return e.prototype.create=function(e,t){return e.driver instanceof De?new Le(e):e.driver instanceof Ea?new fa(e,t):new la(e,t)},e}(),xa=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new ba(n),n}return Ae(t,e),t.prototype.query=function(e,t,n){return void 0===n&&(n=!1),Ne(this,void 0,void 0,(function(){var r=this;return Oe(this,(function(i){if(this.isReleased)throw new Jt;return[2,new Promise((function(i,o){return Ne(r,void 0,void 0,(function(){var r,a,s=this;return Oe(this,(function(u){switch(u.label){case 0:return[4,this.connect()];case 1:return r=u.sent(),this.driver.connection.logger.logQuery(e,t,this),a=+new Date,r.executeSql(e,t,(function(r){var o=s.driver.options.maxQueryExecutionTime,u=+new Date-a;o&&u>o&&s.driver.connection.logger.logQuerySlow(u,e,t,s);var c=new va;if("INSERT INTO"===e.substr(0,11))c.raw=r.insertId;else{for(var l=[],f=0;f<r.rows.length;f++)l.push(r.rows.item(f));c.records=l,c.raw=l}i(n?c:c.raw)}),(function(n){s.driver.connection.logger.logQueryError(n,e,t,s),o(new Wt(e,t,n))})),[2]}}))}))}))]}))}))},t.prototype.startTransaction=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new rt("Transactions are not supported by the Cordova driver")}))}))},t.prototype.commitTransaction=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new rt("Transactions are not supported by the Cordova driver")}))}))},t.prototype.rollbackTransaction=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){throw new rt("Transactions are not supported by the Cordova driver")}))}))},t.prototype.clearDatabase=function(){return Ne(this,void 0,void 0,(function(){var e,t,n=this;return Oe(this,(function(r){switch(r.label){case 0:return[4,this.query("PRAGMA foreign_keys = OFF;")];case 1:r.sent(),r.label=2;case 2:return r.trys.push([2,,7,9]),"SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'",[4,this.query("SELECT 'DROP VIEW \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'view'")];case 3:return e=r.sent(),"SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'",[4,this.query("SELECT 'DROP TABLE \"' || name || '\";' as query FROM \"sqlite_master\" WHERE \"type\" = 'table' AND \"name\" != 'sqlite_sequence'")];case 4:return t=r.sent(),[4,Promise.all(e.map((function(e){return n.query(e.query)})))];case 5:return r.sent(),[4,Promise.all(t.map((function(e){return n.query(e.query)})))];case 6:return r.sent(),[3,9];case 7:return[4,this.query("PRAGMA foreign_keys = ON;")];case 8:return r.sent(),[7];case 9:return[2]}}))}))},t.prototype.parametrize=function(e,t){return void 0===t&&(t=0),Object.keys(e).map((function(e,t){return'"'+e+'"=?'}))},t}(ga),Ta=function(e){function t(t){var n=e.call(this,t)||this;if(n.database=n.options.database,!n.options.database)throw new qt("database");if(!n.options.location)throw new qt("location");return n.loadDependencies(),n}return Ae(t,e),t.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return[2,new Promise((function(t,n){e.queryRunner=void 0,e.databaseConnection.close(t,n)}))]}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new xa(this)),this.queryRunner},t.prototype.createDatabaseConnection=function(){var e=this;return new Promise((function(t,n){var r=Object.assign({},{name:e.options.database,location:e.options.location},e.options.extra||{});e.sqlite.openDatabase(r,(function(e){var r=e;r.executeSql("PRAGMA foreign_keys = ON;",[],(function(e){t(r)}),(function(e){n(e)}))}),(function(e){n(e)}))}))},t.prototype.loadDependencies=function(){try{this.sqlite=window.sqlitePlugin}catch(e){throw new Dt("Cordova-SQLite","cordova-sqlite-storage")}},t}(bn),Ma=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new ba(n),n}return Ae(t,e),t.prototype.query=function(e,t,n){var r=this;if(void 0===n&&(n=!1),this.isReleased)throw new Jt;return new Promise((function(i,o){return Ne(r,void 0,void 0,(function(){var r,a,s=this;return Oe(this,(function(u){switch(u.label){case 0:return[4,this.connect()];case 1:return r=u.sent(),this.driver.connection.logger.logQuery(e,t,this),a=+new Date,r.executeSql(e,t,(function(r){var o=s.driver.options.maxQueryExecutionTime,u=+new Date-a;o&&u>o&&s.driver.connection.logger.logQuerySlow(u,e,t,s);var c=new va;if("INSERT INTO"===e.substr(0,11)&&(c.raw=r.insertId),(null==r?void 0:r.hasOwnProperty("rowsAffected"))&&(c.affected=r.rowsAffected),null==r?void 0:r.hasOwnProperty("rows")){for(var l=[],f=0;f<r.rows.length;f++)l.push(r.rows.item(f));c.raw=l,c.records=l}i(n?c:c.raw)}),(function(n){s.driver.connection.logger.logQueryError(n,e,t,s),o(new Wt(e,t,n))})),[2]}}))}))}))},t.prototype.parametrize=function(e,t){return void 0===t&&(t=0),Object.keys(e).map((function(e,t){return'"'+e+'"=?'}))},t}(ga),Aa=function(e){function t(t){var n=e.call(this,t)||this;if(n.database=n.options.database,!n.options.database)throw new qt("database");if(!n.options.location)throw new qt("location");return n.loadDependencies(),n}return Ae(t,e),t.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return[2,new Promise((function(t,n){e.queryRunner=void 0,e.databaseConnection.close(t,n)}))]}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new Ma(this)),this.queryRunner},t.prototype.createDatabaseConnection=function(){var e=this;return new Promise((function(t,n){var r=Object.assign({},{name:e.options.database,location:e.options.location},e.options.extra||{});e.sqlite.openDatabase(r,(function(e){var r=e;r.executeSql("PRAGMA foreign_keys = ON;",[],(function(e){t(r)}),(function(e){n(e)}))}),(function(e){n(e)}))}))},t.prototype.loadDependencies=function(){try{this.sqlite=$a783ec914730846f$import$f38edc6c390f1611}catch(e){throw new Dt("React-Native","react-native-sqlite-storage")}},t}(bn),Ra=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new ba(n),n}return Ae(t,e),t.prototype.query=function(e,t,n){return void 0===n&&(n=!1),Ne(this,void 0,void 0,(function(){var r,i=this;return Oe(this,(function(o){if(this.isReleased)throw new Jt;return r=this.driver.connection,[2,new Promise((function(o,a){var s="INSERT INTO"===e.substr(0,11),u=function(i,u){var l=this.driver.options.maxQueryExecutionTime,f=+new Date-c;if(l&&f>l&&r.logger.logQuerySlow(f,e,t,this),i)r.logger.logQueryError(i,e,t,this),a(new Wt(e,t,i));else{var h=new va;h.raw=u,!s&&Array.isArray(u)&&(h.records=u),o(n?h:h.raw)}};i.driver.connection.logger.logQuery(e,t,i);var c=+new Date;i.connect().then((function(n){s?n.execSQL(e,t,u):n.all(e,t,u)}))}))]}))}))},t.prototype.parametrize=function(e,t){return void 0===t&&(t=0),Object.keys(e).map((function(e,t){return'"'+e+'"=?'}))},t}(ga),Ia=o("9oHsE").Buffer,Pa=function(e){function t(t){var n=e.call(this,t)||this;if(n.connection=t,n.options=t.options,n.database=n.options.database,n.driver=n.options.driver,!n.options.database)throw new qt("database");return n.loadDependencies(),n}return Ae(t,e),t.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return[2,new Promise((function(t,n){e.queryRunner=void 0,e.databaseConnection.close().then(t).catch(n)}))]}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new Ra(this)),this.queryRunner},t.prototype.normalizeType=function(t){return t.type===Ia?"blob":e.prototype.normalizeType.call(this,t)},t.prototype.createDatabaseConnection=function(){var e=this;return new Promise((function(t,n){var r=Object.assign({},{readOnly:e.options.readOnly,key:e.options.key,multithreading:e.options.multithreading,migrate:e.options.migrate,iosFlags:e.options.iosFlags,androidFlags:e.options.androidFlags},e.options.extra||{});new e.sqlite(e.options.database,r,(function(r,i){if(r)return n(r);i.resultType(e.sqlite.RESULTSASOBJECT),i.execSQL("PRAGMA foreign_keys = ON;",[],(function(e,r){if(e)return n(e);t(i)}))}))}))},t.prototype.loadDependencies=function(){if(this.sqlite=this.driver,!this.driver)throw new Dt("Nativescript","nativescript-sqlite")},t}(bn),Na=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new ba(n),n}return Ae(t,e),t.prototype.startTransaction=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(this.isTransactionActive&&void 0!==this.transaction)throw new vt;return e=new vn,this.broadcaster.broadcastBeforeTransactionStartEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isTransactionActive=!0,t=new vn,this.broadcaster.broadcastAfterTransactionStartEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.commitTransaction=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive&&void 0===this.transaction)throw new bt;return e=new vn,this.broadcaster.broadcastBeforeTransactionCommitEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isTransactionActive=!1,this.transaction=void 0,t=new vn,this.broadcaster.broadcastAfterTransactionCommitEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.rollbackTransaction=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive&&void 0===this.transaction)throw new bt;return e=new vn,this.broadcaster.broadcastBeforeTransactionRollbackEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isTransactionActive=!1,this.transaction=void 0,t=new vn,this.broadcaster.broadcastAfterTransactionRollbackEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,4];case 3:n.sent(),n.label=4;case 4:return[2]}}))}))},t.prototype.query=function(e,t,n){return void 0===n&&(n=!1),Ne(this,void 0,void 0,(function(){var r=this;return Oe(this,(function(i){if(this.isReleased)throw new Jt;return[2,new Promise((function(i,o){return Ne(r,void 0,void 0,(function(){var r,a,s=this;return Oe(this,(function(u){switch(u.label){case 0:return[4,this.connect()];case 1:return r=u.sent(),this.driver.connection.logger.logQuery(e,t,this),a=+new Date,r.transaction((function(r){void 0===s.transaction&&(s.startTransaction(),s.transaction=r),s.transaction.executeSql(e,t,(function(r,o){var u=s.driver.options.maxQueryExecutionTime,c=+new Date-a;u&&c>u&&s.driver.connection.logger.logQuerySlow(c,e,t,s);var l=new va;if("INSERT INTO"===e.substr(0,11)&&(l.raw=o.insertId),(null==o?void 0:o.hasOwnProperty("rowsAffected"))&&(l.affected=o.rowsAffected),null==o?void 0:o.hasOwnProperty("rows")){for(var f=[],h=0;h<o.rows.length;h++)f.push(o.rows.item(h));l.raw=f,l.records=f}i(n?l:l.raw)}),(function(n,r){s.driver.connection.logger.logQueryError(r,e,t,s),o(new Wt(e,t,r))}))}),(function(e){s.rollbackTransaction()}),(function(){s.isTransactionActive=!1,s.transaction=void 0})),[2]}}))}))}))]}))}))},t}(ga),Oa=function(e){function t(t){var n=e.call(this,t)||this;if(n.database=n.options.database,!n.options.database)throw new qt("database");if(!n.options.driver)throw new qt("driver");return n.sqlite=n.options.driver,n}return Ae(t,e),t.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return[2,new Promise((function(t,n){try{e.queryRunner=void 0,e.databaseConnection._db.close(),e.databaseConnection=void 0,t()}catch(e){n(e)}}))]}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new Na(this)),this.queryRunner},t.prototype.createDatabaseConnection=function(){var e=this;return new Promise((function(t,n){try{var r=e.sqlite.openDatabase(e.options.database);r.transaction((function(e){e.executeSql("PRAGMA foreign_keys = ON;",[],(function(e,n){t(r)}),(function(e,t){n({transaction:e,error:t})}))}),(function(e){n(e)}))}catch(e){n(e)}}))},t}(bn),Ca=function(){function e(){}return e.isGreaterOrEqual=function(e,t){var n=ka(e),r=ka(t);return n[0]>r[0]||n[0]===r[0]&&n[1]>r[1]||n[0]===r[0]&&n[1]===r[1]&&n[2]>=r[2]},e}();function ka(e){void 0===e&&(e="");var t=[0,0,0];return e.split(".").forEach((function(e,n){return t[n]=parseInt(e,10)})),t}var Ba=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i.client=n,i}return Ae(t,e),t.prototype.connect=function(){var e=this;return this.databaseConnection?Promise.resolve(this.databaseConnection):(this.databaseConnectionPromise||("slave"===this.mode&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then((function(t){var n=ke(t,2),r=n[0],i=n[1];return e.driver.connectedQueryRunners.push(e),e.databaseConnection=r,e.releaseCallback=i,e.databaseConnection})):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then((function(t){var n=ke(t,2),r=n[0],i=n[1];return e.driver.connectedQueryRunners.push(e),e.databaseConnection=r,e.releaseCallback=i,e.databaseConnection}))),this.databaseConnectionPromise)},t.prototype.startTransaction=function(e){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(this.isTransactionActive)throw new vt;return e=new vn,this.broadcaster.broadcastBeforeTransactionStartEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return this.isTransactionActive=!0,[4,this.client.startTransaction()];case 3:return n.sent(),t=new vn,this.broadcaster.broadcastAfterTransactionStartEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.commitTransaction=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new bt;return e=new vn,this.broadcaster.broadcastBeforeTransactionCommitEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.client.commitTransaction()];case 3:return n.sent(),this.isTransactionActive=!1,t=new vn,this.broadcaster.broadcastAfterTransactionCommitEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.rollbackTransaction=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new bt;return e=new vn,this.broadcaster.broadcastBeforeTransactionRollbackEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.client.rollbackTransaction()];case 3:return n.sent(),t=new vn,this.broadcaster.broadcastAfterTransactionRollbackEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.query=function(e,t,n){return void 0===n&&(n=!1),Ne(this,void 0,void 0,(function(){var r,i;return Oe(this,(function(o){switch(o.label){case 0:if(this.isReleased)throw new Jt;return[4,this.client.query(e,t)];case 1:return r=o.sent(),(i=new va).raw=r,(null==r?void 0:r.hasOwnProperty("records"))&&Array.isArray(r.records)&&(i.records=r.records),(null==r?void 0:r.hasOwnProperty("numberOfRecordsUpdated"))&&(i.affected=r.numberOfRecordsUpdated),n?[2,i]:[2,i.raw]}}))}))},t}(function(e){function t(t,n){return e.call(this,t,n)||this}return Ae(t,e),t}(function(e){function t(t,n){var r=e.call(this)||this;return r.driver=t,r.connection=t.connection,r.mode=n,r.broadcaster=new ba(r),r}return Ae(t,e),t.prototype.connect=function(){var e=this;return this.databaseConnection?Promise.resolve(this.databaseConnection):(this.databaseConnectionPromise||("slave"===this.mode&&this.driver.isReplicated?this.databaseConnectionPromise=this.driver.obtainSlaveConnection().then((function(t){var n=ke(t,2),r=n[0],i=n[1];e.driver.connectedQueryRunners.push(e),e.databaseConnection=r;var o=function(t){return e.releasePostgresConnection(t)};return e.releaseCallback=function(){e.databaseConnection.removeListener("error",o),i()},e.databaseConnection.on("error",o),e.databaseConnection})):this.databaseConnectionPromise=this.driver.obtainMasterConnection().then((function(t){var n=ke(t,2),r=n[0],i=n[1];e.driver.connectedQueryRunners.push(e),e.databaseConnection=r;var o=function(t){return e.releasePostgresConnection(t)};return e.releaseCallback=function(){e.databaseConnection.removeListener("error",o),i()},e.databaseConnection.on("error",o),e.databaseConnection}))),this.databaseConnectionPromise)},t.prototype.releasePostgresConnection=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){return this.isReleased||(this.isReleased=!0,this.releaseCallback&&(this.releaseCallback(e),this.releaseCallback=void 0),-1!==(t=this.driver.connectedQueryRunners.indexOf(this))&&this.driver.connectedQueryRunners.splice(t,1)),[2]}))}))},t.prototype.release=function(){return this.releasePostgresConnection()},t.prototype.startTransaction=function(e){return Ne(this,void 0,void 0,(function(){var t,n;return Oe(this,(function(r){switch(r.label){case 0:if(this.isTransactionActive)throw new vt;return t=new vn,this.broadcaster.broadcastBeforeTransactionStartEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.isTransactionActive=!0,[4,this.query("START TRANSACTION")];case 3:return r.sent(),e?[4,this.query("SET TRANSACTION ISOLATION LEVEL "+e)]:[3,5];case 4:r.sent(),r.label=5;case 5:return n=new vn,this.broadcaster.broadcastAfterTransactionStartEvent(n),n.promises.length>0?[4,Promise.all(n.promises)]:[3,7];case 6:r.sent(),r.label=7;case 7:return[2]}}))}))},t.prototype.commitTransaction=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new bt;return e=new vn,this.broadcaster.broadcastBeforeTransactionCommitEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.query("COMMIT")];case 3:return n.sent(),this.isTransactionActive=!1,t=new vn,this.broadcaster.broadcastAfterTransactionCommitEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.rollbackTransaction=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isTransactionActive)throw new bt;return e=new vn,this.broadcaster.broadcastBeforeTransactionRollbackEvent(e),e.promises.length>0?[4,Promise.all(e.promises)]:[3,2];case 1:n.sent(),n.label=2;case 2:return[4,this.query("ROLLBACK")];case 3:return n.sent(),this.isTransactionActive=!1,t=new vn,this.broadcaster.broadcastAfterTransactionRollbackEvent(t),t.promises.length>0?[4,Promise.all(t.promises)]:[3,5];case 4:n.sent(),n.label=5;case 5:return[2]}}))}))},t.prototype.query=function(e,t,n){return void 0===n&&(n=!1),Ne(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l;return Oe(this,(function(f){switch(f.label){case 0:if(this.isReleased)throw new Jt;return[4,this.connect()];case 1:r=f.sent(),this.driver.connection.logger.logQuery(e,t,this),f.label=2;case 2:return f.trys.push([2,4,,5]),i=+new Date,[4,r.query(e,t)];case 3:switch(o=f.sent(),a=this.driver.options.maxQueryExecutionTime,s=+new Date,u=s-i,a&&u>a&&this.driver.connection.logger.logQuerySlow(u,e,t,this),c=new va,(null==o?void 0:o.hasOwnProperty("rows"))&&(c.records=o.rows),(null==o?void 0:o.hasOwnProperty("rowCount"))&&(c.affected=o.rowCount),o.command){case"DELETE":case"UPDATE":c.raw=[o.rows,o.rowCount];break;default:c.raw=o.rows}return n?[2,c]:[2,c.raw];case 4:throw l=f.sent(),this.driver.connection.logger.logQueryError(l,e,t,this),new Wt(e,t,l);case 5:return[2]}}))}))},t.prototype.stream=function(e,t,n,r){var i=this,o=this.driver.loadStreamDependency();if(this.isReleased)throw new Jt;return new Promise((function(a,s){return Ne(i,void 0,void 0,(function(){var i,u,c;return Oe(this,(function(l){switch(l.label){case 0:return l.trys.push([0,2,,3]),[4,this.connect()];case 1:return i=l.sent(),this.driver.connection.logger.logQuery(e,t,this),u=i.query(new o(e,t)),n&&u.on("end",n),r&&u.on("error",r),a(u),[3,3];case 2:return c=l.sent(),s(c),[3,3];case 3:return[2]}}))}))}))},t.prototype.getDatabases=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve([])]}))}))},t.prototype.getSchemas=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2,Promise.resolve([])]}))}))},t.prototype.hasDatabase=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return[4,this.query("SELECT * FROM pg_database WHERE datname='"+e+"';")];case 1:return[2,!!t.sent().length]}}))}))},t.prototype.getCurrentDatabase=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return[4,this.query("SELECT * FROM current_database()")];case 1:return[2,e.sent()[0].current_database]}}))}))},t.prototype.hasSchema=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return[4,this.query('SELECT * FROM "information_schema"."schemata" WHERE "schema_name" = \''+e+"'")];case 1:return[2,!!t.sent().length]}}))}))},t.prototype.getCurrentSchema=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return[4,this.query("SELECT * FROM current_schema()")];case 1:return[2,e.sent()[0].current_schema]}}))}))},t.prototype.hasTable=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r;return Oe(this,(function(i){switch(i.label){case 0:return(t=this.driver.parseTableName(e)).schema?[3,2]:(n=t,[4,this.getCurrentSchema()]);case 1:n.schema=i.sent(),i.label=2;case 2:return r='SELECT * FROM "information_schema"."tables" WHERE "table_schema" = \''+t.schema+"' AND \"table_name\" = '"+t.tableName+"'",[4,this.query(r)];case 3:return[2,!!i.sent().length]}}))}))},t.prototype.hasColumn=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return(n=this.driver.parseTableName(e)).schema?[3,2]:(r=n,[4,this.getCurrentSchema()]);case 1:r.schema=o.sent(),o.label=2;case 2:return i='SELECT * FROM "information_schema"."columns" WHERE "table_schema" = \''+n.schema+"' AND \"table_name\" = '"+n.tableName+"' AND \"column_name\" = '"+t+"'",[4,this.query(i)];case 3:return[2,!!o.sent().length]}}))}))},t.prototype.createDatabase=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return t?[4,this.hasDatabase(e)]:[3,2];case 1:if(i.sent())return[2,Promise.resolve()];i.label=2;case 2:return n='CREATE DATABASE "'+e+'"',r='DROP DATABASE "'+e+'"',[4,this.executeQueries(new pa(n),new pa(r))];case 3:return i.sent(),[2]}}))}))},t.prototype.dropDatabase=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r;return Oe(this,(function(i){switch(i.label){case 0:return n=t?'DROP DATABASE IF EXISTS "'+e+'"':'DROP DATABASE "'+e+'"',r='CREATE DATABASE "'+e+'"',[4,this.executeQueries(new pa(n),new pa(r))];case 1:return i.sent(),[2]}}))}))},t.prototype.createSchema=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return n=-1===e.indexOf(".")?e:e.split(".")[1],r=t?'CREATE SCHEMA IF NOT EXISTS "'+n+'"':'CREATE SCHEMA "'+n+'"',i='DROP SCHEMA "'+n+'" CASCADE',[4,this.executeQueries(new pa(r),new pa(i))];case 1:return o.sent(),[2]}}))}))},t.prototype.dropSchema=function(e,t,n){return Ne(this,void 0,void 0,(function(){var r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return r=-1===e.indexOf(".")?e:e.split(".")[1],i=t?'DROP SCHEMA IF EXISTS "'+r+'" '+(n?"CASCADE":""):'DROP SCHEMA "'+r+'" '+(n?"CASCADE":""),o='CREATE SCHEMA "'+r+'"',[4,this.executeQueries(new pa(i),new pa(o))];case 1:return a.sent(),[2]}}))}))},t.prototype.createTable=function(e,t,n,r){return void 0===t&&(t=!1),void 0===n&&(n=!0),void 0===r&&(r=!0),Ne(this,void 0,void 0,(function(){var i,o,a,s,u,c,l,f,h,d,p,m,y=this;return Oe(this,(function(g){switch(g.label){case 0:return t?[4,this.hasTable(e)]:[3,2];case 1:if(g.sent())return[2,Promise.resolve()];g.label=2;case 2:i=[],o=[],a=e.columns.filter((function(e){return"enum"===e.type||"simple-enum"===e.type})),s=[],g.label=3;case 3:g.trys.push([3,8,9,10]),u=Ce(a),c=u.next(),g.label=4;case 4:return c.done?[3,7]:(l=c.value,[4,this.hasEnumType(e,l)]);case 5:f=g.sent(),h=this.buildEnumName(e,l),f||-1!==s.indexOf(h)||(s.push(h),i.push(this.createEnumTypeSql(e,l,h)),o.push(this.dropEnumTypeSql(e,l,h))),g.label=6;case 6:return c=u.next(),[3,4];case 7:return[3,10];case 8:return d=g.sent(),p={error:d},[3,10];case 9:try{c&&!c.done&&(m=u.return)&&m.call(u)}finally{if(p)throw p.error}return[7];case 10:return i.push(this.createTableSql(e,n)),o.push(this.dropTableSql(e)),n&&e.foreignKeys.forEach((function(t){return o.push(y.dropForeignKeySql(e,t))})),r&&e.indices.forEach((function(t){t.name||(t.name=y.connection.namingStrategy.indexName(e,t.columnNames,t.where)),i.push(y.createIndexSql(e,t)),o.push(y.dropIndexSql(e,t))})),[4,this.executeQueries(i,o)];case 11:return g.sent(),[2]}}))}))},t.prototype.dropTable=function(e,t,n,r){return void 0===n&&(n=!0),void 0===r&&(r=!0),Ne(this,void 0,void 0,(function(){var i,o,a,s,u,c=this;return Oe(this,(function(l){switch(l.label){case 0:return t?[4,this.hasTable(e)]:[3,2];case 1:if(!l.sent())return[2,Promise.resolve()];l.label=2;case 2:return i=n,o=this.getTablePath(e),[4,this.getCachedTable(o)];case 3:return a=l.sent(),s=[],u=[],r&&a.indices.forEach((function(e){s.push(c.dropIndexSql(a,e)),u.push(c.createIndexSql(a,e))})),n&&a.foreignKeys.forEach((function(e){return s.push(c.dropForeignKeySql(a,e))})),s.push(this.dropTableSql(a)),u.push(this.createTableSql(a,i)),[4,this.executeQueries(s,u)];case 4:return l.sent(),[2]}}))}))},t.prototype.createView=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return n=[],(t=[]).push(this.createViewSql(e)),i=(r=t).push,[4,this.insertViewDefinitionSql(e)];case 1:return i.apply(r,[s.sent()]),n.push(this.dropViewSql(e)),a=(o=n).push,[4,this.deleteViewDefinitionSql(e)];case 2:return a.apply(o,[s.sent()]),[4,this.executeQueries(t,n)];case 3:return s.sent(),[2]}}))}))},t.prototype.dropView=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u;return Oe(this,(function(c){switch(c.label){case 0:return t=e instanceof pn?e.name:e,[4,this.getCachedView(t)];case 1:return n=c.sent(),i=[],a=(o=r=[]).push,[4,this.deleteViewDefinitionSql(n)];case 2:return a.apply(o,[c.sent()]),r.push(this.dropViewSql(n)),u=(s=i).push,[4,this.insertViewDefinitionSql(n)];case 3:return u.apply(s,[c.sent()]),i.push(this.createViewSql(n)),[4,this.executeQueries(r,i)];case 4:return c.sent(),[2]}}))}))},t.prototype.renameTable=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b,v,w,_=this;return Oe(this,(function(E){switch(E.label){case 0:return n=[],r=[],e instanceof dn?(o=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:o=E.sent(),E.label=3;case 3:a=(i=o).clone(),s=this.driver.parseTableName(i),u=s.schema,c=s.tableName,a.name=u?u+"."+t:t,n.push(new pa("ALTER TABLE "+this.escapePath(i)+' RENAME TO "'+t+'"')),r.push(new pa("ALTER TABLE "+this.escapePath(a)+' RENAME TO "'+c+'"')),a.primaryColumns.length>0&&(l=a.primaryColumns.map((function(e){return e.name})),f=this.connection.namingStrategy.primaryKeyName(i,l),h=this.connection.namingStrategy.primaryKeyName(a,l),n.push(new pa("ALTER TABLE "+this.escapePath(a)+' RENAME CONSTRAINT "'+f+'" TO "'+h+'"')),r.push(new pa("ALTER TABLE "+this.escapePath(a)+' RENAME CONSTRAINT "'+h+'" TO "'+f+'"'))),a.columns.map((function(e){if(e.isGenerated&&"increment"===e.generationStrategy){var t=_.buildSequencePath(i,e.name),o=_.buildSequenceName(i,e.name),s=_.buildSequencePath(a,e.name),u=_.buildSequenceName(a,e.name),c="ALTER SEQUENCE "+_.escapePath(t)+' RENAME TO "'+u+'"',l="ALTER SEQUENCE "+_.escapePath(s)+' RENAME TO "'+o+'"';n.push(new pa(c)),r.push(new pa(l))}})),a.uniques.forEach((function(e){var t=_.connection.namingStrategy.uniqueConstraintName(a,e.columnNames);n.push(new pa("ALTER TABLE "+_.escapePath(a)+' RENAME CONSTRAINT "'+e.name+'" TO "'+t+'"')),r.push(new pa("ALTER TABLE "+_.escapePath(a)+' RENAME CONSTRAINT "'+t+'" TO "'+e.name+'"')),e.name=t})),a.indices.forEach((function(e){var t=_.driver.parseTableName(a).schema,i=_.connection.namingStrategy.indexName(a,e.columnNames,e.where),o=t?'ALTER INDEX "'+t+'"."'+e.name+'" RENAME TO "'+i+'"':'ALTER INDEX "'+e.name+'" RENAME TO "'+i+'"',s=t?'ALTER INDEX "'+t+'"."'+i+'" RENAME TO "'+e.name+'"':'ALTER INDEX "'+i+'" RENAME TO "'+e.name+'"';n.push(new pa(o)),r.push(new pa(s)),e.name=i})),a.foreignKeys.forEach((function(e){var t=_.connection.namingStrategy.foreignKeyName(a,e.columnNames,_.getTablePath(e),e.referencedColumnNames);n.push(new pa("ALTER TABLE "+_.escapePath(a)+' RENAME CONSTRAINT "'+e.name+'" TO "'+t+'"')),r.push(new pa("ALTER TABLE "+_.escapePath(a)+' RENAME CONSTRAINT "'+t+'" TO "'+e.name+'"')),e.name=t})),d=a.columns.filter((function(e){return"enum"===e.type||"simple-enum"===e.type})),E.label=4;case 4:E.trys.push([4,9,10,11]),p=Ce(d),m=p.next(),E.label=5;case 5:return m.done?[3,8]:(y=m.value).enumName?[3,7]:[4,this.getUserDefinedTypeName(i,y)];case 6:g=E.sent(),n.push(new pa('ALTER TYPE "'+g.schema+'"."'+g.name+'" RENAME TO '+this.buildEnumName(a,y,!1))),r.push(new pa("ALTER TYPE "+this.buildEnumName(a,y)+' RENAME TO "'+g.name+'"')),E.label=7;case 7:return m=p.next(),[3,5];case 8:return[3,11];case 9:return b=E.sent(),v={error:b},[3,11];case 10:try{m&&!m.done&&(w=p.return)&&w.call(p)}finally{if(v)throw v.error}return[7];case 11:return[4,this.executeQueries(n,r)];case 12:return E.sent(),[2]}}))}))},t.prototype.addColumn=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,f,h,d;return Oe(this,(function(p){switch(p.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=p.sent(),p.label=3;case 3:return i=(n=r).clone(),o=[],a=[],"enum"!==t.type&&"simple-enum"!==t.type?[3,5]:[4,this.hasEnumType(n,t)];case 4:p.sent()||(o.push(this.createEnumTypeSql(n,t)),a.push(this.dropEnumTypeSql(n,t))),p.label=5;case 5:return o.push(new pa("ALTER TABLE "+this.escapePath(n)+" ADD "+this.buildCreateColumnSql(n,t))),a.push(new pa("ALTER TABLE "+this.escapePath(n)+' DROP COLUMN "'+t.name+'"')),t.isPrimary&&((s=i.primaryColumns).length>0&&(u=this.connection.namingStrategy.primaryKeyName(i,s.map((function(e){return e.name}))),c=s.map((function(e){return'"'+e.name+'"'})).join(", "),o.push(new pa("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+u+'"')),a.push(new pa("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+u+'" PRIMARY KEY ('+c+")"))),s.push(t),l=this.connection.namingStrategy.primaryKeyName(i,s.map((function(e){return e.name}))),f=s.map((function(e){return'"'+e.name+'"'})).join(", "),o.push(new pa("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+l+'" PRIMARY KEY ('+f+")")),a.push(new pa("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+l+'"'))),(h=i.indices.find((function(e){return 1===e.columnNames.length&&e.columnNames[0]===t.name})))&&(o.push(this.createIndexSql(n,h)),a.push(this.dropIndexSql(n,h))),t.isUnique&&(d=new ln({name:this.connection.namingStrategy.uniqueConstraintName(n,[t.name]),columnNames:[t.name]}),i.uniques.push(d),o.push(new pa("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+d.name+'" UNIQUE ("'+t.name+'")')),a.push(new pa("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+d.name+'"'))),t.comment&&(o.push(new pa("COMMENT ON COLUMN "+this.escapePath(n)+'."'+t.name+'" IS '+this.escapeComment(t.comment))),a.push(new pa("COMMENT ON COLUMN "+this.escapePath(n)+'."'+t.name+'" IS '+this.escapeComment(t.comment)))),[4,this.executeQueries(o,a)];case 6:return p.sent(),i.addColumn(t),this.replaceCachedTable(n,i),[2]}}))}))},t.prototype.addColumns=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Ce(t),r=n.next(),u.label=1;case 1:return r.done?[3,4]:(i=r.value,[4,this.addColumn(e,i)]);case 2:u.sent(),u.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.renameColumn=function(e,t,n){return Ne(this,void 0,void 0,(function(){var r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e instanceof dn?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=s.sent(),s.label=3;case 3:if(r=i,!(o=t instanceof an?t:r.columns.find((function(e){return e.name===t}))))throw new rt('Column "'+t+'" was not found in the "'+r.name+'" table.');return n instanceof an?a=n:(a=o.clone()).name=n,[2,this.changeColumn(r,o,a)]}}))}))},t.prototype.changeColumn=function(e,t,n){return Ne(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b,v,w,_,E,S,x,T,M,A,R,I,P,N,O,C=this;return Oe(this,(function(k){switch(k.label){case 0:return e instanceof dn?(i=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:i=k.sent(),k.label=3;case 3:if(o=(r=i).clone(),a=[],s=[],u=!1,!(c=t instanceof an?t:r.columns.find((function(e){return e.name===t}))))throw new rt('Column "'+t+'" was not found in the "'+r.name+'" table.');return c.type===n.type&&c.length===n.length&&n.isArray===c.isArray?[3,6]:[4,this.dropColumn(r,c)];case 4:return k.sent(),[4,this.addColumn(r,n)];case 5:return k.sent(),o=r.clone(),[3,10];case 6:return c.name===n.name?[3,9]:(a.push(new pa("ALTER TABLE "+this.escapePath(r)+' RENAME COLUMN "'+c.name+'" TO "'+n.name+'"')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' RENAME COLUMN "'+n.name+'" TO "'+c.name+'"')),"enum"!==c.type&&"simple-enum"!==c.type?[3,8]:[4,this.getUserDefinedTypeName(r,c)]);case 7:l=k.sent(),a.push(new pa('ALTER TYPE "'+l.schema+'"."'+l.name+'" RENAME TO '+this.buildEnumName(r,n,!1))),s.push(new pa("ALTER TYPE "+this.buildEnumName(r,n)+' RENAME TO "'+l.name+'"')),k.label=8;case 8:!0===c.isPrimary&&(R=o.primaryColumns,N=R.map((function(e){return e.name})),f=this.connection.namingStrategy.primaryKeyName(o,N),N.splice(N.indexOf(c.name),1),N.push(n.name),h=this.connection.namingStrategy.primaryKeyName(o,N),a.push(new pa("ALTER TABLE "+this.escapePath(r)+' RENAME CONSTRAINT "'+f+'" TO "'+h+'"')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' RENAME CONSTRAINT "'+h+'" TO "'+f+'"'))),!0===c.isGenerated&&"increment"===n.generationStrategy&&(d=this.buildSequencePath(r,c.name),p=this.buildSequenceName(r,c.name),m=this.buildSequencePath(r,n.name),y=this.buildSequenceName(r,n.name),g="ALTER SEQUENCE "+this.escapePath(d)+' RENAME TO "'+y+'"',b="ALTER SEQUENCE "+this.escapePath(m)+' RENAME TO "'+p+'"',a.push(new pa(g)),s.push(new pa(b))),o.findColumnUniques(c).forEach((function(e){e.columnNames.splice(e.columnNames.indexOf(c.name),1),e.columnNames.push(n.name);var t=C.connection.namingStrategy.uniqueConstraintName(o,e.columnNames);a.push(new pa("ALTER TABLE "+C.escapePath(r)+' RENAME CONSTRAINT "'+e.name+'" TO "'+t+'"')),s.push(new pa("ALTER TABLE "+C.escapePath(r)+' RENAME CONSTRAINT "'+t+'" TO "'+e.name+'"')),e.name=t})),o.findColumnIndices(c).forEach((function(e){e.columnNames.splice(e.columnNames.indexOf(c.name),1),e.columnNames.push(n.name);var t=C.driver.parseTableName(r).schema,i=C.connection.namingStrategy.indexName(o,e.columnNames,e.where),u=t?'ALTER INDEX "'+t+'"."'+e.name+'" RENAME TO "'+i+'"':'ALTER INDEX "'+e.name+'" RENAME TO "'+i+'"',l=t?'ALTER INDEX "'+t+'"."'+i+'" RENAME TO "'+e.name+'"':'ALTER INDEX "'+i+'" RENAME TO "'+e.name+'"';a.push(new pa(u)),s.push(new pa(l)),e.name=i})),o.findColumnForeignKeys(c).forEach((function(e){e.columnNames.splice(e.columnNames.indexOf(c.name),1),e.columnNames.push(n.name);var t=C.connection.namingStrategy.foreignKeyName(o,e.columnNames,C.getTablePath(e),e.referencedColumnNames);a.push(new pa("ALTER TABLE "+C.escapePath(r)+' RENAME CONSTRAINT "'+e.name+'" TO "'+t+'"')),s.push(new pa("ALTER TABLE "+C.escapePath(r)+' RENAME CONSTRAINT "'+t+'" TO "'+e.name+'"')),e.name=t})),v=o.columns.find((function(e){return e.name===c.name})),o.columns[o.columns.indexOf(v)].name=n.name,c.name=n.name,k.label=9;case 9:n.precision===c.precision&&n.scale===c.scale||(a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" TYPE '+this.driver.createFullType(n))),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" TYPE '+this.driver.createFullType(c)))),"enum"!==n.type&&"simple-enum"!==n.type||"enum"!==c.type&&"simple-enum"!==c.type||Ze.isArraysEqual(n.enum,c.enum)&&n.enumName===c.enumName||(w=n.isArray?"[]":"",_=this.buildEnumName(r,n),E=this.buildEnumName(r,c),S=this.buildEnumName(r,c,!1),x=this.buildEnumName(r,c,!0,!1,!0),T=this.buildEnumName(r,c,!1,!1,!0),a.push(new pa("ALTER TYPE "+E+" RENAME TO "+T)),s.push(new pa("ALTER TYPE "+x+" RENAME TO "+S)),a.push(this.createEnumTypeSql(r,n,_)),s.push(this.dropEnumTypeSql(r,n,_)),null!==c.default&&void 0!==c.default&&(u=!0,a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+c.name+'" DROP DEFAULT')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+c.name+'" SET DEFAULT '+c.default))),M=""+_+w+' USING "'+n.name+'"::"text"::'+_+w,A=""+x+w+' USING "'+n.name+'"::"text"::'+x+w,a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" TYPE '+M)),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" TYPE '+A)),null!==n.default&&void 0!==n.default&&(a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" SET DEFAULT '+n.default)),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT'))),a.push(this.dropEnumTypeSql(r,c,x)),s.push(this.createEnumTypeSql(r,c,x))),c.isNullable!==n.isNullable&&(n.isNullable?(a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+c.name+'" DROP NOT NULL')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+c.name+'" SET NOT NULL'))):(a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+c.name+'" SET NOT NULL')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+c.name+'" DROP NOT NULL')))),c.comment!==n.comment&&(a.push(new pa("COMMENT ON COLUMN "+this.escapePath(r)+'."'+c.name+'" IS '+this.escapeComment(n.comment))),s.push(new pa("COMMENT ON COLUMN "+this.escapePath(r)+'."'+n.name+'" IS '+this.escapeComment(c.comment)))),n.isPrimary!==c.isPrimary&&((R=o.primaryColumns).length>0&&(P=this.connection.namingStrategy.primaryKeyName(o,R.map((function(e){return e.name}))),N=R.map((function(e){return'"'+e.name+'"'})).join(", "),a.push(new pa("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+P+'"')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+P+'" PRIMARY KEY ('+N+")"))),!0===n.isPrimary?(R.push(n),o.columns.find((function(e){return e.name===n.name})).isPrimary=!0,P=this.connection.namingStrategy.primaryKeyName(o,R.map((function(e){return e.name}))),N=R.map((function(e){return'"'+e.name+'"'})).join(", "),a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+P+'" PRIMARY KEY ('+N+")")),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+P+'"'))):(I=R.find((function(e){return e.name===n.name})),R.splice(R.indexOf(I),1),o.columns.find((function(e){return e.name===n.name})).isPrimary=!1,R.length>0&&(P=this.connection.namingStrategy.primaryKeyName(o,R.map((function(e){return e.name}))),N=R.map((function(e){return'"'+e.name+'"'})).join(", "),a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+P+'" PRIMARY KEY ('+N+")")),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+P+'"'))))),n.isUnique!==c.isUnique&&(!0===n.isUnique?(O=new ln({name:this.connection.namingStrategy.uniqueConstraintName(r,[n.name]),columnNames:[n.name]}),o.uniques.push(O),a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+O.name+'" UNIQUE ("'+n.name+'")')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+O.name+'"'))):(O=o.uniques.find((function(e){return 1===e.columnNames.length&&!!e.columnNames.find((function(e){return e===n.name}))})),o.uniques.splice(o.uniques.indexOf(O),1),a.push(new pa("ALTER TABLE "+this.escapePath(r)+' DROP CONSTRAINT "'+O.name+'"')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ADD CONSTRAINT "'+O.name+'" UNIQUE ("'+n.name+'")')))),c.isGenerated!==n.isGenerated&&"uuid"!==n.generationStrategy&&(!0===n.isGenerated?(a.push(new pa("CREATE SEQUENCE IF NOT EXISTS "+this.escapePath(this.buildSequencePath(r,n))+" OWNED BY "+this.escapePath(r)+'."'+n.name+'"')),s.push(new pa("DROP SEQUENCE "+this.escapePath(this.buildSequencePath(r,n)))),a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+"\" SET DEFAULT nextval('"+this.escapePath(this.buildSequencePath(r,n))+"')")),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT'))):(a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+"\" SET DEFAULT nextval('"+this.escapePath(this.buildSequencePath(r,n))+"')")),a.push(new pa("DROP SEQUENCE "+this.escapePath(this.buildSequencePath(r,n)))),s.push(new pa("CREATE SEQUENCE IF NOT EXISTS "+this.escapePath(this.buildSequencePath(r,n))+" OWNED BY "+this.escapePath(r)+'."'+n.name+'"')))),n.default===c.default||u||(null!==n.default&&void 0!==n.default?(a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" SET DEFAULT '+n.default)),null!==c.default&&void 0!==c.default?s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" SET DEFAULT '+c.default)):s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT'))):null!==c.default&&void 0!==c.default&&(a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" DROP DEFAULT')),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" SET DEFAULT '+c.default)))),(n.spatialFeatureType||"").toLowerCase()===(c.spatialFeatureType||"").toLowerCase()&&n.srid===c.srid||(a.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" TYPE '+this.driver.createFullType(n))),s.push(new pa("ALTER TABLE "+this.escapePath(r)+' ALTER COLUMN "'+n.name+'" TYPE '+this.driver.createFullType(c)))),k.label=10;case 10:return[4,this.executeQueries(a,s)];case 11:return k.sent(),this.replaceCachedTable(r,o),[2]}}))}))},t.prototype.changeColumns=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c;return Oe(this,(function(l){switch(l.label){case 0:l.trys.push([0,5,6,7]),n=Ce(t),r=n.next(),l.label=1;case 1:return r.done?[3,4]:(i=r.value,o=i.oldColumn,a=i.newColumn,[4,this.changeColumn(e,o,a)]);case 2:l.sent(),l.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return s=l.sent(),u={error:s},[3,7];case 6:try{r&&!r.done&&(c=n.return)&&c.call(n)}finally{if(u)throw u.error}return[7];case 7:return[2]}}))}))},t.prototype.dropColumn=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,f,h,d,p,m,y;return Oe(this,(function(g){switch(g.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=g.sent(),g.label=3;case 3:if(n=r,!(i=t instanceof an?t:n.findColumnByName(t)))throw new rt('Column "'+t+'" was not found in table "'+n.name+'"');return o=n.clone(),a=[],s=[],i.isPrimary&&(u=this.connection.namingStrategy.primaryKeyName(o,o.primaryColumns.map((function(e){return e.name}))),c=o.primaryColumns.map((function(e){return'"'+e.name+'"'})).join(", "),a.push(new pa("ALTER TABLE "+this.escapePath(o)+' DROP CONSTRAINT "'+u+'"')),s.push(new pa("ALTER TABLE "+this.escapePath(o)+' ADD CONSTRAINT "'+u+'" PRIMARY KEY ('+c+")")),o.findColumnByName(i.name).isPrimary=!1,o.primaryColumns.length>0&&(l=this.connection.namingStrategy.primaryKeyName(o,o.primaryColumns.map((function(e){return e.name}))),f=o.primaryColumns.map((function(e){return'"'+e.name+'"'})).join(", "),a.push(new pa("ALTER TABLE "+this.escapePath(o)+' ADD CONSTRAINT "'+l+'" PRIMARY KEY ('+f+")")),s.push(new pa("ALTER TABLE "+this.escapePath(o)+' DROP CONSTRAINT "'+l+'"')))),(h=o.indices.find((function(e){return 1===e.columnNames.length&&e.columnNames[0]===i.name})))&&(o.indices.splice(o.indices.indexOf(h),1),a.push(this.dropIndexSql(n,h)),s.push(this.createIndexSql(n,h))),(d=o.checks.find((function(e){return!!e.columnNames&&1===e.columnNames.length&&e.columnNames[0]===i.name})))&&(o.checks.splice(o.checks.indexOf(d),1),a.push(this.dropCheckConstraintSql(n,d)),s.push(this.createCheckConstraintSql(n,d))),(p=o.uniques.find((function(e){return 1===e.columnNames.length&&e.columnNames[0]===i.name})))&&(o.uniques.splice(o.uniques.indexOf(p),1),a.push(this.dropUniqueConstraintSql(n,p)),s.push(this.createUniqueConstraintSql(n,p))),a.push(new pa("ALTER TABLE "+this.escapePath(n)+' DROP COLUMN "'+i.name+'"')),s.push(new pa("ALTER TABLE "+this.escapePath(n)+" ADD "+this.buildCreateColumnSql(n,i))),"enum"!==i.type&&"simple-enum"!==i.type?[3,6]:[4,this.hasEnumType(n,i)];case 4:return g.sent()?[4,this.getUserDefinedTypeName(n,i)]:[3,6];case 5:m=g.sent(),y='"'+m.schema+'"."'+m.name+'"',a.push(this.dropEnumTypeSql(n,i,y)),s.push(this.createEnumTypeSql(n,i,y)),g.label=6;case 6:return[4,this.executeQueries(a,s)];case 7:return g.sent(),o.removeColumn(i),this.replaceCachedTable(n,o),[2]}}))}))},t.prototype.dropColumns=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Ce(t),r=n.next(),u.label=1;case 1:return r.done?[3,4]:(i=r.value,[4,this.dropColumn(e,i)]);case 2:u.sent(),u.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.createPrimaryKey=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=s.sent(),s.label=3;case 3:return i=(n=r).clone(),o=this.createPrimaryKeySql(n,t),i.columns.forEach((function(e){t.find((function(t){return t===e.name}))&&(e.isPrimary=!0)})),a=this.dropPrimaryKeySql(i),[4,this.executeQueries(o,a)];case 4:return s.sent(),this.replaceCachedTable(n,i),[2]}}))}))},t.prototype.updatePrimaryKeys=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s,u,c,l,f,h;return Oe(this,(function(d){switch(d.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=d.sent(),d.label=3;case 3:return i=(n=r).clone(),o=t.map((function(e){return e.name})),a=[],s=[],(u=i.primaryColumns).length>0&&(c=this.connection.namingStrategy.primaryKeyName(i,u.map((function(e){return e.name}))),l=u.map((function(e){return'"'+e.name+'"'})).join(", "),a.push(new pa("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+c+'"')),s.push(new pa("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+c+'" PRIMARY KEY ('+l+")"))),i.columns.filter((function(e){return-1!==o.indexOf(e.name)})).forEach((function(e){return e.isPrimary=!0})),f=this.connection.namingStrategy.primaryKeyName(i,o),h=o.map((function(e){return'"'+e+'"'})).join(", "),a.push(new pa("ALTER TABLE "+this.escapePath(n)+' ADD CONSTRAINT "'+f+'" PRIMARY KEY ('+h+")")),s.push(new pa("ALTER TABLE "+this.escapePath(n)+' DROP CONSTRAINT "'+f+'"')),[4,this.executeQueries(a,s)];case 4:return d.sent(),this.replaceCachedTable(n,i),[2]}}))}))},t.prototype.dropPrimaryKey=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return e instanceof dn?(n=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:n=o.sent(),o.label=3;case 3:return t=n,r=this.dropPrimaryKeySql(t),i=this.createPrimaryKeySql(t,t.primaryColumns.map((function(e){return e.name}))),[4,this.executeQueries(r,i)];case 4:return o.sent(),t.primaryColumns.forEach((function(e){e.isPrimary=!1})),[2]}}))}))},t.prototype.createUniqueConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=a.sent(),a.label=3;case 3:return n=r,t.name||(t.name=this.connection.namingStrategy.uniqueConstraintName(n,t.columnNames)),i=this.createUniqueConstraintSql(n,t),o=this.dropUniqueConstraintSql(n,t),[4,this.executeQueries(i,o)];case 4:return a.sent(),n.addUniqueConstraint(t),[2]}}))}))},t.prototype.createUniqueConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Ce(t),r=n.next(),u.label=1;case 1:return r.done?[3,4]:(i=r.value,[4,this.createUniqueConstraint(e,i)]);case 2:u.sent(),u.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.dropUniqueConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=s.sent(),s.label=3;case 3:if(n=r,!(i=t instanceof ln?t:n.uniques.find((function(e){return e.name===t}))))throw new rt("Supplied unique constraint was not found in table "+n.name);return o=this.dropUniqueConstraintSql(n,i),a=this.createUniqueConstraintSql(n,i),[4,this.executeQueries(o,a)];case 4:return s.sent(),n.removeUniqueConstraint(i),[2]}}))}))},t.prototype.dropUniqueConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Ce(t),r=n.next(),u.label=1;case 1:return r.done?[3,4]:(i=r.value,[4,this.dropUniqueConstraint(e,i)]);case 2:u.sent(),u.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.createCheckConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=a.sent(),a.label=3;case 3:return n=r,t.name||(t.name=this.connection.namingStrategy.checkConstraintName(n,t.expression)),i=this.createCheckConstraintSql(n,t),o=this.dropCheckConstraintSql(n,t),[4,this.executeQueries(i,o)];case 4:return a.sent(),n.addCheckConstraint(t),[2]}}))}))},t.prototype.createCheckConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return n=t.map((function(t){return r.createCheckConstraint(e,t)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},t.prototype.dropCheckConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=s.sent(),s.label=3;case 3:if(n=r,!(i=t instanceof fn?t:n.checks.find((function(e){return e.name===t}))))throw new rt("Supplied check constraint was not found in table "+n.name);return o=this.dropCheckConstraintSql(n,i),a=this.createCheckConstraintSql(n,i),[4,this.executeQueries(o,a)];case 4:return s.sent(),n.removeCheckConstraint(i),[2]}}))}))},t.prototype.dropCheckConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return n=t.map((function(t){return r.dropCheckConstraint(e,t)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},t.prototype.createExclusionConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=a.sent(),a.label=3;case 3:return n=r,t.name||(t.name=this.connection.namingStrategy.exclusionConstraintName(n,t.expression)),i=this.createExclusionConstraintSql(n,t),o=this.dropExclusionConstraintSql(n,t),[4,this.executeQueries(i,o)];case 4:return a.sent(),n.addExclusionConstraint(t),[2]}}))}))},t.prototype.createExclusionConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return n=t.map((function(t){return r.createExclusionConstraint(e,t)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},t.prototype.dropExclusionConstraint=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=s.sent(),s.label=3;case 3:if(n=r,!(i=t instanceof hn?t:n.exclusions.find((function(e){return e.name===t}))))throw new rt("Supplied exclusion constraint was not found in table "+n.name);return o=this.dropExclusionConstraintSql(n,i),a=this.createExclusionConstraintSql(n,i),[4,this.executeQueries(o,a)];case 4:return s.sent(),n.removeExclusionConstraint(i),[2]}}))}))},t.prototype.dropExclusionConstraints=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return n=t.map((function(t){return r.dropExclusionConstraint(e,t)})),[4,Promise.all(n)];case 1:return i.sent(),[2]}}))}))},t.prototype.createForeignKey=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=a.sent(),a.label=3;case 3:return n=r,t.name||(t.name=this.connection.namingStrategy.foreignKeyName(n,t.columnNames,this.getTablePath(t),t.referencedColumnNames)),i=this.createForeignKeySql(n,t),o=this.dropForeignKeySql(n,t),[4,this.executeQueries(i,o)];case 4:return a.sent(),n.addForeignKey(t),[2]}}))}))},t.prototype.createForeignKeys=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Ce(t),r=n.next(),u.label=1;case 1:return r.done?[3,4]:(i=r.value,[4,this.createForeignKey(e,i)]);case 2:u.sent(),u.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.dropForeignKey=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=s.sent(),s.label=3;case 3:if(n=r,!(i=t instanceof un?t:n.foreignKeys.find((function(e){return e.name===t}))))throw new rt("Supplied foreign key was not found in table "+n.name);return o=this.dropForeignKeySql(n,i),a=this.createForeignKeySql(n,i),[4,this.executeQueries(o,a)];case 4:return s.sent(),n.removeForeignKey(i),[2]}}))}))},t.prototype.dropForeignKeys=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Ce(t),r=n.next(),u.label=1;case 1:return r.done?[3,4]:(i=r.value,[4,this.dropForeignKey(e,i)]);case 2:u.sent(),u.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.createIndex=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o;return Oe(this,(function(a){switch(a.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=a.sent(),a.label=3;case 3:return n=r,t.name||(t.name=this.connection.namingStrategy.indexName(n,t.columnNames,t.where)),i=this.createIndexSql(n,t),o=this.dropIndexSql(n,t),[4,this.executeQueries(i,o)];case 4:return a.sent(),n.addIndex(t),[2]}}))}))},t.prototype.createIndices=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Ce(t),r=n.next(),u.label=1;case 1:return r.done?[3,4]:(i=r.value,[4,this.createIndex(e,i)]);case 2:u.sent(),u.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.dropIndex=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return e instanceof dn?(r=e,[3,3]):[3,1];case 1:return[4,this.getCachedTable(e)];case 2:r=s.sent(),s.label=3;case 3:if(n=r,!(i=t instanceof sn?t:n.indices.find((function(e){return e.name===t}))))throw new rt("Supplied index was not found in table "+n.name);return o=this.dropIndexSql(n,i),a=this.createIndexSql(n,i),[4,this.executeQueries(o,a)];case 4:return s.sent(),n.removeIndex(i),[2]}}))}))},t.prototype.dropIndices=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:u.trys.push([0,5,6,7]),n=Ce(t),r=n.next(),u.label=1;case 1:return r.done?[3,4]:(i=r.value,[4,this.dropIndex(e,i)]);case 2:u.sent(),u.label=3;case 3:return r=n.next(),[3,1];case 4:return[3,7];case 5:return o=u.sent(),a={error:o},[3,7];case 6:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 7:return[2]}}))}))},t.prototype.clearTable=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:return[4,this.query("TRUNCATE TABLE "+this.escapePath(e))];case 1:return t.sent(),[2]}}))}))},t.prototype.clearDatabase=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s,u,c,l=this;return Oe(this,(function(f){switch(f.label){case 0:return e=[],this.connection.entityMetadatas.filter((function(e){return e.schema})).forEach((function(t){!!e.find((function(e){return e===t.schema}))||e.push(t.schema)})),e.push(this.driver.options.schema||"current_schema()"),t=e.map((function(e){return"current_schema()"===e?e:"'"+e+"'"})).join(", "),[4,this.startTransaction()];case 1:f.sent(),f.label=2;case 2:return f.trys.push([2,13,,18]),[4,this.getVersion()];case 3:return n=f.sent(),r='SELECT \'DROP VIEW IF EXISTS "\' || schemaname || \'"."\' || viewname || \'" CASCADE;\' as "query" FROM "pg_views" WHERE "schemaname" IN ('+t+") AND \"viewname\" NOT IN ('geography_columns', 'geometry_columns', 'raster_columns', 'raster_overviews')",[4,this.query(r)];case 4:return i=f.sent(),[4,Promise.all(i.map((function(e){return l.query(e.query)})))];case 5:return f.sent(),Ca.isGreaterOrEqual(n,"9.3")?(o='SELECT \'DROP MATERIALIZED VIEW IF EXISTS "\' || schemaname || \'"."\' || matviewname || \'" CASCADE;\' as "query" FROM "pg_matviews" WHERE "schemaname" IN ('+t+")",[4,this.query(o)]):[3,8];case 6:return a=f.sent(),[4,Promise.all(a.map((function(e){return l.query(e.query)})))];case 7:f.sent(),f.label=8;case 8:return s='SELECT \'DROP TABLE IF EXISTS "\' || schemaname || \'"."\' || tablename || \'" CASCADE;\' as "query" FROM "pg_tables" WHERE "schemaname" IN ('+t+") AND \"tablename\" NOT IN ('spatial_ref_sys')",[4,this.query(s)];case 9:return u=f.sent(),[4,Promise.all(u.map((function(e){return l.query(e.query)})))];case 10:return f.sent(),[4,this.dropEnumTypes(t)];case 11:return f.sent(),[4,this.commitTransaction()];case 12:return f.sent(),[3,18];case 13:c=f.sent(),f.label=14;case 14:return f.trys.push([14,16,,17]),[4,this.rollbackTransaction()];case 15:return f.sent(),[3,17];case 16:return f.sent(),[3,17];case 17:throw c;case 18:return[2]}}))}))},t.prototype.loadViews=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o=this;return Oe(this,(function(a){switch(a.label){case 0:return[4,this.hasTable(this.getTypeormMetadataTableName())];case 1:return a.sent()?(e||(e=[]),[4,this.getCurrentDatabase()]):[2,[]];case 2:return t=a.sent(),[4,this.getCurrentSchema()];case 3:return n=a.sent(),r=0===e.length?"1=1":e.map((function(e){return o.driver.parseTableName(e)})).map((function(e){var t=e.schema,r=e.tableName;return t||(t=o.driver.options.schema||n),'("t"."schema" = \''+t+'\' AND "t"."name" = \''+r+"')"})).join(" OR "),i='SELECT "t".* FROM '+this.escapePath(this.getTypeormMetadataTableName())+' "t" INNER JOIN "pg_catalog"."pg_class" "c" ON "c"."relname" = "t"."name" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "c"."relnamespace" AND "n"."nspname" = "t"."schema" WHERE "t"."type" IN (\'VIEW\', \'MATERIALIZED_VIEW\') '+(r?"AND ("+r+")":""),[4,this.query(i)];case 4:return[2,a.sent().map((function(e){var r=new pn,i=e.schema!==n||o.driver.options.schema?e.schema:void 0;return r.database=t,r.schema=e.schema,r.name=o.driver.buildTableName(e.name,i),r.expression=e.value,r.materialized="MATERIALIZED_VIEW"===e.type,r}))]}}))}))},t.prototype.loadTables=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b,v,w,_,E,S,x,T,M,A=this;return Oe(this,(function(R){switch(R.label){case 0:return e&&0===e.length?[2,[]]:[4,this.getCurrentSchema()];case 1:return t=R.sent(),[4,this.getCurrentDatabase()];case 2:return n=R.sent(),r=[],e?[3,4]:(c='SELECT "table_schema", "table_name" FROM "information_schema"."tables"',o=(i=r.push).apply,a=[r],s=[[]],[4,this.query(c)]);case 3:return o.apply(i,a.concat([Be.apply(void 0,s.concat([ke.apply(void 0,[R.sent()])]))])),[3,6];case 4:return u=e.map((function(e){return A.driver.parseTableName(e)})).map((function(e){var n=e.schema,r=e.tableName;return'("table_schema" = \''+(n||t)+"' AND \"table_name\" = '"+r+"')"})).join(" OR "),c='SELECT "table_schema", "table_name" FROM "information_schema"."tables" WHERE '+u,f=(l=r.push).apply,h=[r],d=[[]],[4,this.query(c)];case 5:f.apply(l,h.concat([Be.apply(void 0,d.concat([ke.apply(void 0,[R.sent()])]))])),R.label=6;case 6:return 0===r.length?[2,[]]:(p=r.map((function(e){return'("table_schema" = \''+e.table_schema+"' AND \"table_name\" = '"+e.table_name+"')"})).join(" OR "),m='SELECT columns.*, pg_catalog.col_description((\'"\' || table_catalog || \'"."\' || table_schema || \'"."\' || table_name || \'"\')::regclass::oid, ordinal_position) AS description, (\'"\' || "udt_schema" || \'"."\' || "udt_name" || \'"\')::"regtype" AS "regtype", pg_catalog.format_type("col_attr"."atttypid", "col_attr"."atttypmod") AS "format_type" FROM "information_schema"."columns" LEFT JOIN "pg_catalog"."pg_attribute" AS "col_attr" ON "col_attr"."attname" = "columns"."column_name" AND "col_attr"."attrelid" = ( SELECT "cls"."oid" FROM "pg_catalog"."pg_class" AS "cls" LEFT JOIN "pg_catalog"."pg_namespace" AS "ns" ON "ns"."oid" = "cls"."relnamespace" WHERE "cls"."relname" = "columns"."table_name" AND "ns"."nspname" = "columns"."table_schema" ) WHERE '+p,y=r.map((function(e){return'("ns"."nspname" = \''+e.table_schema+'\' AND "t"."relname" = \''+e.table_name+"')"})).join(" OR "),g='SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "cnst"."conname" AS "constraint_name", pg_get_constraintdef("cnst"."oid") AS "expression", CASE "cnst"."contype" WHEN \'p\' THEN \'PRIMARY\' WHEN \'u\' THEN \'UNIQUE\' WHEN \'c\' THEN \'CHECK\' WHEN \'x\' THEN \'EXCLUDE\' END AS "constraint_type", "a"."attname" AS "column_name" FROM "pg_constraint" "cnst" INNER JOIN "pg_class" "t" ON "t"."oid" = "cnst"."conrelid" INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "cnst"."connamespace" LEFT JOIN "pg_attribute" "a" ON "a"."attrelid" = "cnst"."conrelid" AND "a"."attnum" = ANY ("cnst"."conkey") WHERE "t"."relkind" IN (\'r\', \'p\') AND ('+y+")",b='SELECT "ns"."nspname" AS "table_schema", "t"."relname" AS "table_name", "i"."relname" AS "constraint_name", "a"."attname" AS "column_name", CASE "ix"."indisunique" WHEN \'t\' THEN \'TRUE\' ELSE\'FALSE\' END AS "is_unique", pg_get_expr("ix"."indpred", "ix"."indrelid") AS "condition", "types"."typname" AS "type_name" FROM "pg_class" "t" INNER JOIN "pg_index" "ix" ON "ix"."indrelid" = "t"."oid" INNER JOIN "pg_attribute" "a" ON "a"."attrelid" = "t"."oid"  AND "a"."attnum" = ANY ("ix"."indkey") INNER JOIN "pg_namespace" "ns" ON "ns"."oid" = "t"."relnamespace" INNER JOIN "pg_class" "i" ON "i"."oid" = "ix"."indexrelid" INNER JOIN "pg_type" "types" ON "types"."oid" = "a"."atttypid" LEFT JOIN "pg_constraint" "cnst" ON "cnst"."conname" = "i"."relname" WHERE "t"."relkind" IN (\'r\', \'p\') AND "cnst"."contype" IS NULL AND ('+y+")",v=r.map((function(e){return'("ns"."nspname" = \''+e.table_schema+'\' AND "cl"."relname" = \''+e.table_name+"')"})).join(" OR "),[4,this.hasSupportForPartitionedTables()]);case 7:return w=R.sent(),_='SELECT "con"."conname" AS "constraint_name", "con"."nspname" AS "table_schema", "con"."relname" AS "table_name", "att2"."attname" AS "column_name", "ns"."nspname" AS "referenced_table_schema", "cl"."relname" AS "referenced_table_name", "att"."attname" AS "referenced_column_name", "con"."confdeltype" AS "on_delete", "con"."confupdtype" AS "on_update", "con"."condeferrable" AS "deferrable", "con"."condeferred" AS "deferred" FROM ( SELECT UNNEST ("con1"."conkey") AS "parent", UNNEST ("con1"."confkey") AS "child", "con1"."confrelid", "con1"."conrelid", "con1"."conname", "con1"."contype", "ns"."nspname", "cl"."relname", "con1"."condeferrable", CASE WHEN "con1"."condeferred" THEN \'INITIALLY DEFERRED\' ELSE \'INITIALLY IMMEDIATE\' END as condeferred, CASE "con1"."confdeltype" WHEN \'a\' THEN \'NO ACTION\' WHEN \'r\' THEN \'RESTRICT\' WHEN \'c\' THEN \'CASCADE\' WHEN \'n\' THEN \'SET NULL\' WHEN \'d\' THEN \'SET DEFAULT\' END as "confdeltype", CASE "con1"."confupdtype" WHEN \'a\' THEN \'NO ACTION\' WHEN \'r\' THEN \'RESTRICT\' WHEN \'c\' THEN \'CASCADE\' WHEN \'n\' THEN \'SET NULL\' WHEN \'d\' THEN \'SET DEFAULT\' END as "confupdtype" FROM "pg_class" "cl" INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_constraint" "con1" ON "con1"."conrelid" = "cl"."oid" WHERE "con1"."contype" = \'f\' AND ('+v+') ) "con" INNER JOIN "pg_attribute" "att" ON "att"."attrelid" = "con"."confrelid" AND "att"."attnum" = "con"."child" INNER JOIN "pg_class" "cl" ON "cl"."oid" = "con"."confrelid" '+(w?' AND "cl"."relispartition" = \'f\'':"")+'INNER JOIN "pg_namespace" "ns" ON "cl"."relnamespace" = "ns"."oid" INNER JOIN "pg_attribute" "att2" ON "att2"."attrelid" = "con"."conrelid" AND "att2"."attnum" = "con"."parent"',[4,Promise.all([this.query(m),this.query(g),this.query(b),this.query(_)])];case 8:return E=ke.apply(void 0,[R.sent(),4]),S=E[0],x=E[1],T=E[2],M=E[3],[2,Promise.all(r.map((function(e){return Ne(A,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,f,h=this;return Oe(this,(function(d){switch(d.label){case 0:return r=new dn,o=(i=function(e,n){return e[n]!==t||h.driver.options.schema&&h.driver.options.schema!==t?e[n]:void 0})(e,"table_schema"),r.database=n,r.schema=e.table_schema,r.name=this.driver.buildTableName(e.table_name,o),a=r,[4,Promise.all(S.filter((function(t){return t.table_name===e.table_name&&t.table_schema===e.table_schema})).map((function(t){return Ne(h,void 0,void 0,(function(){var n,i,o,a,s,u,c,l,f,h,d,p,m,y,g,b,v;return Oe(this,(function(w){switch(w.label){case 0:return n=x.filter((function(e){return e.table_name===t.table_name&&e.table_schema===t.table_schema&&e.column_name===t.column_name})),(i=new an).name=t.column_name,i.type=t.regtype.toLowerCase(),"numeric"!==i.type&&"decimal"!==i.type&&"float"!==i.type||(null===t.numeric_precision||this.isDefaultColumnPrecision(r,i,t.numeric_precision)?null===t.numeric_scale||this.isDefaultColumnScale(r,i,t.numeric_scale)||(i.precision=void 0):i.precision=t.numeric_precision,null===t.numeric_scale||this.isDefaultColumnScale(r,i,t.numeric_scale)?null===t.numeric_precision||this.isDefaultColumnPrecision(r,i,t.numeric_precision)||(i.scale=void 0):i.scale=t.numeric_scale),"interval"!==i.type&&"time without time zone"!==i.type&&"time with time zone"!==i.type&&"timestamp without time zone"!==i.type&&"timestamp with time zone"!==i.type||(i.precision=this.isDefaultColumnPrecision(r,i,t.datetime_precision)?void 0:t.datetime_precision),"USER-DEFINED"!==t.data_type&&"ARRAY"!==t.data_type?[3,3]:[4,this.getUserDefinedTypeName(r,i)];case 1:return o=w.sent().name,a=this.buildEnumName(r,i,!1,!0),s=a!==o?o:void 0,u='SELECT "e"."enumlabel" AS "value" FROM "pg_enum" "e" INNER JOIN "pg_type" "t" ON "t"."oid" = "e"."enumtypid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = \''+e.table_schema+'\' AND "t"."typname" = \''+(s||o)+"'",[4,this.query(u)];case 2:(h=w.sent()).length&&(i.type="enum",i.enum=h.map((function(e){return e.value})),i.enumName=s),"ARRAY"===t.data_type&&(i.isArray=!0,c=i.type.replace("[]",""),i.type=this.connection.driver.normalizeType({type:c})),w.label=3;case 3:return"geometry"!==i.type?[3,5]:(l='SELECT * FROM (\n                        SELECT\n                          "f_table_schema" "table_schema",\n                          "f_table_name" "table_name",\n                          "f_geometry_column" "column_name",\n                          "srid",\n                          "type"\n                        FROM "geometry_columns"\n                      ) AS _\n                      WHERE\n                          "column_name" = \''+t.column_name+"' AND\n                          \"table_schema\" = '"+t.table_schema+"' AND\n                          \"table_name\" = '"+t.table_name+"'",[4,this.query(l)]);case 4:(h=w.sent()).length>0&&(i.spatialFeatureType=h[0].type,i.srid=h[0].srid),w.label=5;case 5:return"geography"!==i.type?[3,7]:(f='SELECT * FROM (\n                        SELECT\n                          "f_table_schema" "table_schema",\n                          "f_table_name" "table_name",\n                          "f_geography_column" "column_name",\n                          "srid",\n                          "type"\n                        FROM "geography_columns"\n                      ) AS _\n                      WHERE\n                          "column_name" = \''+t.column_name+"' AND\n                          \"table_schema\" = '"+t.table_schema+"' AND\n                          \"table_name\" = '"+t.table_name+"'",[4,this.query(f)]);case 6:(h=w.sent()).length>0&&(i.spatialFeatureType=h[0].type,i.srid=h[0].srid),w.label=7;case 7:return-1!==this.driver.withLengthColumnTypes.indexOf(i.type)&&(i.isArray?(p=/\((\d+)\)/.exec(t.format_type),d=p?p[1]:void 0):t.character_maximum_length&&(d=t.character_maximum_length.toString()),d&&(i.length=this.isDefaultColumnLength(r,i,d)?"":d)),i.isNullable="YES"===t.is_nullable,i.isPrimary=!!n.find((function(e){return"PRIMARY"===e.constraint_type})),m=n.find((function(e){return"UNIQUE"===e.constraint_type})),y=!!m&&!!x.find((function(e){return"UNIQUE"===e.constraint_type&&e.constraint_name===m.constraint_name&&e.column_name!==t.column_name})),i.isUnique=!!m&&!y,null!==t.column_default&&void 0!==t.column_default&&(g="nextval('"+this.buildSequenceName(r,t.column_name)+"'::regclass)",b="nextval('"+this.buildSequencePath(r,t.column_name)+"'::regclass)",(v=t.column_default.replace(/"/g,""))===g||v===b?(i.isGenerated=!0,i.generationStrategy="increment"):"gen_random_uuid()"===t.column_default||/^uuid_generate_v\d\(\)/.test(t.column_default)?(i.isGenerated=!0,i.generationStrategy="uuid"):"now()"===t.column_default||-1!==t.column_default.indexOf("'now'::text")?i.default=t.column_default:(i.default=t.column_default.replace(/::[\w\s\[\]\"]+/g,""),i.default=i.default.replace(/^(-?\d+)$/,"'$1'"))),i.comment=t.description?t.description:void 0,t.character_set_name&&(i.charset=t.character_set_name),t.collation_name&&(i.collation=t.collation_name),[2,i]}}))}))})))];case 1:return a.columns=d.sent(),s=Ze.uniq(x.filter((function(t){return t.table_name===e.table_name&&t.table_schema===e.table_schema&&"UNIQUE"===t.constraint_type})),(function(e){return e.constraint_name})),r.uniques=s.map((function(e){var t=x.filter((function(t){return t.constraint_name===e.constraint_name}));return new ln({name:e.constraint_name,columnNames:t.map((function(e){return e.column_name}))})})),u=Ze.uniq(x.filter((function(t){return t.table_name===e.table_name&&t.table_schema===e.table_schema&&"CHECK"===t.constraint_type})),(function(e){return e.constraint_name})),r.checks=u.map((function(e){var t=x.filter((function(t){return t.constraint_name===e.constraint_name}));return new fn({name:e.constraint_name,columnNames:t.map((function(e){return e.column_name})),expression:e.expression.replace(/^\s*CHECK\s*\((.*)\)\s*$/i,"$1")})})),c=Ze.uniq(x.filter((function(t){return t.table_name===e.table_name&&t.table_schema===e.table_schema&&"EXCLUDE"===t.constraint_type})),(function(e){return e.constraint_name})),r.exclusions=c.map((function(e){return new hn({name:e.constraint_name,expression:e.expression.substring(8)})})),l=Ze.uniq(M.filter((function(t){return t.table_name===e.table_name&&t.table_schema===e.table_schema})),(function(e){return e.constraint_name})),r.foreignKeys=l.map((function(e){var t=M.filter((function(t){return t.constraint_name===e.constraint_name})),n=i(e,"referenced_table_schema"),r=h.driver.buildTableName(e.referenced_table_name,n);return new un({name:e.constraint_name,columnNames:t.map((function(e){return e.column_name})),referencedTableName:r,referencedColumnNames:t.map((function(e){return e.referenced_column_name})),onDelete:e.on_delete,onUpdate:e.on_update,deferrable:e.deferrable?e.deferred:void 0})})),f=Ze.uniq(T.filter((function(t){return t.table_name===e.table_name&&t.table_schema===e.table_schema})),(function(e){return e.constraint_name})),r.indices=f.map((function(e){var t=T.filter((function(t){return t.table_schema===e.table_schema&&t.table_name===e.table_name&&t.constraint_name===e.constraint_name}));return new sn({table:r,name:e.constraint_name,columnNames:t.map((function(e){return e.column_name})),isUnique:"TRUE"===e.is_unique,where:e.condition,isSpatial:t.every((function(e){return h.driver.spatialTypes.indexOf(e.type_name)>=0})),isFulltext:!1})})),[2,r]}}))}))})))]}}))}))},t.prototype.createTableSql=function(e,t){var n=this,r=e.columns.map((function(t){return n.buildCreateColumnSql(e,t)})).join(", "),i="CREATE TABLE "+this.escapePath(e)+" ("+r;if(e.columns.filter((function(e){return e.isUnique})).forEach((function(t){e.uniques.some((function(e){return 1===e.columnNames.length&&e.columnNames[0]===t.name}))||e.uniques.push(new ln({name:n.connection.namingStrategy.uniqueConstraintName(e,[t.name]),columnNames:[t.name]}))})),e.uniques.length>0){var o=e.uniques.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.uniqueConstraintName(e,t.columnNames))+'" UNIQUE ('+t.columnNames.map((function(e){return'"'+e+'"'})).join(", ")+")"})).join(", ");i+=", "+o}if(e.checks.length>0){var a=e.checks.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.checkConstraintName(e,t.expression))+'" CHECK ('+t.expression+")"})).join(", ");i+=", "+a}if(e.exclusions.length>0){var s=e.exclusions.map((function(t){return'CONSTRAINT "'+(t.name?t.name:n.connection.namingStrategy.exclusionConstraintName(e,t.expression))+'" EXCLUDE '+t.expression})).join(", ");i+=", "+s}if(e.foreignKeys.length>0&&t){var u=e.foreignKeys.map((function(t){var r=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");t.name||(t.name=n.connection.namingStrategy.foreignKeyName(e,t.columnNames,n.getTablePath(t),t.referencedColumnNames));var i=t.referencedColumnNames.map((function(e){return'"'+e+'"'})).join(", "),o='CONSTRAINT "'+t.name+'" FOREIGN KEY ('+r+") REFERENCES "+n.escapePath(n.getTablePath(t))+" ("+i+")";return t.onDelete&&(o+=" ON DELETE "+t.onDelete),t.onUpdate&&(o+=" ON UPDATE "+t.onUpdate),t.deferrable&&(o+=" DEFERRABLE "+t.deferrable),o})).join(", ");i+=", "+u}var c=e.columns.filter((function(e){return e.isPrimary}));if(c.length>0){var l=this.connection.namingStrategy.primaryKeyName(e,c.map((function(e){return e.name}))),f=c.map((function(e){return'"'+e.name+'"'})).join(", ");i+=', CONSTRAINT "'+l+'" PRIMARY KEY ('+f+")"}return i+=")",e.columns.filter((function(e){return e.comment})).forEach((function(t){return i+="; COMMENT ON COLUMN "+n.escapePath(e)+'."'+t.name+'" IS '+n.escapeComment(t.comment)})),new pa(i)},t.prototype.getVersion=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return[4,this.query("SHOW SERVER_VERSION")];case 1:return[2,e.sent()[0].server_version]}}))}))},t.prototype.dropTableSql=function(e){return new pa("DROP TABLE "+this.escapePath(e))},t.prototype.createViewSql=function(e){var t=e.materialized?"MATERIALIZED ":"",n=this.escapePath(e);return"string"==typeof e.expression?new pa("CREATE "+t+"VIEW "+n+" AS "+e.expression):new pa("CREATE "+t+"VIEW "+n+" AS "+e.expression(this.connection).getQuery())},t.prototype.insertViewDefinitionSql=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c;return Oe(this,(function(l){switch(l.label){case 0:return[4,this.getCurrentSchema()];case 1:return t=l.sent(),n=this.driver.parseTableName(e),r=n.schema,i=n.tableName,r||(r=t),o=e.materialized?"MATERIALIZED_VIEW":"VIEW",a="string"==typeof e.expression?e.expression.trim():e.expression(this.connection).getQuery(),s=ke(this.connection.createQueryBuilder().insert().into(this.getTypeormMetadataTableName()).values({type:o,schema:r,name:i,value:a}).getQueryAndParameters(),2),u=s[0],c=s[1],[2,new pa(u,c)]}}))}))},t.prototype.dropViewSql=function(e){var t=e.materialized?"MATERIALIZED ":"";return new pa("DROP "+t+"VIEW "+this.escapePath(e))},t.prototype.deleteViewDefinitionSql=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,u,c;return Oe(this,(function(l){switch(l.label){case 0:return[4,this.getCurrentSchema()];case 1:return t=l.sent(),n=this.driver.parseTableName(e),r=n.schema,i=n.tableName,r||(r=t),o=e.materialized?"MATERIALIZED_VIEW":"VIEW",a=this.connection.createQueryBuilder(),s=ke(a.delete().from(this.getTypeormMetadataTableName()).where(a.escape("type")+" = :type",{type:o}).andWhere(a.escape("schema")+" = :schema",{schema:r}).andWhere(a.escape("name")+" = :name",{name:i}).getQueryAndParameters(),2),u=s[0],c=s[1],[2,new pa(u,c)]}}))}))},t.prototype.dropEnumTypes=function(e){return Ne(this,void 0,void 0,(function(){var t,n,r=this;return Oe(this,(function(i){switch(i.label){case 0:return t='SELECT \'DROP TYPE IF EXISTS "\' || n.nspname || \'"."\' || t.typname || \'" CASCADE;\' as "query" FROM "pg_type" "t" INNER JOIN "pg_enum" "e" ON "e"."enumtypid" = "t"."oid" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" IN ('+e+') GROUP BY "n"."nspname", "t"."typname"',[4,this.query(t)];case 1:return n=i.sent(),[4,Promise.all(n.map((function(e){return r.query(e.query)})))];case 2:return i.sent(),[2]}}))}))},t.prototype.hasEnumType=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i;return Oe(this,(function(o){switch(o.label){case 0:return(n=this.driver.parseTableName(e).schema)?[3,2]:[4,this.getCurrentSchema()];case 1:n=o.sent(),o.label=2;case 2:return r=this.buildEnumName(e,t,!1,!0),i='SELECT "n"."nspname", "t"."typname" FROM "pg_type" "t" INNER JOIN "pg_namespace" "n" ON "n"."oid" = "t"."typnamespace" WHERE "n"."nspname" = \''+n+'\' AND "t"."typname" = \''+r+"'",[4,this.query(i)];case 3:return[2,!!o.sent().length]}}))}))},t.prototype.createEnumTypeSql=function(e,t,n){n||(n=this.buildEnumName(e,t));var r=t.enum.map((function(e){return"'"+e.replace("'","''")+"'"})).join(", ");return new pa("CREATE TYPE "+n+" AS ENUM("+r+")")},t.prototype.dropEnumTypeSql=function(e,t,n){return n||(n=this.buildEnumName(e,t)),new pa("DROP TYPE "+n)},t.prototype.createIndexSql=function(e,t){var n=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");return new pa("CREATE "+(t.isUnique?"UNIQUE ":"")+'INDEX "'+t.name+'" ON '+this.escapePath(e)+" "+(t.isSpatial?"USING GiST ":"")+"("+n+") "+(t.where?"WHERE "+t.where:""))},t.prototype.dropIndexSql=function(e,t){var n=t instanceof sn?t.name:t,r=this.driver.parseTableName(e).schema;return new pa(r?'DROP INDEX "'+r+'"."'+n+'"':'DROP INDEX "'+n+'"')},t.prototype.createPrimaryKeySql=function(e,t){var n=this.connection.namingStrategy.primaryKeyName(e,t),r=t.map((function(e){return'"'+e+'"'})).join(", ");return new pa("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+n+'" PRIMARY KEY ('+r+")")},t.prototype.dropPrimaryKeySql=function(e){var t=e.primaryColumns.map((function(e){return e.name})),n=this.connection.namingStrategy.primaryKeyName(e,t);return new pa("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.createUniqueConstraintSql=function(e,t){var n=t.columnNames.map((function(e){return'"'+e+'"'})).join(", ");return new pa("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t.name+'" UNIQUE ('+n+")")},t.prototype.dropUniqueConstraintSql=function(e,t){var n=t instanceof ln?t.name:t;return new pa("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.createCheckConstraintSql=function(e,t){return new pa("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t.name+'" CHECK ('+t.expression+")")},t.prototype.dropCheckConstraintSql=function(e,t){var n=t instanceof fn?t.name:t;return new pa("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.createExclusionConstraintSql=function(e,t){return new pa("ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t.name+'" EXCLUDE '+t.expression)},t.prototype.dropExclusionConstraintSql=function(e,t){var n=t instanceof hn?t.name:t;return new pa("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.createForeignKeySql=function(e,t){var n=t.columnNames.map((function(e){return'"'+e+'"'})).join(", "),r=t.referencedColumnNames.map((function(e){return'"'+e+'"'})).join(","),i="ALTER TABLE "+this.escapePath(e)+' ADD CONSTRAINT "'+t.name+'" FOREIGN KEY ('+n+") REFERENCES "+this.escapePath(this.getTablePath(t))+"("+r+")";return t.onDelete&&(i+=" ON DELETE "+t.onDelete),t.onUpdate&&(i+=" ON UPDATE "+t.onUpdate),t.deferrable&&(i+=" DEFERRABLE "+t.deferrable),new pa(i)},t.prototype.dropForeignKeySql=function(e,t){var n=t instanceof un?t.name:t;return new pa("ALTER TABLE "+this.escapePath(e)+' DROP CONSTRAINT "'+n+'"')},t.prototype.buildSequenceName=function(e,t){var n=this.driver.parseTableName(e).tableName,r=t instanceof an?t.name:t,i=n+"_"+r+"_seq";return i.length>this.connection.driver.maxAliasLength&&(i=n.substring(0,29)+"_"+r.substring(0,Math.max(29,63-e.name.length-5))+"_seq"),i},t.prototype.buildSequencePath=function(e,t){var n=this.driver.parseTableName(e).schema;return n?n+"."+this.buildSequenceName(e,t):this.buildSequenceName(e,t)},t.prototype.buildEnumName=function(e,t,n,r,i){void 0===n&&(n=!0);var o=this.driver.parseTableName(e),a=o.schema,s=o.tableName,u=t.enumName?t.enumName:s+"_"+t.name.toLowerCase()+"_enum";return a&&n&&(u=a+"."+u),i&&(u+="_old"),u.split(".").map((function(e){return r?e:'"'+e+'"'})).join(".")},t.prototype.getUserDefinedTypeName=function(e,t){return Ne(this,void 0,void 0,(function(){var n,r,i,o,a;return Oe(this,(function(s){switch(s.label){case 0:return n=this.driver.parseTableName(e),r=n.schema,i=n.tableName,r?[3,2]:[4,this.getCurrentSchema()];case 1:r=s.sent(),s.label=2;case 2:return[4,this.query('SELECT "udt_schema", "udt_name" FROM "information_schema"."columns" WHERE "table_schema" = \''+r+"' AND \"table_name\" = '"+i+"' AND \"column_name\"='"+t.name+"'")];case 3:return o=s.sent(),0===(a=o[0].udt_name).indexOf("_")&&(a=a.substr(1,a.length)),[2,{schema:o[0].udt_schema,name:a}]}}))}))},t.prototype.escapeComment=function(e){return e&&0!==e.length?"'"+(e=e.replace(/'/g,"''").replace(/\u0000/g,""))+"'":"NULL"},t.prototype.escapePath=function(e){var t=this.driver.parseTableName(e),n=t.schema,r=t.tableName;return n&&n!==this.driver.searchSchema?'"'+n+'"."'+r+'"':'"'+r+'"'},t.prototype.buildCreateColumnSql=function(e,t){var n='"'+t.name+'"';return!0===t.isGenerated&&"uuid"!==t.generationStrategy&&("integer"!==t.type&&"int"!==t.type&&"int4"!==t.type||(n+=" SERIAL"),"smallint"!==t.type&&"int2"!==t.type||(n+=" SMALLSERIAL"),"bigint"!==t.type&&"int8"!==t.type||(n+=" BIGSERIAL")),"enum"===t.type||"simple-enum"===t.type?(n+=" "+this.buildEnumName(e,t),t.isArray&&(n+=" array")):t.isGenerated&&"uuid"!==t.type||(n+=" "+this.connection.driver.createFullType(t)),t.charset&&(n+=' CHARACTER SET "'+t.charset+'"'),t.collation&&(n+=' COLLATE "'+t.collation+'"'),!0!==t.isNullable&&(n+=" NOT NULL"),void 0!==t.default&&null!==t.default&&(n+=" DEFAULT "+t.default),t.isGenerated&&"uuid"===t.generationStrategy&&!t.default&&(n+=" DEFAULT "+this.driver.uuidGenerator),n},t.prototype.hasSupportForPartitionedTables=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return[4,this.query("SELECT TRUE FROM information_schema.columns WHERE table_name = 'pg_class' and column_name = 'relispartition'")];case 1:return[2,!!e.sent().length]}}))}))},t}(ya))),Da=function(e){function t(t){var n=e.call(this)||this;return n.connection=t,n.options=t.options,n.isReplicated=!1,n.loadDependencies(),n.client=new n.DataApiDriver(n.options.region,n.options.secretArn,n.options.resourceArn,n.options.database,(function(e,t){return n.connection.logger.logQuery(e,t)}),n.options.serviceConfigOptions,n.options.formatOptions),n.database=nt.buildDriverOptions(n.options).database,n}return Ae(t,e),t.prototype.connect=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2]}))}))},t.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2]}))}))},t.prototype.createQueryRunner=function(e){var t=this;return new Ba(this,new this.DataApiDriver(this.options.region,this.options.secretArn,this.options.resourceArn,this.options.database,(function(e,n){return t.connection.logger.logQuery(e,n)}),this.options.serviceConfigOptions,this.options.formatOptions),e)},t.prototype.preparePersistentValue=function(t,n){return this.options.formatOptions&&!1===this.options.formatOptions.castParameters?e.prototype.preparePersistentValue.call(this,t,n):(n.transformer&&(t=gn.transformTo(n.transformer,t)),this.client.preparePersistentValue(t,n))},t.prototype.prepareHydratedValue=function(t,n){return this.options.formatOptions&&!1===this.options.formatOptions.castParameters?e.prototype.prepareHydratedValue.call(this,t,n):(n.transformer&&(t=gn.transformFrom(n.transformer,t)),this.client.prepareHydratedValue(t,n))},t.prototype.loadDependencies=function(){var e=Po.load("typeorm-aurora-data-api-driver").pg;this.DataApiDriver=e},t.prototype.executeQuery=function(e,t){return this.connection.query(t)},t.prototype.afterConnect=function(){return Ne(this,void 0,void 0,(function(){var e;return Oe(this,(function(t){switch(t.label){case 0:return[4,this.checkMetadataForExtensions()];case 1:return(e=t.sent()).hasExtensions?[4,this.enableExtensions(e,this.connection)]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2,Promise.resolve()]}}))}))},t}(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),t}(Ue)),ja=function(e){function t(t){var n=e.call(this)||this;return n.driver=t,n.connection=t.connection,n.broadcaster=new ba(n),n}return Ae(t,e),t.prototype.executeSet=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:if(this.isReleased)throw new Jt;return[4,this.connect()];case 1:return[2,t.sent().executeSet(e,!1)]}}))}))},t.prototype.query=function(e,t,n){return void 0===n&&(n=!1),Ne(this,void 0,void 0,(function(){var r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:if(this.isReleased)throw new Jt;return[4,this.connect()];case 1:r=u.sent(),this.driver.connection.logger.logQuery(e,t,this),i=e.substr(0,e.indexOf(" ")),u.label=2;case 2:return u.trys.push([2,9,,10]),o=void 0,-1===["BEGIN","ROLLBACK","COMMIT","CREATE","ALTER","DROP"].indexOf(i)?[3,4]:[4,r.execute(e,!1)];case 3:return o=u.sent(),[3,8];case 4:return-1===["INSERT","UPDATE","DELETE"].indexOf(i)?[3,6]:[4,r.run(e,t,!1)];case 5:return o=u.sent(),[3,8];case 6:return[4,r.query(e,t||[])];case 7:o=u.sent(),u.label=8;case 8:return a=new va,(null==o?void 0:o.hasOwnProperty("values"))&&(a.raw=o.values,a.records=o.values),(null==o?void 0:o.hasOwnProperty("changes"))&&(a.affected=o.changes.changes,a.raw=o.changes.lastId||o.changes.changes),n?[2,a]:[2,a.raw];case 9:throw s=u.sent(),this.driver.connection.logger.logQueryError(s,e,t,this),new Wt(e,t,s);case 10:return[2]}}))}))},t.prototype.parametrize=function(e){return Object.keys(e).map((function(e){return'"'+e+'"=?'}))},t}(ga),La=function(e){function t(t){var n=e.call(this,t)||this;if(n.database=n.options.database,n.driver=n.options.driver,!n.options.database)throw new qt("database");if(!n.options.driver)throw new qt("driver");return n.sqlite=n.options.driver,n}return Ae(t,e),t.prototype.connect=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:return this.databaseConnection=this.createDatabaseConnection(),[4,this.databaseConnection];case 1:return e.sent(),[2]}}))}))},t.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){switch(t.label){case 0:return this.queryRunner=void 0,[4,this.databaseConnection];case 1:return[2,t.sent().close().then((function(){e.databaseConnection=void 0}))]}}))}))},t.prototype.createQueryRunner=function(e){return this.queryRunner||(this.queryRunner=new ja(this)),this.queryRunner},t.prototype.createDatabaseConnection=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r;return Oe(this,(function(i){switch(i.label){case 0:return e=this.options.mode||"no-encryption",t="no-encryption"!==e,n=void 0===this.options.version?1:this.options.version,[4,this.sqlite.createConnection(this.options.database,t,e,n)];case 1:return[4,(r=i.sent()).open()];case 2:return i.sent(),[4,r.query("PRAGMA foreign_keys = ON")];case 3:return i.sent(),this.options.journalMode&&-1!==["DELETE","TRUNCATE","PERSIST","MEMORY","WAL","OFF"].indexOf(this.options.journalMode)?[4,r.query("PRAGMA journal_mode = "+this.options.journalMode)]:[3,5];case 4:i.sent(),i.label=5;case 5:return[2,r]}}))}))},t.prototype.loadDependencies=function(){if(this.sqlite=this.driver,!this.driver)throw new Dt("Capacitor","@capacitor-community/sqlite")},t}(bn),qa=function(){function e(){}return e.prototype.create=function(e){var t=e.options.type;switch(t){case"mysql":case"mariadb":return new We(e);case"postgres":return new Ue(e);case"cockroachdb":return new Ke(e);case"sap":return new ze(e);case"sqlite":return new Ge(e);case"better-sqlite3":return new Qe(e);case"cordova":return new Ta(e);case"nativescript":return new Pa(e);case"react-native":return new Aa(e);case"sqljs":return new Ea(e);case"oracle":return new He(e);case"mssql":return new Ve(e);case"mongodb":return new De(e);case"expo":return new Oa(e);case"aurora-data-api":return new Fe(e);case"aurora-data-api-pg":return new Da(e);case"capacitor":return new La(e);default:throw new Bt(t,["aurora-data-api","aurora-data-api-pg","better-sqlite3","capacitor","cockroachdb","cordova","expo","mariadb","mongodb","mssql","mysql","nativescript","oracle","postgres","react-native","sap","sqlite","sqljs"])}},e}();function Ua(e,t,n){return void 0===n&&(n=[".js",".cjs",".ts"]),[]}var Fa,Ka,Va=new(function(){function e(){this.instances=[]}return e.prototype.get=function(e){var t=this.instances.find((function(t){return t.type===e}));return t||(t={type:e,object:new e},this.instances.push(t)),t.object},e}());function za(e){if(Fa)try{var t=Fa.get(e);if(t)return t;if(!Ka||!Ka.fallback)return t}catch(e){if(!Ka||!Ka.fallbackOnErrors)throw e}return Va.get(e)}var Wa=function(){function e(e){this.isUnique=!1,this.isSpatial=!1,this.isFulltext=!1,this.synchronize=!0,this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,null!==e.args.synchronize&&void 0!==e.args.synchronize&&(this.synchronize=e.args.synchronize),this.isUnique=!!e.args.unique,this.isSpatial=!!e.args.spatial,this.isFulltext=!!e.args.fulltext,this.parser=e.args.parser,this.where=e.args.where,this.isSparse=e.args.sparse,this.isBackground=e.args.background,this.expireAfterSeconds=e.args.expireAfterSeconds,this.givenName=e.args.name,this.givenColumnNames=e.args.columns)}return e.prototype.build=function(e){var t=this;if(!1===this.synchronize)return this.name=this.givenName,this;var n={};if(this.givenColumnNames){var r=[];if(Array.isArray(this.givenColumnNames))(r=this.givenColumnNames.map((function(e){return t.embeddedMetadata?t.embeddedMetadata.propertyPath+"."+e:e.trim()}))).forEach((function(e){return n[e]=1}));else{var i=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(i)?(r=i.map((function(e){return String(e)}))).forEach((function(e){return n[e]=1})):(r=Object.keys(i).map((function(e){return String(e)})),Object.keys(i).forEach((function(e){return n[e]=i[e]})))}this.columns=r.map((function(e){var n=t.entityMetadata.columns.find((function(t){return t.propertyPath===e}));if(n)return[n];var r=t.entityMetadata.relations.find((function(t){return t.isWithJoinColumn&&t.propertyName===e}));if(r)return r.joinColumns;var i=t.givenName?'"'+t.givenName+'" ':"",o=t.entityMetadata.targetName;throw new rt("Index "+i+"contains column that is missing in the entity ("+o+"): "+e)})).reduce((function(e,t){return e.concat(t)}))}return this.columnNamesWithOrderingMap=Object.keys(n).reduce((function(e,r){var i=t.entityMetadata.columns.find((function(e){return e.propertyPath===r}));return i&&(e[i.databasePath]=n[r]),e}),{}),this.name=this.givenName?this.givenName:e.indexName(this.entityMetadata.tableName,this.columns.map((function(e){return e.databaseName})),this.where),this},e}(),Ha=function(){function e(e){this.isTreeParent=!1,this.isTreeChildren=!1,this.isPrimary=!1,this.isLazy=!1,this.isEager=!1,this.persistenceEnabled=!0,this.isCascadeInsert=!1,this.isCascadeUpdate=!1,this.isCascadeRemove=!1,this.isCascadeSoftRemove=!1,this.isCascadeRecover=!1,this.isNullable=!0,this.createForeignKeyConstraints=!0,this.isOwning=!1,this.isOneToOne=!1,this.isOneToOneOwner=!1,this.isWithJoinColumn=!1,this.isOneToOneNotOwner=!1,this.isOneToMany=!1,this.isManyToOne=!1,this.isManyToMany=!1,this.isManyToManyOwner=!1,this.isManyToManyNotOwner=!1,this.foreignKeys=[],this.joinColumns=[],this.inverseJoinColumns=[],this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata;var t=e.args;this.target=t.target,this.propertyName=t.propertyName,this.relationType=t.relationType,t.inverseSideProperty&&(this.givenInverseSidePropertyFactory=t.inverseSideProperty),this.isLazy=t.isLazy||!1,this.isCascadeInsert=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("insert"),this.isCascadeUpdate=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("update"),this.isCascadeRemove=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("remove"),this.isCascadeSoftRemove=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("soft-remove"),this.isCascadeRecover=!0===t.options.cascade||Array.isArray(t.options.cascade)&&-1!==t.options.cascade.indexOf("recover"),this.isPrimary=t.options.primary||!1,this.isNullable=!1!==t.options.nullable&&!this.isPrimary,this.onDelete=t.options.onDelete,this.onUpdate=t.options.onUpdate,this.deferrable=t.options.deferrable,this.createForeignKeyConstraints=!1!==t.options.createForeignKeyConstraints,this.isEager=t.options.eager||!1,this.persistenceEnabled=!1!==t.options.persistence,this.orphanedRowAction=t.options.orphanedRowAction||"nullify",this.isTreeParent=t.isTreeParent||!1,this.isTreeChildren=t.isTreeChildren||!1,this.type=t.type instanceof Function?t.type():t.type,this.isOneToOne="one-to-one"===this.relationType,this.isOneToMany="one-to-many"===this.relationType,this.isManyToOne="many-to-one"===this.relationType,this.isManyToMany="many-to-many"===this.relationType,this.isOneToOneNotOwner=!!this.isOneToOne,this.isManyToManyNotOwner=!!this.isManyToMany}return e.prototype.getRelationIdMap=function(e){var t=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map((function(e){return e.referencedColumn}));return yn.getValueMap(e,t)},e.prototype.ensureRelationIdMap=function(e){if(e instanceof Object)return e;var t=(this.isOwning?this.joinColumns:this.inverseRelation.joinColumns).map((function(e){return e.referencedColumn}));if(t.length>1)throw new rt("Cannot create relation id map for a single value because relation contains multiple referenced columns.");return t[0].createValueMap(e)},e.prototype.getEntityValue=function(e,t){if(void 0===t&&(t=!1),null!=e){if(this.embeddedMetadata){var n=Be([],ke(this.embeddedMetadata.parentPropertyNames)),r=function(e,t){var n=e.shift();return n?t[n]?r(e,t[n]):void 0:t},i=r(n,e);return this.isLazy?void 0!==i["__"+this.propertyName+"__"]?i["__"+this.propertyName+"__"]:!0===t?i[this.propertyName]:void 0:i?i[this.isLazy?"__"+this.propertyName+"__":this.propertyName]:void 0}return this.isLazy?void 0!==e["__"+this.propertyName+"__"]?e["__"+this.propertyName+"__"]:!0===t?e[this.propertyName]:void 0:e[this.propertyName]}},e.prototype.setEntityValue=function(e,t){var n=this.isLazy?"__"+this.propertyName+"__":this.propertyName;if(this.embeddedMetadata){var r=function(e,i){var o=e.shift();return o?(i[o.propertyName]||(i[o.propertyName]=o.create()),r(e,i[o.propertyName]),i):(i[n]=t,i)};return r(Be([],ke(this.embeddedMetadata.embeddedMetadataTree)),e)}e[n]=t},e.prototype.createValueMap=function(e){var t,n=this;if(this.embeddedMetadata){var r=Be([],ke(this.embeddedMetadata.parentPropertyNames)),i=function(t,r){var o=t.shift();return o?(r[o]={},i(t,r[o]),r):(r[n.propertyName]=e,r)};return i(r,{})}return(t={})[this.propertyName]=e,t},e.prototype.build=function(){this.propertyPath=this.buildPropertyPath()},e.prototype.registerForeignKeys=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=this.foreignKeys).push.apply(e,Be([],ke(t)))},e.prototype.registerJoinColumns=function(e,t){void 0===e&&(e=[]),void 0===t&&(t=[]),this.joinColumns=e,this.inverseJoinColumns=t,this.isOwning=this.isManyToOne||(this.isManyToMany||this.isOneToOne)&&this.joinColumns.length>0,this.isOneToOneOwner=this.isOneToOne&&this.isOwning,this.isOneToOneNotOwner=this.isOneToOne&&!this.isOwning,this.isManyToManyOwner=this.isManyToMany&&this.isOwning,this.isManyToManyNotOwner=this.isManyToMany&&!this.isOwning,this.isWithJoinColumn=this.isManyToOne||this.isOneToOneOwner},e.prototype.registerJunctionEntityMetadata=function(e){this.junctionEntityMetadata=e,this.joinTableName=e.tableName,this.inverseRelation&&(this.inverseRelation.junctionEntityMetadata=e,this.joinTableName=e.tableName)},e.prototype.buildInverseSidePropertyPath=function(){if(this.givenInverseSidePropertyFactory){var e=this.inverseEntityMetadata.propertiesMap;if("function"==typeof this.givenInverseSidePropertyFactory)return this.givenInverseSidePropertyFactory(e);if("string"==typeof this.givenInverseSidePropertyFactory)return this.givenInverseSidePropertyFactory}else{if(this.isTreeParent&&this.entityMetadata.treeChildrenRelation)return this.entityMetadata.treeChildrenRelation.propertyName;if(this.isTreeChildren&&this.entityMetadata.treeParentRelation)return this.entityMetadata.treeParentRelation.propertyName}return""},e.prototype.buildPropertyPath=function(){return this.embeddedMetadata&&this.embeddedMetadata.parentPropertyNames.length?this.embeddedMetadata.parentPropertyNames.join(".")+"."+this.propertyName:this.propertyName},e}(),Ga=function(){function e(e){this.columns=[],this.relations=[],this.listeners=[],this.indices=[],this.uniques=[],this.relationIds=[],this.relationCounts=[],this.embeddeds=[],this.isAlwaysUsingConstructor=!0,this.isArray=!1,this.parentPropertyNames=[],this.parentPrefixes=[],this.embeddedMetadataTree=[],this.columnsFromTree=[],this.relationsFromTree=[],this.listenersFromTree=[],this.indicesFromTree=[],this.uniquesFromTree=[],this.relationIdsFromTree=[],this.relationCountsFromTree=[],this.entityMetadata=e.entityMetadata,this.type=e.args.type(),this.propertyName=e.args.propertyName,this.customPrefix=e.args.prefix,this.isArray=e.args.isArray}return e.prototype.create=function(e){return!(null==e?void 0:e.fromDeserializer)||this.isAlwaysUsingConstructor?new this.type:Object.create(this.type.prototype)},e.prototype.build=function(e){return this.embeddeds.forEach((function(t){return t.build(e)})),this.prefix=this.buildPrefix(e),this.parentPropertyNames=this.buildParentPropertyNames(),this.parentPrefixes=this.buildParentPrefixes(),this.propertyPath=this.parentPropertyNames.join("."),this.embeddedMetadataTree=this.buildEmbeddedMetadataTree(),this.columnsFromTree=this.buildColumnsFromTree(),this.relationsFromTree=this.buildRelationsFromTree(),this.listenersFromTree=this.buildListenersFromTree(),this.indicesFromTree=this.buildIndicesFromTree(),this.uniquesFromTree=this.buildUniquesFromTree(),this.relationIdsFromTree=this.buildRelationIdsFromTree(),this.relationCountsFromTree=this.buildRelationCountsFromTree(),e.options.entitySkipConstructor&&(this.isAlwaysUsingConstructor=!e.options.entitySkipConstructor),this},e.prototype.buildPartialPrefix=function(){if(void 0===this.customPrefix||!0===this.customPrefix)return[this.propertyName];if(""===this.customPrefix||!1===this.customPrefix)return[];if("string"==typeof this.customPrefix)return[this.customPrefix];throw new rt("Invalid prefix option given for "+this.entityMetadata.targetName+"#"+this.propertyName)},e.prototype.buildPrefix=function(e){if(e.driver instanceof De)return this.propertyName;var t=[];return this.parentEmbeddedMetadata&&t.push(this.parentEmbeddedMetadata.buildPrefix(e)),t.push.apply(t,Be([],ke(this.buildPartialPrefix()))),t.join("_")},e.prototype.buildParentPropertyNames=function(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPropertyNames().concat(this.propertyName):[this.propertyName]},e.prototype.buildParentPrefixes=function(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildParentPrefixes().concat(this.buildPartialPrefix()):this.buildPartialPrefix()},e.prototype.buildEmbeddedMetadataTree=function(){return this.parentEmbeddedMetadata?this.parentEmbeddedMetadata.buildEmbeddedMetadataTree().concat(this):[this]},e.prototype.buildColumnsFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildColumnsFromTree())}),this.columns)},e.prototype.buildRelationsFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildRelationsFromTree())}),this.relations)},e.prototype.buildListenersFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildListenersFromTree())}),this.listeners)},e.prototype.buildIndicesFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildIndicesFromTree())}),this.indices)},e.prototype.buildUniquesFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildUniquesFromTree())}),this.uniques)},e.prototype.buildRelationIdsFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildRelationIdsFromTree())}),this.relationIds)},e.prototype.buildRelationCountsFromTree=function(){return this.embeddeds.reduce((function(e,t){return e.concat(t.buildRelationCountsFromTree())}),this.relationCounts)},e}(),Qa=function(){function e(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}return e.prototype.setValue=function(e){var t=this,n=this.relation.getEntityValue(e);if(Array.isArray(n))e[this.propertyName]=n.map((function(e){return t.relation.inverseEntityMetadata.getEntityIdMixedMap(e)})).filter((function(e){return null!=e}));else{var r=this.relation.inverseEntityMetadata.getEntityIdMixedMap(n);void 0!==r&&(e[this.propertyName]=r)}},e.prototype.build=function(){var e=this.relationNameOrFactory instanceof Function?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new rt("Cannot find relation "+e+". Wrong relation specified for @RelationId decorator.");this.relation=t},e}(),Ja=function(){function e(e){this.entityMetadata=e.entityMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.relationNameOrFactory=e.args.relation,this.alias=e.args.alias,this.queryBuilderFactory=e.args.queryBuilderFactory}return e.prototype.build=function(){var e=this.relationNameOrFactory instanceof Function?this.relationNameOrFactory(this.entityMetadata.propertiesMap):this.relationNameOrFactory,t=this.entityMetadata.findRelationWithPropertyPath(e);if(!t)throw new rt("Cannot find relation "+e+". Wrong relation specified for @RelationCount decorator.");this.relation=t},e}(),Za=function(){function e(){}return e.AFTER_LOAD="after-load",e.BEFORE_INSERT="before-insert",e.AFTER_INSERT="after-insert",e.BEFORE_UPDATE="before-update",e.AFTER_UPDATE="after-update",e.BEFORE_REMOVE="before-remove",e.AFTER_REMOVE="after-remove",e}(),$a=function(){function e(e){this.columns=[],this.referencedColumns=[],this.columnNames=[],this.referencedColumnNames=[],this.entityMetadata=e.entityMetadata,this.referencedEntityMetadata=e.referencedEntityMetadata,this.columns=e.columns,this.referencedColumns=e.referencedColumns,this.onDelete=e.onDelete||"NO ACTION",this.onUpdate=e.onUpdate||"NO ACTION",this.deferrable=e.deferrable,e.namingStrategy&&this.build(e.namingStrategy)}return e.prototype.build=function(e){this.columnNames=this.columns.map((function(e){return e.databaseName})),this.referencedColumnNames=this.referencedColumns.map((function(e){return e.databaseName})),this.referencedTablePath=this.referencedEntityMetadata.tablePath,this.name=e.foreignKeyName(this.entityMetadata.tableName,this.columnNames,this.referencedEntityMetadata.tableName,this.referencedColumnNames)},e}(),Ya=function(){function e(e){this.connection=e}return e.prototype.build=function(e,t){var n=this,r=this.collectReferencedColumns(e,t),i=this.collectInverseReferencedColumns(e,t),o=t.name||this.connection.namingStrategy.joinTableName(e.entityMetadata.tableNameWithoutPrefix,e.inverseEntityMetadata.tableNameWithoutPrefix,e.propertyPath,e.inverseRelation?e.inverseRelation.propertyName:""),a=new yn({connection:this.connection,args:{target:"",name:o,type:"junction",database:t.database||e.entityMetadata.database,schema:t.schema||e.entityMetadata.schema}});a.build();var s=r.map((function(r){var i=t.joinColumns?t.joinColumns.find((function(e){return!(e.referencedColumnName&&e.referencedColumnName!==r.propertyName||!e.name)})):void 0,o=i&&i.name?i.name:n.connection.namingStrategy.joinTableColumnName(e.entityMetadata.tableNameWithoutPrefix,r.propertyName,r.databaseName);return new da({connection:n.connection,entityMetadata:a,referencedColumn:r,args:{target:"",mode:"virtual",propertyName:o,options:{name:o,length:r.length||!(n.connection.driver instanceof We||n.connection.driver instanceof Fe)||"uuid"!==r.generationStrategy&&"uuid"!==r.type?r.length:"36",width:r.width,type:r.type,precision:r.precision,scale:r.scale,charset:r.charset,collation:r.collation,zerofill:r.zerofill,unsigned:!!r.zerofill||r.unsigned,enum:r.enum,enumName:r.enumName,nullable:!1,primary:!0}}})})),u=i.map((function(r){var i=t.inverseJoinColumns?t.inverseJoinColumns.find((function(e){return!(e.referencedColumnName&&e.referencedColumnName!==r.propertyName||!e.name)})):void 0,o=i&&i.name?i.name:n.connection.namingStrategy.joinTableInverseColumnName(e.inverseEntityMetadata.tableNameWithoutPrefix,r.propertyName,r.databaseName);return new da({connection:n.connection,entityMetadata:a,referencedColumn:r,args:{target:"",mode:"virtual",propertyName:o,options:{length:r.length||!(n.connection.driver instanceof We||n.connection.driver instanceof Fe)||"uuid"!==r.generationStrategy&&"uuid"!==r.type?r.length:"36",width:r.width,type:r.type,precision:r.precision,scale:r.scale,charset:r.charset,collation:r.collation,zerofill:r.zerofill,unsigned:!!r.zerofill||r.unsigned,enum:r.enum,enumName:r.enumName,name:o,nullable:!1,primary:!0}}})}));return this.changeDuplicatedColumnNames(s,u),a.ownerColumns=s,a.inverseColumns=u,a.ownColumns=Be(Be([],ke(s)),ke(u)),a.ownColumns.forEach((function(t){return t.relationMetadata=e})),a.foreignKeys=e.createForeignKeyConstraints?[new $a({entityMetadata:a,referencedEntityMetadata:e.entityMetadata,columns:s,referencedColumns:r,onDelete:e.onDelete||"CASCADE",onUpdate:this.connection.driver instanceof He?"NO ACTION":e.onUpdate||"CASCADE"}),new $a({entityMetadata:a,referencedEntityMetadata:e.inverseEntityMetadata,columns:u,referencedColumns:i,onDelete:e.inverseRelation?e.inverseRelation.onDelete:"CASCADE",onUpdate:this.connection.driver instanceof He?"NO ACTION":e.inverseRelation?e.inverseRelation.onUpdate:"CASCADE"})]:[],a.ownIndices=[new Wa({entityMetadata:a,columns:s,args:{target:a.target,synchronize:!0}}),new Wa({entityMetadata:a,columns:u,args:{target:a.target,synchronize:!0}})],a},e.prototype.collectReferencedColumns=function(e,t){var n=!!t.joinColumns&&t.joinColumns.find((function(e){return!!e.referencedColumnName}));return!t.joinColumns||t.joinColumns&&!n?e.entityMetadata.columns.filter((function(e){return e.isPrimary})):t.joinColumns.map((function(t){var n=e.entityMetadata.columns.find((function(e){return e.propertyName===t.referencedColumnName}));if(!n)throw new rt("Referenced column "+t.referencedColumnName+" was not found in entity "+e.entityMetadata.name);return n}))},e.prototype.collectInverseReferencedColumns=function(e,t){var n=!!t.inverseJoinColumns,r=!!n&&t.inverseJoinColumns.find((function(e){return!!e.referencedColumnName}));return!n||n&&!r?e.inverseEntityMetadata.primaryColumns:t.inverseJoinColumns.map((function(t){var n=e.inverseEntityMetadata.ownColumns.find((function(e){return e.propertyName===t.referencedColumnName}));if(!n)throw new rt("Referenced column "+t.referencedColumnName+" was not found in entity "+e.inverseEntityMetadata.name);return n}))},e.prototype.changeDuplicatedColumnNames=function(e,t){var n=this;e.forEach((function(e){t.forEach((function(t){if(e.givenDatabaseName===t.givenDatabaseName){var r=n.connection.namingStrategy.joinTableColumnDuplicationPrefix(e.propertyName,1);e.propertyName=r,e.givenDatabaseName=r;var i=n.connection.namingStrategy.joinTableColumnDuplicationPrefix(t.propertyName,2);t.propertyName=i,t.givenDatabaseName=i}}))}))},e}(),Xa=function(){function e(e){this.connection=e}return e.prototype.build=function(e){var t=this,n=new yn({parentClosureEntityMetadata:e,connection:this.connection,args:{target:"",name:e.treeOptions&&e.treeOptions.closureTableName?e.treeOptions.closureTableName:e.tableNameWithoutPrefix,type:"closure-junction"}});return n.build(),e.primaryColumns.forEach((function(r){n.ownColumns.push(new da({connection:t.connection,entityMetadata:n,closureType:"ancestor",referencedColumn:r,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.ancestorColumnName?e.treeOptions.ancestorColumnName(r):r.propertyName+"_ancestor",options:{primary:!0,length:r.length,type:r.type}}})),n.ownColumns.push(new da({connection:t.connection,entityMetadata:n,closureType:"descendant",referencedColumn:r,args:{target:"",mode:"virtual",propertyName:e.treeOptions&&e.treeOptions.descendantColumnName?e.treeOptions.descendantColumnName(r):r.propertyName+"_descendant",options:{primary:!0,length:r.length,type:r.type}}}))})),n.ownIndices=[new Wa({entityMetadata:n,columns:[n.ownColumns[0]],args:{target:n.target,synchronize:!0}}),new Wa({entityMetadata:n,columns:[n.ownColumns[1]],args:{target:n.target,synchronize:!0}})],e.treeLevelColumn&&n.ownColumns.push(new da({connection:this.connection,entityMetadata:n,args:{target:"",mode:"virtual",propertyName:"level",options:{type:this.connection.driver.mappedDataTypes.treeLevel}}})),n.foreignKeys=[new $a({entityMetadata:n,referencedEntityMetadata:e,columns:[n.ownColumns[0]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver instanceof Ve?"NO ACTION":"CASCADE"}),new $a({entityMetadata:n,referencedEntityMetadata:e,columns:[n.ownColumns[1]],referencedColumns:e.primaryColumns,onDelete:this.connection.driver instanceof Ve?"NO ACTION":"CASCADE"})],n},e}(),es=function(){function e(e){this.columns=[],this.columnNamesWithOrderingMap={},this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,e.columns&&(this.columns=e.columns),e.args&&(this.target=e.args.target,this.givenName=e.args.name,this.givenColumnNames=e.args.columns)}return e.prototype.build=function(e){var t=this,n={};if(this.givenColumnNames){var r=[];if(Array.isArray(this.givenColumnNames))(r=this.givenColumnNames.map((function(e){return t.embeddedMetadata?t.embeddedMetadata.propertyPath+"."+e:e.trim()}))).forEach((function(e){return n[e]=1}));else{var i=this.givenColumnNames(this.entityMetadata.propertiesMap);Array.isArray(i)?(r=i.map((function(e){return String(e)}))).forEach((function(e){return n[e]=1})):(r=Object.keys(i).map((function(e){return String(e)})),Object.keys(i).forEach((function(e){return n[e]=i[e]})))}this.columns=r.map((function(e){var n=t.entityMetadata.columns.find((function(t){return t.propertyPath===e}));if(n)return[n];var r=t.entityMetadata.relations.find((function(t){return t.isWithJoinColumn&&t.propertyName===e}));if(r)return r.joinColumns;var i=t.givenName?'"'+t.givenName+'" ':"",o=t.entityMetadata.targetName;throw new rt("Unique constraint "+i+"contains column that is missing in the entity ("+o+"): "+e)})).reduce((function(e,t){return e.concat(t)}))}return this.columnNamesWithOrderingMap=Object.keys(n).reduce((function(e,r){var i=t.entityMetadata.columns.find((function(e){return e.propertyPath===r}));return i&&(e[i.databasePath]=n[r]),e}),{}),this.name=this.givenName?this.givenName:e.uniqueConstraintName(this.entityMetadata.tableName,this.columns.map((function(e){return e.databaseName}))),this},e}(),ts=function(){function e(e){this.connection=e}return e.prototype.build=function(e,t){var n=this.collectReferencedColumns(e,t),r=this.collectColumns(e,t,n);if(!n.length||!t.createForeignKeyConstraints)return{foreignKey:void 0,columns:r,uniqueConstraint:void 0};var i=new $a({entityMetadata:t.entityMetadata,referencedEntityMetadata:t.inverseEntityMetadata,namingStrategy:this.connection.namingStrategy,columns:r,referencedColumns:n,onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable});if(this.connection.driver instanceof He&&r.every((function(e){return e.isPrimary})))return{foreignKey:i,columns:r,uniqueConstraint:void 0};if(n.length>0&&t.isOneToOne){var o=new es({entityMetadata:t.entityMetadata,columns:i.columns,args:{name:this.connection.namingStrategy.relationConstraintName(t.entityMetadata.tableName,i.columns.map((function(e){return e.databaseName}))),target:t.entityMetadata.target}});return o.build(this.connection.namingStrategy),{foreignKey:i,columns:r,uniqueConstraint:o}}return{foreignKey:i,columns:r,uniqueConstraint:void 0}},e.prototype.collectReferencedColumns=function(e,t){var n=e.find((function(e){return!!e.referencedColumnName})),r=0===e.length&&t.isManyToOne,i=e.length>0&&!n;return r||i?t.inverseEntityMetadata.primaryColumns:e.map((function(e){var n=t.inverseEntityMetadata.ownColumns.find((function(t){return t.propertyName===e.referencedColumnName}));if(!n)throw new rt("Referenced column "+e.referencedColumnName+" was not found in entity "+t.inverseEntityMetadata.name);return n}))},e.prototype.collectColumns=function(e,t,n){var r=this;return n.map((function(n){var i=e.find((function(e){return!(e.referencedColumnName&&e.referencedColumnName!==n.propertyName||!e.name)})),o=i?i.name:r.connection.namingStrategy.joinColumnName(t.propertyName,n.propertyName),a=t.entityMetadata.ownColumns.find((function(e){return e.databaseName===o}));return a||(a=new da({connection:r.connection,entityMetadata:t.entityMetadata,args:{target:"",mode:"virtual",propertyName:t.propertyName,options:{name:o,type:n.type,length:n.length||!(r.connection.driver instanceof We||r.connection.driver instanceof Fe)||"uuid"!==n.generationStrategy&&"uuid"!==n.type?n.length:"36",width:n.width,charset:n.charset,collation:n.collation,precision:n.precision,scale:n.scale,zerofill:n.zerofill,unsigned:n.unsigned,comment:n.comment,enum:n.enum,enumName:n.enumName,primary:t.isPrimary,nullable:t.isNullable}}}),t.entityMetadata.registerColumn(a)),a.referencedColumn=n,a.type=n.type,a.relationMetadata=t,a.build(r.connection),a}))},e}(),ns=function(){function e(e){this.entityMetadata=e.entityMetadata,this.embeddedMetadata=e.embeddedMetadata,this.target=e.args.target,this.propertyName=e.args.propertyName,this.type=e.args.type}return e.prototype.isAllowed=function(e){return this.entityMetadata.target===e.constructor||this.entityMetadata.target instanceof Function&&e.constructor.prototype instanceof this.entityMetadata.target},e.prototype.execute=function(e){if(!this.embeddedMetadata)return e[this.propertyName]();this.callEntityEmbeddedMethod(e,this.embeddedMetadata.propertyPath.split("."))},e.prototype.callEntityEmbeddedMethod=function(e,t){var n=this,r=t.shift();r&&e[r]&&(0===t.length?e[r]instanceof Array?e[r].map((function(e){return e[n.propertyName]()})):e[r][this.propertyName]():e[r]&&this.callEntityEmbeddedMethod(e[r],t))},e}(),rs=function(){function e(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}return e.prototype.build=function(e){return this.name=this.givenName?this.givenName:e.checkConstraintName(this.entityMetadata.tableName,this.expression),this},e}(),is=function(){function e(e){this.entityMetadata=e.entityMetadata,e.args&&(this.target=e.args.target,this.expression=e.args.expression,this.givenName=e.args.name)}return e.prototype.build=function(e){return this.name=this.givenName?this.givenName:e.exclusionConstraintName(this.entityMetadata.tableName,this.expression),this},e}(),os=function(){function e(e,t){this.connection=e,this.metadataArgsStorage=t,this.junctionEntityMetadataBuilder=new Ya(e),this.closureJunctionEntityMetadataBuilder=new Xa(e),this.relationJoinColumnBuilder=new ts(e)}return e.prototype.build=function(e){var t=this,n=(e?this.metadataArgsStorage.filterTables(e):this.metadataArgsStorage.tables).filter((function(e){return"regular"===e.type||"closure"===e.type||"entity-child"===e.type||"view"===e.type})).map((function(e){return t.createEntityMetadata(e)}));return n.forEach((function(e){return t.computeParentEntityMetadata(n,e)})),n.forEach((function(e){e.childEntityMetadatas=n.filter((function(t){return e.target instanceof Function&&t.target instanceof Function&&Ro.isInherited(t.target,e.target)}))})),n.filter((function(e){return"entity-child"!==e.tableType})).forEach((function(e){return e.build()})),n.filter((function(e){return"entity-child"===e.tableType})).forEach((function(e){return e.build()})),n.filter((function(e){return"entity-child"!==e.tableType})).forEach((function(e){return t.computeEntityMetadataStep1(n,e)})),n.filter((function(e){return"entity-child"===e.tableType})).forEach((function(e){return t.computeEntityMetadataStep1(n,e)})),n.forEach((function(e){return t.computeEntityMetadataStep2(e)})),n.forEach((function(e){return t.computeInverseProperties(e,n)})),n.filter((function(e){return"entity-child"!==e.tableType})).forEach((function(e){e.relations.filter((function(e){return e.isOneToOne||e.isManyToOne})).forEach((function(n){var r=t.metadataArgsStorage.filterJoinColumns(n.target,n.propertyName),i=t.relationJoinColumnBuilder.build(r,n),o=i.foreignKey,a=i.columns,s=i.uniqueConstraint;if(o&&(n.registerForeignKeys(o),e.foreignKeys.push(o)),a&&n.registerJoinColumns(a),s)if(t.connection.driver instanceof We||t.connection.driver instanceof Fe||t.connection.driver instanceof Ve||t.connection.driver instanceof ze){var u=new Wa({entityMetadata:s.entityMetadata,columns:s.columns,args:{target:s.target,name:s.name,unique:!0,synchronize:!0}});t.connection.driver instanceof Ve&&(u.where=u.columns.map((function(e){return t.connection.driver.escape(e.databaseName)+" IS NOT NULL"})).join(" AND ")),n.embeddedMetadata?n.embeddedMetadata.indices.push(u):n.entityMetadata.ownIndices.push(u),t.computeEntityMetadataStep2(e)}else n.embeddedMetadata?n.embeddedMetadata.uniques.push(s):n.entityMetadata.ownUniques.push(s),t.computeEntityMetadataStep2(e);if(o&&t.connection.driver instanceof Ke){u=new Wa({entityMetadata:n.entityMetadata,columns:o.columns,args:{target:n.entityMetadata.target,synchronize:!0}});n.embeddedMetadata?n.embeddedMetadata.indices.push(u):n.entityMetadata.ownIndices.push(u),t.computeEntityMetadataStep2(e)}})),e.relations.filter((function(e){return e.isManyToMany})).forEach((function(e){var r=t.metadataArgsStorage.findJoinTable(e.target,e.propertyName);if(r){var i=t.junctionEntityMetadataBuilder.build(e,r);e.registerForeignKeys.apply(e,Be([],ke(i.foreignKeys))),e.registerJoinColumns(i.ownIndices[0].columns,i.ownIndices[1].columns),e.registerJunctionEntityMetadata(i),t.computeEntityMetadataStep2(i),t.computeInverseProperties(i,n),n.push(i)}}))})),n.forEach((function(e){e.relationsWithJoinColumns=e.relations.filter((function(e){return e.isWithJoinColumn})),e.hasNonNullableRelations=e.relationsWithJoinColumns.some((function(e){return!e.isNullable||e.isPrimary}))})),n.filter((function(e){return"closure-table"===e.treeType})).forEach((function(e){var r=t.closureJunctionEntityMetadataBuilder.build(e);e.closureJunctionTable=r,t.computeEntityMetadataStep2(r),t.computeInverseProperties(r,n),n.push(r)})),n.filter((function(e){return"STI"===e.inheritancePattern&&e.discriminatorColumn})).forEach((function(e){return t.createKeysForTableInheritance(e)})),n.forEach((function(e){e.indices.forEach((function(e){return e.build(t.connection.namingStrategy)}))})),n.forEach((function(e){e.uniques.forEach((function(e){return e.build(t.connection.namingStrategy)}))})),n.forEach((function(e){e.checks.forEach((function(e){return e.build(t.connection.namingStrategy)}))})),n.forEach((function(e){e.exclusions.forEach((function(e){return e.build(t.connection.namingStrategy)}))})),n.filter((function(e){return e.target instanceof Function})).forEach((function(e){e.relations.filter((function(e){return e.isLazy})).forEach((function(n){t.connection.relationLoader.enableLazyLoad(n,e.target.prototype)}))})),n.forEach((function(e){e.columns.forEach((function(n){var r=t.metadataArgsStorage.findGenerated(n.target,n.propertyName);r&&(n.isGenerated=!0,n.generationStrategy=r.strategy,"uuid"===r.strategy?n.type="uuid":"rowid"===r.strategy?n.type="int":n.type=n.type||Number,n.build(t.connection),t.computeEntityMetadataStep2(e))}))})),n},e.prototype.createEntityMetadata=function(e){var t,n=e.target instanceof Function?Ro.getInheritanceTree(e.target):[e.target],r=this.metadataArgsStorage.findInheritanceType(e.target),i=this.metadataArgsStorage.findTree(e.target);return(r&&"STI"===r.pattern||"entity-child"===e.type)&&(t=this.metadataArgsStorage.filterSingleTableChildren(e.target).map((function(e){return e.target})).filter((function(e){return e instanceof Function})),n.push.apply(n,Be([],ke(t)))),new yn({connection:this.connection,args:e,inheritanceTree:n,tableTree:i,inheritancePattern:r?r.pattern:void 0})},e.prototype.computeParentEntityMetadata=function(e,t){"entity-child"===t.tableType&&(t.parentEntityMetadata=e.find((function(e){return-1!==e.inheritanceTree.indexOf(t.target)&&"STI"===e.inheritancePattern})))},e.prototype.computeEntityMetadataStep1=function(e,t){var n,r,i,o=this,a=this.metadataArgsStorage.findInheritanceType(t.target),s=this.metadataArgsStorage.findDiscriminatorValue(t.target);if(t.discriminatorValue=void 0!==s?s.value:t.target.name,t.embeddeds=this.createEmbeddedsRecursively(t,this.metadataArgsStorage.filterEmbeddeds(t.inheritanceTree)).map((function(e){return"STI"===t.inheritancePattern&&(e.columns=e.columns.map((function(e){return e.isNullable=!0,e}))),e})),t.ownColumns=this.metadataArgsStorage.filterColumns(t.inheritanceTree).map((function(n){if("entity-child"===t.tableType)return t.parentEntityMetadata.ownColumns.find((function(e){return e.propertyName===n.propertyName}));var r=new da({connection:o.connection,entityMetadata:t,args:n});return e.find((function(e){return"entity-child"===e.tableType&&e.target===n.target}))&&(r.isNullable=!0),r})),a&&a.column){var u=a.column&&a.column.name?a.column.name:"type",c=t.ownColumns.find((function(e){return e.propertyName===u}));c?c.isDiscriminator=!0:((c=new da({connection:this.connection,entityMetadata:t,args:{target:t.target,mode:"virtual",propertyName:u,options:a.column||{name:u,type:"varchar",nullable:!1}}})).isVirtual=!0,c.isDiscriminator=!0,t.ownColumns.push(c))}if("entity-child"===t.tableType){var l=t.parentEntityMetadata.ownColumns.find((function(e){return e.isDiscriminator}));l&&!t.ownColumns.find((function(e){return e===l}))&&t.ownColumns.push(l)}var f=this.connection.namingStrategy;if("materialized-path"===t.treeType)t.ownColumns.push(new da({connection:this.connection,entityMetadata:t,materializedPath:!0,args:{target:t.target,mode:"virtual",propertyName:"mpath",options:{name:f.materializedPathColumnName,type:"varchar",nullable:!0,default:""}}}));else if("nested-set"===t.treeType){var h=f.nestedSetColumnNames,d=h.left,p=h.right;t.ownColumns.push(new da({connection:this.connection,entityMetadata:t,nestedSetLeft:!0,args:{target:t.target,mode:"virtual",propertyName:d,options:{name:d,type:"integer",nullable:!1,default:1}}})),t.ownColumns.push(new da({connection:this.connection,entityMetadata:t,nestedSetRight:!0,args:{target:t.target,mode:"virtual",propertyName:p,options:{name:p,type:"integer",nullable:!1,default:2}}}))}if(t.ownRelations=this.metadataArgsStorage.filterRelations(t.inheritanceTree).map((function(e){if("entity-child"===t.tableType){var n=t.parentEntityMetadata.ownRelations.find((function(t){return t.propertyName===e.propertyName})),r=e.type instanceof Function?e.type():e.type;if(n.type!==r){var i=Object.create(n);return i.type=r,i}return n}return new Ha({entityMetadata:t,args:e})})),t.relationIds=this.metadataArgsStorage.filterRelationIds(t.inheritanceTree).map((function(e){return"entity-child"===t.tableType?t.parentEntityMetadata.relationIds.find((function(t){return t.propertyName===e.propertyName})):new Qa({entityMetadata:t,args:e})})),t.relationCounts=this.metadataArgsStorage.filterRelationCounts(t.inheritanceTree).map((function(e){return"entity-child"===t.tableType?t.parentEntityMetadata.relationCounts.find((function(t){return t.propertyName===e.propertyName})):new Ja({entityMetadata:t,args:e})})),t.ownListeners=this.metadataArgsStorage.filterListeners(t.inheritanceTree).map((function(e){return new ns({entityMetadata:t,args:e})})),t.checks=this.metadataArgsStorage.filterChecks(t.inheritanceTree).map((function(e){return new rs({entityMetadata:t,args:e})})),this.connection.driver instanceof Ue&&(t.exclusions=this.metadataArgsStorage.filterExclusions(t.inheritanceTree).map((function(e){return new is({entityMetadata:t,args:e})}))),this.connection.driver instanceof Ke){t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter((function(e){return!e.unique})).map((function(e){return new Wa({entityMetadata:t,args:e})}));var m=this.metadataArgsStorage.filterIndices(t.inheritanceTree).filter((function(e){return e.unique})).map((function(e){return new es({entityMetadata:t,args:{target:e.target,name:e.name,columns:e.columns}})}));(n=t.ownUniques).push.apply(n,Be([],ke(m)))}else t.ownIndices=this.metadataArgsStorage.filterIndices(t.inheritanceTree).map((function(e){return new Wa({entityMetadata:t,args:e})}));if(this.connection.driver instanceof We||this.connection.driver instanceof Fe||this.connection.driver instanceof ze){var y=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map((function(e){return new Wa({entityMetadata:t,args:{target:e.target,name:e.name,columns:e.columns,unique:!0,synchronize:!0}})}));(r=t.ownIndices).push.apply(r,Be([],ke(y)))}else{m=this.metadataArgsStorage.filterUniques(t.inheritanceTree).map((function(e){return new es({entityMetadata:t,args:e})}));(i=t.ownUniques).push.apply(i,Be([],ke(m)))}},e.prototype.createEmbeddedsRecursively=function(e,t){var n=this;return t.map((function(t){var r=new Ga({entityMetadata:e,args:t}),i=Ro.getInheritanceTree(r.type);return r.columns=n.metadataArgsStorage.filterColumns(i).map((function(t){return new da({connection:n.connection,entityMetadata:e,embeddedMetadata:r,args:t})})),r.relations=n.metadataArgsStorage.filterRelations(i).map((function(t){return new Ha({entityMetadata:e,embeddedMetadata:r,args:t})})),r.listeners=n.metadataArgsStorage.filterListeners(i).map((function(t){return new ns({entityMetadata:e,embeddedMetadata:r,args:t})})),r.indices=n.metadataArgsStorage.filterIndices(i).map((function(t){return new Wa({entityMetadata:e,embeddedMetadata:r,args:t})})),r.uniques=n.metadataArgsStorage.filterUniques(i).map((function(t){return new es({entityMetadata:e,embeddedMetadata:r,args:t})})),r.relationIds=n.metadataArgsStorage.filterRelationIds(i).map((function(t){return new Qa({entityMetadata:e,args:t})})),r.relationCounts=n.metadataArgsStorage.filterRelationCounts(i).map((function(t){return new Ja({entityMetadata:e,args:t})})),r.embeddeds=n.createEmbeddedsRecursively(e,n.metadataArgsStorage.filterEmbeddeds(i)),r.embeddeds.forEach((function(e){return e.parentEmbeddedMetadata=r})),e.allEmbeddeds.push(r),r}))},e.prototype.computeEntityMetadataStep2=function(e){var t=this;e.embeddeds.forEach((function(e){return e.build(t.connection)})),e.embeddeds.forEach((function(e){e.columnsFromTree.forEach((function(e){return e.build(t.connection)})),e.relationsFromTree.forEach((function(e){return e.build()}))})),e.ownColumns.forEach((function(e){return e.build(t.connection)})),e.ownRelations.forEach((function(e){return e.build()})),e.relations=e.embeddeds.reduce((function(e,t){return e.concat(t.relationsFromTree)}),e.ownRelations),e.eagerRelations=e.relations.filter((function(e){return e.isEager})),e.lazyRelations=e.relations.filter((function(e){return e.isLazy})),e.oneToOneRelations=e.relations.filter((function(e){return e.isOneToOne})),e.oneToManyRelations=e.relations.filter((function(e){return e.isOneToMany})),e.manyToOneRelations=e.relations.filter((function(e){return e.isManyToOne})),e.manyToManyRelations=e.relations.filter((function(e){return e.isManyToMany})),e.ownerOneToOneRelations=e.relations.filter((function(e){return e.isOneToOneOwner})),e.ownerManyToManyRelations=e.relations.filter((function(e){return e.isManyToManyOwner})),e.treeParentRelation=e.relations.find((function(e){return e.isTreeParent})),e.treeChildrenRelation=e.relations.find((function(e){return e.isTreeChildren})),e.columns=e.embeddeds.reduce((function(e,t){return e.concat(t.columnsFromTree)}),e.ownColumns),e.listeners=e.embeddeds.reduce((function(e,t){return e.concat(t.listenersFromTree)}),e.ownListeners),e.afterLoadListeners=e.listeners.filter((function(e){return e.type===Za.AFTER_LOAD})),e.afterInsertListeners=e.listeners.filter((function(e){return e.type===Za.AFTER_INSERT})),e.afterUpdateListeners=e.listeners.filter((function(e){return e.type===Za.AFTER_UPDATE})),e.afterRemoveListeners=e.listeners.filter((function(e){return e.type===Za.AFTER_REMOVE})),e.beforeInsertListeners=e.listeners.filter((function(e){return e.type===Za.BEFORE_INSERT})),e.beforeUpdateListeners=e.listeners.filter((function(e){return e.type===Za.BEFORE_UPDATE})),e.beforeRemoveListeners=e.listeners.filter((function(e){return e.type===Za.BEFORE_REMOVE})),e.indices=e.embeddeds.reduce((function(e,t){return e.concat(t.indicesFromTree)}),e.ownIndices),e.uniques=e.embeddeds.reduce((function(e,t){return e.concat(t.uniquesFromTree)}),e.ownUniques),e.primaryColumns=e.columns.filter((function(e){return e.isPrimary})),e.nonVirtualColumns=e.columns.filter((function(e){return!e.isVirtual})),e.ancestorColumns=e.columns.filter((function(e){return"ancestor"===e.closureType})),e.descendantColumns=e.columns.filter((function(e){return"descendant"===e.closureType})),e.hasMultiplePrimaryKeys=e.primaryColumns.length>1,e.generatedColumns=e.columns.filter((function(e){return e.isGenerated||e.isObjectId})),e.hasUUIDGeneratedColumns=e.columns.filter((function(e){return e.isGenerated||"uuid"===e.generationStrategy})).length>0,e.createDateColumn=e.columns.find((function(e){return e.isCreateDate})),e.updateDateColumn=e.columns.find((function(e){return e.isUpdateDate})),e.deleteDateColumn=e.columns.find((function(e){return e.isDeleteDate})),e.versionColumn=e.columns.find((function(e){return e.isVersion})),e.discriminatorColumn=e.columns.find((function(e){return e.isDiscriminator})),e.treeLevelColumn=e.columns.find((function(e){return e.isTreeLevel})),e.nestedSetLeftColumn=e.columns.find((function(e){return e.isNestedSetLeft})),e.nestedSetRightColumn=e.columns.find((function(e){return e.isNestedSetRight})),e.materializedPathColumn=e.columns.find((function(e){return e.isMaterializedPath})),e.objectIdColumn=e.columns.find((function(e){return e.isObjectId})),e.foreignKeys.forEach((function(e){return e.build(t.connection.namingStrategy)})),e.propertiesMap=e.createPropertiesMap(),e.relationIds.forEach((function(e){return e.build()})),e.relationCounts.forEach((function(e){return e.build()})),e.embeddeds.forEach((function(e){e.relationIdsFromTree.forEach((function(e){return e.build()})),e.relationCountsFromTree.forEach((function(e){return e.build()}))}))},e.prototype.computeInverseProperties=function(e,t){e.relations.forEach((function(n){var r=t.find((function(e){return e.target===n.type||"string"==typeof n.type&&(e.targetName===n.type||e.givenTableName===n.type)}));if(!r)throw new rt("Entity metadata for "+e.name+"#"+n.propertyPath+" was not found. Check if you specified a correct entity object and if it's connected in the connection options.");n.inverseEntityMetadata=r,n.inverseSidePropertyPath=n.buildInverseSidePropertyPath(),n.inverseRelation=r.relations.find((function(e){return e.propertyPath===n.inverseSidePropertyPath}))}))},e.prototype.createKeysForTableInheritance=function(e){e.indices.push(new Wa({entityMetadata:e,columns:[e.discriminatorColumn],args:{target:e.target,unique:!1}}))},e}(),as=function(){function e(){}return e.prototype.transform=function(e){var t=new Io;return e.forEach((function(e){var n=e.options,r={target:n.target||n.name,name:n.tableName,database:n.database,schema:n.schema,type:n.type||"regular",orderBy:n.orderBy,synchronize:n.synchronize,expression:n.expression};t.tables.push(r),Object.keys(n.columns).forEach((function(e){var r=n.columns[e],i="regular";r.createDate&&(i="createDate"),r.updateDate&&(i="updateDate"),r.deleteDate&&(i="deleteDate"),r.version&&(i="version"),r.treeChildrenCount&&(i="treeChildrenCount"),r.treeLevel&&(i="treeLevel"),r.objectId&&(i="objectId");var o={target:n.target||n.name,mode:i,propertyName:e,options:{type:r.type,name:r.objectId?"_id":r.name,length:r.length,width:r.width,nullable:r.nullable,readonly:r.readonly,update:r.update,select:r.select,insert:r.insert,primary:r.primary,unique:r.unique,comment:r.comment,default:r.default,onUpdate:r.onUpdate,precision:r.precision,scale:r.scale,zerofill:r.zerofill,unsigned:r.unsigned,charset:r.charset,collation:r.collation,enum:r.enum,asExpression:r.asExpression,generatedType:r.generatedType,hstoreType:r.hstoreType,array:r.array,transformer:r.transformer,spatialFeatureType:r.spatialFeatureType,srid:r.srid}};if(t.columns.push(o),r.generated){var a={target:n.target||n.name,propertyName:e,strategy:"string"==typeof r.generated?r.generated:"increment"};t.generations.push(a)}r.unique&&t.uniques.push({target:n.target||n.name,columns:[e]})})),n.relations&&Object.keys(n.relations).forEach((function(e){var r,i,o=n.relations[e],a={target:n.target||n.name,propertyName:e,relationType:o.type,isLazy:o.lazy||!1,type:o.target,inverseSideProperty:o.inverseSide,isTreeParent:o.treeParent,isTreeChildren:o.treeChildren,options:{eager:o.eager||!1,cascade:o.cascade,nullable:o.nullable,onDelete:o.onDelete,onUpdate:o.onUpdate,deferrable:o.deferrable,primary:o.primary,persistence:o.persistence,orphanedRowAction:o.orphanedRowAction}};if(t.relations.push(a),o.joinColumn)if("boolean"==typeof o.joinColumn){var s={target:n.target||n.name,propertyName:e};t.joinColumns.push(s)}else{var u=Array.isArray(o.joinColumn)?o.joinColumn:[o.joinColumn];try{for(var c=Ce(u),l=c.next();!l.done;l=c.next()){var f=l.value;s={target:n.target||n.name,propertyName:e,name:f.name,referencedColumnName:f.referencedColumnName};t.joinColumns.push(s)}}catch(e){r={error:e}}finally{try{l&&!l.done&&(i=c.return)&&i.call(c)}finally{if(r)throw r.error}}}if(o.joinTable)if("boolean"==typeof o.joinTable){var h={target:n.target||n.name,propertyName:e};t.joinTables.push(h)}else{h={target:n.target||n.name,propertyName:e,name:o.joinTable.name,database:o.joinTable.database,schema:o.joinTable.schema,joinColumns:o.joinTable.joinColumn?[o.joinTable.joinColumn]:o.joinTable.joinColumns,inverseJoinColumns:o.joinTable.inverseJoinColumn?[o.joinTable.inverseJoinColumn]:o.joinTable.inverseJoinColumns};t.joinTables.push(h)}})),n.indices&&n.indices.forEach((function(e){var r={target:n.target||n.name,name:e.name,unique:!0===e.unique,spatial:!0===e.spatial,fulltext:!0===e.fulltext,parser:e.parser,synchronize:!1!==e.synchronize,where:e.where,sparse:e.sparse,columns:e.columns};t.indices.push(r)})),n.uniques&&n.uniques.forEach((function(e){var r={target:n.target||n.name,name:e.name,columns:e.columns};t.uniques.push(r)})),n.checks&&n.checks.forEach((function(e){var r={target:n.target||n.name,name:e.name,expression:e.expression};t.checks.push(r)})),n.exclusions&&n.exclusions.forEach((function(e){var r={target:n.target||n.name,name:e.name,expression:e.expression};t.exclusions.push(r)}))})),t},e}(),ss=function(){function e(e){this.connection=e}return e.prototype.buildMigrations=function(e){var t=ke(Ze.splitClassesAndStrings(e),2),n=t[0];t[1];return Be(Be([],ke(n)),ke(Ua(this.connection.logger))).map((function(e){return za(e)}))},e.prototype.buildSubscribers=function(e){var t=ke(Ze.splitClassesAndStrings(e||[]),2),n=t[0],r=(t[1],Be(Be([],ke(n)),ke(Ua(this.connection.logger))));return Es().filterSubscribers(r).map((function(e){return za(e.target)}))},e.prototype.buildEntityMetadatas=function(e){var t=ke(Ze.splitClassesAndStrings(e||[]),2),n=t[0],r=(t[1],n.filter((function(e){return e instanceof wt==!1}))),i=n.filter((function(e){return e instanceof wt})),o=Be(Be([],ke(r)),ke(Ua(this.connection.logger)));o.forEach((function(e){e instanceof wt&&i.push(e)}));var a=new os(this.connection,Es()).build(o),s=(new as).transform(i),u=new os(this.connection,s).build();return Be(Be([],ke(a)),ke(u))},e}(),us=o("8iajb"),cs=function(){function e(e){this.options=e}return e.prototype.logQuery=function(e,t,n){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("query")){var r=e+(t&&t.length?" -- PARAMETERS: "+this.stringifyParams(t):"");console.log("query: "+r)}},e.prototype.logQueryError=function(e,t,n,r){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("error")){var i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");console.log("query failed: "+i),console.log("error:",e)}},e.prototype.logQuerySlow=function(e,t,n,r){var i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");console.log("query is slow: "+i),console.log("execution time: "+e)},e.prototype.logSchemaBuild=function(e,t){("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("schema"))&&console.log(e)},e.prototype.logMigration=function(e,t){console.log(e)},e.prototype.log=function(e,t,n){switch(e){case"log":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("log"))&&console.log(t);break;case"info":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("info"))&&console.info(t);break;case"warn":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("warn"))&&console.warn(t)}},e.prototype.stringifyParams=function(e){try{return JSON.stringify(e)}catch(t){return e}},e}(),ls=function(){function e(e){this.options=e}return e.prototype.logQuery=function(e,t,n){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("query")){var r=e+(t&&t.length?" -- PARAMETERS: "+this.stringifyParams(t):"");Po.logInfo("query:",Po.highlightSql(r))}},e.prototype.logQueryError=function(e,t,n,r){if("all"===this.options||!0===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("error")){var i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");Po.logError("query failed:",Po.highlightSql(i)),Po.logError("error:",e)}},e.prototype.logQuerySlow=function(e,t,n,r){var i=t+(n&&n.length?" -- PARAMETERS: "+this.stringifyParams(n):"");Po.logWarn("query is slow:",Po.highlightSql(i)),Po.logWarn("execution time:",e)},e.prototype.logSchemaBuild=function(e,t){("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("schema"))&&Po.log(e)},e.prototype.logMigration=function(e,t){Po.log(e)},e.prototype.log=function(e,t,n){switch(e){case"log":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("log"))&&Po.log(t);break;case"info":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("info"))&&Po.logInfo("INFO:",t);break;case"warn":("all"===this.options||Array.isArray(this.options)&&-1!==this.options.indexOf("warn"))&&console.warn(Po.warn(t))}},e.prototype.stringifyParams=function(e){try{return JSON.stringify(e)}catch(t){return e}},e}(),fs=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ae(t,e),t}(function(){function e(){}return e.prototype.logQuery=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.logQueryError=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.logQuerySlow=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.logSchemaBuild=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.logMigration=function(){throw new Error("This logger is not applicable in a browser context")},e.prototype.log=function(){throw new Error("This logger is not applicable in a browser context")},e}()),hs={};di=o("iThRa");hs.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+hs.humanize(this.diff),!this.useColors)return;const t="color: "+this.color;e.splice(1,0,t,"color: inherit");let n=0,r=0;e[0].replace(/%[a-zA-Z%]/g,(e=>{"%%"!==e&&(n++,"%c"===e&&(r=n))})),e.splice(r,0,t)},hs.save=function(e){try{e?hs.storage.setItem("debug",e):hs.storage.removeItem("debug")}catch(e){}},hs.load=function(){let e;try{e=hs.storage.getItem("debug")}catch(e){}!e&&void 0!==di&&"env"in di&&(e=void 0);return e},hs.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},hs.storage=function(){try{return localStorage}catch(e){}}(),hs.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),hs.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],hs.log=console.debug||console.log||(()=>{}),hs=o("aipRq")(hs);const{formatters:ds}=hs;ds.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}};var ps=function(){function e(){this.debugQueryLog=n(hs)("typeorm:query:log"),this.debugQueryError=n(hs)("typeorm:query:error"),this.debugQuerySlow=n(hs)("typeorm:query:slow"),this.debugSchemaBuild=n(hs)("typeorm:schema"),this.debugMigration=n(hs)("typeorm:migration"),this.debugLog=n(hs)("typeorm:log"),this.debugInfo=n(hs)("typeorm:info"),this.debugWarn=n(hs)("typeorm:warn")}return e.prototype.logQuery=function(e,t,n){this.debugQueryLog.enabled&&(this.debugQueryLog(Po.highlightSql(e)+";"),t&&t.length&&this.debugQueryLog("parameters:",t))},e.prototype.logQueryError=function(e,t,n,r){this.debugQueryError.enabled&&(this.debugQueryError(Po.highlightSql(t)+";"),n&&n.length&&this.debugQueryError("parameters:",n),this.debugQueryError("error: ",e))},e.prototype.logQuerySlow=function(e,t,n,r){this.debugQuerySlow.enabled&&(this.debugQuerySlow(Po.highlightSql(t)+";"),n&&n.length&&this.debugQuerySlow("parameters:",n),this.debugQuerySlow("execution time:",e))},e.prototype.logSchemaBuild=function(e,t){this.debugSchemaBuild.enabled&&this.debugSchemaBuild(e)},e.prototype.logMigration=function(e,t){this.debugMigration.enabled&&this.debugMigration(e)},e.prototype.log=function(e,t,n){switch(e){case"log":this.debugLog.enabled&&this.debugLog(t);break;case"info":this.debugInfo.enabled&&this.debugInfo(t);break;case"warn":this.debugWarn.enabled&&this.debugWarn(t)}},e}(),ms=function(){function e(){}return e.prototype.create=function(e,t){if(e instanceof Object)return e;if(e)switch(e){case"simple-console":return new cs(t);case"file":return new fs(t);case"advanced-console":return new ls(t);case"debug":return new ps}return new ls(t)},e}(),ys=function(){function e(e,t){this.connection=e,this.clientType=t,this.redis=this.loadRedis()}return e.prototype.connect=function(){return Ne(this,void 0,void 0,(function(){var e;return Oe(this,(function(t){if(e=this.connection.options.cache,"redis"===this.clientType)e&&e.options?this.client=this.redis.createClient(e.options):this.client=this.redis.createClient();else if("ioredis"===this.clientType)e&&e.port?e.options?this.client=new this.redis(e.port,e.options):this.client=new this.redis(e.port):e&&e.options?this.client=new this.redis(e.options):this.client=new this.redis;else if("ioredis/cluster"===this.clientType)if(e&&e.options&&Array.isArray(e.options))this.client=new this.redis.Cluster(e.options);else{if(!(e&&e.options&&e.options.startupNodes))throw new rt("options.startupNodes required for "+this.clientType+".");this.client=new this.redis.Cluster(e.options.startupNodes,e.options.options)}return[2]}))}))},e.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return[2,new Promise((function(t,n){e.client.quit((function(r,i){if(r)return n(r);t(),e.client=void 0}))}))]}))}))},e.prototype.synchronize=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2]}))}))},e.prototype.getFromCache=function(e,t){var n=this;return new Promise((function(t,r){e.identifier?n.client.get(e.identifier,(function(e,n){if(e)return r(e);t(JSON.parse(n))})):e.query?n.client.get(e.query,(function(e,n){if(e)return r(e);t(JSON.parse(n))})):t(void 0)}))},e.prototype.isExpired=function(e){return e.time+e.duration<(new Date).getTime()},e.prototype.storeInCache=function(e,t,n){return Ne(this,void 0,void 0,(function(){var t=this;return Oe(this,(function(n){return[2,new Promise((function(n,r){e.identifier?t.client.set(e.identifier,JSON.stringify(e),"PX",e.duration,(function(e,t){if(e)return r(e);n()})):e.query&&t.client.set(e.query,JSON.stringify(e),"PX",e.duration,(function(e,t){if(e)return r(e);n()}))}))]}))}))},e.prototype.clear=function(e){return Ne(this,void 0,void 0,(function(){var e=this;return Oe(this,(function(t){return[2,new Promise((function(t,n){e.client.flushdb((function(e,r){if(e)return n(e);t()}))}))]}))}))},e.prototype.remove=function(e,t){return Ne(this,void 0,void 0,(function(){var t=this;return Oe(this,(function(n){switch(n.label){case 0:return[4,Promise.all(e.map((function(e){return t.deleteKey(e)})))];case 1:return n.sent(),[2]}}))}))},e.prototype.deleteKey=function(e){var t=this;return new Promise((function(n,r){t.client.del(e,(function(e,t){if(e)return r(e);n()}))}))},e.prototype.loadRedis=function(){try{return"ioredis/cluster"===this.clientType?Po.load("ioredis"):Po.load(this.clientType)}catch(e){throw new rt("Cannot use cache because "+this.clientType+' is not installed. Please run "npm i '+this.clientType+' --save".')}},e}(),gs=function(){function e(e){this.connection=e;var t=this.connection.driver.options.schema,n=this.connection.driver.database,r=("object"==typeof this.connection.options.cache?this.connection.options.cache:{}).tableName||"query-result-cache";this.queryResultCacheDatabase=n,this.queryResultCacheSchema=t,this.queryResultCacheTable=this.connection.driver.buildTableName(r,t,n)}return e.prototype.connect=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2]}))}))},e.prototype.disconnect=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){return[2]}))}))},e.prototype.synchronize=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){switch(n.label){case 0:return e=this.getQueryRunner(e),t=this.connection.driver,[4,e.hasTable(this.queryResultCacheTable)];case 1:return n.sent()?[2]:[4,e.createTable(new dn({database:this.queryResultCacheDatabase,schema:this.queryResultCacheSchema,name:this.queryResultCacheTable,columns:[{name:"id",isPrimary:!0,isNullable:!1,type:t.normalizeType({type:t.mappedDataTypes.cacheId}),generationStrategy:"increment",isGenerated:!0},{name:"identifier",type:t.normalizeType({type:t.mappedDataTypes.cacheIdentifier}),isNullable:!0},{name:"time",type:t.normalizeType({type:t.mappedDataTypes.cacheTime}),isPrimary:!1,isNullable:!1},{name:"duration",type:t.normalizeType({type:t.mappedDataTypes.cacheDuration}),isPrimary:!1,isNullable:!1},{name:"query",type:t.normalizeType({type:t.mappedDataTypes.cacheQuery}),isPrimary:!1,isNullable:!1},{name:"result",type:t.normalizeType({type:t.mappedDataTypes.cacheResult}),isNullable:!1}]}))];case 2:return n.sent(),[2]}}))}))},e.prototype.getFromCache=function(e,t){t=this.getQueryRunner(t);var n=this.connection.createQueryBuilder(t).select().from(this.queryResultCacheTable,"cache");return e.identifier?n.where(n.escape("cache")+"."+n.escape("identifier")+" = :identifier").setParameters({identifier:this.connection.driver instanceof Ve?new ko(e.identifier,"nvarchar"):e.identifier}).getRawOne():e.query?this.connection.driver instanceof He?n.where("dbms_lob.compare("+n.escape("cache")+"."+n.escape("query")+", :query) = 0",{query:e.query}).getRawOne():n.where(n.escape("cache")+"."+n.escape("query")+" = :query").setParameters({query:this.connection.driver instanceof Ve?new ko(e.query,"nvarchar"):e.query}).getRawOne():Promise.resolve(void 0)},e.prototype.isExpired=function(e){var t="string"==typeof e.duration?parseInt(e.duration):e.duration;return("string"==typeof e.time?parseInt(e.time):e.time)+t<(new Date).getTime()},e.prototype.storeInCache=function(e,t,n){return Ne(this,void 0,void 0,(function(){var r,i;return Oe(this,(function(o){switch(o.label){case 0:return n=this.getQueryRunner(n),r=e,this.connection.driver instanceof Ve&&(r={identifier:new ko(e.identifier,"nvarchar"),time:new ko(e.time,"bigint"),duration:new ko(e.duration,"int"),query:new ko(e.query,"nvarchar"),result:new ko(e.result,"nvarchar")}),t&&t.identifier?((i=n.manager.createQueryBuilder().update(this.queryResultCacheTable).set(r)).where(i.escape("identifier")+" = :condition",{condition:r.identifier}),[4,i.execute()]):[3,2];case 1:return o.sent(),[3,6];case 2:return t&&t.query?(i=n.manager.createQueryBuilder().update(this.queryResultCacheTable).set(r),this.connection.driver instanceof He?i.where('dbms_lob.compare("query", :condition) = 0',{condition:r.query}):i.where(i.escape("query")+" = :condition",{condition:r.query}),[4,i.execute()]):[3,4];case 3:return o.sent(),[3,6];case 4:return[4,n.manager.createQueryBuilder().insert().into(this.queryResultCacheTable).values(r).execute()];case 5:o.sent(),o.label=6;case 6:return[2]}}))}))},e.prototype.clear=function(e){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){return[2,this.getQueryRunner(e).clearTable(this.queryResultCacheTable)]}))}))},e.prototype.remove=function(e,t){return Ne(this,void 0,void 0,(function(){var n=this;return Oe(this,(function(r){switch(r.label){case 0:return[4,Promise.all(e.map((function(e){var r=n.getQueryRunner(t).manager.createQueryBuilder();return r.delete().from(n.queryResultCacheTable).where(r.escape("identifier")+" = :identifier",{identifier:e}).execute()})))];case 1:return r.sent(),[2]}}))}))},e.prototype.getQueryRunner=function(e){return e||this.connection.createQueryRunner()},e}(),bs=function(){function e(e){this.connection=e}return e.prototype.create=function(){if(!this.connection.options.cache)throw new rt("To use cache you need to enable it in connection options by setting cache: true or providing some caching options. Example: { host: ..., username: ..., cache: true }");var e=this.connection.options.cache;return e.provider&&"function"==typeof e.provider?e.provider(this.connection):"redis"===e.type||"ioredis"===e.type||"ioredis/cluster"===e.type?new ys(this.connection,e.type):new gs(this.connection)},e}(),vs=function(){function e(e){this.connection=e}return e.prototype.load=function(e,t,n){return n&&n.isReleased&&(n=void 0),e.isManyToOne||e.isOneToOneOwner?this.loadManyToOneOrOneToOneOwner(e,t,n):e.isOneToMany||e.isOneToOneNotOwner?this.loadOneToManyOrOneToOneNotOwner(e,t,n):e.isManyToManyOwner?this.loadManyToManyOwner(e,t,n):this.loadManyToManyNotOwner(e,t,n)},e.prototype.loadManyToOneOrOneToOneOwner=function(e,t,n){var r=Array.isArray(t)?t:[t],i=e.entityMetadata.primaryColumns,o=(e.isOwning?e.joinColumns:e.inverseRelation.joinColumns).map((function(t){return e.entityMetadata.name+"."+t.propertyName+" = "+e.propertyName+"."+t.referencedColumn.propertyName})).join(" AND "),a=e.entityMetadata.name,s=this.connection.createQueryBuilder(n).select(e.propertyName).from(e.type,e.propertyName).innerJoin(e.entityMetadata.target,a,o);if(1===i.length)s.where(a+"."+i[0].propertyPath+" IN (:..."+a+"_"+i[0].propertyName+")"),s.setParameter(a+"_"+i[0].propertyName,r.map((function(e){return i[0].getEntityValue(e)})));else{var u=r.map((function(e,t){return i.map((function(n,r){var i=a+"_entity_"+t+"_"+r;return s.setParameter(i,n.getEntityValue(e)),a+"."+n.propertyPath+" = :"+i})).join(" AND ")})).map((function(e){return"("+e+")"})).join(" OR ");s.where(u)}return s.getMany()},e.prototype.loadOneToManyOrOneToOneNotOwner=function(e,t,n){var r=Array.isArray(t)?t:[t],i=e.propertyName,o=e.inverseRelation.joinColumns,a=this.connection.createQueryBuilder(n).select(i).from(e.inverseRelation.entityMetadata.target,i);if(1===o.length)a.where(i+"."+o[0].propertyPath+" IN (:..."+i+"_"+o[0].propertyName+")"),a.setParameter(i+"_"+o[0].propertyName,r.map((function(e){return o[0].referencedColumn.getEntityValue(e)})));else{var s=r.map((function(e,t){return o.map((function(n,r){var o=i+"_entity_"+t+"_"+r;return a.setParameter(o,n.referencedColumn.getEntityValue(e)),i+"."+n.propertyPath+" = :"+o})).join(" AND ")})).map((function(e){return"("+e+")"})).join(" OR ");a.where(s)}return a.getMany()},e.prototype.loadManyToManyOwner=function(e,t,n){var r=Array.isArray(t)?t:[t],i=e.propertyName,o=e.junctionEntityMetadata.tableName,a=e.joinColumns.map((function(e){return o+"."+e.propertyName+" IN (:..."+e.propertyName+")"})),s=e.inverseJoinColumns.map((function(e){return o+"."+e.propertyName+"="+i+"."+e.referencedColumn.propertyName})),u=e.joinColumns.reduce((function(e,t){return e[t.propertyName]=r.map((function(e){return t.referencedColumn.getEntityValue(e)})),e}),{});return this.connection.createQueryBuilder(n).select(i).from(e.type,i).innerJoin(o,o,Be(Be([],ke(a)),ke(s)).join(" AND ")).setParameters(u).getMany()},e.prototype.loadManyToManyNotOwner=function(e,t,n){var r=Array.isArray(t)?t:[t],i=e.propertyName,o=e.junctionEntityMetadata.tableName,a=e.inverseRelation.joinColumns.map((function(e){return o+"."+e.propertyName+" = "+i+"."+e.referencedColumn.propertyName})),s=e.inverseRelation.inverseJoinColumns.map((function(e){return o+"."+e.propertyName+" IN (:..."+e.propertyName+")"})),u=e.inverseRelation.inverseJoinColumns.reduce((function(e,t){return e[t.propertyName]=r.map((function(e){return t.referencedColumn.getEntityValue(e)})),e}),{});return this.connection.createQueryBuilder(n).select(i).from(e.type,i).innerJoin(o,o,Be(Be([],ke(a)),ke(s)).join(" AND ")).setParameters(u).getMany()},e.prototype.enableLazyLoad=function(e,t,n){var r=this,i="__"+e.propertyName+"__",o="__promise_"+e.propertyName+"__",a="__has_"+e.propertyName+"__",s=function(e,t){return e[i]=t,e[a]=!0,delete e[o],t},u=function(e,t){return delete e[a],delete e[i],e[o]=t,t.then((function(n){return e[o]===t?s(e,n):n})),t};Object.defineProperty(t,e.propertyName,{get:function(){if(!0===this[a]||void 0!==this[i])return Promise.resolve(this[i]);if(this[o])return this[o];var t=r.load(e,this,n).then((function(t){return e.isOneToOne||e.isManyToOne?0===t.length?null:t[0]:t}));return u(this,t)},set:function(e){e instanceof Promise?u(this,e):s(this,e)},configurable:!0})},e}(),ws=function(){function e(e){this.migrations=[],this.subscribers=[],this.entityMetadatas=[],this.name=e.name||"default",this.options=e,this.logger=(new ms).create(this.options.logger,this.options.logging),this.driver=(new qa).create(this),this.manager=this.createEntityManager(),this.namingStrategy=e.namingStrategy||new Oo,this.queryResultCache=e.cache?new bs(this).create():void 0,this.relationLoader=new vs(this),this.isConnected=!1}return Object.defineProperty(e.prototype,"mongoManager",{get:function(){if(!(this.manager instanceof Le))throw new rt("MongoEntityManager is only available for MongoDB databases.");return this.manager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"sqljsManager",{get:function(){if(!(this.manager instanceof fa))throw new rt("SqljsEntityManager is only available for Sqljs databases.");return this.manager},enumerable:!1,configurable:!0}),e.prototype.connect=function(){return Ne(this,void 0,void 0,(function(){var e;return Oe(this,(function(t){switch(t.label){case 0:if(this.isConnected)throw new ft(this.name);return[4,this.driver.connect()];case 1:return t.sent(),this.queryResultCache?[4,this.queryResultCache.connect()]:[3,3];case 2:t.sent(),t.label=3;case 3:ut.assign(this,{isConnected:!0}),t.label=4;case 4:return t.trys.push([4,12,,14]),this.buildMetadatas(),[4,this.driver.afterConnect()];case 5:return t.sent(),this.options.dropSchema?[4,this.dropDatabase()]:[3,7];case 6:t.sent(),t.label=7;case 7:return this.options.synchronize?[4,this.synchronize()]:[3,9];case 8:t.sent(),t.label=9;case 9:return this.options.migrationsRun?[4,this.runMigrations({transaction:this.options.migrationsTransactionMode})]:[3,11];case 10:t.sent(),t.label=11;case 11:return[3,14];case 12:return e=t.sent(),[4,this.close()];case 13:throw t.sent(),e;case 14:return[2,this]}}))}))},e.prototype.close=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:if(!this.isConnected)throw new $t(this.name);return[4,this.driver.disconnect()];case 1:return e.sent(),this.queryResultCache?[4,this.queryResultCache.disconnect()]:[3,3];case 2:e.sent(),e.label=3;case 3:return ut.assign(this,{isConnected:!1}),[2]}}))}))},e.prototype.synchronize=function(e){return void 0===e&&(e=!1),Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){switch(t.label){case 0:if(!this.isConnected)throw new $t(this.name);return e?[4,this.dropDatabase()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,this.driver.createSchemaBuilder().build()];case 3:return t.sent(),[2]}}))}))},e.prototype.dropDatabase=function(){return Ne(this,void 0,void 0,(function(){var e,t,n,r,i,o,a,s;return Oe(this,(function(u){switch(u.label){case 0:e=this.createQueryRunner(),u.label=1;case 1:if(u.trys.push([1,,13,15]),!(this.driver instanceof Ve||this.driver instanceof We||this.driver instanceof Fe))return[3,10];t=this.driver.database?[this.driver.database]:[],this.entityMetadatas.forEach((function(e){e.database&&-1===t.indexOf(e.database)&&t.push(e.database)})),u.label=2;case 2:u.trys.push([2,7,8,9]),n=Ce(t),r=n.next(),u.label=3;case 3:return r.done?[3,6]:(i=r.value,[4,e.clearDatabase(i)]);case 4:u.sent(),u.label=5;case 5:return r=n.next(),[3,3];case 6:return[3,9];case 7:return o=u.sent(),a={error:o},[3,9];case 8:try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}return[7];case 9:return[3,12];case 10:return[4,e.clearDatabase()];case 11:u.sent(),u.label=12;case 12:return[3,15];case 13:return[4,e.release()];case 14:return u.sent(),[7];case 15:return[2]}}))}))},e.prototype.runMigrations=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isConnected)throw new $t(this.name);return(t=new Bo(this)).transaction=e&&e.transaction||"all",[4,t.executePendingMigrations()];case 1:return[2,n.sent()]}}))}))},e.prototype.undoLastMigration=function(e){return Ne(this,void 0,void 0,(function(){var t;return Oe(this,(function(n){switch(n.label){case 0:if(!this.isConnected)throw new $t(this.name);return(t=new Bo(this)).transaction=e&&e.transaction||"all",[4,t.undoLastMigration()];case 1:return n.sent(),[2]}}))}))},e.prototype.showMigrations=function(){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(e){switch(e.label){case 0:if(!this.isConnected)throw new $t(this.name);return[4,new Bo(this).showMigrations()];case 1:return[2,e.sent()]}}))}))},e.prototype.hasMetadata=function(e){return!!this.findMetadata(e)},e.prototype.getMetadata=function(e){var t=this.findMetadata(e);if(!t)throw new Et(e);return t},e.prototype.getRepository=function(e){return this.manager.getRepository(e)},e.prototype.getTreeRepository=function(e){return this.manager.getTreeRepository(e)},e.prototype.getMongoRepository=function(e){if(!(this.driver instanceof De))throw new rt("You can use getMongoRepository only for MongoDB connections.");return this.manager.getRepository(e)},e.prototype.getCustomRepository=function(e){return this.manager.getCustomRepository(e)},e.prototype.transaction=function(e,t){return Ne(this,void 0,void 0,(function(){return Oe(this,(function(n){return[2,this.manager.transaction(e,t)]}))}))},e.prototype.query=function(e,t,n){return Ne(this,void 0,void 0,(function(){var r;return Oe(this,(function(i){switch(i.label){case 0:if(this instanceof Le)throw new rt("Queries aren't supported by MongoDB.");if(n&&n.isReleased)throw new At;r=n||this.createQueryRunner(),i.label=1;case 1:return i.trys.push([1,,3,6]),[4,r.query(e,t)];case 2:return[2,i.sent()];case 3:return n?[3,5]:[4,r.release()];case 4:i.sent(),i.label=5;case 5:return[7];case 6:return[2]}}))}))},e.prototype.createQueryBuilder=function(e,t,n){if(this instanceof Le)throw new rt("Query Builder is not supported by MongoDB.");if(t){var r=this.getMetadata(e);return new us.SelectQueryBuilder(this,n).select(t).from(r.target,t)}return new us.SelectQueryBuilder(this,e)},e.prototype.createQueryRunner=function(e){void 0===e&&(e="master");var t=this.driver.createQueryRunner(e),n=this.createEntityManager(t);return Object.assign(t,{manager:n}),t},e.prototype.getManyToManyMetadata=function(e,t){var n=this.getMetadata(e).findRelationWithPropertyPath(t);if(!n)throw new rt('Relation "'+t+'" was not found in '+e+" entity.");if(!n.isManyToMany)throw new rt('Relation "'+e+"#"+t+'" does not have a many-to-many relationship.You can use this method only on many-to-many relations.');return n.junctionEntityMetadata},e.prototype.createEntityManager=function(e){return(new Sa).create(this,e)},e.prototype.findMetadata=function(e){return this.entityMetadatas.find((function(t){return t.target===e||(e instanceof wt?t.name===e.options.name:"string"==typeof e&&(-1!==e.indexOf(".")?t.tablePath===e:t.name===e||t.tableName===e))}))},e.prototype.buildMetadatas=function(){var e=new ss(this),t=new Lo,n=e.buildSubscribers(this.options.subscribers||[]);ut.assign(this,{subscribers:n});var r=e.buildEntityMetadatas(this.options.entities||[]);ut.assign(this,{entityMetadatas:r});var i=e.buildMigrations(this.options.migrations||[]);ut.assign(this,{migrations:i}),t.validateMany(this.entityMetadatas.filter((function(e){return"view"!==e.tableType})),this.driver)},e}(),_s=function(){function e(){this.connectionMap=new Map}return Object.defineProperty(e.prototype,"connections",{get:function(){return Array.from(this.connectionMap.values())},enumerable:!1,configurable:!0}),e.prototype.has=function(e){return this.connectionMap.has(e)},e.prototype.get=function(e){void 0===e&&(e="default");var t=this.connectionMap.get(e);if(!t)throw new jt(e);return t},e.prototype.create=function(e){var t=this.connectionMap.get(e.name||"default");if(t&&t.isConnected)throw new ct(e.name||"default");var n=new ws(e);return this.connectionMap.set(n.name,n),n},e}();function Es(){var e=Po.getGlobalVariable();return e.typeormMetadataArgsStorage||(e.typeormMetadataArgsStorage=new Io),e.typeormMetadataArgsStorage}function Ss(e){return void 0===e&&(e="default"),Ne(this,void 0,void 0,(function(){return Oe(this,(function(t){return[2,(new No).get(e)]}))}))}function xs(){return za(_s)}function Ts(e){return void 0===e&&(e="default"),xs().get(e)}function Ms(e,t){return function(n,r){var i;"string"==typeof e||e instanceof Function?i=e:e&&(t=e,i=e.type),t||(t={});var o=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",n,r):void 0;if(!i&&o&&(i=o),!t.type&&i&&(t.type=i),"hstore"!==t.type||t.hstoreType||(t.hstoreType=o===Object?"object":"string"),e instanceof Function)Es().embeddeds.push({target:n.constructor,propertyName:r,isArray:o===Array||!0===t.array,prefix:void 0!==t.prefix?t.prefix:void 0,type:e});else{if(!t.type)throw new Qt(n,r);!0===t.unique&&Es().uniques.push({target:n.constructor,columns:[r]}),Es().columns.push({target:n.constructor,propertyName:r,mode:"regular",options:t}),t.generated&&Es().generations.push({target:n.constructor,propertyName:r,strategy:"string"==typeof t.generated?t.generated:"increment"})}}}function As(e,t){return function(n,r){var i;"string"==typeof e?i=e:t=Object.assign({},e),t||(t={});var o=Reflect&&Reflect.getMetadata?Reflect.getMetadata("design:type",n,r):void 0;if(!i&&o&&(i=o),!t.type&&i&&(t.type=i),!t.type)throw new Qt(n,r);if(t.nullable)throw new Tt(n,r);t.primary=!0,Es().columns.push({target:n.constructor,propertyName:r,mode:"regular",options:t}),t.generated&&Es().generations.push({target:n.constructor,propertyName:r,strategy:"string"==typeof t.generated?t.generated:"increment"})}}function Rs(){return function(e,t){Es().entityListeners.push({target:e.constructor,propertyName:t,type:Za.AFTER_INSERT})}}function Is(){return function(e,t){Es().entityListeners.push({target:e.constructor,propertyName:t,type:Za.AFTER_LOAD})}}function Ps(){return function(e,t){Es().entityListeners.push({target:e.constructor,propertyName:t,type:Za.AFTER_UPDATE})}}function Ns(e,t){var n=("object"==typeof e?e:t)||{},r="string"==typeof e?e:n.name;return function(e){Es().tables.push({target:e,name:r,type:"regular",orderBy:n.orderBy?n.orderBy:void 0,engine:n.engine?n.engine:void 0,database:n.database?n.database:void 0,schema:n.schema?n.schema:void 0,synchronize:n.synchronize,withoutRowid:n.withoutRowid})}}function Os(e,t,n){var r="string"==typeof e?e:void 0,i="string"==typeof e?t:e,o="object"!=typeof e||Array.isArray(e)?n:e;return o||(o="object"!=typeof t||Array.isArray(t)?n:t),function(e,t){Es().indices.push({target:t?e.constructor:e,name:r,columns:t?[t]:i,synchronize:!o||!1!==o.synchronize,where:o?o.where:void 0,unique:!(!o||!o.unique),spatial:!(!o||!o.spatial),fulltext:!(!o||!o.fulltext),parser:o?o.parser:void 0,sparse:!(!o||!o.sparse),background:!(!o||!o.background),expireAfterSeconds:o?o.expireAfterSeconds:void 0})}}function Cs(){return new Xt("isNull",void 0,!1)}o("iHHst");(function(){function e(){}e.prototype.hasId=function(){return this.constructor.getRepository().hasId(this)},e.prototype.save=function(e){return this.constructor.getRepository().save(this,e)},e.prototype.remove=function(e){return this.constructor.getRepository().remove(this,e)},e.prototype.softRemove=function(e){return this.constructor.getRepository().softRemove(this,e)},e.prototype.recover=function(e){return this.constructor.getRepository().recover(this,e)},e.prototype.reload=function(){return Ne(this,void 0,void 0,(function(){var e,t;return Oe(this,(function(n){switch(n.label){case 0:return[4,(e=this.constructor).getRepository().findOneOrFail(e.getId(this))];case 1:return t=n.sent(),ut.assign(this,t),[2]}}))}))},e.useConnection=function(e){this.usedConnection=e},e.getRepository=function(){return(this.usedConnection||Ts()).getRepository(this)},Object.defineProperty(e,"target",{get:function(){return this.getRepository().target},enumerable:!1,configurable:!0}),e.hasId=function(e){return this.getRepository().hasId(e)},e.getId=function(e){return this.getRepository().getId(e)},e.createQueryBuilder=function(e){return this.getRepository().createQueryBuilder(e)},e.create=function(e){return this.getRepository().create(e)},e.merge=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return(t=this.getRepository()).merge.apply(t,Be([e],ke(n)))},e.preload=function(e){return this.getRepository().preload(e)},e.save=function(e,t){return this.getRepository().save(e,t)},e.remove=function(e,t){return this.getRepository().remove(e,t)},e.softRemove=function(e,t){return this.getRepository().softRemove(e,t)},e.insert=function(e,t){return this.getRepository().insert(e,t)},e.update=function(e,t,n){return this.getRepository().update(e,t,n)},e.delete=function(e,t){return this.getRepository().delete(e,t)},e.count=function(e){return this.getRepository().count(e)},e.find=function(e){return this.getRepository().find(e)},e.findAndCount=function(e){return this.getRepository().findAndCount(e)},e.findByIds=function(e,t){return this.getRepository().findByIds(e,t)},e.findOne=function(e,t){return this.getRepository().findOne(e,t)},e.findOneOrFail=function(e,t){return this.getRepository().findOneOrFail(e,t)},e.query=function(e,t){return this.getRepository().query(e,t)},e.clear=function(){return this.getRepository().clear()}})(),o("lawob"),us=o("8iajb"),o("9nUs1"),o("dtkPP"),o("d3jyk"),o("3RnXi"),o("7OEKV"),o("hMYFp"),o("2QnDk"),o("14MvS");class ks{constructor(e,t,n,r){if(this.userId=e,this.key=t,this.treeIndex=n,this.hashPath=r,32!==t.length)throw new Error("Invalid key buffer.")}}class Bs{constructor(e,t,n){this.accountPublicKey=e,this.aliasHash=t,this.index=n}}Wn=o("1T4rt"),sr=o("jJK4a"),$n=o("4G3uU");var Ds=function(){return Ds=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Ds.apply(this,arguments)};function js(e,t,n){if(n||2===arguments.length)for(var r,i=0,o=t.length;i<o;i++)!r&&i in t||(r||(r=Array.prototype.slice.call(t,0,i)),r[i]=t[i]);return e.concat(r||Array.prototype.slice.call(t))}var Ls="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:t,qs=Object.keys,Us=Array.isArray;function Fs(e,t){return"object"!=typeof t||qs(t).forEach((function(n){e[n]=t[n]})),e}"undefined"==typeof Promise||Ls.Promise||(Ls.Promise=Promise);var Ks=Object.getPrototypeOf,Vs={}.hasOwnProperty;function zs(e,t){return Vs.call(e,t)}function Ws(e,t){"function"==typeof t&&(t=t(Ks(e))),("undefined"==typeof Reflect?qs:Reflect.ownKeys)(t).forEach((function(n){Gs(e,n,t[n])}))}var Hs=Object.defineProperty;function Gs(e,t,n,r){Hs(e,t,Fs(n&&zs(n,"get")&&"function"==typeof n.get?{get:n.get,set:n.set,configurable:!0}:{value:n,configurable:!0,writable:!0},r))}function Qs(e){return{from:function(t){return e.prototype=Object.create(t.prototype),Gs(e.prototype,"constructor",e),{extend:Ws.bind(null,e.prototype)}}}}var Js=Object.getOwnPropertyDescriptor;function Zs(e,t){var n;return Js(e,t)||(n=Ks(e))&&Zs(n,t)}var $s=[].slice;function Ys(e,t,n){return $s.call(e,t,n)}function Xs(e,t){return t(e)}function eu(e){if(!e)throw new Error("Assertion Failed")}function tu(e){Ls.setImmediate?setImmediate(e):setTimeout(e,0)}function nu(e,t){return e.reduce((function(e,n,r){var i=t(n,r);return i&&(e[i[0]]=i[1]),e}),{})}function ru(e,t){if(zs(e,t))return e[t];if(!t)return e;if("string"!=typeof t){for(var n=[],r=0,i=t.length;r<i;++r){var o=ru(e,t[r]);n.push(o)}return n}var a=t.indexOf(".");if(-1!==a){var s=e[t.substr(0,a)];return void 0===s?void 0:ru(s,t.substr(a+1))}}function iu(e,t,n){if(e&&void 0!==t&&(!("isFrozen"in Object)||!Object.isFrozen(e)))if("string"!=typeof t&&"length"in t){eu("string"!=typeof n&&"length"in n);for(var r=0,i=t.length;r<i;++r)iu(e,t[r],n[r])}else{var o=t.indexOf(".");if(-1!==o){var a=t.substr(0,o),s=t.substr(o+1);if(""===s)void 0===n?Us(e)&&!isNaN(parseInt(a))?e.splice(a,1):delete e[a]:e[a]=n;else{var u=e[a];u||(u=e[a]={}),iu(u,s,n)}}else void 0===n?Us(e)&&!isNaN(parseInt(t))?e.splice(t,1):delete e[t]:e[t]=n}}function ou(e){var t={};for(var n in e)zs(e,n)&&(t[n]=e[n]);return t}var au=[].concat;function su(e){return au.apply([],e)}var uu="Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(su([8,16,32,64].map((function(e){return["Int","Uint","Float"].map((function(t){return t+e+"Array"}))})))).filter((function(e){return Ls[e]})),cu=uu.map((function(e){return Ls[e]}));nu(uu,(function(e){return[e,!0]}));var lu=null;function fu(e){lu="undefined"!=typeof WeakMap&&new WeakMap;var t=hu(e);return lu=null,t}function hu(e){if(!e||"object"!=typeof e)return e;var t=lu&&lu.get(e);if(t)return t;if(Us(e)){t=[],lu&&lu.set(e,t);for(var n=0,r=e.length;n<r;++n)t.push(hu(e[n]))}else if(cu.indexOf(e.constructor)>=0)t=e;else{var i=Ks(e);for(var o in t=i===Object.prototype?{}:Object.create(i),lu&&lu.set(e,t),e)zs(e,o)&&(t[o]=hu(e[o]))}return t}var du={}.toString;function pu(e){return du.call(e).slice(8,-1)}var mu="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator",yu="symbol"==typeof mu?function(e){var t;return null!=e&&(t=e[mu])&&t.apply(e)}:function(){return null},gu={};function bu(e){var t,n,r,i;if(1===arguments.length){if(Us(e))return e.slice();if(this===gu&&"string"==typeof e)return[e];if(i=yu(e)){for(n=[];!(r=i.next()).done;)n.push(r.value);return n}if(null==e)return[e];if("number"==typeof(t=e.length)){for(n=new Array(t);t--;)n[t]=e[t];return n}return[e]}for(t=arguments.length,n=new Array(t);t--;)n[t]=arguments[t];return n}var vu="undefined"!=typeof Symbol?function(e){return"AsyncFunction"===e[Symbol.toStringTag]}:function(){return!1},wu="undefined"!=typeof location&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function _u(e,t){wu=e,Eu=t}var Eu=function(){return!0},Su=!new Error("").stack;function xu(){if(Su)try{throw xu.arguments,new Error}catch(e){return e}return new Error}function Tu(e,t){var n=e.stack;return n?(t=t||0,0===n.indexOf(e.name)&&(t+=(e.name+e.message).split("\n").length),n.split("\n").slice(t).filter(Eu).map((function(e){return"\n"+e})).join("")):""}var Mu=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Au=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(Mu),Ru={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function Iu(e,t){this._e=xu(),this.name=e,this.message=t}function Pu(e,t){return e+". Errors: "+Object.keys(t).map((function(e){return t[e].toString()})).filter((function(e,t,n){return n.indexOf(e)===t})).join("\n")}function Nu(e,t,n,r){this._e=xu(),this.failures=t,this.failedKeys=r,this.successCount=n,this.message=Pu(e,t)}function Ou(e,t){this._e=xu(),this.name="BulkError",this.failures=Object.keys(t).map((function(e){return t[e]})),this.failuresByPos=t,this.message=Pu(e,t)}Qs(Iu).from(Error).extend({stack:{get:function(){return this._stack||(this._stack=this.name+": "+this.message+Tu(this._e,2))}},toString:function(){return this.name+": "+this.message}}),Qs(Nu).from(Iu),Qs(Ou).from(Iu);var Cu=Au.reduce((function(e,t){return e[t]=t+"Error",e}),{}),ku=Iu,Bu=Au.reduce((function(e,t){var n=t+"Error";function r(e,r){this._e=xu(),this.name=n,e?"string"==typeof e?(this.message=e+(r?"\n "+r:""),this.inner=r||null):"object"==typeof e&&(this.message=e.name+" "+e.message,this.inner=e):(this.message=Ru[t]||n,this.inner=null)}return Qs(r).from(ku),e[t]=r,e}),{});Bu.Syntax=SyntaxError,Bu.Type=TypeError,Bu.Range=RangeError;var Du=Mu.reduce((function(e,t){return e[t+"Error"]=Bu[t],e}),{});var ju=Au.reduce((function(e,t){return-1===["Syntax","Type","Range"].indexOf(t)&&(e[t+"Error"]=Bu[t]),e}),{});function Lu(){}function qu(e){return e}function Uu(e,t){return null==e||e===qu?t:function(n){return t(e(n))}}function Fu(e,t){return function(){e.apply(this,arguments),t.apply(this,arguments)}}function Ku(e,t){return e===Lu?t:function(){var n=e.apply(this,arguments);void 0!==n&&(arguments[0]=n);var r=this.onsuccess,i=this.onerror;this.onsuccess=null,this.onerror=null;var o=t.apply(this,arguments);return r&&(this.onsuccess=this.onsuccess?Fu(r,this.onsuccess):r),i&&(this.onerror=this.onerror?Fu(i,this.onerror):i),void 0!==o?o:n}}function Vu(e,t){return e===Lu?t:function(){e.apply(this,arguments);var n=this.onsuccess,r=this.onerror;this.onsuccess=this.onerror=null,t.apply(this,arguments),n&&(this.onsuccess=this.onsuccess?Fu(n,this.onsuccess):n),r&&(this.onerror=this.onerror?Fu(r,this.onerror):r)}}function zu(e,t){return e===Lu?t:function(n){var r=e.apply(this,arguments);Fs(n,r);var i=this.onsuccess,o=this.onerror;this.onsuccess=null,this.onerror=null;var a=t.apply(this,arguments);return i&&(this.onsuccess=this.onsuccess?Fu(i,this.onsuccess):i),o&&(this.onerror=this.onerror?Fu(o,this.onerror):o),void 0===r?void 0===a?void 0:a:Fs(r,a)}}function Wu(e,t){return e===Lu?t:function(){return!1!==t.apply(this,arguments)&&e.apply(this,arguments)}}function Hu(e,t){return e===Lu?t:function(){var n=e.apply(this,arguments);if(n&&"function"==typeof n.then){for(var r=this,i=arguments.length,o=new Array(i);i--;)o[i]=arguments[i];return n.then((function(){return t.apply(r,o)}))}return t.apply(this,arguments)}}ju.ModifyError=Nu,ju.DexieError=Iu,ju.BulkError=Ou;var Gu={},Qu="undefined"==typeof Promise?[]:function(){var e=Promise.resolve();if("undefined"==typeof crypto||!crypto.subtle)return[e,Ks(e),e];var t=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[t,Ks(t),e]}(),Ju=Qu[0],Zu=Qu[1],$u=Qu[2],Yu=Zu&&Zu.then,Xu=Ju&&Ju.constructor,ec=!!$u,tc=!1,nc=$u?function(){$u.then(Tc)}:Ls.setImmediate?setImmediate.bind(null,Tc):Ls.MutationObserver?function(){var e=document.createElement("div");new MutationObserver((function(){Tc(),e=null})).observe(e,{attributes:!0}),e.setAttribute("i","1")}:function(){setTimeout(Tc,0)},rc=function(e,t){hc.push([e,t]),oc&&(nc(),oc=!1)},ic=!0,oc=!0,ac=[],sc=[],uc=null,cc=qu,lc={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Jc,pgp:!1,env:{},finalize:function(){this.unhandleds.forEach((function(e){try{Jc(e[0],e[1])}catch(e){}}))}},fc=lc,hc=[],dc=0,pc=[];function mc(e){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");this._listeners=[],this.onuncatched=Lu,this._lib=!1;var t=this._PSD=fc;if(wu&&(this._stackHolder=xu(),this._prev=null,this._numPrev=0),"function"!=typeof e){if(e!==Gu)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(!1===this._state&&vc(this,this._value))}this._state=null,this._value=null,++t.ref,bc(this,e)}var yc={get:function(){var e=fc,t=Bc;function n(n,r){var i=this,o=!e.global&&(e!==fc||t!==Bc),a=o&&!qc(),s=new mc((function(t,s){_c(i,new gc(Gc(n,e,o,a),Gc(r,e,o,a),t,s,e))}));return wu&&xc(s,this),s}return n.prototype=Gu,n},set:function(e){Gs(this,"then",e&&e.prototype===Gu?yc:{get:function(){return e},set:yc.set})}};function gc(e,t,n,r,i){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.resolve=n,this.reject=r,this.psd=i}function bc(e,t){try{t((function(t){if(null===e._state){if(t===e)throw new TypeError("A promise cannot be resolved with itself.");var n=e._lib&&Mc();t&&"function"==typeof t.then?bc(e,(function(e,n){t instanceof mc?t._then(e,n):t.then(e,n)})):(e._state=!0,e._value=t,wc(e)),n&&Ac()}}),vc.bind(null,e))}catch(t){vc(e,t)}}function vc(e,t){if(sc.push(t),null===e._state){var n=e._lib&&Mc();t=cc(t),e._state=!1,e._value=t,wu&&null!==t&&"object"==typeof t&&!t._promise&&function(e,t,n){try{e.apply(null,n)}catch(e){t&&t(e)}}((function(){var n=Zs(t,"stack");t._promise=e,Gs(t,"stack",{get:function(){return tc?n&&(n.get?n.get.apply(t):n.value):e.stack}})})),function(e){ac.some((function(t){return t._value===e._value}))||ac.push(e)}(e),wc(e),n&&Ac()}}function wc(e){var t=e._listeners;e._listeners=[];for(var n=0,r=t.length;n<r;++n)_c(e,t[n]);var i=e._PSD;--i.ref||i.finalize(),0===dc&&(++dc,rc((function(){0==--dc&&Rc()}),[]))}function _c(e,t){if(null!==e._state){var n=e._state?t.onFulfilled:t.onRejected;if(null===n)return(e._state?t.resolve:t.reject)(e._value);++t.psd.ref,++dc,rc(Ec,[n,e,t])}else e._listeners.push(t)}function Ec(e,t,n){try{uc=t;var r,i=t._value;t._state?r=e(i):(sc.length&&(sc=[]),r=e(i),-1===sc.indexOf(i)&&function(e){var t=ac.length;for(;t;)if(ac[--t]._value===e._value)return void ac.splice(t,1)}(t)),n.resolve(r)}catch(e){n.reject(e)}finally{uc=null,0==--dc&&Rc(),--n.psd.ref||n.psd.finalize()}}function Sc(e,t,n){if(t.length===n)return t;var r="";if(!1===e._state){var i,o,a=e._value;null!=a?(i=a.name||"Error",o=a.message||a,r=Tu(a,0)):(i=a,o=""),t.push(i+(o?": "+o:"")+r)}return wu&&((r=Tu(e._stackHolder,2))&&-1===t.indexOf(r)&&t.push(r),e._prev&&Sc(e._prev,t,n)),t}function xc(e,t){var n=t?t._numPrev+1:0;n<100&&(e._prev=t,e._numPrev=n)}function Tc(){Mc()&&Ac()}function Mc(){var e=ic;return ic=!1,oc=!1,e}function Ac(){var e,t,n;do{for(;hc.length>0;)for(e=hc,hc=[],n=e.length,t=0;t<n;++t){var r=e[t];r[0].apply(null,r[1])}}while(hc.length>0);ic=!0,oc=!0}function Rc(){var e=ac;ac=[],e.forEach((function(e){e._PSD.onunhandled.call(null,e._value,e)}));for(var t=pc.slice(0),n=t.length;n;)t[--n]()}function Ic(e){return new mc(Gu,!1,e)}function Pc(e,t){var n=fc;return function(){var r=Mc(),i=fc;try{return Vc(n,!0),e.apply(this,arguments)}catch(e){t&&t(e)}finally{Vc(i,!1),r&&Ac()}}}Ws(mc.prototype,{then:yc,_then:function(e,t){_c(this,new gc(null,null,e,t,fc))},catch:function(e){if(1===arguments.length)return this.then(null,e);var t=arguments[0],n=arguments[1];return"function"==typeof t?this.then(null,(function(e){return e instanceof t?n(e):Ic(e)})):this.then(null,(function(e){return e&&e.name===t?n(e):Ic(e)}))},finally:function(e){return this.then((function(t){return e(),t}),(function(t){return e(),Ic(t)}))},stack:{get:function(){if(this._stack)return this._stack;try{tc=!0;var e=Sc(this,[],20).join("\nFrom previous: ");return null!==this._state&&(this._stack=e),e}finally{tc=!1}}},timeout:function(e,t){var n=this;return e<1/0?new mc((function(r,i){var o=setTimeout((function(){return i(new Bu.Timeout(t))}),e);n.then(r,i).finally(clearTimeout.bind(null,o))})):this}}),"undefined"!=typeof Symbol&&Symbol.toStringTag&&Gs(mc.prototype,Symbol.toStringTag,"Dexie.Promise"),lc.env=zc(),Ws(mc,{all:function(){var e=bu.apply(null,arguments).map(Uc);return new mc((function(t,n){0===e.length&&t([]);var r=e.length;e.forEach((function(i,o){return mc.resolve(i).then((function(n){e[o]=n,--r||t(e)}),n)}))}))},resolve:function(e){if(e instanceof mc)return e;if(e&&"function"==typeof e.then)return new mc((function(t,n){e.then(t,n)}));var t=new mc(Gu,!0,e);return xc(t,uc),t},reject:Ic,race:function(){var e=bu.apply(null,arguments).map(Uc);return new mc((function(t,n){e.map((function(e){return mc.resolve(e).then(t,n)}))}))},PSD:{get:function(){return fc},set:function(e){return fc=e}},totalEchoes:{get:function(){return Bc}},newPSD:jc,usePSD:Wc,scheduler:{get:function(){return rc},set:function(e){rc=e}},rejectionMapper:{get:function(){return cc},set:function(e){cc=e}},follow:function(e,t){return new mc((function(n,r){return jc((function(t,n){var r=fc;r.unhandleds=[],r.onunhandled=n,r.finalize=Fu((function(){var e=this;!function(e){function t(){e(),pc.splice(pc.indexOf(t),1)}pc.push(t),++dc,rc((function(){0==--dc&&Rc()}),[])}((function(){0===e.unhandleds.length?t():n(e.unhandleds[0])}))}),r.finalize),e()}),t,n,r)}))}}),Xu&&(Xu.allSettled&&Gs(mc,"allSettled",(function(){var e=bu.apply(null,arguments).map(Uc);return new mc((function(t){0===e.length&&t([]);var n=e.length,r=new Array(n);e.forEach((function(e,i){return mc.resolve(e).then((function(e){return r[i]={status:"fulfilled",value:e}}),(function(e){return r[i]={status:"rejected",reason:e}})).then((function(){return--n||t(r)}))}))}))})),Xu.any&&"undefined"!=typeof AggregateError&&Gs(mc,"any",(function(){var e=bu.apply(null,arguments).map(Uc);return new mc((function(t,n){0===e.length&&n(new AggregateError([]));var r=e.length,i=new Array(r);e.forEach((function(e,o){return mc.resolve(e).then((function(e){return t(e)}),(function(e){i[o]=e,--r||n(new AggregateError(i))}))}))}))})));var Nc={awaits:0,echoes:0,id:0},Oc=0,Cc=[],kc=0,Bc=0,Dc=0;function jc(e,t,n,r){var i=fc,o=Object.create(i);o.parent=i,o.ref=0,o.global=!1,o.id=++Dc;var a=lc.env;o.env=ec?{Promise:mc,PromiseProp:{value:mc,configurable:!0,writable:!0},all:mc.all,race:mc.race,allSettled:mc.allSettled,any:mc.any,resolve:mc.resolve,reject:mc.reject,nthen:Qc(a.nthen,o),gthen:Qc(a.gthen,o)}:{},t&&Fs(o,t),++i.ref,o.finalize=function(){--this.parent.ref||this.parent.finalize()};var s=Wc(o,e,n,r);return 0===o.ref&&o.finalize(),s}function Lc(){return Nc.id||(Nc.id=++Oc),++Nc.awaits,Nc.echoes+=100,Nc.id}function qc(){return!!Nc.awaits&&(0==--Nc.awaits&&(Nc.id=0),Nc.echoes=100*Nc.awaits,!0)}function Uc(e){return Nc.echoes&&e&&e.constructor===Xu?(Lc(),e.then((function(e){return qc(),e}),(function(e){return qc(),Zc(e)}))):e}function Fc(e){++Bc,Nc.echoes&&0!=--Nc.echoes||(Nc.echoes=Nc.id=0),Cc.push(fc),Vc(e,!0)}function Kc(){var e=Cc[Cc.length-1];Cc.pop(),Vc(e,!1)}function Vc(e,t){var n=fc;if((t?!Nc.echoes||kc++&&e===fc:!kc||--kc&&e===fc)||Hc(t?Fc.bind(null,e):Kc),e!==fc&&(fc=e,n===lc&&(lc.env=zc()),ec)){var r=lc.env.Promise,i=e.env;Zu.then=i.nthen,r.prototype.then=i.gthen,(n.global||e.global)&&(Object.defineProperty(Ls,"Promise",i.PromiseProp),r.all=i.all,r.race=i.race,r.resolve=i.resolve,r.reject=i.reject,i.allSettled&&(r.allSettled=i.allSettled),i.any&&(r.any=i.any))}}function zc(){var e=Ls.Promise;return ec?{Promise:e,PromiseProp:Object.getOwnPropertyDescriptor(Ls,"Promise"),all:e.all,race:e.race,allSettled:e.allSettled,any:e.any,resolve:e.resolve,reject:e.reject,nthen:Zu.then,gthen:e.prototype.then}:{}}function Wc(e,t,n,r,i){var o=fc;try{return Vc(e,!0),t(n,r,i)}finally{Vc(o,!1)}}function Hc(e){Yu.call(Ju,e)}function Gc(e,t,n,r){return"function"!=typeof e?e:function(){var i=fc;n&&Lc(),Vc(t,!0);try{return e.apply(this,arguments)}finally{Vc(i,!1),r&&Hc(qc)}}}function Qc(e,t){return function(n,r){return e.call(this,Gc(n,t),Gc(r,t))}}-1===(""+Yu).indexOf("[native code]")&&(Lc=qc=Lu);function Jc(e,t){var n;try{n=t.onuncatched(e)}catch(e){}if(!1!==n)try{var r,i={promise:t,reason:e};if(Ls.document&&document.createEvent?((r=document.createEvent("Event")).initEvent("unhandledrejection",!0,!0),Fs(r,i)):Ls.CustomEvent&&Fs(r=new CustomEvent("unhandledrejection",{detail:i}),i),r&&Ls.dispatchEvent&&(dispatchEvent(r),!Ls.PromiseRejectionEvent&&Ls.onunhandledrejection))try{Ls.onunhandledrejection(r)}catch(e){}wu&&r&&!r.defaultPrevented&&console.warn("Unhandled rejection: "+(e.stack||e))}catch(e){}}var Zc=mc.reject;function $c(e,t,n,r){if(e.idbdb&&(e._state.openComplete||fc.letThrough||e._vip)){var i=e._createTransaction(t,n,e._dbSchema);try{i.create(),e._state.PR1398_maxLoop=3}catch(i){return i.name===Cu.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((function(){return $c(e,t,n,r)}))):Zc(i)}return i._promise(t,(function(e,t){return jc((function(){return fc.trans=i,r(e,t,i)}))})).then((function(e){return i._completion.then((function(){return e}))}))}if(e._state.openComplete)return Zc(new Bu.DatabaseClosed(e._state.dbOpenError));if(!e._state.isBeingOpened){if(!e._options.autoOpen)return Zc(new Bu.DatabaseClosed);e.open().catch(Lu)}return e._state.dbReadyPromise.then((function(){return $c(e,t,n,r)}))}var Yc=String.fromCharCode(65535),Xc="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",el=[],tl="undefined"!=typeof navigator&&/(MSIE|Trident|Edge)/.test(navigator.userAgent),nl=tl,rl=tl,il=function(e){return!/(dexie\.js|dexie\.min\.js)/.test(e)};function ol(e,t){return e?t?function(){return e.apply(this,arguments)&&t.apply(this,arguments)}:e:t}var al={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function sl(e){return"string"!=typeof e||/\./.test(e)?function(e){return e}:function(t){return void 0===t[e]&&e in t&&delete(t=fu(t))[e],t}}var ul=function(){function e(){}return e.prototype._trans=function(e,t,n){var r=this._tx||fc.trans,i=this.name;function o(e,n,r){if(!r.schema[i])throw new Bu.NotFound("Table "+i+" not part of transaction");return t(r.idbtrans,r)}var a=Mc();try{return r&&r.db===this.db?r===fc.trans?r._promise(e,o,n):jc((function(){return r._promise(e,o,n)}),{trans:r,transless:fc.transless||fc}):$c(this.db,e,[this.name],o)}finally{a&&Ac()}},e.prototype.get=function(e,t){var n=this;return e&&e.constructor===Object?this.where(e).first(t):this._trans("readonly",(function(t){return n.core.get({trans:t,key:e}).then((function(e){return n.hook.reading.fire(e)}))})).then(t)},e.prototype.where=function(e){if("string"==typeof e)return new this.db.WhereClause(this,e);if(Us(e))return new this.db.WhereClause(this,"["+e.join("+")+"]");var t=qs(e);if(1===t.length)return this.where(t[0]).equals(e[t[0]]);var n=this.schema.indexes.concat(this.schema.primKey).filter((function(e){return e.compound&&t.every((function(t){return e.keyPath.indexOf(t)>=0}))&&e.keyPath.every((function(e){return t.indexOf(e)>=0}))}))[0];if(n&&this.db._maxKey!==Yc)return this.where(n.name).equals(n.keyPath.map((function(t){return e[t]})));!n&&wu&&console.warn("The query "+JSON.stringify(e)+" on "+this.name+" would benefit of a compound index ["+t.join("+")+"]");var r=this.schema.idxByName,i=this.db._deps.indexedDB;function o(e,t){try{return 0===i.cmp(e,t)}catch(e){return!1}}var a=t.reduce((function(t,n){var i=t[0],a=t[1],s=r[n],u=e[n];return[i||s,i||!s?ol(a,s&&s.multi?function(e){var t=ru(e,n);return Us(t)&&t.some((function(e){return o(u,e)}))}:function(e){return o(u,ru(e,n))}):a]}),[null,null]),s=a[0],u=a[1];return s?this.where(s.name).equals(e[s.keyPath]).filter(u):n?this.filter(u):this.where(t).equals("")},e.prototype.filter=function(e){return this.toCollection().and(e)},e.prototype.count=function(e){return this.toCollection().count(e)},e.prototype.offset=function(e){return this.toCollection().offset(e)},e.prototype.limit=function(e){return this.toCollection().limit(e)},e.prototype.each=function(e){return this.toCollection().each(e)},e.prototype.toArray=function(e){return this.toCollection().toArray(e)},e.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},e.prototype.orderBy=function(e){return new this.db.Collection(new this.db.WhereClause(this,Us(e)?"["+e.join("+")+"]":e))},e.prototype.reverse=function(){return this.toCollection().reverse()},e.prototype.mapToClass=function(e){this.schema.mappedClass=e;var t=function(t){if(!t)return t;var n=Object.create(e.prototype);for(var r in t)if(zs(t,r))try{n[r]=t[r]}catch(e){}return n};return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=t,this.hook("reading",t),e},e.prototype.defineClass=function(){return this.mapToClass((function(e){Fs(this,e)}))},e.prototype.add=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=sl(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"add",keys:null!=t?[t]:null,values:[a]})})).then((function(e){return e.numFailures?mc.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{iu(e,o,t)}catch(e){}return t}))},e.prototype.update=function(e,t){if("object"!=typeof e||Us(e))return this.where(":id").equals(e).modify(t);var n=ru(e,this.schema.primKey.keyPath);if(void 0===n)return Zc(new Bu.InvalidArgument("Given object does not contain its primary key"));try{"function"!=typeof t?qs(t).forEach((function(n){iu(e,n,t[n])})):t(e,{value:e,primKey:n})}catch(e){}return this.where(":id").equals(n).modify(t)},e.prototype.put=function(e,t){var n=this,r=this.schema.primKey,i=r.auto,o=r.keyPath,a=e;return o&&i&&(a=sl(o)(e)),this._trans("readwrite",(function(e){return n.core.mutate({trans:e,type:"put",values:[a],keys:null!=t?[t]:null})})).then((function(e){return e.numFailures?mc.reject(e.failures[0]):e.lastResult})).then((function(t){if(o)try{iu(e,o,t)}catch(e){}return t}))},e.prototype.delete=function(e){var t=this;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:[e]})})).then((function(e){return e.numFailures?mc.reject(e.failures[0]):void 0}))},e.prototype.clear=function(){var e=this;return this._trans("readwrite",(function(t){return e.core.mutate({trans:t,type:"deleteRange",range:al})})).then((function(e){return e.numFailures?mc.reject(e.failures[0]):void 0}))},e.prototype.bulkGet=function(e){var t=this;return this._trans("readonly",(function(n){return t.core.getMany({keys:e,trans:n}).then((function(e){return e.map((function(e){return t.hook.reading.fire(e)}))}))}))},e.prototype.bulkAdd=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,s=n.keyPath;if(s&&i)throw new Bu.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Bu.InvalidArgument("Arguments objects and keys must have the same length");var u=e.length,c=s&&a?e.map(sl(s)):e;return r.core.mutate({trans:t,type:"add",keys:i,values:c,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,a=e.failures;if(0===t)return o?n:i;throw new Ou(r.name+".bulkAdd(): "+t+" of "+u+" operations failed",a)}))}))},e.prototype.bulkPut=function(e,t,n){var r=this,i=Array.isArray(t)?t:void 0,o=(n=n||(i?void 0:t))?n.allKeys:void 0;return this._trans("readwrite",(function(t){var n=r.schema.primKey,a=n.auto,s=n.keyPath;if(s&&i)throw new Bu.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(i&&i.length!==e.length)throw new Bu.InvalidArgument("Arguments objects and keys must have the same length");var u=e.length,c=s&&a?e.map(sl(s)):e;return r.core.mutate({trans:t,type:"put",keys:i,values:c,wantResults:o}).then((function(e){var t=e.numFailures,n=e.results,i=e.lastResult,a=e.failures;if(0===t)return o?n:i;throw new Ou(r.name+".bulkPut(): "+t+" of "+u+" operations failed",a)}))}))},e.prototype.bulkDelete=function(e){var t=this,n=e.length;return this._trans("readwrite",(function(n){return t.core.mutate({trans:n,type:"delete",keys:e})})).then((function(e){var r=e.numFailures,i=e.lastResult,o=e.failures;if(0===r)return i;throw new Ou(t.name+".bulkDelete(): "+r+" of "+n+" operations failed",o)}))},e}();function cl(e){var t={},n=function(n,r){if(r){for(var i=arguments.length,o=new Array(i-1);--i;)o[i-1]=arguments[i];return t[n].subscribe.apply(null,o),e}if("string"==typeof n)return t[n]};n.addEventType=o;for(var r=1,i=arguments.length;r<i;++r)o(arguments[r]);function o(e,r,i){if("object"==typeof e)return a(e);r||(r=Wu),i||(i=Lu);var o={subscribers:[],fire:i,subscribe:function(e){-1===o.subscribers.indexOf(e)&&(o.subscribers.push(e),o.fire=r(o.fire,e))},unsubscribe:function(e){o.subscribers=o.subscribers.filter((function(t){return t!==e})),o.fire=o.subscribers.reduce(r,i)}};return t[e]=n[e]=o,o}function a(e){qs(e).forEach((function(t){var n=e[t];if(Us(n))o(t,e[t][0],e[t][1]);else{if("asap"!==n)throw new Bu.InvalidArgument("Invalid event config");var r=o(t,qu,(function(){for(var e=arguments.length,t=new Array(e);e--;)t[e]=arguments[e];r.subscribers.forEach((function(e){tu((function(){e.apply(null,t)}))}))}))}}))}return n}function ll(e,t){return Qs(t).from({prototype:e}),t}function fl(e,t){return!(e.filter||e.algorithm||e.or)&&(t?e.justLimit:!e.replayFilter)}function hl(e,t){e.filter=ol(e.filter,t)}function dl(e,t,n){var r=e.replayFilter;e.replayFilter=r?function(){return ol(r(),t())}:t,e.justLimit=n&&!r}function pl(e,t){if(e.isPrimKey)return t.primaryKey;var n=t.getIndexByKeyPath(e.index);if(!n)throw new Bu.Schema("KeyPath "+e.index+" on object store "+t.name+" is not indexed");return n}function ml(e,t,n){var r=pl(e,t.schema);return t.openCursor({trans:n,values:!e.keysOnly,reverse:"prev"===e.dir,unique:!!e.unique,query:{index:r,range:e.range}})}function yl(e,t,n,r){var i=e.replayFilter?ol(e.filter,e.replayFilter()):e.filter;if(e.or){var o={},a=function(e,n,r){if(!i||i(n,r,(function(e){return n.stop(e)}),(function(e){return n.fail(e)}))){var a=n.primaryKey,s=""+a;"[object ArrayBuffer]"===s&&(s=""+new Uint8Array(a)),zs(o,s)||(o[s]=!0,t(e,n,r))}};return Promise.all([e.or._iterate(a,n),gl(ml(e,r,n),e.algorithm,a,!e.keysOnly&&e.valueMapper)])}return gl(ml(e,r,n),ol(e.algorithm,i),t,!e.keysOnly&&e.valueMapper)}function gl(e,t,n,r){var i=Pc(r?function(e,t,i){return n(r(e),t,i)}:n);return e.then((function(e){if(e)return e.start((function(){var n=function(){return e.continue()};t&&!t(e,(function(e){return n=e}),(function(t){e.stop(t),n=Lu}),(function(t){e.fail(t),n=Lu}))||i(e.value,e,(function(e){return n=e})),n()}))}))}function bl(e,t){try{var n=vl(e),r=vl(t);if(n!==r)return"Array"===n?1:"Array"===r?-1:"binary"===n?1:"binary"===r?-1:"string"===n?1:"string"===r?-1:"Date"===n?1:"Date"!==r?NaN:-1;switch(n){case"number":case"Date":case"string":return e>t?1:e<t?-1:0;case"binary":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o)if(e[o]!==t[o])return e[o]<t[o]?-1:1;return n===r?0:n<r?-1:1}(wl(e),wl(t));case"Array":return function(e,t){for(var n=e.length,r=t.length,i=n<r?n:r,o=0;o<i;++o){var a=bl(e[o],t[o]);if(0!==a)return a}return n===r?0:n<r?-1:1}(e,t)}}catch(e){}return NaN}function vl(e){var t=typeof e;if("object"!==t)return t;if(ArrayBuffer.isView(e))return"binary";var n=pu(e);return"ArrayBuffer"===n?"binary":n}function wl(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var _l=function(){function e(){}return e.prototype._read=function(e,t){var n=this._ctx;return n.error?n.table._trans(null,Zc.bind(null,n.error)):n.table._trans("readonly",e).then(t)},e.prototype._write=function(e){var t=this._ctx;return t.error?t.table._trans(null,Zc.bind(null,t.error)):t.table._trans("readwrite",e,"locked")},e.prototype._addAlgorithm=function(e){var t=this._ctx;t.algorithm=ol(t.algorithm,e)},e.prototype._iterate=function(e,t){return yl(this._ctx,e,t,this._ctx.table.core)},e.prototype.clone=function(e){var t=Object.create(this.constructor.prototype),n=Object.create(this._ctx);return e&&Fs(n,e),t._ctx=n,t},e.prototype.raw=function(){return this._ctx.valueMapper=null,this},e.prototype.each=function(e){var t=this._ctx;return this._read((function(n){return yl(t,e,n,t.table.core)}))},e.prototype.count=function(e){var t=this;return this._read((function(e){var n=t._ctx,r=n.table.core;if(fl(n,!0))return r.count({trans:e,query:{index:pl(n,r.schema),range:n.range}}).then((function(e){return Math.min(e,n.limit)}));var i=0;return yl(n,(function(){return++i,!1}),e,r).then((function(){return i}))})).then(e)},e.prototype.sortBy=function(e,t){var n=e.split(".").reverse(),r=n[0],i=n.length-1;function o(e,t){return t?o(e[n[t]],t-1):e[r]}var a="next"===this._ctx.dir?1:-1;function s(e,t){var n=o(e,i),r=o(t,i);return n<r?-a:n>r?a:0}return this.toArray((function(e){return e.sort(s)})).then(t)},e.prototype.toArray=function(e){var t=this;return this._read((function(e){var n=t._ctx;if("next"===n.dir&&fl(n,!0)&&n.limit>0){var r=n.valueMapper,i=pl(n,n.table.core.schema);return n.table.core.query({trans:e,limit:n.limit,values:!0,query:{index:i,range:n.range}}).then((function(e){var t=e.result;return r?t.map(r):t}))}var o=[];return yl(n,(function(e){return o.push(e)}),e,n.table.core).then((function(){return o}))}),e)},e.prototype.offset=function(e){var t=this._ctx;return e<=0||(t.offset+=e,fl(t)?dl(t,(function(){var t=e;return function(e,n){return 0===t||(1===t?(--t,!1):(n((function(){e.advance(t),t=0})),!1))}})):dl(t,(function(){var t=e;return function(){return--t<0}}))),this},e.prototype.limit=function(e){return this._ctx.limit=Math.min(this._ctx.limit,e),dl(this._ctx,(function(){var t=e;return function(e,n,r){return--t<=0&&n(r),t>=0}}),!0),this},e.prototype.until=function(e,t){return hl(this._ctx,(function(n,r,i){return!e(n.value)||(r(i),t)})),this},e.prototype.first=function(e){return this.limit(1).toArray((function(e){return e[0]})).then(e)},e.prototype.last=function(e){return this.reverse().first(e)},e.prototype.filter=function(e){var t,n;return hl(this._ctx,(function(t){return e(t.value)})),t=this._ctx,n=e,t.isMatch=ol(t.isMatch,n),this},e.prototype.and=function(e){return this.filter(e)},e.prototype.or=function(e){return new this.db.WhereClause(this._ctx.table,e,this)},e.prototype.reverse=function(){return this._ctx.dir="prev"===this._ctx.dir?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},e.prototype.desc=function(){return this.reverse()},e.prototype.eachKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.key,n)}))},e.prototype.eachUniqueKey=function(e){return this._ctx.unique="unique",this.eachKey(e)},e.prototype.eachPrimaryKey=function(e){var t=this._ctx;return t.keysOnly=!t.isMatch,this.each((function(t,n){e(n.primaryKey,n)}))},e.prototype.keys=function(e){var t=this._ctx;t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.key)})).then((function(){return n})).then(e)},e.prototype.primaryKeys=function(e){var t=this._ctx;if("next"===t.dir&&fl(t,!0)&&t.limit>0)return this._read((function(e){var n=pl(t,t.table.core.schema);return t.table.core.query({trans:e,values:!1,limit:t.limit,query:{index:n,range:t.range}})})).then((function(e){return e.result})).then(e);t.keysOnly=!t.isMatch;var n=[];return this.each((function(e,t){n.push(t.primaryKey)})).then((function(){return n})).then(e)},e.prototype.uniqueKeys=function(e){return this._ctx.unique="unique",this.keys(e)},e.prototype.firstKey=function(e){return this.limit(1).keys((function(e){return e[0]})).then(e)},e.prototype.lastKey=function(e){return this.reverse().firstKey(e)},e.prototype.distinct=function(){var e=this._ctx,t=e.index&&e.table.schema.idxByName[e.index];if(!t||!t.multi)return this;var n={};return hl(this._ctx,(function(e){var t=e.primaryKey.toString(),r=zs(n,t);return n[t]=!0,!r})),this},e.prototype.modify=function(e){var t=this,n=this._ctx;return this._write((function(r){var i;if("function"==typeof e)i=e;else{var o=qs(e),a=o.length;i=function(t){for(var n=!1,r=0;r<a;++r){var i=o[r],s=e[i];ru(t,i)!==s&&(iu(t,i,s),n=!0)}return n}}var s=n.table.core,u=s.schema.primaryKey,c=u.outbound,l=u.extractKey,f=t.db._options.modifyChunkSize||200,h=[],d=0,p=[],m=function(e,t){var n=t.failures,r=t.numFailures;d+=e-r;for(var i=0,o=qs(n);i<o.length;i++){var a=o[i];h.push(n[a])}};return t.clone().primaryKeys().then((function(t){var o=function(a){var u=Math.min(f,t.length-a);return s.getMany({trans:r,keys:t.slice(a,a+u),cache:"immutable"}).then((function(h){for(var d=[],p=[],y=c?[]:null,g=[],b=0;b<u;++b){var v=h[b],w={value:fu(v),primKey:t[a+b]};!1!==i.call(w,w.value,w)&&(null==w.value?g.push(t[a+b]):c||0===bl(l(v),l(w.value))?(p.push(w.value),c&&y.push(t[a+b])):(g.push(t[a+b]),d.push(w.value)))}var _=fl(n)&&n.limit===1/0&&("function"!=typeof e||e===El)&&{index:n.index,range:n.range};return Promise.resolve(d.length>0&&s.mutate({trans:r,type:"add",values:d}).then((function(e){for(var t in e.failures)g.splice(parseInt(t),1);m(d.length,e)}))).then((function(){return(p.length>0||_&&"object"==typeof e)&&s.mutate({trans:r,type:"put",keys:y,values:p,criteria:_,changeSpec:"function"!=typeof e&&e}).then((function(e){return m(p.length,e)}))})).then((function(){return(g.length>0||_&&e===El)&&s.mutate({trans:r,type:"delete",keys:g,criteria:_}).then((function(e){return m(g.length,e)}))})).then((function(){return t.length>a+u&&o(a+f)}))}))};return o(0).then((function(){if(h.length>0)throw new Nu("Error modifying one or more objects",h,d,p);return t.length}))}))}))},e.prototype.delete=function(){var e=this._ctx,t=e.range;return fl(e)&&(e.isPrimKey&&!rl||3===t.type)?this._write((function(n){var r=e.table.core.schema.primaryKey,i=t;return e.table.core.count({trans:n,query:{index:r,range:i}}).then((function(t){return e.table.core.mutate({trans:n,type:"deleteRange",range:i}).then((function(e){var n=e.failures;e.lastResult,e.results;var r=e.numFailures;if(r)throw new Nu("Could not delete some values",Object.keys(n).map((function(e){return n[e]})),t-r);return t-r}))}))})):this.modify(El)},e}(),El=function(e,t){return t.value=null};function Sl(e,t){return e<t?-1:e===t?0:1}function xl(e,t){return e>t?-1:e===t?0:1}function Tl(e,t,n){var r=e instanceof Nl?new e.Collection(e):e;return r._ctx.error=n?new n(t):new TypeError(t),r}function Ml(e){return new e.Collection(e,(function(){return Pl("")})).limit(0)}function Al(e,t,n,r,i,o){for(var a=Math.min(e.length,r.length),s=-1,u=0;u<a;++u){var c=t[u];if(c!==r[u])return i(e[u],n[u])<0?e.substr(0,u)+n[u]+n.substr(u+1):i(e[u],r[u])<0?e.substr(0,u)+r[u]+n.substr(u+1):s>=0?e.substr(0,s)+t[s]+n.substr(s+1):null;i(e[u],c)<0&&(s=u)}return a<r.length&&"next"===o?e+n.substr(e.length):a<e.length&&"prev"===o?e.substr(0,n.length):s<0?null:e.substr(0,s)+r[s]+n.substr(s+1)}function Rl(e,t,n,r){var i,o,a,s,u,c,l,f=n.length;if(!n.every((function(e){return"string"==typeof e})))return Tl(e,"String expected.");function h(e){i=function(e){return"next"===e?function(e){return e.toUpperCase()}:function(e){return e.toLowerCase()}}(e),o=function(e){return"next"===e?function(e){return e.toLowerCase()}:function(e){return e.toUpperCase()}}(e),a="next"===e?Sl:xl;var t=n.map((function(e){return{lower:o(e),upper:i(e)}})).sort((function(e,t){return a(e.lower,t.lower)}));s=t.map((function(e){return e.upper})),u=t.map((function(e){return e.lower})),c=e,l="next"===e?"":r}h("next");var d=new e.Collection(e,(function(){return Il(s[0],u[f-1]+r)}));d._ondirectionchange=function(e){h(e)};var p=0;return d._addAlgorithm((function(e,n,r){var i=e.key;if("string"!=typeof i)return!1;var h=o(i);if(t(h,u,p))return!0;for(var d=null,m=p;m<f;++m){var y=Al(i,h,s[m],u[m],a,c);null===y&&null===d?p=m+1:(null===d||a(d,y)>0)&&(d=y)}return n(null!==d?function(){e.continue(d+l)}:r),!1})),d}function Il(e,t,n,r){return{type:2,lower:e,upper:t,lowerOpen:n,upperOpen:r}}function Pl(e){return{type:1,lower:e,upper:e}}var Nl=function(){function e(){}return Object.defineProperty(e.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),e.prototype.between=function(e,t,n,r){n=!1!==n,r=!0===r;try{return this._cmp(e,t)>0||0===this._cmp(e,t)&&(n||r)&&(!n||!r)?Ml(this):new this.Collection(this,(function(){return Il(e,t,!n,!r)}))}catch(e){return Tl(this,Xc)}},e.prototype.equals=function(e){return null==e?Tl(this,Xc):new this.Collection(this,(function(){return Pl(e)}))},e.prototype.above=function(e){return null==e?Tl(this,Xc):new this.Collection(this,(function(){return Il(e,void 0,!0)}))},e.prototype.aboveOrEqual=function(e){return null==e?Tl(this,Xc):new this.Collection(this,(function(){return Il(e,void 0,!1)}))},e.prototype.below=function(e){return null==e?Tl(this,Xc):new this.Collection(this,(function(){return Il(void 0,e,!1,!0)}))},e.prototype.belowOrEqual=function(e){return null==e?Tl(this,Xc):new this.Collection(this,(function(){return Il(void 0,e)}))},e.prototype.startsWith=function(e){return"string"!=typeof e?Tl(this,"String expected."):this.between(e,e+Yc,!0,!0)},e.prototype.startsWithIgnoreCase=function(e){return""===e?this.startsWith(e):Rl(this,(function(e,t){return 0===e.indexOf(t[0])}),[e],Yc)},e.prototype.equalsIgnoreCase=function(e){return Rl(this,(function(e,t){return e===t[0]}),[e],"")},e.prototype.anyOfIgnoreCase=function(){var e=bu.apply(gu,arguments);return 0===e.length?Ml(this):Rl(this,(function(e,t){return-1!==t.indexOf(e)}),e,"")},e.prototype.startsWithAnyOfIgnoreCase=function(){var e=bu.apply(gu,arguments);return 0===e.length?Ml(this):Rl(this,(function(e,t){return t.some((function(t){return 0===e.indexOf(t)}))}),e,Yc)},e.prototype.anyOf=function(){var e=this,t=bu.apply(gu,arguments),n=this._cmp;try{t.sort(n)}catch(e){return Tl(this,Xc)}if(0===t.length)return Ml(this);var r=new this.Collection(this,(function(){return Il(t[0],t[t.length-1])}));r._ondirectionchange=function(r){n="next"===r?e._ascending:e._descending,t.sort(n)};var i=0;return r._addAlgorithm((function(e,r,o){for(var a=e.key;n(a,t[i])>0;)if(++i===t.length)return r(o),!1;return 0===n(a,t[i])||(r((function(){e.continue(t[i])})),!1)})),r},e.prototype.notEqual=function(e){return this.inAnyRange([[-(1/0),e],[e,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},e.prototype.noneOf=function(){var e=bu.apply(gu,arguments);if(0===e.length)return new this.Collection(this);try{e.sort(this._ascending)}catch(e){return Tl(this,Xc)}var t=e.reduce((function(e,t){return e?e.concat([[e[e.length-1][1],t]]):[[-(1/0),t]]}),null);return t.push([e[e.length-1],this.db._maxKey]),this.inAnyRange(t,{includeLowers:!1,includeUppers:!1})},e.prototype.inAnyRange=function(e,t){var n=this,r=this._cmp,i=this._ascending,o=this._descending,a=this._min,s=this._max;if(0===e.length)return Ml(this);if(!e.every((function(e){return void 0!==e[0]&&void 0!==e[1]&&i(e[0],e[1])<=0})))return Tl(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Bu.InvalidArgument);var u=!t||!1!==t.includeLowers,c=t&&!0===t.includeUppers;var l,f=i;function h(e,t){return f(e[0],t[0])}try{(l=e.reduce((function(e,t){for(var n=0,i=e.length;n<i;++n){var o=e[n];if(r(t[0],o[1])<0&&r(t[1],o[0])>0){o[0]=a(o[0],t[0]),o[1]=s(o[1],t[1]);break}}return n===i&&e.push(t),e}),[])).sort(h)}catch(e){return Tl(this,Xc)}var d=0,p=c?function(e){return i(e,l[d][1])>0}:function(e){return i(e,l[d][1])>=0},m=u?function(e){return o(e,l[d][0])>0}:function(e){return o(e,l[d][0])>=0};var y=p,g=new this.Collection(this,(function(){return Il(l[0][0],l[l.length-1][1],!u,!c)}));return g._ondirectionchange=function(e){"next"===e?(y=p,f=i):(y=m,f=o),l.sort(h)},g._addAlgorithm((function(e,t,r){for(var o=e.key;y(o);)if(++d===l.length)return t(r),!1;return!!function(e){return!p(e)&&!m(e)}(o)||(0===n._cmp(o,l[d][1])||0===n._cmp(o,l[d][0])||t((function(){f===i?e.continue(l[d][0]):e.continue(l[d][1])})),!1)})),g},e.prototype.startsWithAnyOf=function(){var e=bu.apply(gu,arguments);return e.every((function(e){return"string"==typeof e}))?0===e.length?Ml(this):this.inAnyRange(e.map((function(e){return[e,e+Yc]}))):Tl(this,"startsWithAnyOf() only works with strings")},e}();function Ol(e){return Pc((function(t){return Cl(t),e(t.target.error),!1}))}function Cl(e){e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault()}var kl=cl(null,"storagemutated"),Bl=function(){function e(){}return e.prototype._lock=function(){return eu(!fc.global),++this._reculock,1!==this._reculock||fc.global||(fc.lockOwnerFor=this),this},e.prototype._unlock=function(){if(eu(!fc.global),0==--this._reculock)for(fc.global||(fc.lockOwnerFor=null);this._blockedFuncs.length>0&&!this._locked();){var e=this._blockedFuncs.shift();try{Wc(e[1],e[0])}catch(e){}}return this},e.prototype._locked=function(){return this._reculock&&fc.lockOwnerFor!==this},e.prototype.create=function(e){var t=this;if(!this.mode)return this;var n=this.db.idbdb,r=this.db._state.dbOpenError;if(eu(!this.idbtrans),!e&&!n)switch(r&&r.name){case"DatabaseClosedError":throw new Bu.DatabaseClosed(r);case"MissingAPIError":throw new Bu.MissingAPI(r.message,r);default:throw new Bu.OpenFailed(r)}if(!this.active)throw new Bu.TransactionInactive;return eu(null===this._completion._state),(e=this.idbtrans=e||(this.db.core?this.db.core.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}):n.transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability}))).onerror=Pc((function(n){Cl(n),t._reject(e.error)})),e.onabort=Pc((function(n){Cl(n),t.active&&t._reject(new Bu.Abort(e.error)),t.active=!1,t.on("abort").fire(n)})),e.oncomplete=Pc((function(){t.active=!1,t._resolve(),"mutatedParts"in e&&kl.storagemutated.fire(e.mutatedParts)})),this},e.prototype._promise=function(e,t,n){var r=this;if("readwrite"===e&&"readwrite"!==this.mode)return Zc(new Bu.ReadOnly("Transaction is readonly"));if(!this.active)return Zc(new Bu.TransactionInactive);if(this._locked())return new mc((function(i,o){r._blockedFuncs.push([function(){r._promise(e,t,n).then(i,o)},fc])}));if(n)return jc((function(){var e=new mc((function(e,n){r._lock();var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return e.finally((function(){return r._unlock()})),e._lib=!0,e}));var i=new mc((function(e,n){var i=t(e,n,r);i&&i.then&&i.then(e,n)}));return i._lib=!0,i},e.prototype._root=function(){return this.parent?this.parent._root():this},e.prototype.waitFor=function(e){var t=this._root(),n=mc.resolve(e);if(t._waitingFor)t._waitingFor=t._waitingFor.then((function(){return n}));else{t._waitingFor=n,t._waitingQueue=[];var r=t.idbtrans.objectStore(t.storeNames[0]);!function e(){for(++t._spinCount;t._waitingQueue.length;)t._waitingQueue.shift()();t._waitingFor&&(r.get(-1/0).onsuccess=e)}()}var i=t._waitingFor;return new mc((function(e,r){n.then((function(n){return t._waitingQueue.push(Pc(e.bind(null,n)))}),(function(e){return t._waitingQueue.push(Pc(r.bind(null,e)))})).finally((function(){t._waitingFor===i&&(t._waitingFor=null)}))}))},e.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Bu.Abort))},e.prototype.table=function(e){var t=this._memoizedTables||(this._memoizedTables={});if(zs(t,e))return t[e];var n=this.schema[e];if(!n)throw new Bu.NotFound("Table "+e+" not part of transaction");var r=new this.db.Table(e,n,this);return r.core=this.db.core.table(e),t[e]=r,r},e}();function Dl(e,t,n,r,i,o,a){return{name:e,keyPath:t,unique:n,multi:r,auto:i,compound:o,src:(n&&!a?"&":"")+(r?"*":"")+(i?"++":"")+jl(t)}}function jl(e){return"string"==typeof e?e:e?"["+[].join.call(e,"+")+"]":""}function Ll(e,t,n){return{name:e,primKey:t,indexes:n,mappedClass:null,idxByName:nu(n,(function(e){return[e.name,e]}))}}var ql=function(e){try{return e.only([[]]),ql=function(){return[[]]},[[]]}catch(e){return ql=function(){return Yc},Yc}};function Ul(e){return null==e?function(){}:"string"==typeof e?function(e){return 1===e.split(".").length?function(t){return t[e]}:function(t){return ru(t,e)}}(e):function(t){return ru(t,e)}}function Fl(e){return[].slice.call(e)}var Kl=0;function Vl(e){return null==e?":id":"string"==typeof e?e:"["+e.join("+")+"]"}function zl(e,t,n){function r(e){if(3===e.type)return null;if(4===e.type)throw new Error("Cannot convert never type to IDBKeyRange");var n=e.lower,r=e.upper,i=e.lowerOpen,o=e.upperOpen;return void 0===n?void 0===r?null:t.upperBound(r,!!o):void 0===r?t.lowerBound(n,!!i):t.bound(n,r,!!i,!!o)}var i,o,a,s=(o=n,a=Fl((i=e).objectStoreNames),{schema:{name:i.name,tables:a.map((function(e){return o.objectStore(e)})).map((function(e){var t=e.keyPath,n=e.autoIncrement,r=Us(t),i=null==t,o={},a={name:e.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:i,compound:r,keyPath:t,autoIncrement:n,unique:!0,extractKey:Ul(t)},indexes:Fl(e.indexNames).map((function(t){return e.index(t)})).map((function(e){var t=e.name,n=e.unique,r=e.multiEntry,i=e.keyPath,a={name:t,compound:Us(i),keyPath:i,unique:n,multiEntry:r,extractKey:Ul(i)};return o[Vl(i)]=a,a})),getIndexByKeyPath:function(e){return o[Vl(e)]}};return o[":id"]=a.primaryKey,null!=t&&(o[Vl(t)]=a.primaryKey),a}))},hasGetAll:a.length>0&&"getAll"in o.objectStore(a[0])&&!("undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),u=s.schema,c=s.hasGetAll,l=u.tables.map((function(e){return function(e){var t,n=e.name;return{name:n,schema:e,mutate:function(e){var t=e.trans,i=e.type,o=e.keys,a=e.values,s=e.range;return new Promise((function(e,u){e=Pc(e);var c=t.objectStore(n),l=null==c.keyPath,f="put"===i||"add"===i;if(!f&&"delete"!==i&&"deleteRange"!==i)throw new Error("Invalid operation type: "+i);var h,d=(o||a||{length:1}).length;if(o&&a&&o.length!==a.length)throw new Error("Given keys array must have same length as given values array.");if(0===d)return e({numFailures:0,failures:{},results:[],lastResult:void 0});var p=[],m=[],y=0,g=function(e){++y,Cl(e)};if("deleteRange"===i){if(4===s.type)return e({numFailures:y,failures:m,results:[],lastResult:void 0});3===s.type?p.push(h=c.clear()):p.push(h=c.delete(r(s)))}else{var b=f?l?[a,o]:[a,null]:[o,null],v=b[0],w=b[1];if(f)for(var _=0;_<d;++_)p.push(h=w&&void 0!==w[_]?c[i](v[_],w[_]):c[i](v[_])),h.onerror=g;else for(_=0;_<d;++_)p.push(h=c[i](v[_])),h.onerror=g}var E=function(t){var n=t.target.result;p.forEach((function(e,t){return null!=e.error&&(m[t]=e.error)})),e({numFailures:y,failures:m,results:"delete"===i?o:p.map((function(e){return e.result})),lastResult:n})};h.onerror=function(e){g(e),E(e)},h.onsuccess=E}))},getMany:function(e){var t=e.trans,r=e.keys;return new Promise((function(e,i){e=Pc(e);for(var o,a=t.objectStore(n),s=r.length,u=new Array(s),c=0,l=0,f=function(t){var n=t.target;u[n._pos]=n.result,++l===c&&e(u)},h=Ol(i),d=0;d<s;++d)null!=r[d]&&((o=a.get(r[d]))._pos=d,o.onsuccess=f,o.onerror=h,++c);0===c&&e(u)}))},get:function(e){var t=e.trans,r=e.key;return new Promise((function(e,i){e=Pc(e);var o=t.objectStore(n).get(r);o.onsuccess=function(t){return e(t.target.result)},o.onerror=Ol(i)}))},query:(t=c,function(e){return new Promise((function(i,o){i=Pc(i);var a=e.trans,s=e.values,u=e.limit,c=e.query,l=u===1/0?void 0:u,f=c.index,h=c.range,d=a.objectStore(n),p=f.isPrimaryKey?d:d.index(f.name),m=r(h);if(0===u)return i({result:[]});if(t){var y=s?p.getAll(m,l):p.getAllKeys(m,l);y.onsuccess=function(e){return i({result:e.target.result})},y.onerror=Ol(o)}else{var g=0,b=s||!("openKeyCursor"in p)?p.openCursor(m):p.openKeyCursor(m),v=[];b.onsuccess=function(e){var t=b.result;return t?(v.push(s?t.value:t.primaryKey),++g===u?i({result:v}):void t.continue()):i({result:v})},b.onerror=Ol(o)}}))}),openCursor:function(e){var t=e.trans,i=e.values,o=e.query,a=e.reverse,s=e.unique;return new Promise((function(e,u){e=Pc(e);var c=o.index,l=o.range,f=t.objectStore(n),h=c.isPrimaryKey?f:f.index(c.name),d=a?s?"prevunique":"prev":s?"nextunique":"next",p=i||!("openKeyCursor"in h)?h.openCursor(r(l),d):h.openKeyCursor(r(l),d);p.onerror=Ol(u),p.onsuccess=Pc((function(n){var r=p.result;if(r){r.___id=++Kl,r.done=!1;var i=r.continue.bind(r),o=r.continuePrimaryKey;o&&(o=o.bind(r));var a=r.advance.bind(r),s=function(){throw new Error("Cursor not stopped")};r.trans=t,r.stop=r.continue=r.continuePrimaryKey=r.advance=function(){throw new Error("Cursor not started")},r.fail=Pc(u),r.next=function(){var e=this,t=1;return this.start((function(){return t--?e.continue():e.stop()})).then((function(){return e}))},r.start=function(e){var t=new Promise((function(e,t){e=Pc(e),p.onerror=Ol(t),r.fail=t,r.stop=function(t){r.stop=r.continue=r.continuePrimaryKey=r.advance=s,e(t)}})),n=function(){if(p.result)try{e()}catch(e){r.fail(e)}else r.done=!0,r.start=function(){throw new Error("Cursor behind last entry")},r.stop()};return p.onsuccess=Pc((function(e){p.onsuccess=n,n()})),r.continue=i,r.continuePrimaryKey=o,r.advance=a,n(),t},e(r)}else e(null)}),u)}))},count:function(e){var t=e.query,i=e.trans,o=t.index,a=t.range;return new Promise((function(e,t){var s=i.objectStore(n),u=o.isPrimaryKey?s:s.index(o.name),c=r(a),l=c?u.count(c):u.count();l.onsuccess=Pc((function(t){return e(t.target.result)})),l.onerror=Ol(t)}))}}}(e)})),f={};return l.forEach((function(e){return f[e.name]=e})),{stack:"dbcore",transaction:e.transaction.bind(e),table:function(e){if(!f[e])throw new Error("Table '"+e+"' not found");return f[e]},MIN_KEY:-1/0,MAX_KEY:ql(t),schema:u}}function Wl(e,t,n,r){var i=n.IDBKeyRange;n.indexedDB;var o=function(e,t){return t.reduce((function(e,t){var n=t.create;return Ds(Ds({},e),n(e))}),e)}(zl(t,i,r),e.dbcore);return{dbcore:o}}function Hl(e,t){var n=e._novip,r=t.db,i=Wl(n._middlewares,r,n._deps,t);n.core=i.dbcore,n.tables.forEach((function(e){var t=e.name;n.core.schema.tables.some((function(e){return e.name===t}))&&(e.core=n.core.table(t),n[t]instanceof n.Table&&(n[t].core=e.core))}))}function Gl(e,t,n,r){var i=e._novip;n.forEach((function(e){var n=r[e];t.forEach((function(t){var r=Zs(t,e);(!r||"value"in r&&void 0===r.value)&&(t===i.Transaction.prototype||t instanceof i.Transaction?Gs(t,e,{get:function(){return this.table(e)},set:function(t){Hs(this,e,{value:t,writable:!0,configurable:!0,enumerable:!0})}}):t[e]=new i.Table(e,n))}))}))}function Ql(e,t){var n=e._novip;t.forEach((function(e){for(var t in e)e[t]instanceof n.Table&&delete e[t]}))}function Jl(e,t){return e._cfg.version-t._cfg.version}function Zl(e,t,n,r){var i=e._dbSchema,o=e._createTransaction("readwrite",e._storeNames,i);o.create(n),o._completion.catch(r);var a=o._reject.bind(o),s=fc.transless||fc;jc((function(){fc.trans=o,fc.transless=s,0===t?(qs(i).forEach((function(e){Yl(n,e,i[e].primKey,i[e].indexes)})),Hl(e,n),mc.follow((function(){return e.on.populate.fire(o)})).catch(a)):function(e,t,n,r){var i=e._novip,o=[],a=i._versions,s=i._dbSchema=ef(i,i.idbdb,r),u=!1;function c(){return o.length?mc.resolve(o.shift()(n.idbtrans)).then(c):mc.resolve()}return a.filter((function(e){return e._cfg.version>=t})).forEach((function(e){o.push((function(){var o=s,a=e._cfg.dbschema;tf(i,o,r),tf(i,a,r),s=i._dbSchema=a;var c=$l(o,a);c.add.forEach((function(e){Yl(r,e[0],e[1].primKey,e[1].indexes)})),c.change.forEach((function(e){if(e.recreate)throw new Bu.Upgrade("Not yet support for changing primary key");var t=r.objectStore(e.name);e.add.forEach((function(e){return Xl(t,e)})),e.change.forEach((function(e){t.deleteIndex(e.name),Xl(t,e)})),e.del.forEach((function(e){return t.deleteIndex(e)}))}));var l=e._cfg.contentUpgrade;if(l&&e._cfg.version>t){Hl(i,r),n._memoizedTables={},u=!0;var f=ou(a);c.del.forEach((function(e){f[e]=o[e]})),Ql(i,[i.Transaction.prototype]),Gl(i,[i.Transaction.prototype],qs(f),f),n.schema=f;var h,d=vu(l);d&&Lc();var p=mc.follow((function(){if((h=l(n))&&d){var e=qc.bind(null,null);h.then(e,e)}}));return h&&"function"==typeof h.then?mc.resolve(h):p.then((function(){return h}))}})),o.push((function(t){u&&nl||function(e,t){[].slice.call(t.db.objectStoreNames).forEach((function(n){return null==e[n]&&t.db.deleteObjectStore(n)}))}(e._cfg.dbschema,t);Ql(i,[i.Transaction.prototype]),Gl(i,[i.Transaction.prototype],i._storeNames,i._dbSchema),n.schema=i._dbSchema}))})),c().then((function(){var e,t;t=r,qs(e=s).forEach((function(n){t.db.objectStoreNames.contains(n)||Yl(t,n,e[n].primKey,e[n].indexes)}))}))}(e,t,o,n).catch(a)}))}function $l(e,t){var n,r={del:[],add:[],change:[]};for(n in e)t[n]||r.del.push(n);for(n in t){var i=e[n],o=t[n];if(i){var a={name:n,def:o,recreate:!1,del:[],add:[],change:[]};if(""+(i.primKey.keyPath||"")!=""+(o.primKey.keyPath||"")||i.primKey.auto!==o.primKey.auto&&!tl)a.recreate=!0,r.change.push(a);else{var s=i.idxByName,u=o.idxByName,c=void 0;for(c in s)u[c]||a.del.push(c);for(c in u){var l=s[c],f=u[c];l?l.src!==f.src&&a.change.push(f):a.add.push(f)}(a.del.length>0||a.add.length>0||a.change.length>0)&&r.change.push(a)}}else r.add.push([n,o])}return r}function Yl(e,t,n,r){var i=e.db.createObjectStore(t,n.keyPath?{keyPath:n.keyPath,autoIncrement:n.auto}:{autoIncrement:n.auto});return r.forEach((function(e){return Xl(i,e)})),i}function Xl(e,t){e.createIndex(t.name,t.keyPath,{unique:t.unique,multiEntry:t.multi})}function ef(e,t,n){var r={};return Ys(t.objectStoreNames,0).forEach((function(e){for(var t=n.objectStore(e),i=t.keyPath,o=Dl(jl(i),i||"",!1,!1,!!t.autoIncrement,i&&"string"!=typeof i,!0),a=[],s=0;s<t.indexNames.length;++s){var u=t.index(t.indexNames[s]);i=u.keyPath;var c=Dl(u.name,i,!!u.unique,!!u.multiEntry,!1,i&&"string"!=typeof i,!1);a.push(c)}r[e]=Ll(e,o,a)})),r}function tf(e,t,n){for(var r=e._novip,i=n.db.objectStoreNames,o=0;o<i.length;++o){var a=i[o],s=n.objectStore(a);r._hasGetAll="getAll"in s;for(var u=0;u<s.indexNames.length;++u){var c=s.indexNames[u],l=s.index(c).keyPath,f="string"==typeof l?l:"["+Ys(l).join("+")+"]";if(t[a]){var h=t[a].idxByName[f];h&&(h.name=c,delete t[a].idxByName[f],t[a].idxByName[c]=h)}}}"undefined"!=typeof navigator&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&Ls.WorkerGlobalScope&&Ls instanceof Ls.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(r._hasGetAll=!1)}var nf=function(){function e(){}return e.prototype._parseStoresSpec=function(e,t){qs(e).forEach((function(n){if(null!==e[n]){var r=e[n].split(",").map((function(e,t){var n=(e=e.trim()).replace(/([&*]|\+\+)/g,""),r=/^\[/.test(n)?n.match(/^\[(.*)\]$/)[1].split("+"):n;return Dl(n,r||null,/\&/.test(e),/\*/.test(e),/\+\+/.test(e),Us(r),0===t)})),i=r.shift();if(i.multi)throw new Bu.Schema("Primary key cannot be multi-valued");r.forEach((function(e){if(e.auto)throw new Bu.Schema("Only primary key can be marked as autoIncrement (++)");if(!e.keyPath)throw new Bu.Schema("Index must have a name and cannot be an empty string")})),t[n]=Ll(n,i,r)}}))},e.prototype.stores=function(e){var t=this.db;this._cfg.storesSource=this._cfg.storesSource?Fs(this._cfg.storesSource,e):e;var n=t._versions,r={},i={};return n.forEach((function(e){Fs(r,e._cfg.storesSource),i=e._cfg.dbschema={},e._parseStoresSpec(r,i)})),t._dbSchema=i,Ql(t,[t._allTables,t,t.Transaction.prototype]),Gl(t,[t._allTables,t,t.Transaction.prototype,this._cfg.tables],qs(i),i),t._storeNames=qs(i),this},e.prototype.upgrade=function(e){return this._cfg.contentUpgrade=Hu(this._cfg.contentUpgrade||Lu,e),this},e}();function rf(e,t){var n=e._dbNamesDB;return n||(n=e._dbNamesDB=new If("__dbnames",{addons:[],indexedDB:e,IDBKeyRange:t})).version(1).stores({dbnames:"name"}),n.table("dbnames")}function of(e){return e&&"function"==typeof e.databases}function af(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!of(n)&&"__dbnames"!==t&&rf(n,r).delete(t).catch(Lu)}function sf(e){return jc((function(){return fc.letThrough=!0,e()}))}function uf(){var e;return!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise((function(t){var n=function(){return indexedDB.databases().finally(t)};e=setInterval(n,100),n()})).finally((function(){return clearInterval(e)})):Promise.resolve()}function cf(e){var t=e._state,n=e._deps.indexedDB;if(t.isBeingOpened||e.idbdb)return t.dbReadyPromise.then((function(){return t.dbOpenError?Zc(t.dbOpenError):e}));wu&&(t.openCanceller._stackHolder=xu()),t.isBeingOpened=!0,t.dbOpenError=null,t.openComplete=!1;var r=t.openCanceller;function i(){if(t.openCanceller!==r)throw new Bu.DatabaseClosed("db.open() was cancelled")}var o=t.dbReadyResolve,a=null,s=!1;return mc.race([r,("undefined"==typeof navigator?mc.resolve():uf()).then((function(){return new mc((function(r,o){if(i(),!n)throw new Bu.MissingAPI;var u=e.name,c=t.autoSchema?n.open(u):n.open(u,Math.round(10*e.verno));if(!c)throw new Bu.MissingAPI;c.onerror=Ol(o),c.onblocked=Pc(e._fireOnBlocked),c.onupgradeneeded=Pc((function(r){if(a=c.transaction,t.autoSchema&&!e._options.allowEmptyDB){c.onerror=Cl,a.abort(),c.result.close();var i=n.deleteDatabase(u);i.onsuccess=i.onerror=Pc((function(){o(new Bu.NoSuchDatabase("Database "+u+" doesnt exist"))}))}else{a.onerror=Ol(o);var l=r.oldVersion>Math.pow(2,62)?0:r.oldVersion;s=l<1,e._novip.idbdb=c.result,Zl(e,l/10,a,o)}}),o),c.onsuccess=Pc((function(){a=null;var n,i=e._novip.idbdb=c.result,o=Ys(i.objectStoreNames);if(o.length>0)try{var l=i.transaction(1===(n=o).length?n[0]:n,"readonly");t.autoSchema?function(e,t,n){var r=e._novip;r.verno=t.version/10;var i=r._dbSchema=ef(0,t,n);r._storeNames=Ys(t.objectStoreNames,0),Gl(r,[r._allTables],qs(i),i)}(e,i,l):(tf(e,e._dbSchema,l),function(e,t){var n=$l(ef(0,e.idbdb,t),e._dbSchema);return!(n.add.length||n.change.some((function(e){return e.add.length||e.change.length})))}(e,l)||console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Some queries may fail.")),Hl(e,l)}catch(e){}el.push(e),i.onversionchange=Pc((function(n){t.vcFired=!0,e.on("versionchange").fire(n)})),i.onclose=Pc((function(t){e.on("close").fire(t)})),s&&function(e,t){var n=e.indexedDB,r=e.IDBKeyRange;!of(n)&&"__dbnames"!==t&&rf(n,r).put({name:t}).catch(Lu)}(e._deps,u),r()}),o)}))}))]).then((function(){return i(),t.onReadyBeingFired=[],mc.resolve(sf((function(){return e.on.ready.fire(e.vip)}))).then((function n(){if(t.onReadyBeingFired.length>0){var r=t.onReadyBeingFired.reduce(Hu,Lu);return t.onReadyBeingFired=[],mc.resolve(sf((function(){return r(e.vip)}))).then(n)}}))})).finally((function(){t.onReadyBeingFired=null,t.isBeingOpened=!1})).then((function(){return e})).catch((function(n){t.dbOpenError=n;try{a&&a.abort()}catch(e){}return r===t.openCanceller&&e._close(),Zc(n)})).finally((function(){t.openComplete=!0,o()}))}function lf(e){var t=function(t){return e.next(t)},n=i(t),r=i((function(t){return e.throw(t)}));function i(e){return function(t){var i=e(t),o=i.value;return i.done?o:o&&"function"==typeof o.then?o.then(n,r):Us(o)?Promise.all(o).then(n,r):n(o)}}return i(t)()}function ff(e,t,n){var r=arguments.length;if(r<2)throw new Bu.InvalidArgument("Too few arguments");for(var i=new Array(r-1);--r;)i[r-1]=arguments[r];n=i.pop();var o=su(i);return[e,o,n]}function hf(e,t,n,r,i){return mc.resolve().then((function(){var o=fc.transless||fc,a=e._createTransaction(t,n,e._dbSchema,r),s={trans:a,transless:o};if(r)a.idbtrans=r.idbtrans;else try{a.create(),e._state.PR1398_maxLoop=3}catch(r){return r.name===Cu.InvalidState&&e.isOpen()&&--e._state.PR1398_maxLoop>0?(console.warn("Dexie: Need to reopen db"),e._close(),e.open().then((function(){return hf(e,t,n,null,i)}))):Zc(r)}var u,c=vu(i);c&&Lc();var l=mc.follow((function(){if(u=i.call(a,a))if(c){var e=qc.bind(null,null);u.then(e,e)}else"function"==typeof u.next&&"function"==typeof u.throw&&(u=lf(u))}),s);return(u&&"function"==typeof u.then?mc.resolve(u).then((function(e){return a.active?e:Zc(new Bu.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))})):l.then((function(){return u}))).then((function(e){return r&&a._resolve(),a._completion.then((function(){return e}))})).catch((function(e){return a._reject(e),Zc(e)}))}))}function df(e,t,n){for(var r=Us(e)?e.slice():[e],i=0;i<n;++i)r.push(t);return r}var pf={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(e){return Ds(Ds({},e),{table:function(t){var n=e.table(t),r=n.schema,i={},o=[];function a(e,t,n){var r=Vl(e),s=i[r]=i[r]||[],u=null==e?0:"string"==typeof e?1:e.length,c=t>0,l=Ds(Ds({},n),{isVirtual:c,keyTail:t,keyLength:u,extractKey:Ul(e),unique:!c&&n.unique});(s.push(l),l.isPrimaryKey||o.push(l),u>1)&&a(2===u?e[0]:e.slice(0,u-1),t+1,n);return s.sort((function(e,t){return e.keyTail-t.keyTail})),l}var s=a(r.primaryKey.keyPath,0,r.primaryKey);i[":id"]=[s];for(var u=0,c=r.indexes;u<c.length;u++){var l=c[u];a(l.keyPath,0,l)}function f(t){var n,r,i=t.query.index;return i.isVirtual?Ds(Ds({},t),{query:{index:i,range:(n=t.query.range,r=i.keyTail,{type:1===n.type?2:n.type,lower:df(n.lower,n.lowerOpen?e.MAX_KEY:e.MIN_KEY,r),lowerOpen:!0,upper:df(n.upper,n.upperOpen?e.MIN_KEY:e.MAX_KEY,r),upperOpen:!0})}}):t}return Ds(Ds({},n),{schema:Ds(Ds({},r),{primaryKey:s,indexes:o,getIndexByKeyPath:function(e){var t=i[Vl(e)];return t&&t[0]}}),count:function(e){return n.count(f(e))},query:function(e){return n.query(f(e))},openCursor:function(t){var r=t.query.index,i=r.keyTail,o=r.isVirtual,a=r.keyLength;if(!o)return n.openCursor(t);return n.openCursor(f(t)).then((function(n){return n&&function(n){return Object.create(n,{continue:{value:function(r){null!=r?n.continue(df(r,t.reverse?e.MAX_KEY:e.MIN_KEY,i)):t.unique?n.continue(n.key.slice(0,a).concat(t.reverse?e.MIN_KEY:e.MAX_KEY,i)):n.continue()}},continuePrimaryKey:{value:function(t,r){n.continuePrimaryKey(df(t,e.MAX_KEY,i),r)}},primaryKey:{get:function(){return n.primaryKey}},key:{get:function(){var e=n.key;return 1===a?e[0]:e.slice(0,a)}},value:{get:function(){return n.value}}})}(n)}))}})}})}};function mf(e,t,n,r){return n=n||{},r=r||"",qs(e).forEach((function(i){if(zs(t,i)){var o=e[i],a=t[i];if("object"==typeof o&&"object"==typeof a&&o&&a){var s=pu(o);s!==pu(a)?n[r+i]=t[i]:"Object"===s?mf(o,a,n,r+i+"."):o!==a&&(n[r+i]=t[i])}else o!==a&&(n[r+i]=t[i])}else n[r+i]=void 0})),qs(t).forEach((function(i){zs(e,i)||(n[r+i]=t[i])})),n}var yf={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(e){return Ds(Ds({},e),{table:function(t){var n=e.table(t),r=n.schema.primaryKey;return Ds(Ds({},n),{mutate:function(e){var i=fc.trans,o=i.table(t).hook,a=o.deleting,s=o.creating,u=o.updating;switch(e.type){case"add":if(s.fire===Lu)break;return i._promise("readwrite",(function(){return c(e)}),!0);case"put":if(s.fire===Lu&&u.fire===Lu)break;return i._promise("readwrite",(function(){return c(e)}),!0);case"delete":if(a.fire===Lu)break;return i._promise("readwrite",(function(){return c(e)}),!0);case"deleteRange":if(a.fire===Lu)break;return i._promise("readwrite",(function(){return l((t=e).trans,t.range,1e4);var t}),!0)}function c(e){var t=fc.trans,i=e.keys||function(e,t){return"delete"===t.type?t.keys:t.keys||t.values.map(e.extractKey)}(r,e);if(!i)throw new Error("Keys missing");return"delete"!==(e="add"===e.type||"put"===e.type?Ds(Ds({},e),{keys:i}):Ds({},e)).type&&(e.values=js([],e.values,!0)),e.keys&&(e.keys=js([],e.keys,!0)),function(e,t,n){return"add"===t.type?Promise.resolve([]):e.getMany({trans:t.trans,keys:n,cache:"immutable"})}(n,e,i).then((function(o){var c=i.map((function(n,i){var c=o[i],l={onerror:null,onsuccess:null};if("delete"===e.type)a.fire.call(l,n,c,t);else if("add"===e.type||void 0===c){var f=s.fire.call(l,n,e.values[i],t);null==n&&null!=f&&(n=f,e.keys[i]=n,r.outbound||iu(e.values[i],r.keyPath,n))}else{var h=mf(c,e.values[i]),d=u.fire.call(l,h,n,c,t);if(d){var p=e.values[i];Object.keys(d).forEach((function(e){zs(p,e)?p[e]=d[e]:iu(p,e,d[e])}))}}return l}));return n.mutate(e).then((function(t){for(var n=t.failures,r=t.results,a=t.numFailures,s=t.lastResult,u=0;u<i.length;++u){var l=r?r[u]:i[u],f=c[u];null==l?f.onerror&&f.onerror(n[u]):f.onsuccess&&f.onsuccess("put"===e.type&&o[u]?e.values[u]:l)}return{failures:n,results:r,numFailures:a,lastResult:s}})).catch((function(e){return c.forEach((function(t){return t.onerror&&t.onerror(e)})),Promise.reject(e)}))}))}function l(e,t,i){return n.query({trans:e,values:!1,query:{index:r,range:t},limit:i}).then((function(n){var r=n.result;return c({type:"delete",keys:r,trans:e}).then((function(n){return n.numFailures>0?Promise.reject(n.failures[0]):r.length<i?{failures:[],numFailures:0,lastResult:void 0}:l(e,Ds(Ds({},t),{lower:r[r.length-1],lowerOpen:!0}),i)}))}))}return n.mutate(e)}})}})}};function gf(e,t,n){try{if(!t)return null;if(t.keys.length<e.length)return null;for(var r=[],i=0,o=0;i<t.keys.length&&o<e.length;++i)0===bl(t.keys[i],e[o])&&(r.push(n?fu(t.values[i]):t.values[i]),++o);return r.length===e.length?r:null}catch(e){return null}}var bf,vf={stack:"dbcore",level:-1,create:function(e){return{table:function(t){var n=e.table(t);return Ds(Ds({},n),{getMany:function(e){if(!e.cache)return n.getMany(e);var t=gf(e.keys,e.trans._cache,"clone"===e.cache);return t?mc.resolve(t):n.getMany(e).then((function(t){return e.trans._cache={keys:e.keys,values:"clone"===e.cache?fu(t):t},t}))},mutate:function(e){return"add"!==e.type&&(e.trans._cache=null),n.mutate(e)}})}}}};function wf(e){return!("from"in e)}var _f=function(e,t){if(!this){var n=new _f;return e&&"d"in e&&Fs(n,e),n}Fs(this,arguments.length?{d:1,from:e,to:arguments.length>1?t:e}:{d:0})};function Ef(e,t,n){var r=bl(t,n);if(!isNaN(r)){if(r>0)throw RangeError();if(wf(e))return Fs(e,{from:t,to:n,d:1});var i=e.l,o=e.r;if(bl(n,e.from)<0)return i?Ef(i,t,n):e.l={from:t,to:n,d:1,l:null,r:null},Tf(e);if(bl(t,e.to)>0)return o?Ef(o,t,n):e.r={from:t,to:n,d:1,l:null,r:null},Tf(e);bl(t,e.from)<0&&(e.from=t,e.l=null,e.d=o?o.d+1:1),bl(n,e.to)>0&&(e.to=n,e.r=null,e.d=e.l?e.l.d+1:1);var a=!e.r;i&&!e.l&&Sf(e,i),o&&a&&Sf(e,o)}}function Sf(e,t){wf(t)||function e(t,n){var r=n.from,i=n.to,o=n.l,a=n.r;Ef(t,r,i),o&&e(t,o),a&&e(t,a)}(e,t)}function xf(e){var t=wf(e)?null:{s:0,n:e};return{next:function(e){for(var n=arguments.length>0;t;)switch(t.s){case 0:if(t.s=1,n)for(;t.n.l&&bl(e,t.n.from)<0;)t={up:t,n:t.n.l,s:1};else for(;t.n.l;)t={up:t,n:t.n.l,s:1};case 1:if(t.s=2,!n||bl(e,t.n.to)<=0)return{value:t.n,done:!1};case 2:if(t.n.r){t.s=3,t={up:t,n:t.n.r,s:0};continue}case 3:t=t.up}return{done:!0}}}}function Tf(e){var t,n,r=((null===(t=e.r)||void 0===t?void 0:t.d)||0)-((null===(n=e.l)||void 0===n?void 0:n.d)||0),i=r>1?"r":r<-1?"l":"";if(i){var o="r"===i?"l":"r",a=Ds({},e),s=e[i];e.from=s.from,e.to=s.to,e[i]=s[i],a[i]=s[o],e[o]=a,a.d=Mf(a)}e.d=Mf(e)}function Mf(e){var t=e.r,n=e.l;return(t?n?Math.max(t.d,n.d):t.d:n?n.d:0)+1}Ws(_f.prototype,((bf={add:function(e){return Sf(this,e),this},addKey:function(e){return Ef(this,e,e),this},addKeys:function(e){var t=this;return e.forEach((function(e){return Ef(t,e,e)})),this}})[mu]=function(){return xf(this)},bf));var Af={stack:"dbcore",level:0,create:function(e){var t=e.schema.name,n=new _f(e.MIN_KEY,e.MAX_KEY);return Ds(Ds({},e),{table:function(r){var i=e.table(r),o=i.schema,a=o.primaryKey,s=a.extractKey,u=a.outbound,c=Ds(Ds({},i),{mutate:function(e){var a=e.trans,s=a.mutatedParts||(a.mutatedParts={}),u=function(e){var n="idb://"+t+"/"+r+"/"+e;return s[n]||(s[n]=new _f)},c=u(""),l=u(":dels"),f=e.type,h="deleteRange"===e.type?[e.range]:"delete"===e.type?[e.keys]:e.values.length<50?[[],e.values]:[],d=h[0],p=h[1],m=e.trans._cache;return i.mutate(e).then((function(e){if(Us(d)){"delete"!==f&&(d=e.results),c.addKeys(d);var t=gf(d,m);t||"add"===f||l.addKeys(d),(t||p)&&function(e,t,n,r){function i(t){var i=e(t.name||"");function o(e){return null!=e?t.extractKey(e):null}var a=function(e){return t.multiEntry&&Us(e)?e.forEach((function(e){return i.addKey(e)})):i.addKey(e)};(n||r).forEach((function(e,t){var i=n&&o(n[t]),s=r&&o(r[t]);0!==bl(i,s)&&(null!=i&&a(i),null!=s&&a(s))}))}t.indexes.forEach(i)}(u,o,t,p)}else if(d){var r={from:d.lower,to:d.upper};l.add(r),c.add(r)}else c.add(n),l.add(n),o.indexes.forEach((function(e){return u(e.name).add(n)}));return e}))}}),l=function(t){var n,r,i=t.query,o=i.index,a=i.range;return[o,new _f(null!==(n=a.lower)&&void 0!==n?n:e.MIN_KEY,null!==(r=a.upper)&&void 0!==r?r:e.MAX_KEY)]},f={get:function(e){return[a,new _f(e.key)]},getMany:function(e){return[a,(new _f).addKeys(e.keys)]},count:l,query:l,openCursor:l};return qs(f).forEach((function(e){c[e]=function(o){var a=fc.subscr;if(a){var c=function(e){var n="idb://"+t+"/"+r+"/"+e;return a[n]||(a[n]=new _f)},l=c(""),h=c(":dels"),d=f[e](o),p=d[0],m=d[1];if(c(p.name||"").add(m),!p.isPrimaryKey){if("count"!==e){var y="query"===e&&u&&o.values&&i.query(Ds(Ds({},o),{values:!1}));return i[e].apply(this,arguments).then((function(t){if("query"===e){if(u&&o.values)return y.then((function(e){var n=e.result;return l.addKeys(n),t}));var n=o.values?t.result.map(s):t.result;o.values?l.addKeys(n):h.addKeys(n)}else if("openCursor"===e){var r=t,i=o.values;return r&&Object.create(r,{key:{get:function(){return h.addKey(r.primaryKey),r.key}},primaryKey:{get:function(){var e=r.primaryKey;return h.addKey(e),e}},value:{get:function(){return i&&l.addKey(r.primaryKey),r.value}}})}return t}))}h.add(n)}}return i[e].apply(this,arguments)}})),c}})}};var Rf,If=function(){function e(t,n){var r=this;this._middlewares={},this.verno=0;var i=e.dependencies;this._options=n=Ds({addons:e.addons,autoOpen:!0,indexedDB:i.indexedDB,IDBKeyRange:i.IDBKeyRange},n),this._deps={indexedDB:n.indexedDB,IDBKeyRange:n.IDBKeyRange};var o=n.addons;this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var a,s={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Lu,dbReadyPromise:null,cancelOpen:Lu,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3};s.dbReadyPromise=new mc((function(e){s.dbReadyResolve=e})),s.openCanceller=new mc((function(e,t){s.cancelOpen=t})),this._state=s,this.name=t,this.on=cl(this,"populate","blocked","versionchange","close",{ready:[Hu,Lu]}),this.on.ready.subscribe=Xs(this.on.ready.subscribe,(function(t){return function(n,i){e.vip((function(){var e=r._state;if(e.openComplete)e.dbOpenError||mc.resolve().then(n),i&&t(n);else if(e.onReadyBeingFired)e.onReadyBeingFired.push(n),i&&t(n);else{t(n);var o=r;i||t((function e(){o.on.ready.unsubscribe(n),o.on.ready.unsubscribe(e)}))}}))}})),this.Collection=(a=this,ll(_l.prototype,(function(e,t){this.db=a;var n=al,r=null;if(t)try{n=t()}catch(e){r=e}var i=e._ctx,o=i.table,s=o.hook.reading.fire;this._ctx={table:o,index:i.index,isPrimKey:!i.index||o.schema.primKey.keyPath&&i.index===o.schema.primKey.name,range:n,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:r,or:i.or,valueMapper:s!==qu?s:null}}))),this.Table=function(e){return ll(ul.prototype,(function(t,n,r){this.db=e,this._tx=r,this.name=t,this.schema=n,this.hook=e._allTables[t]?e._allTables[t].hook:cl(null,{creating:[Ku,Lu],reading:[Uu,qu],updating:[zu,Lu],deleting:[Vu,Lu]})}))}(this),this.Transaction=function(e){return ll(Bl.prototype,(function(t,n,r,i,o){var a=this;this.db=e,this.mode=t,this.storeNames=n,this.schema=r,this.chromeTransactionDurability=i,this.idbtrans=null,this.on=cl(this,"complete","error","abort"),this.parent=o||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new mc((function(e,t){a._resolve=e,a._reject=t})),this._completion.then((function(){a.active=!1,a.on.complete.fire()}),(function(e){var t=a.active;return a.active=!1,a.on.error.fire(e),a.parent?a.parent._reject(e):t&&a.idbtrans&&a.idbtrans.abort(),Zc(e)}))}))}(this),this.Version=function(e){return ll(nf.prototype,(function(t){this.db=e,this._cfg={version:t,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}}))}(this),this.WhereClause=function(e){return ll(Nl.prototype,(function(t,n,r){this.db=e,this._ctx={table:t,index:":id"===n?null:n,or:r};var i=e._deps.indexedDB;if(!i)throw new Bu.MissingAPI;this._cmp=this._ascending=i.cmp.bind(i),this._descending=function(e,t){return i.cmp(t,e)},this._max=function(e,t){return i.cmp(e,t)>0?e:t},this._min=function(e,t){return i.cmp(e,t)<0?e:t},this._IDBKeyRange=e._deps.IDBKeyRange}))}(this),this.on("versionchange",(function(e){e.newVersion>0?console.warn("Another connection wants to upgrade database '"+r.name+"'. Closing db now to resume the upgrade."):console.warn("Another connection wants to delete database '"+r.name+"'. Closing db now to resume the delete request."),r.close()})),this.on("blocked",(function(e){!e.newVersion||e.newVersion<e.oldVersion?console.warn("Dexie.delete('"+r.name+"') was blocked"):console.warn("Upgrade '"+r.name+"' blocked by other connection holding version "+e.oldVersion/10)})),this._maxKey=ql(n.IDBKeyRange),this._createTransaction=function(e,t,n,i){return new r.Transaction(e,t,n,r._options.chromeTransactionDurability,i)},this._fireOnBlocked=function(e){r.on("blocked").fire(e),el.filter((function(e){return e.name===r.name&&e!==r&&!e._state.vcFired})).map((function(t){return t.on("versionchange").fire(e)}))},this.use(pf),this.use(yf),this.use(Af),this.use(vf),this.vip=Object.create(this,{_vip:{value:!0}}),o.forEach((function(e){return e(r)}))}return e.prototype.version=function(e){if(isNaN(e)||e<.1)throw new Bu.Type("Given version is not a positive number");if(e=Math.round(10*e)/10,this.idbdb||this._state.isBeingOpened)throw new Bu.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,e);var t=this._versions,n=t.filter((function(t){return t._cfg.version===e}))[0];return n||(n=new this.Version(e),t.push(n),t.sort(Jl),n.stores({}),this._state.autoSchema=!1,n)},e.prototype._whenReady=function(e){var t=this;return this.idbdb&&(this._state.openComplete||fc.letThrough||this._vip)?e():new mc((function(e,n){if(t._state.openComplete)return n(new Bu.DatabaseClosed(t._state.dbOpenError));if(!t._state.isBeingOpened){if(!t._options.autoOpen)return void n(new Bu.DatabaseClosed);t.open().catch(Lu)}t._state.dbReadyPromise.then(e,n)})).then(e)},e.prototype.use=function(e){var t=e.stack,n=e.create,r=e.level,i=e.name;i&&this.unuse({stack:t,name:i});var o=this._middlewares[t]||(this._middlewares[t]=[]);return o.push({stack:t,create:n,level:null==r?10:r,name:i}),o.sort((function(e,t){return e.level-t.level})),this},e.prototype.unuse=function(e){var t=e.stack,n=e.name,r=e.create;return t&&this._middlewares[t]&&(this._middlewares[t]=this._middlewares[t].filter((function(e){return r?e.create!==r:!!n&&e.name!==n}))),this},e.prototype.open=function(){return cf(this)},e.prototype._close=function(){var e=this._state,t=el.indexOf(this);if(t>=0&&el.splice(t,1),this.idbdb){try{this.idbdb.close()}catch(e){}this._novip.idbdb=null}e.dbReadyPromise=new mc((function(t){e.dbReadyResolve=t})),e.openCanceller=new mc((function(t,n){e.cancelOpen=n}))},e.prototype.close=function(){this._close();var e=this._state;this._options.autoOpen=!1,e.dbOpenError=new Bu.DatabaseClosed,e.isBeingOpened&&e.cancelOpen(e.dbOpenError)},e.prototype.delete=function(){var e=this,t=arguments.length>0,n=this._state;return new mc((function(r,i){var o=function(){e.close();var t=e._deps.indexedDB.deleteDatabase(e.name);t.onsuccess=Pc((function(){af(e._deps,e.name),r()})),t.onerror=Ol(i),t.onblocked=e._fireOnBlocked};if(t)throw new Bu.InvalidArgument("Arguments not allowed in db.delete()");n.isBeingOpened?n.dbReadyPromise.then(o):o()}))},e.prototype.backendDB=function(){return this.idbdb},e.prototype.isOpen=function(){return null!==this.idbdb},e.prototype.hasBeenClosed=function(){var e=this._state.dbOpenError;return e&&"DatabaseClosed"===e.name},e.prototype.hasFailed=function(){return null!==this._state.dbOpenError},e.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(e.prototype,"tables",{get:function(){var e=this;return qs(this._allTables).map((function(t){return e._allTables[t]}))},enumerable:!1,configurable:!0}),e.prototype.transaction=function(){var e=ff.apply(this,arguments);return this._transaction.apply(this,e)},e.prototype._transaction=function(e,t,n){var r=this,i=fc.trans;i&&i.db===this&&-1===e.indexOf("!")||(i=null);var o,a,s=-1!==e.indexOf("?");e=e.replace("!","").replace("?","");try{if(a=t.map((function(e){var t=e instanceof r.Table?e.name:e;if("string"!=typeof t)throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return t})),"r"==e||"readonly"===e)o="readonly";else{if("rw"!=e&&"readwrite"!=e)throw new Bu.InvalidArgument("Invalid transaction mode: "+e);o="readwrite"}if(i){if("readonly"===i.mode&&"readwrite"===o){if(!s)throw new Bu.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");i=null}i&&a.forEach((function(e){if(i&&-1===i.storeNames.indexOf(e)){if(!s)throw new Bu.SubTransaction("Table "+e+" not included in parent transaction.");i=null}})),s&&i&&!i.active&&(i=null)}}catch(e){return i?i._promise(null,(function(t,n){n(e)})):Zc(e)}var u=hf.bind(null,this,o,a,i,n);return i?i._promise(o,u,"lock"):fc.trans?Wc(fc.transless,(function(){return r._whenReady(u)})):this._whenReady(u)},e.prototype.table=function(e){if(!zs(this._allTables,e))throw new Bu.InvalidTable("Table "+e+" does not exist");return this._allTables[e]},e}(),Pf="undefined"!=typeof Symbol&&"observable"in Symbol?Symbol.observable:"@@observable",Nf=function(){function e(e){this._subscribe=e}return e.prototype.subscribe=function(e,t,n){return this._subscribe(e&&"function"!=typeof e?e:{next:e,error:t,complete:n})},e.prototype[Pf]=function(){return this},e}();function Of(e,t){return qs(t).forEach((function(n){Sf(e[n]||(e[n]=new _f),t[n])})),e}try{Rf={indexedDB:Ls.indexedDB||Ls.mozIndexedDB||Ls.webkitIndexedDB||Ls.msIndexedDB,IDBKeyRange:Ls.IDBKeyRange||Ls.webkitIDBKeyRange}}catch(e){Rf={indexedDB:null,IDBKeyRange:null}}var Cf=If;function kf(e){var t=Bf;try{Bf=!0,kl.storagemutated.fire(e)}finally{Bf=t}}Ws(Cf,Ds(Ds({},ju),{delete:function(e){return new Cf(e,{addons:[]}).delete()},exists:function(e){return new Cf(e,{addons:[]}).open().then((function(e){return e.close(),!0})).catch("NoSuchDatabaseError",(function(){return!1}))},getDatabaseNames:function(e){try{return function(e){var t=e.indexedDB,n=e.IDBKeyRange;return of(t)?Promise.resolve(t.databases()).then((function(e){return e.map((function(e){return e.name})).filter((function(e){return"__dbnames"!==e}))})):rf(t,n).toCollection().primaryKeys()}(Cf.dependencies).then(e)}catch(e){return Zc(new Bu.MissingAPI)}},defineClass:function(){return function(e){Fs(this,e)}},ignoreTransaction:function(e){return fc.trans?Wc(fc.transless,e):e()},vip:sf,async:function(e){return function(){try{var t=lf(e.apply(this,arguments));return t&&"function"==typeof t.then?t:mc.resolve(t)}catch(e){return Zc(e)}}},spawn:function(e,t,n){try{var r=lf(e.apply(n,t||[]));return r&&"function"==typeof r.then?r:mc.resolve(r)}catch(e){return Zc(e)}},currentTransaction:{get:function(){return fc.trans||null}},waitFor:function(e,t){var n=mc.resolve("function"==typeof e?Cf.ignoreTransaction(e):e).timeout(t||6e4);return fc.trans?fc.trans.waitFor(n):n},Promise:mc,debug:{get:function(){return wu},set:function(e){_u(e,"dexie"===e?function(){return!0}:il)}},derive:Qs,extend:Fs,props:Ws,override:Xs,Events:cl,on:kl,liveQuery:function(e){return new Nf((function(t){var n=vu(e);var r=!1,i={},o={},a={get closed(){return r},unsubscribe:function(){r=!0,kl.storagemutated.unsubscribe(l)}};t.start&&t.start(a);var s=!1,u=!1;function c(){return qs(o).some((function(e){return i[e]&&function(e,t){var n=xf(t),r=n.next();if(r.done)return!1;for(var i=r.value,o=xf(e),a=o.next(i.from),s=a.value;!r.done&&!a.done;){if(bl(s.from,i.to)<=0&&bl(s.to,i.from)>=0)return!0;bl(i.from,s.from)<0?i=(r=n.next(s.from)).value:s=(a=o.next(i.from)).value}return!1}(i[e],o[e])}))}var l=function(e){Of(i,e),c()&&f()},f=function(){if(!s&&!r){i={};var h={},d=function(t){n&&Lc();var r=function(){return jc(e,{subscr:t,trans:null})},i=fc.trans?Wc(fc.transless,r):r();return n&&i.then(qc,qc),i}(h);u||(kl("storagemutated",l),u=!0),s=!0,Promise.resolve(d).then((function(e){s=!1,r||(c()?f():(i={},o=h,t.next&&t.next(e)))}),(function(e){s=!1,t.error&&t.error(e),a.unsubscribe()}))}};return f(),a}))},extendObservabilitySet:Of,getByKeyPath:ru,setByKeyPath:iu,delByKeyPath:function(e,t){"string"==typeof t?iu(e,t,void 0):"length"in t&&[].map.call(t,(function(t){iu(e,t,void 0)}))},shallowClone:ou,deepClone:fu,getObjectDiff:mf,cmp:bl,asap:tu,minKey:-(1/0),addons:[],connections:el,errnames:Cu,dependencies:Rf,semVer:"3.2.1",version:"3.2.1".split(".").map((function(e){return parseInt(e)})).reduce((function(e,t,n){return e+t/Math.pow(10,2*n)}))})),Cf.maxKey=ql(Cf.dependencies.IDBKeyRange),"undefined"!=typeof dispatchEvent&&"undefined"!=typeof addEventListener&&(kl("storagemutated",(function(e){var t;Bf||(tl?(t=document.createEvent("CustomEvent")).initCustomEvent("x-storagemutated-1",!0,!0,e):t=new CustomEvent("x-storagemutated-1",{detail:e}),Bf=!0,dispatchEvent(t),Bf=!1)})),addEventListener("x-storagemutated-1",(function(e){var t=e.detail;Bf||kf(t)})));var Bf=!1;if("undefined"!=typeof BroadcastChannel){var Df=new BroadcastChannel("x-storagemutated-1");kl("storagemutated",(function(e){Bf||Df.postMessage(e)})),Df.onmessage=function(e){e.data&&kf(e.data)}}else if("undefined"!=typeof self&&"undefined"!=typeof navigator){kl("storagemutated",(function(e){try{Bf||("undefined"!=typeof localStorage&&localStorage.setItem("x-storagemutated-1",JSON.stringify({trig:Math.random(),changedParts:e})),"object"==typeof self.clients&&js([],self.clients.matchAll({includeUncontrolled:!0}),!0).forEach((function(t){return t.postMessage({type:"x-storagemutated-1",changedParts:e})})))}catch(e){}})),addEventListener("storage",(function(e){if("x-storagemutated-1"===e.key){var t=JSON.parse(e.newValue);t&&kf(t.changedParts)}}));var jf=self.document&&navigator.serviceWorker;jf&&jf.addEventListener("message",(function(e){var t=e.data;t&&"x-storagemutated-1"===t.type&&kf(t.changedParts)}))}mc.rejectionMapper=function(e,t){if(!e||e instanceof Iu||e instanceof TypeError||e instanceof SyntaxError||!e.name||!Du[e.name])return e;var n=new Du[e.name](t||e.message,e);return"stack"in e&&Gs(n,"stack",{get:function(){return this.inner.stack}}),n},_u(wu,il);var Lf=T;const qf=(e,t)=>`${e}__${t}`;class Uf{constructor(e,t,n,r,i,o,a,s,u,c,l,f,h,d){this.owner=e,this.assetId=t,this.value=n,this.accountRequired=r,this.noteSecret=i,this.creatorPubKey=o,this.inputNullifier=a,this.commitment=s,this.nullifier=u,this.allowChain=c,this.index=l,this.nullified=f,this.pending=h,this.hashPath=d}}const Ff=({owner:e,assetId:t,value:n,accountRequired:r,noteSecret:i,creatorPubKey:o,inputNullifier:a,commitment:s,nullifier:u,allowChain:c,nullified:l,index:f,pending:h,hashPath:d})=>new gr(new $n.TreeNote(new Wn.GrumpkinAddress(Lf.from(e)),BigInt(n),t,r,Lf.from(i),Lf.from(o),Lf.from(a)),Lf.from(s),Lf.from(u),c,!!l,h?void 0:f,d?Lf.from(d):void 0);class Kf{constructor(e,t,n){this.id=e,this.accountPrivateKey=t,this.syncedToRollup=n}}const Vf=({id:e,accountPrivateKey:t,syncedToRollup:n})=>new Kf(new Uint8Array(e.toBuffer()),new Uint8Array(t),n),zf=({id:e,accountPrivateKey:t,syncedToRollup:n})=>{const r=new Wn.GrumpkinAddress(Lf.from(e));return{id:r,accountPublicKey:r,accountPrivateKey:Lf.from(t),syncedToRollup:n}};class Wf{constructor(e,t,n,r,i,o,a,s,u,c,l,f,h,d,p){this.txId=e,this.userId=t,this.proofId=n,this.assetId=r,this.publicValue=i,this.privateInput=o,this.recipientPrivateOutput=a,this.senderPrivateOutput=s,this.isRecipient=u,this.isSender=c,this.accountRequired=l,this.txRefNo=f,this.created=h,this.settled=d,this.publicOwner=p}}const Hf=({txId:e,userId:t,proofId:n,assetId:r,publicValue:i,publicOwner:o,privateInput:a,recipientPrivateOutput:s,senderPrivateOutput:u,isRecipient:c,isSender:l,accountRequired:f,txRefNo:h,created:d,settled:p})=>new lr(new g.TxId(Lf.from(e)),new Wn.GrumpkinAddress(Lf.from(t)),n,r,BigInt(i),o?new Wn.EthAddress(Lf.from(o)):void 0,BigInt(a),BigInt(s),BigInt(u),c,l,f,h,d,p?new Date(p):void 0);class Gf{constructor(e,t,n,r,i,o,a,s,u,c){this.txId=e,this.userId=t,this.proofId=n,this.aliasHash=r,this.migrated=i,this.txRefNo=o,this.created=a,this.settled=s,this.newSpendingPublicKey1=u,this.newSpendingPublicKey2=c}}const Qf=({txId:e,userId:t,aliasHash:n,newSpendingPublicKey1:r,newSpendingPublicKey2:i,migrated:o,txRefNo:a,created:s,settled:u})=>new ar(new g.TxId(Lf.from(e)),new Wn.GrumpkinAddress(Lf.from(t)),new f.AliasHash(Lf.from(n)),r?Lf.from(r):void 0,i?Lf.from(i):void 0,o,a,s,u?new Date(u):void 0);class Jf{constructor(e,t,n,r,i,o,a,s,u,c,l,f,h,d,p,m,y,g){this.txId=e,this.userId=t,this.proofId=n,this.bridgeId=r,this.depositValue=i,this.txFee=o,this.partialStateSecret=a,this.txRefNo=s,this.created=u,this.settled=c,this.interactionNonce=l,this.isAsync=f,this.success=h,this.outputValueA=d,this.outputValueB=p,this.finalised=m,this.claimSettled=y,this.claimTxId=g}}const Zf=({txId:e,userId:t,bridgeId:n,depositValue:r,txFee:i,partialStateSecret:o,txRefNo:a,created:s,settled:u,interactionNonce:c,isAsync:l,success:f,outputValueA:h,outputValueB:d,finalised:p,claimSettled:m,claimTxId:y})=>new cr(new g.TxId(Lf.from(e)),new Wn.GrumpkinAddress(Lf.from(t)),sr.BridgeId.fromBuffer(Lf.from(n)),BigInt(r),BigInt(i),Lf.from(o),a,s,u?new Date(u):void 0,c,l,f,h?BigInt(h):void 0,d?BigInt(d):void 0,p,m,y?new g.TxId(Lf.from(y)):void 0);class $f{constructor(e,t,n,r,i){this.nullifier=e,this.txId=t,this.userId=n,this.secret=r,this.interactionNonce=i}}class Yf{constructor(e,t,n,r){this.userId=e,this.key=t,this.treeIndex=n,this.hashPath=r}}const Xf=({userId:e,key:t,treeIndex:n,hashPath:r})=>new Yf(new Uint8Array(e.toBuffer()),new Uint8Array(t),n,new Uint8Array(r)),eh=({userId:e,key:t,hashPath:n,...r})=>({...r,userId:new Wn.GrumpkinAddress(Lf.from(e)),key:Lf.from(t),hashPath:Lf.from(n)});class th{constructor(e,t,n){this.accountPublicKey=e,this.aliasHash=t,this.index=n}}const nh=({accountPublicKey:e,aliasHash:t,index:n})=>new th(new Uint8Array(e.toBuffer()),new Uint8Array(t.toBuffer()),n),rh=({accountPublicKey:e,aliasHash:t,index:n})=>({accountPublicKey:new Wn.GrumpkinAddress(Lf.from(e)),aliasHash:new f.AliasHash(Lf.from(t)),index:n}),ih=e=>[...e.filter((e=>!e.settled)).sort(((e,t)=>e.created<t.created?1:-1)),...e.filter((e=>e.settled))];class oh{constructor(e="hummus",t=6){this.dbName=e,this.version=t}async init(){this.createTables();try{await this.getUsers()}catch(e){await this.dexie.delete(),this.createTables()}}createTables(){this.dexie=new If(this.dbName),this.dexie.version(this.version).stores({alias:"&accountPublicKey, aliasHash",claimTx:"&nullifier, userId",key:"&name",mutex:"&name",note:"&commitment, nullifier, [owner+nullified], [owner+pending]",spendingKey:"&[userId+key], userId",user:"&id",userTx:"&[txId+userId], txId, [txId+proofId], [userId+proofId], proofId, settled, [userId+proofId+interactionNonce]"}),this.alias=this.dexie.table("alias"),this.claimTx=this.dexie.table("claimTx"),this.key=this.dexie.table("key"),this.mutex=this.dexie.table("mutex"),this.note=this.dexie.table("note"),this.spendingKey=this.dexie.table("spendingKey"),this.user=this.dexie.table("user"),this.userTx=this.dexie.table("userTx")}async close(){await this.dexie.close()}async clear(){for(const e of this.dexie.tables)await e.clear()}async addNote(e){await this.note.put((e=>new Uf(new Uint8Array(e.owner.toBuffer()),e.assetId,e.value.toString(),e.treeNote.accountRequired,new Uint8Array(e.treeNote.noteSecret),new Uint8Array(e.treeNote.creatorPubKey),new Uint8Array(e.treeNote.inputNullifier),e.commitment,e.nullifier,e.allowChain,e.index||0,e.nullified?1:0,void 0===e.index?1:0,e.hashPath?new Uint8Array(e.hashPath):void 0))(e))}async getNote(e){const t=await this.note.get({commitment:new Uint8Array(e)});return t?Ff(t):void 0}async getNoteByNullifier(e){const t=await this.note.get({nullifier:new Uint8Array(e)});return t?Ff(t):void 0}async nullifyNote(e){await this.note.where({nullifier:new Uint8Array(e)}).modify({nullified:1})}async addClaimTx(e){var t;await this.claimTx.put((t=e,new $f(new Uint8Array(t.nullifier),new Uint8Array(t.defiTxId.toBuffer()),new Uint8Array(t.userId.toBuffer()),new Uint8Array(t.secret),t.interactionNonce)))}async getClaimTx(e){const t=await this.claimTx.get({nullifier:new Uint8Array(e)});return t?(({nullifier:e,txId:t,userId:n,secret:r,interactionNonce:i})=>({nullifier:Lf.from(e),defiTxId:new g.TxId(Lf.from(t)),userId:new Wn.GrumpkinAddress(Lf.from(n)),secret:Lf.from(r),interactionNonce:i}))(t):void 0}async getNotes(e){return(await this.note.where({owner:new Uint8Array(e.toBuffer()),nullified:0}).toArray()).map(Ff)}async getPendingNotes(e){return(await this.note.where({owner:new Uint8Array(e.toBuffer()),pending:1}).toArray()).map(Ff)}async removeNote(e){await this.note.where({nullifier:new Uint8Array(e)}).delete()}async getUser(e){const t=await this.user.get(new Uint8Array(e.toBuffer()));return t?zf(t):void 0}async getUsers(){return(await this.user.toArray()).map(zf)}async addUser(e){await this.user.put(Vf(e))}async updateUser(e){await this.user.where({id:new Uint8Array(e.id.toBuffer())}).modify(Vf(e))}async addPaymentTx(e){await this.userTx.put((e=>new Wf(new Uint8Array(e.txId.toBuffer()),new Uint8Array(e.userId.toBuffer()),e.proofId,e.assetId,e.publicValue.toString(),e.privateInput.toString(),e.recipientPrivateOutput.toString(),e.senderPrivateOutput.toString(),e.isRecipient,e.isSender,e.accountRequired,e.txRefNo,e.created,e.settled?e.settled.getTime():0,e.publicOwner?new Uint8Array(e.publicOwner.toBuffer()):void 0))(e))}async getPaymentTx(e,t){const n=await this.userTx.get({txId:new Uint8Array(t.toBuffer()),userId:new Uint8Array(e.toBuffer())});return n&&[p.ProofId.DEPOSIT,p.ProofId.WITHDRAW,p.ProofId.SEND].includes(n.proofId)?Hf(n):void 0}async getPaymentTxs(e){const t=(await this.userTx.where({userId:new Uint8Array(e.toBuffer())}).reverse().sortBy("settled")).filter((e=>[p.ProofId.DEPOSIT,p.ProofId.WITHDRAW,p.ProofId.SEND].includes(e.proofId)));return ih(t).map(Hf)}async settlePaymentTx(e,t,n){await this.userTx.where({txId:new Uint8Array(t.toBuffer()),userId:new Uint8Array(e.toBuffer())}).modify({settled:n})}async addAccountTx(e){await this.userTx.put((e=>new Gf(new Uint8Array(e.txId.toBuffer()),new Uint8Array(e.userId.toBuffer()),p.ProofId.ACCOUNT,new Uint8Array(e.aliasHash.toBuffer()),e.migrated,e.txRefNo,e.created,e.settled?e.settled.getTime():0,e.newSpendingPublicKey1?new Uint8Array(e.newSpendingPublicKey1):void 0,e.newSpendingPublicKey2?new Uint8Array(e.newSpendingPublicKey2):void 0))(e))}async getAccountTx(e){const t=await this.userTx.get({txId:new Uint8Array(e.toBuffer()),proofId:p.ProofId.ACCOUNT});return t?Qf(t):void 0}async getAccountTxs(e){const t=await this.userTx.where({userId:new Uint8Array(e.toBuffer()),proofId:p.ProofId.ACCOUNT}).reverse().sortBy("settled");return ih(t).map(Qf)}async settleAccountTx(e,t){await this.userTx.where({txId:new Uint8Array(e.toBuffer()),proofId:p.ProofId.ACCOUNT}).modify({settled:t})}async addDefiTx(e){await this.userTx.put((e=>new Jf(new Uint8Array(e.txId.toBuffer()),new Uint8Array(e.userId.toBuffer()),p.ProofId.DEFI_DEPOSIT,new Uint8Array(e.bridgeId.toBuffer()),e.depositValue.toString(),e.txFee.toString(),new Uint8Array(e.partialStateSecret),e.txRefNo,e.created,e.settled?e.settled.getTime():0,e.interactionNonce,e.isAsync,e.success,e.outputValueA?.toString(),e.outputValueB?.toString(),e.finalised,e.claimSettled,e.claimTxId?new Uint8Array(e.claimTxId.toBuffer()):void 0))(e))}async getDefiTx(e){const t=await this.userTx.get({txId:new Uint8Array(e.toBuffer()),proofId:p.ProofId.DEFI_DEPOSIT});return t?Zf(t):void 0}async getDefiTxs(e){const t=await this.userTx.where({userId:new Uint8Array(e.toBuffer()),proofId:p.ProofId.DEFI_DEPOSIT}).reverse().sortBy("settled");return ih(t).map(Zf)}async getDefiTxsByNonce(e,t){const n=await this.userTx.where({userId:new Uint8Array(e.toBuffer()),proofId:p.ProofId.DEFI_DEPOSIT,interactionNonce:t}).reverse().sortBy("settled");return ih(n).map(Zf)}async settleDefiDeposit(e,t,n,r){await this.userTx.where({txId:new Uint8Array(e.toBuffer()),proofId:p.ProofId.DEFI_DEPOSIT}).modify({interactionNonce:t,isAsync:n,settled:r})}async updateDefiTxFinalisationResult(e,t,n,r,i){await this.userTx.where({txId:new Uint8Array(e.toBuffer()),proofId:p.ProofId.DEFI_DEPOSIT}).modify({success:t,outputValueA:n,outputValueB:r,finalised:i})}async settleDefiTx(e,t,n){await this.userTx.where({txId:new Uint8Array(e.toBuffer()),proofId:p.ProofId.DEFI_DEPOSIT}).modify({claimSettled:t,claimTxId:new Uint8Array(n.toBuffer())})}async getUserTxs(e){const t=await this.userTx.where({userId:new Uint8Array(e.toBuffer())}).reverse().sortBy("settled");return ih(t).map((e=>{switch(e.proofId){case p.ProofId.ACCOUNT:return Qf(e);case p.ProofId.DEFI_DEPOSIT:return Zf(e);default:return Hf(e)}}))}async isUserTxSettled(e){const t=await this.userTx.where({txId:new Uint8Array(e.toBuffer())}).toArray();return t.length>0&&t.every((e=>e.settled))}async getPendingUserTxs(e){return(await this.userTx.where({settled:0}).toArray()).flat().filter((t=>new Wn.GrumpkinAddress(Lf.from(t.userId)).equals(e))).map((({txId:e})=>new g.TxId(Lf.from(e))))}async removeUserTx(e,t){await this.userTx.where({txId:new Uint8Array(t.toBuffer()),userId:new Uint8Array(e.toBuffer())}).delete()}async removeUser(e){const t=new Uint8Array(e.toBuffer());await this.user.where({id:t}).delete(),await this.userTx.where({userId:t}).delete(),await this.claimTx.where({userId:t}).delete(),await this.spendingKey.where({userId:t}).delete(),await this.note.where({owner:t}).delete()}async resetUsers(){await this.user.toCollection().modify({syncedToRollup:-1}),await this.note.clear(),await this.userTx.clear(),await this.claimTx.clear(),await this.spendingKey.clear()}async deleteKey(e){const t=await this.key.get(e);if(t){for(let n=0;n<t.count;++n)await this.key.where({name:qf(e,n)}).delete();await this.key.where({name:e}).delete()}}async addKey(e,t){const n=t.byteLength;if(n<=1e8)await this.key.put({name:e,value:t,size:n});else{await this.deleteKey(e);const r=Math.ceil(n/1e8);for(let n=0;n<r;++n){const r=new Uint8Array(t.buffer.slice(1e8*n,1e8*(n+1)));await this.key.add({name:qf(e,n),value:r,size:r.byteLength})}await this.key.add({name:e,value:new Uint8Array,size:n,count:r})}}async getKey(e){const t=await this.key.get(e);if(!t||!t.size)return;if(!t.count)return Lf.from(t.value);const n=[...Array(t.count)].map(((t,n)=>qf(e,n))),r=await this.key.bulkGet(n);if(r.some((e=>!e)))return;const i=Lf.alloc(t.size);let o=0;for(let e=0;e<t.count;++e)i.set(r[e].value,o),o+=r[e].value.byteLength;return i}async addSpendingKey(e){await this.spendingKey.put(Xf(e))}async addSpendingKeys(e){await this.spendingKey.bulkPut(e.map(Xf))}async getSpendingKey(e,t){const n=await this.spendingKey.get({userId:new Uint8Array(e.toBuffer()),key:new Uint8Array(t.toBuffer().slice(0,32))});return n?eh(n):void 0}async getSpendingKeys(e){return(await this.spendingKey.where({userId:new Uint8Array(e.toBuffer())}).toArray()).map(eh)}async removeSpendingKeys(e){await this.spendingKey.where({userId:new Uint8Array(e.toBuffer())}).delete()}async addAlias(e){return this.addAliases([e])}async addAliases(e){const t=e.map(nh);await this.alias.bulkPut(t)}async getAlias(e){const t=await this.alias.get({accountPublicKey:new Uint8Array(e.toBuffer())});return t?rh(t):void 0}async getAliases(e){return(await this.alias.where({aliasHash:new Uint8Array(e.toBuffer())}).toArray()).map(rh).sort(((e,t)=>e.index<t.index?1:-1))}async acquireLock(e,t){const n=Date.now();await this.mutex.filter((t=>t.name===e&&t.expiredAt<=n)).delete();try{return await this.mutex.add({name:e,expiredAt:n+t}),!0}catch(e){return!1}}async extendLock(e,t){await this.mutex.update(e,{expiredAt:Date.now()+t})}async releaseLock(e){await this.mutex.delete(e)}}Wn=o("1T4rt"),Wn=o("1T4rt"),sr=o("jJK4a");const ah={to:e=>void 0!==e?`${e}`:"",from:e=>e?BigInt(e):void 0},sh={to:e=>e?.toBuffer(),from:e=>e?new Wn.GrumpkinAddress(e):void 0},uh={to:e=>e?.toBuffer(),from:e=>e?new f.AliasHash(e):void 0},ch={to:e=>e?.toBuffer(),from:e=>e?new g.TxId(e):void 0},lh={to:e=>e?.toBuffer(),from:e=>e?new Wn.EthAddress(e):void 0},fh={to:e=>e?.toBuffer(),from:e=>e?sr.BridgeId.fromBuffer(e):void 0};var hh,dh,ph,mh,yh,gh,bh,vh=T;let wh=class{afterLoad(){null===this.settled&&delete this.settled}};Ie([As("blob",{transformer:[ch]}),Pe("design:type","function"==typeof(hh=void 0!==g.TxId&&g.TxId)?hh:Object)],wh.prototype,"txId",void 0),Ie([Os({unique:!1}),Ms("blob",{transformer:[sh]}),Pe("design:type","function"==typeof(dh=void 0!==Wn.GrumpkinAddress&&Wn.GrumpkinAddress)?dh:Object)],wh.prototype,"userId",void 0),Ie([Ms("blob",{nullable:!0,transformer:[uh]}),Pe("design:type","function"==typeof(ph=void 0!==f.AliasHash&&f.AliasHash)?ph:Object)],wh.prototype,"aliasHash",void 0),Ie([Ms({nullable:!0}),Pe("design:type","function"==typeof(mh=void 0!==vh&&vh)?mh:Object)],wh.prototype,"newSpendingPublicKey1",void 0),Ie([Ms({nullable:!0}),Pe("design:type","function"==typeof(yh=void 0!==vh&&vh)?yh:Object)],wh.prototype,"newSpendingPublicKey2",void 0),Ie([Ms(),Pe("design:type",Boolean)],wh.prototype,"migrated",void 0),Ie([Ms(),Pe("design:type",Number)],wh.prototype,"txRefNo",void 0),Ie([Ms(),Pe("design:type","function"==typeof(gh="undefined"!=typeof Date&&Date)?gh:Object)],wh.prototype,"created",void 0),Ie([Ms({nullable:!0}),Pe("design:type","function"==typeof(bh="undefined"!=typeof Date&&Date)?bh:Object)],wh.prototype,"settled",void 0),Ie([Is(),Rs(),Ps(),Pe("design:type",Function),Pe("design:paramtypes",[]),Pe("design:returntype",void 0)],wh.prototype,"afterLoad",null),wh=Ie([Ns({name:"accountTx"})],wh);var _h,Eh,Sh;Wn=o("1T4rt");let xh=class{constructor(e){Object.assign(this,e)}};Ie([As("blob",{transformer:[sh]}),Pe("design:type","function"==typeof(_h=void 0!==Wn.GrumpkinAddress&&Wn.GrumpkinAddress)?_h:Object)],xh.prototype,"accountPublicKey",void 0),Ie([Os({unique:!1}),Ms("blob",{transformer:[uh]}),Pe("design:type","function"==typeof(Eh=void 0!==f.AliasHash&&f.AliasHash)?Eh:Object)],xh.prototype,"aliasHash",void 0),Ie([Ms(),Pe("design:type",Number)],xh.prototype,"index",void 0),xh=Ie([Ns({name:"alias"}),Pe("design:paramtypes",["function"==typeof(Sh=void 0!==Bs&&Bs)?Sh:Object])],xh);Wn=o("1T4rt");var Th,Mh,Ah,Rh,Ih=T;let Ph=class{};Ie([As(),Pe("design:type","function"==typeof(Th=void 0!==Ih&&Ih)?Th:Object)],Ph.prototype,"nullifier",void 0),Ie([Ms("blob",{transformer:[ch]}),Pe("design:type","function"==typeof(Mh=void 0!==g.TxId&&g.TxId)?Mh:Object)],Ph.prototype,"defiTxId",void 0),Ie([Os({unique:!1}),Ms("blob",{transformer:[sh]}),Pe("design:type","function"==typeof(Ah=void 0!==Wn.GrumpkinAddress&&Wn.GrumpkinAddress)?Ah:Object)],Ph.prototype,"userId",void 0),Ie([Ms(),Pe("design:type","function"==typeof(Rh=void 0!==Ih&&Ih)?Rh:Object)],Ph.prototype,"secret",void 0),Ie([Ms(),Pe("design:type",Number)],Ph.prototype,"interactionNonce",void 0),Ph=Ie([Ns({name:"claimTx"})],Ph);Wn=o("1T4rt"),sr=o("jJK4a");var Nh,Oh,Ch,kh,Bh,Dh,jh,Lh,qh,Uh=T;let Fh=class{afterLoad(){null===this.settled&&delete this.settled,null===this.interactionNonce&&delete this.interactionNonce,null===this.isAsync&&delete this.isAsync,null===this.success&&delete this.success,null===this.outputValueA&&delete this.outputValueA,null===this.outputValueB&&delete this.outputValueB,null===this.finalised&&delete this.finalised,null===this.claimSettled&&delete this.claimSettled,null===this.claimTxId&&delete this.claimTxId}};Ie([As("blob",{transformer:[ch]}),Pe("design:type","function"==typeof(Nh=void 0!==g.TxId&&g.TxId)?Nh:Object)],Fh.prototype,"txId",void 0),Ie([Os({unique:!1}),Ms("blob",{transformer:[sh]}),Pe("design:type","function"==typeof(Oh=void 0!==Wn.GrumpkinAddress&&Wn.GrumpkinAddress)?Oh:Object)],Fh.prototype,"userId",void 0),Ie([Ms("blob",{transformer:[fh]}),Pe("design:type","function"==typeof(Ch=void 0!==sr.BridgeId&&sr.BridgeId)?Ch:Object)],Fh.prototype,"bridgeId",void 0),Ie([Ms("text",{transformer:[ah]}),Pe("design:type","function"==typeof BigInt?BigInt:Object)],Fh.prototype,"depositValue",void 0),Ie([Ms("text",{transformer:[ah]}),Pe("design:type","function"==typeof BigInt?BigInt:Object)],Fh.prototype,"txFee",void 0),Ie([Ms(),Pe("design:type","function"==typeof(kh=void 0!==Uh&&Uh)?kh:Object)],Fh.prototype,"partialStateSecret",void 0),Ie([Ms(),Pe("design:type",Number)],Fh.prototype,"txRefNo",void 0),Ie([Ms(),Pe("design:type","function"==typeof(Bh="undefined"!=typeof Date&&Date)?Bh:Object)],Fh.prototype,"created",void 0),Ie([Ms({nullable:!0}),Pe("design:type","function"==typeof(Dh="undefined"!=typeof Date&&Date)?Dh:Object)],Fh.prototype,"settled",void 0),Ie([Os({unique:!1}),Ms({nullable:!0}),Pe("design:type",Number)],Fh.prototype,"interactionNonce",void 0),Ie([Ms({nullable:!0}),Pe("design:type",Boolean)],Fh.prototype,"isAsync",void 0),Ie([Ms({nullable:!0}),Pe("design:type",Boolean)],Fh.prototype,"success",void 0),Ie([Ms("text",{transformer:[ah],nullable:!0}),Pe("design:type","function"==typeof BigInt?BigInt:Object)],Fh.prototype,"outputValueA",void 0),Ie([Ms("text",{transformer:[ah],nullable:!0}),Pe("design:type","function"==typeof BigInt?BigInt:Object)],Fh.prototype,"outputValueB",void 0),Ie([Ms({nullable:!0}),Pe("design:type","function"==typeof(jh="undefined"!=typeof Date&&Date)?jh:Object)],Fh.prototype,"finalised",void 0),Ie([Ms({nullable:!0}),Pe("design:type","function"==typeof(Lh="undefined"!=typeof Date&&Date)?Lh:Object)],Fh.prototype,"claimSettled",void 0),Ie([Ms("blob",{nullable:!0,transformer:[ch]}),Pe("design:type","function"==typeof(qh=void 0!==g.TxId&&g.TxId)?qh:Object)],Fh.prototype,"claimTxId",void 0),Ie([Is(),Rs(),Ps(),Pe("design:type",Function),Pe("design:paramtypes",[]),Pe("design:returntype",void 0)],Fh.prototype,"afterLoad",null),Fh=Ie([Ns({name:"defiTx"})],Fh);var Kh,Vh=T;let zh=class{};Ie([As(),Pe("design:type",String)],zh.prototype,"name",void 0),Ie([Ms(),Pe("design:type","function"==typeof(Kh=void 0!==Vh&&Vh)?Kh:Object)],zh.prototype,"value",void 0),zh=Ie([Ns({name:"key"})],zh);let Wh=class{};Ie([As(),Pe("design:type",String)],Wh.prototype,"name",void 0),Ie([Os({unique:!1}),Ms(),Pe("design:type",Number)],Wh.prototype,"expiredAt",void 0),Wh=Ie([Ns({name:"mutex"})],Wh);Wn=o("1T4rt"),$n=o("4G3uU");var Hh,Gh,Qh,Jh,Zh,$h,Yh,Xh=T;let ed=class{afterLoad(){this.hashPath||delete this.hashPath,null===this.index&&delete this.index}};Ie([As(),Pe("design:type","function"==typeof(Hh=void 0!==Xh&&Xh)?Hh:Object)],ed.prototype,"commitment",void 0),Ie([Os({unique:!0}),Ms(),Pe("design:type","function"==typeof(Gh=void 0!==Xh&&Xh)?Gh:Object)],ed.prototype,"nullifier",void 0),Ie([Ms(),Pe("design:type","function"==typeof(Qh=void 0!==Xh&&Xh)?Qh:Object)],ed.prototype,"noteSecret",void 0),Ie([Ms("blob",{transformer:[sh]}),Pe("design:type","function"==typeof(Jh=void 0!==Wn.GrumpkinAddress&&Wn.GrumpkinAddress)?Jh:Object)],ed.prototype,"owner",void 0),Ie([Ms(),Pe("design:type",Boolean)],ed.prototype,"accountRequired",void 0),Ie([Ms(),Pe("design:type","function"==typeof(Zh=void 0!==Xh&&Xh)?Zh:Object)],ed.prototype,"creatorPubKey",void 0),Ie([Ms(),Pe("design:type","function"==typeof($h=void 0!==Xh&&Xh)?$h:Object)],ed.prototype,"inputNullifier",void 0),Ie([Ms(),Pe("design:type",Number)],ed.prototype,"assetId",void 0),Ie([Ms("text",{transformer:[ah]}),Pe("design:type","function"==typeof BigInt?BigInt:Object)],ed.prototype,"value",void 0),Ie([Ms(),Pe("design:type",Boolean)],ed.prototype,"allowChain",void 0),Ie([Os({unique:!1}),Ms({nullable:!0}),Pe("design:type",Number)],ed.prototype,"index",void 0),Ie([Os({unique:!1}),Ms(),Pe("design:type",Boolean)],ed.prototype,"nullified",void 0),Ie([Ms({nullable:!0}),Pe("design:type","function"==typeof(Yh=void 0!==Xh&&Xh)?Yh:Object)],ed.prototype,"hashPath",void 0),Ie([Is(),Rs(),Ps(),Pe("design:type",Function),Pe("design:paramtypes",[]),Pe("design:returntype",void 0)],ed.prototype,"afterLoad",null),ed=Ie([Ns({name:"note"})],ed);const td=({commitment:e,nullifier:t,noteSecret:n,owner:r,accountRequired:i,creatorPubKey:o,inputNullifier:a,assetId:s,value:u,allowChain:c,index:l,nullified:f,hashPath:h})=>new gr(new $n.TreeNote(r,u,s,i,n,o,a),e,t,c,f,l,h);var nd,rd,id,od;Wn=o("1T4rt");let ad=class{afterLoad(){null===this.settled&&delete this.settled}};Ie([As("blob",{transformer:[ch]}),Pe("design:type","function"==typeof(nd=void 0!==g.TxId&&g.TxId)?nd:Object)],ad.prototype,"txId",void 0),Ie([As("blob",{transformer:[sh]}),Pe("design:type","function"==typeof(rd=void 0!==Wn.GrumpkinAddress&&Wn.GrumpkinAddress)?rd:Object)],ad.prototype,"userId",void 0),Ie([Ms(),Pe("design:type",Number)],ad.prototype,"proofId",void 0),Ie([Ms(),Pe("design:type",Number)],ad.prototype,"assetId",void 0),Ie([Ms("text",{transformer:[ah]}),Pe("design:type","function"==typeof BigInt?BigInt:Object)],ad.prototype,"publicValue",void 0),Ie([Ms("blob",{transformer:[lh],nullable:!0}),Pe("design:type",Object)],ad.prototype,"publicOwner",void 0),Ie([Ms("text",{transformer:[ah]}),Pe("design:type","function"==typeof BigInt?BigInt:Object)],ad.prototype,"privateInput",void 0),Ie([Ms("text",{transformer:[ah]}),Pe("design:type","function"==typeof BigInt?BigInt:Object)],ad.prototype,"recipientPrivateOutput",void 0),Ie([Ms("text",{transformer:[ah]}),Pe("design:type","function"==typeof BigInt?BigInt:Object)],ad.prototype,"senderPrivateOutput",void 0),Ie([Ms(),Pe("design:type",Boolean)],ad.prototype,"isRecipient",void 0),Ie([Ms(),Pe("design:type",Boolean)],ad.prototype,"isSender",void 0),Ie([Ms(),Pe("design:type",Boolean)],ad.prototype,"accountRequired",void 0),Ie([Ms(),Pe("design:type",Number)],ad.prototype,"txRefNo",void 0),Ie([Ms(),Pe("design:type","function"==typeof(id="undefined"!=typeof Date&&Date)?id:Object)],ad.prototype,"created",void 0),Ie([Ms({nullable:!0}),Pe("design:type","function"==typeof(od="undefined"!=typeof Date&&Date)?od:Object)],ad.prototype,"settled",void 0),Ie([Is(),Rs(),Ps(),Pe("design:type",Function),Pe("design:paramtypes",[]),Pe("design:returntype",void 0)],ad.prototype,"afterLoad",null),ad=Ie([Ns({name:"paymentTx"}),Os(["txId","userId"],{unique:!0})],ad);Wn=o("1T4rt");var sd,ud,cd,ld,fd=T;let hd=class{constructor(e){Object.assign(this,e)}};Ie([As(),Pe("design:type","function"==typeof(sd=void 0!==fd&&fd)?sd:Object)],hd.prototype,"key",void 0),Ie([As("blob",{transformer:[sh]}),Pe("design:type","function"==typeof(ud=void 0!==Wn.GrumpkinAddress&&Wn.GrumpkinAddress)?ud:Object)],hd.prototype,"userId",void 0),Ie([Ms(),Pe("design:type",Number)],hd.prototype,"treeIndex",void 0),Ie([Ms(),Pe("design:type","function"==typeof(cd=void 0!==fd&&fd)?cd:Object)],hd.prototype,"hashPath",void 0),hd=Ie([Ns({name:"spendingKey"}),Os(["key","userId"],{unique:!0}),Pe("design:paramtypes",["function"==typeof(ld=void 0!==ks&&ks)?ld:Object])],hd);Wn=o("1T4rt");var dd,pd,md,yd=T;let gd=class{};Ie([As("blob",{transformer:[sh]}),Pe("design:type","function"==typeof(dd=void 0!==Wn.GrumpkinAddress&&Wn.GrumpkinAddress)?dd:Object)],gd.prototype,"id",void 0),Ie([Ms("blob",{transformer:[sh]}),Pe("design:type","function"==typeof(pd=void 0!==Wn.GrumpkinAddress&&Wn.GrumpkinAddress)?pd:Object)],gd.prototype,"accountPublicKey",void 0),Ie([Ms(),Pe("design:type","function"==typeof(md=void 0!==yd&&yd)?md:Object)],gd.prototype,"accountPrivateKey",void 0),Ie([Ms(),Pe("design:type",Number)],gd.prototype,"syncedToRollup",void 0),gd=Ie([Ns({name:"userData"})],gd);const bd=e=>new lr(e.txId,e.userId,e.proofId,e.assetId,e.publicValue,e.publicOwner,e.privateInput,e.recipientPrivateOutput,e.senderPrivateOutput,e.isRecipient,e.isSender,e.accountRequired,e.txRefNo,e.created,e.settled),vd=e=>new ar(e.txId,e.userId,e.aliasHash,e.newSpendingPublicKey1,e.newSpendingPublicKey2,e.migrated,e.txRefNo,e.created,e.settled),wd=e=>new cr(e.txId,e.userId,e.bridgeId,e.depositValue,e.txFee,e.partialStateSecret,e.txRefNo,e.created,e.settled,e.interactionNonce,e.isAsync,e.success,e.outputValueA,e.outputValueB,e.finalised,e.claimSettled,e.claimTxId),_d=e=>[...e.filter((e=>!e.settled)).sort(((e,t)=>e.created<t.created?1:-1)),...e.filter((e=>e.settled))];class Ed{constructor(e){this.connection=e,this.accountTxRep=this.connection.getRepository(wh),this.aliasRep=this.connection.getRepository(xh),this.claimTxRep=this.connection.getRepository(Ph),this.defiTxRep=this.connection.getRepository(Fh),this.keyRep=this.connection.getRepository(zh),this.noteRep=this.connection.getRepository(ed),this.paymentTxRep=this.connection.getRepository(ad),this.userDataRep=this.connection.getRepository(gd),this.spendingKeyRep=this.connection.getRepository(hd),this.mutex=this.connection.getRepository(Wh)}async init(){}async close(){await this.connection.close()}async clear(){await this.connection.synchronize(!0)}async addNote(e){await this.noteRep.save((({treeNote:{noteSecret:e,ownerPubKey:t,accountRequired:n,creatorPubKey:r,inputNullifier:i,assetId:o},commitment:a,nullifier:s,value:u,allowChain:c,index:l,nullified:f,hashPath:h})=>({commitment:a,nullifier:s,noteSecret:e,owner:t,accountRequired:n,creatorPubKey:r,inputNullifier:i,assetId:o,value:u,allowChain:c,nullified:f,index:l,hashPath:h}))(e))}async getNote(e){const t=await this.noteRep.findOne({commitment:e});return t?td(t):void 0}async getNoteByNullifier(e){const t=await this.noteRep.findOne({nullifier:e});return t?td(t):void 0}async nullifyNote(e){await this.noteRep.update({nullifier:e},{nullified:!0})}async getNotes(e){return(await this.noteRep.find({where:{owner:e,nullified:!1}})).map(td)}async getPendingNotes(e){return(await this.noteRep.find({where:{owner:e,index:Cs()}})).map(td)}async removeNote(e){await this.noteRep.delete({nullifier:e})}async getUser(e){return this.userDataRep.findOne({id:e})}async addUser(e){await this.userDataRep.save(e)}async getUsers(){return this.userDataRep.find()}async updateUser(e){await this.userDataRep.update({id:e.id},e)}async removeUser(e){await this.getUser(e)&&(await this.accountTxRep.delete({userId:e}),await this.claimTxRep.delete({userId:e}),await this.paymentTxRep.delete({userId:e}),await this.spendingKeyRep.delete({userId:e}),await this.noteRep.delete({owner:e}),await this.userDataRep.delete({id:e}))}async resetUsers(){var e;await this.noteRep.clear(),await this.spendingKeyRep.clear(),await this.accountTxRep.clear(),await this.claimTxRep.clear(),await this.paymentTxRep.clear(),await this.userDataRep.update({syncedToRollup:(e=-1,new Xt("moreThan",e))},{syncedToRollup:-1})}async addPaymentTx(e){await this.paymentTxRep.save({...e})}async getPaymentTx(e,t){const n=await this.paymentTxRep.findOne({txId:t,userId:e});return n?bd(n):void 0}async getPaymentTxs(e){const t=await this.paymentTxRep.find({where:{userId:e},order:{settled:"DESC"}});return _d(t).map(bd)}async settlePaymentTx(e,t,n){await this.paymentTxRep.update({txId:t,userId:e},{settled:n})}async addAccountTx(e){await this.accountTxRep.save({...e})}async getAccountTx(e){const t=await this.accountTxRep.findOne({txId:e});return t?vd(t):void 0}async getAccountTxs(e){const t=await this.accountTxRep.find({where:{userId:e},order:{settled:"DESC"}});return _d(t).map(vd)}async settleAccountTx(e,t){await this.accountTxRep.update({txId:e},{settled:t})}async addDefiTx(e){await this.defiTxRep.save({...e})}async getDefiTx(e){const t=await this.defiTxRep.findOne({txId:e});return t?wd(t):void 0}async getDefiTxs(e){const t=await this.defiTxRep.find({where:{userId:e},order:{settled:"DESC"}});return _d(t).map(wd)}async getDefiTxsByNonce(e,t){const n=await this.defiTxRep.find({where:{userId:e,interactionNonce:t},order:{settled:"DESC"}});return _d(n).map(wd)}async settleDefiDeposit(e,t,n,r){await this.defiTxRep.update({txId:e},{interactionNonce:t,isAsync:n,settled:r})}async updateDefiTxFinalisationResult(e,t,n,r,i){await this.defiTxRep.update({txId:e},{success:t,outputValueA:n,outputValueB:r,finalised:i})}async settleDefiTx(e,t,n){await this.defiTxRep.update({txId:e},{claimSettled:t,claimTxId:n})}async addClaimTx(e){await this.claimTxRep.save(e)}async getClaimTx(e){return this.claimTxRep.findOne({nullifier:e})}async getUserTxs(e){const t=(await Promise.all([this.getAccountTxs(e),this.getPaymentTxs(e),this.getDefiTxs(e)])).flat();return[...t.filter((e=>!e.settled)).sort(((e,t)=>e.created<t.created?1:-1)),...t.filter((e=>e.settled)).sort(((e,t)=>e.settled<t.settled?1:e.settled>t.settled?-1:0))]}async isUserTxSettled(e){const t=await this.paymentTxRep.find({where:{txId:e}});if(t.length>0)return t.every((e=>e.settled));const n=await this.defiTxRep.findOne({where:{txId:e}});if(n)return!!n.settled;return!!(await this.accountTxRep.findOne({where:{txId:e}}))?.settled}async getPendingUserTxs(e){return(await Promise.all([this.accountTxRep.find({where:{userId:e,settled:Cs()}}),this.paymentTxRep.find({where:{userId:e,settled:Cs()}}),this.defiTxRep.find({where:{userId:e,settled:Cs()}})])).flat().map((({txId:e})=>e))}async removeUserTx(e,t){await Promise.all([this.accountTxRep.delete({txId:t}),this.paymentTxRep.delete({txId:t,userId:e}),this.defiTxRep.delete({txId:t,userId:e})])}async addSpendingKey(e){await this.spendingKeyRep.save(e)}async addBulkItems(e,t,n,r){let i=r,o=!1;for(;!o;){const r=[...t],a=Ts(this.connection.name).createQueryRunner();await a.connect();const s=a.manager.getRepository(e);await a.startTransaction();try{for(;r.length;){const e=r.slice(0,i).map((e=>new n(e)));await s.save(e),r.splice(0,i)}await a.commitTransaction(),await a.release(),o=!0}catch(e){if(await a.rollbackTransaction(),await a.release(),i/=2,i<1)throw new Error(`Unable to insert entity, error: ${e}`);i=Math.round(i)}}}async addSpendingKeys(e){await this.addBulkItems("SpendingKeyDao",e,hd,100)}async getSpendingKey(e,t){const n=t.toBuffer();return await this.spendingKeyRep.findOne({where:{userId:e,key:n.slice(0,32)}})??void 0}async getSpendingKeys(e){return await this.spendingKeyRep.find({userId:e})}async removeSpendingKeys(e){await this.spendingKeyRep.delete({userId:e})}async addAlias(e){await this.aliasRep.save(e)}async addAliases(e){await this.addBulkItems("AliasDao",e,xh,100)}async getAlias(e){return this.aliasRep.findOne({accountPublicKey:e})}async getAliases(e){return this.aliasRep.find({where:{aliasHash:e},order:{index:"DESC"}})}async addKey(e,t){await this.keyRep.save({name:e,value:t})}async getKey(e){const t=await this.keyRep.findOne({name:e});return t?t.value:void 0}async deleteKey(e){await this.keyRep.delete({name:e})}async acquireLock(e,t){var n;await this.mutex.delete({name:e,expiredAt:(n=Date.now(),new Xt("lessThanOrEqual",n))});try{return await this.mutex.insert({name:e,expiredAt:Date.now()+t}),!0}catch(e){return!1}}async extendLock(e,t){await this.mutex.update(e,{expiredAt:Date.now()+t})}async releaseLock(e){await this.mutex.delete({name:e})}}const Sd=h.createLogger("bb:create_vanilla_core_sdk");async function xd(e=!1,t){if(n(false)){const n=((e=!1,t)=>({name:"aztec2-sdk"+(t?`-${t}`:""),type:"sqlite",database:e?":memory:":"./data"+(t?`/${t}`:"")+"/aztec2-sdk.sqlite",entities:[wh,xh,Ph,Fh,zh,Wh,ed,ad,gd,hd],synchronize:!0,logging:!1}))(e,t),r=await function(e){return Ne(this,void 0,void 0,(function(){var t,n,r;return Oe(this,(function(i){switch(i.label){case 0:return t="string"==typeof e?e:"default",e instanceof Object?(r=e,[3,3]):[3,1];case 1:return[4,Ss(t)];case 2:r=i.sent(),i.label=3;case 3:return n=r,[2,xs().create(n).connect()]}}))}))}(n);return new Ed(r)}return new oh}async function Td(e){Sd("creating vanilla core sdk...");const{numWorkers:t=uo()}=e,r=await no.BarretenbergWasm.new(),i=await no.WorkerPool.new(r,t),a=new v.PooledPedersen(r,i),s=new to.PooledPippenger(i),u=new eo.PooledFftFactory(i),{memoryDb:c,identifier:l,serverUrl:f,pollInterval:h}=e,d=function(e=!1,t){if(n(!1)){const r="./data"+(t?`/${t}`:"");return e?n(hi)(o("fO1PS")()):(io.mkdirSync(r,{recursive:!0}),n(hi)(o("gO7hz")(`${r}/aztec2-sdk.db`)))}return n(hi)(o("bYdEu")("aztec2-sdk"))}(c,l),p=await xd(c,l);await p.init();const m=new URL(f),y=new ri.ServerRollupProvider(m,h),g=new ti(d,p,y,r,a,s,u,i);return await g.init(e),g}Ln=o("3KgUz");var Md=T;class Ad extends Ln.EventEmitter{constructor(e,t,n){super(),this.core=e,this.origin=t,this.leveldb=n,this.serialQueue=new Dr;for(const e in Jr){const t=Jr[e];this.core.on(t,((...e)=>this.emit(t,...e)))}}async init(e){await this.core.init(e)}async run(){await this.core.run()}async destroy(){await this.core.destroy(),await this.leveldb.close()}async getLocalStatus(){return this.core.getLocalStatus()}async getRemoteStatus(){return this.core.getRemoteStatus()}async isAccountRegistered(e){return this.core.isAccountRegistered(e)}async isRemoteAccountRegistered(e){return this.core.isRemoteAccountRegistered(e)}async isAliasRegistered(e){return this.core.isAliasRegistered(e)}async isRemoteAliasRegistered(e){return this.core.isRemoteAliasRegistered(e)}async accountExists(e,t){return this.core.accountExists(e,t)}async remoteAccountExists(e,t){return this.core.remoteAccountExists(e,t)}async getAccountPublicKey(e){return(await this.core.getAccountPublicKey(e))?.toString()}async getRemoteUnsettledAccountPublicKey(e){return(await this.core.getRemoteUnsettledAccountPublicKey(e))?.toString()}async getTxFees(e){return this.core.getTxFees(e)}async getDefiFees(e){return this.core.getDefiFees(e)}async createDepositProof(e,t,n,r,i,o,a){return this.core.createDepositProof(e,t,n,r,i,o,a)}async createPaymentProofInput(e,t,n,r,i,o,a,s,u,c,l,f){return await this.checkPermission(e),this.core.createPaymentProofInput(e,t,n,r,i,o,a,s,u,c,l,f)}async createPaymentProof(e,t){const{tx:{outputNotes:n}}=Nr(e),r=n[1].ownerPubKey;return await this.checkPermission(r.toString()),this.core.createPaymentProof(e,t)}async createAccountProofSigningData(e,t,n,r,i,o,a){return this.core.createAccountProofSigningData(e,t,n,r,i,o,a)}async createAccountProofInput(e,t,n,r,i,o,a){return this.core.createAccountProofInput(e,t,n,r,i,o,a)}async createAccountProof(e,t){const{tx:{accountPublicKey:n}}=Ir(e);return await this.checkPermission(n.toString()),this.core.createAccountProof(e,t)}async createDefiProofInput(e,t,n,r,i){return await this.checkPermission(e),this.core.createDefiProofInput(e,t,n,r,i)}async createDefiProof(e,t){const{tx:{outputNotes:n}}=Nr(e),r=n[1].ownerPubKey;return await this.checkPermission(r.toString()),this.core.createDefiProof(e,t)}async sendProofs(e){return this.core.sendProofs(e)}async awaitSynchronised(){await this.core.awaitSynchronised()}async isUserSynching(e){return await this.checkPermission(e),this.core.isUserSynching(e)}async awaitUserSynchronised(e){await this.checkPermission(e),await this.core.awaitUserSynchronised(e)}async awaitSettlement(e,t){await this.core.awaitSettlement(e,t)}async awaitDefiDepositCompletion(e,t){await this.core.awaitDefiDepositCompletion(e,t)}async awaitDefiFinalisation(e,t){await this.core.awaitDefiFinalisation(e,t)}async awaitDefiSettlement(e,t){await this.core.awaitDefiSettlement(e,t)}async getDefiInteractionNonce(e){return this.core.getDefiInteractionNonce(e)}async userExists(e){return await this.hasPermission(e)&&await this.core.userExists(e)}async getUserData(e){return await this.checkPermission(e),this.core.getUserData(e)}async getUsersData(){const e=await this.core.getUsersData(),t=await Promise.all(e.map((e=>this.hasPermission(e.id))));return e.filter(((e,n)=>t[n]))}async derivePublicKey(e){return this.core.derivePublicKey(e)}async constructSignature(e,t){return this.core.constructSignature(e,t)}async addUser(e,t){return this.serialQueue.push((async()=>{let n;try{const n=await this.core.addUser(e,t);return await this.addPermission(n.id),n}catch(e){n=e}const r=await this.core.derivePublicKey(e);try{const e=await this.core.getUserData(r);return await this.addPermission(r),e}catch(e){throw n}}))}async removeUser(e){return this.serialQueue.push((async()=>{await this.checkPermission(e);1===(await this.getUserDomains(e)).length&&await this.core.removeUser(e),await this.removePermission(e)}))}async getSpendingKeys(e){return await this.checkPermission(e),this.core.getSpendingKeys(e)}async getBalances(e,t){return await this.checkPermission(e),this.core.getBalances(e,t)}async getBalance(e,t,n){return await this.checkPermission(e),this.core.getBalance(e,t,n)}async getSpendableSum(e,t,n,r){return await this.checkPermission(e),this.core.getSpendableSum(e,t,n,r)}async getSpendableSums(e,t,n){return await this.checkPermission(e),this.core.getSpendableSums(e,t,n)}async getMaxSpendableValue(e,t,n,r,i){return await this.checkPermission(e),this.core.getMaxSpendableValue(e,t,n,r,i)}async pickNotes(e,t,n,r,i){return await this.checkPermission(e),this.core.pickNotes(e,t,n,r,i)}async pickNote(e,t,n,r,i){return await this.checkPermission(e),this.core.pickNote(e,t,n,r,i)}async getUserTxs(e){return await this.checkPermission(e),this.core.getUserTxs(e)}async getRemoteUnsettledPaymentTxs(){return this.core.getRemoteUnsettledPaymentTxs()}async checkPermission(e){if(!await this.hasPermission(e))throw new Error(`User not permitted: ${e}`)}async hasPermission(e){return(await this.getUserDomains(e)).includes(this.origin)}async addPermission(e){const t=await this.getUserDomains(e);await this.updateUserDomains(e,[...t,this.origin])}async removePermission(e){const t=(await this.getUserDomains(e)).filter((e=>e!==this.origin));await this.updateUserDomains(e,t)}async updateUserDomains(e,t){await this.leveldb.put(e,Md.from(JSON.stringify(t)))}async getUserDomains(e){return this.leveldb.get(e).then((e=>JSON.parse(e.toString()))).catch((()=>[]))}}const Rd=h.createLogger("bb:create_caramel_core_sdk");async function Id(e,t){Rd("creating origin permissioned backend...");const r=void 0!==window.SharedWorker?await Mo(t):await Td(t),i=n(hi)(o("bYdEu")("aztec2-sdk-auth"));return new Ad(new fi(r),e,i)}const Pd=h.createLogger("aztec:sdk:iframe_backend");class Nd extends(n(Ln)){constructor(e){super(),this.origin=e,this.coreSdkDispatch=Kn(this,"coreSdk",Pd)}async initComponents(e){this.initPromise||(this.initPromise=this.initInternal(e)),await this.initPromise}async initInternal(e){e.debug&&h.enableLogs(e.debug);const t=await async function(){{const e=await fetch("/DEPLOY_TAG",{}).then((e=>e.ok?e.text():"")).catch((()=>""));if(e)return`https://api.aztec.network/${e}/falafel`;{const e=await fetch("/ROLLUP_PROVIDER_URL");if(!e.ok)throw new Error("Failed to fetch /ROLLUP_PROVIDER_URL.");return e.text()}}}();this.coreSdk=await Id(this.origin,{...e,serverUrl:t});for(const e in Jr){const t=Jr[e];this.coreSdk.on(t,((...e)=>{this.emit("dispatch_msg",{fn:"coreSdkDispatch",args:[{fn:"emit",args:[t,...e]}]})}))}}}Ln=o("3KgUz");class Od extends(n(Ln)){constructor(e){super(),this.window=e,this.handleMessageEvent=e=>{const[t]=e.ports;t&&this.emit("new_socket",new Fn(t))}}open(){this.window.addEventListener("message",this.handleMessageEvent)}close(){this.window.removeEventListener("message",this.handleMessageEvent)}}!function(){const e=new Nd(document.referrer),t=new Od(window),n=new zn(t,(async({fn:t,args:n})=>e[t](...n)));e.on("dispatch_msg",(e=>n.broadcast(e))),n.start(),window.parent.postMessage("Ready","*")}();